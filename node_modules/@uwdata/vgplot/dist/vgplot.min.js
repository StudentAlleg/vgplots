var vW=Object.create;var cA=Object.defineProperty;var SW=Object.getOwnPropertyDescriptor;var IW=Object.getOwnPropertyNames;var TW=Object.getPrototypeOf,AW=Object.prototype.hasOwnProperty;var ZN=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Qr=(e,t)=>{for(var r in t)cA(e,r,{get:t[r],enumerable:!0})},MW=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of IW(t))!AW.call(e,i)&&i!==r&&cA(e,i,{get:()=>t[i],enumerable:!(n=SW(t,i))||n.enumerable});return e};var EW=(e,t,r)=>(r=e!=null?vW(TW(e)):{},MW(t||!e||!e.__esModule?cA(r,"default",{value:e,enumerable:!0}):r,e));var a9=ZN((cre,s9)=>{"use strict";function ylt(e,t,r,n,i){for(var o=i+1;n<=i;){var s=n+i>>>1,a=e[s],c=r!==void 0?r(a,t):a-t;c>=0?(o=s,i=s-1):n=s+1}return o}function glt(e,t,r,n,i){for(var o=i+1;n<=i;){var s=n+i>>>1,a=e[s],c=r!==void 0?r(a,t):a-t;c>0?(o=s,i=s-1):n=s+1}return o}function blt(e,t,r,n,i){for(var o=n-1;n<=i;){var s=n+i>>>1,a=e[s],c=r!==void 0?r(a,t):a-t;c<0?(o=s,n=s+1):i=s-1}return o}function xlt(e,t,r,n,i){for(var o=n-1;n<=i;){var s=n+i>>>1,a=e[s],c=r!==void 0?r(a,t):a-t;c<=0?(o=s,n=s+1):i=s-1}return o}function _lt(e,t,r,n,i){for(;n<=i;){var o=n+i>>>1,s=e[o],a=r!==void 0?r(s,t):s-t;if(a===0)return o;a<=0?n=o+1:i=o-1}return-1}function Zb(e,t,r,n,i,o){return typeof r=="function"?o(e,t,r,n===void 0?0:n|0,i===void 0?e.length-1:i|0):o(e,t,void 0,r===void 0?0:r|0,n===void 0?e.length-1:n|0)}s9.exports={ge:function(e,t,r,n,i){return Zb(e,t,r,n,i,ylt)},gt:function(e,t,r,n,i){return Zb(e,t,r,n,i,glt)},lt:function(e,t,r,n,i){return Zb(e,t,r,n,i,blt)},le:function(e,t,r,n,i){return Zb(e,t,r,n,i,xlt)},eq:function(e,t,r,n,i){return Zb(e,t,r,n,i,_lt)}}});var m9=ZN((lre,p9)=>{"use strict";var AT=a9(),tm=0,dd=1,TT=2;p9.exports=vlt;function pN(e,t,r,n,i){this.mid=e,this.left=t,this.right=r,this.leftPoints=n,this.rightPoints=i,this.count=(t?t.count:0)+(r?r.count:0)+n.length}var Kb=pN.prototype;function dN(e,t){e.mid=t.mid,e.left=t.left,e.right=t.right,e.leftPoints=t.leftPoints,e.rightPoints=t.rightPoints,e.count=t.count}function u9(e,t){var r=em(t);e.mid=r.mid,e.left=r.left,e.right=r.right,e.leftPoints=r.leftPoints,e.rightPoints=r.rightPoints,e.count=r.count}function c9(e,t){var r=e.intervals([]);r.push(t),u9(e,r)}function l9(e,t){var r=e.intervals([]),n=r.indexOf(t);return n<0?tm:(r.splice(n,1),u9(e,r),dd)}Kb.intervals=function(e){return e.push.apply(e,this.leftPoints),this.left&&this.left.intervals(e),this.right&&this.right.intervals(e),e};Kb.insert=function(e){var t=this.count-this.leftPoints.length;if(this.count+=1,e[1]<this.mid)this.left?4*(this.left.count+1)>3*(t+1)?c9(this,e):this.left.insert(e):this.left=em([e]);else if(e[0]>this.mid)this.right?4*(this.right.count+1)>3*(t+1)?c9(this,e):this.right.insert(e):this.right=em([e]);else{var r=AT.ge(this.leftPoints,e,mN),n=AT.ge(this.rightPoints,e,yN);this.leftPoints.splice(r,0,e),this.rightPoints.splice(n,0,e)}};Kb.remove=function(e){var t=this.count-this.leftPoints;if(e[1]<this.mid){if(!this.left)return tm;var r=this.right?this.right.count:0;if(4*r>3*(t-1))return l9(this,e);var n=this.left.remove(e);return n===TT?(this.left=null,this.count-=1,dd):(n===dd&&(this.count-=1),n)}else if(e[0]>this.mid){if(!this.right)return tm;var i=this.left?this.left.count:0;if(4*i>3*(t-1))return l9(this,e);var n=this.right.remove(e);return n===TT?(this.right=null,this.count-=1,dd):(n===dd&&(this.count-=1),n)}else{if(this.count===1)return this.leftPoints[0]===e?TT:tm;if(this.leftPoints.length===1&&this.leftPoints[0]===e){if(this.left&&this.right){for(var o=this,s=this.left;s.right;)o=s,s=s.right;if(o===this)s.right=this.right;else{var a=this.left,n=this.right;o.count-=s.count,o.right=s.left,s.left=a,s.right=n}dN(this,s),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?dN(this,this.left):dN(this,this.right);return dd}for(var a=AT.ge(this.leftPoints,e,mN);a<this.leftPoints.length&&this.leftPoints[a][0]===e[0];++a)if(this.leftPoints[a]===e){this.count-=1,this.leftPoints.splice(a,1);for(var n=AT.ge(this.rightPoints,e,yN);n<this.rightPoints.length&&this.rightPoints[n][1]===e[1];++n)if(this.rightPoints[n]===e)return this.rightPoints.splice(n,1),dd}return tm}};function f9(e,t,r){for(var n=0;n<e.length&&e[n][0]<=t;++n){var i=r(e[n]);if(i)return i}}function d9(e,t,r){for(var n=e.length-1;n>=0&&e[n][1]>=t;--n){var i=r(e[n]);if(i)return i}}function h9(e,t){for(var r=0;r<e.length;++r){var n=t(e[r]);if(n)return n}}Kb.queryPoint=function(e,t){if(e<this.mid){if(this.left){var r=this.left.queryPoint(e,t);if(r)return r}return f9(this.leftPoints,e,t)}else if(e>this.mid){if(this.right){var r=this.right.queryPoint(e,t);if(r)return r}return d9(this.rightPoints,e,t)}else return h9(this.leftPoints,t)};Kb.queryInterval=function(e,t,r){if(e<this.mid&&this.left){var n=this.left.queryInterval(e,t,r);if(n)return n}if(t>this.mid&&this.right){var n=this.right.queryInterval(e,t,r);if(n)return n}return t<this.mid?f9(this.leftPoints,t,r):e>this.mid?d9(this.rightPoints,e,r):h9(this.leftPoints,r)};function wlt(e,t){return e-t}function mN(e,t){var r=e[0]-t[0];return r||e[1]-t[1]}function yN(e,t){var r=e[1]-t[1];return r||e[0]-t[0]}function em(e){if(e.length===0)return null;for(var t=[],r=0;r<e.length;++r)t.push(e[r][0],e[r][1]);t.sort(wlt);for(var n=t[t.length>>1],i=[],o=[],s=[],r=0;r<e.length;++r){var a=e[r];a[1]<n?i.push(a):n<a[0]?o.push(a):s.push(a)}var c=s,l=s.slice();return c.sort(mN),l.sort(yN),new pN(n,em(i),em(o),c,l)}function hN(e){this.root=e}var rm=hN.prototype;rm.insert=function(e){this.root?this.root.insert(e):this.root=new pN(e[0],null,null,[e],[e])};rm.remove=function(e){if(this.root){var t=this.root.remove(e);return t===TT&&(this.root=null),t!==tm}return!1};rm.queryPoint=function(e,t){if(this.root)return this.root.queryPoint(e,t)};rm.queryInterval=function(e,t,r){if(e<=t&&this.root)return this.root.queryInterval(e,t,r)};Object.defineProperty(rm,"count",{get:function(){return this.root?this.root.count:0}});Object.defineProperty(rm,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}});function vlt(e){return!e||e.length===0?new hN(null):new hN(em(e))}});function ux(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function P(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(u){try{l(n.next(u))}catch(f){s(f)}}function c(u){try{l(n.throw(u))}catch(f){s(f)}}function l(u){u.done?o(u.value):i(u.value).then(a,c)}l((n=n.apply(e,t||[])).next())})}function KN(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function G(e){return this instanceof G?(this.v=e,this):new G(e)}function ke(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(d){n[d]&&(i[d]=function(h){return new Promise(function(p,m){o.push([d,h,p,m])>1||a(d,h)})})}function a(d,h){try{c(n[d](h))}catch(p){f(o[0][3],p)}}function c(d){d.value instanceof G?Promise.resolve(d.value.v).then(l,u):f(o[0][2],d)}function l(d){a("next",d)}function u(d){a("throw",d)}function f(d,h){d(h),o.shift(),o.length&&a(o[0][0],o[0][1])}}function oo(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,o){t[i]=e[i]?function(s){return(r=!r)?{value:G(e[i](s)),done:!1}:o?o(s):s}:o}}function or(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof KN=="function"?KN(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(o){r[o]=e[o]&&function(s){return new Promise(function(a,c){s=e[o](s),i(a,c,s.done,s.value)})}}function i(o,s,a,c){Promise.resolve(c).then(function(l){o({value:l,done:a})},s)}}var pA={};Qr(pA,{compareArrayLike:()=>hA,joinUint8Arrays:()=>Mi,memcpy:()=>md,rebaseValueOffsets:()=>xm,toArrayBufferView:()=>Zt,toArrayBufferViewAsyncIterator:()=>Uo,toArrayBufferViewIterator:()=>Bs,toBigInt64Array:()=>RW,toBigUint64Array:()=>UW,toFloat32Array:()=>PW,toFloat32ArrayAsyncIterator:()=>eG,toFloat32ArrayIterator:()=>GW,toFloat64Array:()=>$W,toFloat64ArrayAsyncIterator:()=>rG,toFloat64ArrayIterator:()=>XW,toInt16Array:()=>LW,toInt16ArrayAsyncIterator:()=>KW,toInt16ArrayIterator:()=>jW,toInt32Array:()=>Bu,toInt32ArrayAsyncIterator:()=>QW,toInt32ArrayIterator:()=>qW,toInt8Array:()=>DW,toInt8ArrayAsyncIterator:()=>ZW,toInt8ArrayIterator:()=>VW,toUint16Array:()=>kW,toUint16ArrayAsyncIterator:()=>JW,toUint16ArrayIterator:()=>YW,toUint32Array:()=>CW,toUint32ArrayAsyncIterator:()=>tG,toUint32ArrayIterator:()=>WW,toUint8Array:()=>Rt,toUint8ArrayAsyncIterator:()=>dA,toUint8ArrayIterator:()=>fA,toUint8ClampedArray:()=>zW,toUint8ClampedArrayAsyncIterator:()=>nG,toUint8ClampedArrayIterator:()=>HW});var BW=new TextDecoder("utf-8"),gm=e=>BW.decode(e),OW=new TextEncoder,Kc=e=>OW.encode(e);var[so,Zft]=(()=>{let e=()=>{throw new Error("BigInt64Array is not available in this environment")};class t{static get BYTES_PER_ELEMENT(){return 8}static of(){throw e()}static from(){throw e()}constructor(){throw e()}}return typeof BigInt64Array<"u"?[BigInt64Array,!0]:[t,!1]})(),[ao,Kft]=(()=>{let e=()=>{throw new Error("BigUint64Array is not available in this environment")};class t{static get BYTES_PER_ELEMENT(){return 8}static of(){throw e()}static from(){throw e()}constructor(){throw e()}}return typeof BigUint64Array<"u"?[BigUint64Array,!0]:[t,!1]})();var FW=e=>typeof e=="number",QN=e=>typeof e=="boolean",Nr=e=>typeof e=="function",Ln=e=>e!=null&&Object(e)===e,Ai=e=>Ln(e)&&Nr(e.then);var Co=e=>Ln(e)&&Nr(e[Symbol.iterator]),co=e=>Ln(e)&&Nr(e[Symbol.asyncIterator]),fx=e=>Ln(e)&&Ln(e.schema);var dx=e=>Ln(e)&&"done"in e&&"value"in e;var hx=e=>Ln(e)&&Nr(e.stat)&&FW(e.fd);var px=e=>Ln(e)&&bm(e.body),mx=e=>"_getDOMStream"in e&&"_getNodeStream"in e,JN=e=>Ln(e)&&Nr(e.abort)&&Nr(e.getWriter)&&!mx(e),bm=e=>Ln(e)&&Nr(e.cancel)&&Nr(e.getReader)&&!mx(e),tD=e=>Ln(e)&&Nr(e.end)&&Nr(e.write)&&QN(e.writable)&&!mx(e),yx=e=>Ln(e)&&Nr(e.read)&&Nr(e.pipe)&&QN(e.readable)&&!mx(e),eD=e=>Ln(e)&&Nr(e.clear)&&Nr(e.bytes)&&Nr(e.position)&&Nr(e.setPosition)&&Nr(e.capacity)&&Nr(e.getBufferIdentifier)&&Nr(e.createLong);var uA=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:ArrayBuffer;function NW(e){let t=e[0]?[e[0]]:[],r,n,i,o;for(let s,a,c=0,l=0,u=e.length;++c<u;){if(s=t[l],a=e[c],!s||!a||s.buffer!==a.buffer||a.byteOffset<s.byteOffset){a&&(t[++l]=a);continue}if({byteOffset:r,byteLength:i}=s,{byteOffset:n,byteLength:o}=a,r+i<n||n+o<r){a&&(t[++l]=a);continue}t[l]=new Uint8Array(s.buffer,r,n-r+o)}return t}function md(e,t,r=0,n=t.byteLength){let i=e.byteLength,o=new Uint8Array(e.buffer,e.byteOffset,i),s=new Uint8Array(t.buffer,t.byteOffset,Math.min(n,i));return o.set(s,r),e}function Mi(e,t){let r=NW(e),n=r.reduce((u,f)=>u+f.byteLength,0),i,o,s,a=0,c=-1,l=Math.min(t||Number.POSITIVE_INFINITY,n);for(let u=r.length;++c<u;){if(i=r[c],o=i.subarray(0,Math.min(i.length,l-a)),l<=a+o.length){o.length<i.length?r[c]=i.subarray(o.length):o.length===i.length&&c++,s?md(s,o,a):s=o;break}md(s||(s=new Uint8Array(l)),o,a),a+=o.length}return[s||new Uint8Array(0),r.slice(c),n-(s?s.byteLength:0)]}function Zt(e,t){let r=dx(t)?t.value:t;return r instanceof e?e===Uint8Array?new e(r.buffer,r.byteOffset,r.byteLength):r:r?(typeof r=="string"&&(r=Kc(r)),r instanceof ArrayBuffer?new e(r):r instanceof uA?new e(r):eD(r)?Zt(e,r.bytes()):ArrayBuffer.isView(r)?r.byteLength<=0?new e(0):new e(r.buffer,r.byteOffset,r.byteLength/e.BYTES_PER_ELEMENT):e.from(r)):new e(0)}var DW=e=>Zt(Int8Array,e),LW=e=>Zt(Int16Array,e),Bu=e=>Zt(Int32Array,e),RW=e=>Zt(so,e),Rt=e=>Zt(Uint8Array,e),kW=e=>Zt(Uint16Array,e),CW=e=>Zt(Uint32Array,e),UW=e=>Zt(ao,e),PW=e=>Zt(Float32Array,e),$W=e=>Zt(Float64Array,e),zW=e=>Zt(Uint8ClampedArray,e),lA=e=>(e.next(),e);function*Bs(e,t){let r=function*(i){yield i},n=typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof uA?r(t):Co(t)?t:r(t);return yield*lA(function*(i){let o=null;do o=i.next(yield Zt(e,o));while(!o.done)}(n[Symbol.iterator]())),new e}var VW=e=>Bs(Int8Array,e),jW=e=>Bs(Int16Array,e),qW=e=>Bs(Int32Array,e),fA=e=>Bs(Uint8Array,e),YW=e=>Bs(Uint16Array,e),WW=e=>Bs(Uint32Array,e),GW=e=>Bs(Float32Array,e),XW=e=>Bs(Float64Array,e),HW=e=>Bs(Uint8ClampedArray,e);function Uo(e,t){return ke(this,arguments,function*(){if(Ai(t))return yield G(yield G(yield*oo(or(Uo(e,yield G(t))))));let n=function(s){return ke(this,arguments,function*(){yield yield G(yield G(s))})},i=function(s){return ke(this,arguments,function*(){yield G(yield*oo(or(lA(function*(a){let c=null;do c=a.next(yield c?.value);while(!c.done)}(s[Symbol.iterator]())))))})},o=typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof uA?n(t):Co(t)?i(t):co(t)?t:n(t);return yield G(yield*oo(or(lA(function(s){return ke(this,arguments,function*(){let a=null;do a=yield G(s.next(yield yield G(Zt(e,a))));while(!a.done)})}(o[Symbol.asyncIterator]()))))),yield G(new e)})}var ZW=e=>Uo(Int8Array,e),KW=e=>Uo(Int16Array,e),QW=e=>Uo(Int32Array,e),dA=e=>Uo(Uint8Array,e),JW=e=>Uo(Uint16Array,e),tG=e=>Uo(Uint32Array,e),eG=e=>Uo(Float32Array,e),rG=e=>Uo(Float64Array,e),nG=e=>Uo(Uint8ClampedArray,e);function xm(e,t,r){if(e!==0){r=r.slice(0,t+1);for(let n=-1;++n<=t;)r[n]+=e}return r}function hA(e,t){let r=0,n=e.length;if(n!==t.length)return!1;if(n>0)do if(e[r]!==t[r])return!1;while(++r<n);return!0}var Jr={fromIterable(e){return gx(iG(e))},fromAsyncIterable(e){return gx(oG(e))},fromDOMStream(e){return gx(sG(e))},fromNodeStream(e){return gx(aG(e))},toDOMStream(e,t){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(e,t){throw new Error('"toNodeStream" not available in this environment')}},gx=e=>(e.next(),e);function*iG(e){let t,r=!1,n=[],i,o,s,a=0;function c(){return o==="peek"?Mi(n,s)[0]:([i,n,a]=Mi(n,s),i)}({cmd:o,size:s}=yield null);let l=fA(e)[Symbol.iterator]();try{do if({done:t,value:i}=Number.isNaN(s-a)?l.next():l.next(s-a),!t&&i.byteLength>0&&(n.push(i),a+=i.byteLength),t||s<=a)do({cmd:o,size:s}=yield c());while(s<a);while(!t)}catch(u){(r=!0)&&typeof l.throw=="function"&&l.throw(u)}finally{r===!1&&typeof l.return=="function"&&l.return(null)}return null}function oG(e){return ke(this,arguments,function*(){let r,n=!1,i=[],o,s,a,c=0;function l(){return s==="peek"?Mi(i,a)[0]:([o,i,c]=Mi(i,a),o)}({cmd:s,size:a}=yield yield G(null));let u=dA(e)[Symbol.asyncIterator]();try{do if({done:r,value:o}=Number.isNaN(a-c)?yield G(u.next()):yield G(u.next(a-c)),!r&&o.byteLength>0&&(i.push(o),c+=o.byteLength),r||a<=c)do({cmd:s,size:a}=yield yield G(l()));while(a<c);while(!r)}catch(f){(n=!0)&&typeof u.throw=="function"&&(yield G(u.throw(f)))}finally{n===!1&&typeof u.return=="function"&&(yield G(u.return(new Uint8Array(0))))}return yield G(null)})}function sG(e){return ke(this,arguments,function*(){let r=!1,n=!1,i=[],o,s,a,c=0;function l(){return s==="peek"?Mi(i,a)[0]:([o,i,c]=Mi(i,a),o)}({cmd:s,size:a}=yield yield G(null));let u=new yA(e);try{do if({done:r,value:o}=Number.isNaN(a-c)?yield G(u.read()):yield G(u.read(a-c)),!r&&o.byteLength>0&&(i.push(Rt(o)),c+=o.byteLength),r||a<=c)do({cmd:s,size:a}=yield yield G(l()));while(a<c);while(!r)}catch(f){(n=!0)&&(yield G(u.cancel(f)))}finally{n===!1?yield G(u.cancel()):e.locked&&u.releaseLock()}return yield G(null)})}var yA=class{constructor(t){this.source=t,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch(()=>{})}get closed(){return this.reader?this.reader.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=null}cancel(t){return P(this,void 0,void 0,function*(){let{reader:r,source:n}=this;r&&(yield r.cancel(t).catch(()=>{})),n&&n.locked&&this.releaseLock()})}read(t){return P(this,void 0,void 0,function*(){if(t===0)return{done:this.reader==null,value:new Uint8Array(0)};let r=yield this.reader.read();return!r.done&&(r.value=Rt(r)),r})}},mA=(e,t)=>{let r=i=>n([t,i]),n;return[t,r,new Promise(i=>(n=i)&&e.once(t,r))]};function aG(e){return ke(this,arguments,function*(){let r=[],n="error",i=!1,o=null,s,a,c=0,l=[],u;function f(){return s==="peek"?Mi(l,a)[0]:([u,l,c]=Mi(l,a),u)}if({cmd:s,size:a}=yield yield G(null),e.isTTY)return yield yield G(new Uint8Array(0)),yield G(null);try{r[0]=mA(e,"end"),r[1]=mA(e,"error");do{if(r[2]=mA(e,"readable"),[n,o]=yield G(Promise.race(r.map(h=>h[2]))),n==="error")break;if((i=n==="end")||(Number.isFinite(a-c)?(u=Rt(e.read(a-c)),u.byteLength<a-c&&(u=Rt(e.read()))):u=Rt(e.read()),u.byteLength>0&&(l.push(u),c+=u.byteLength)),i||a<=c)do({cmd:s,size:a}=yield yield G(f()));while(a<c)}while(!i)}finally{yield G(d(r,n==="error"?o:null))}return yield G(null);function d(h,p){return u=l=null,new Promise((m,g)=>{for(let[y,b]of h)e.off(y,b);try{let y=e.destroy;y&&y.call(e,p),p=void 0}catch(y){p=y||p}finally{p!=null?g(p):m()}})}})}var tn;(function(e){e[e.V1=0]="V1",e[e.V2=1]="V2",e[e.V3=2]="V3",e[e.V4=3]="V4",e[e.V5=4]="V5"})(tn||(tn={}));var sr;(function(e){e[e.Sparse=0]="Sparse",e[e.Dense=1]="Dense"})(sr||(sr={}));var He;(function(e){e[e.HALF=0]="HALF",e[e.SINGLE=1]="SINGLE",e[e.DOUBLE=2]="DOUBLE"})(He||(He={}));var _n;(function(e){e[e.DAY=0]="DAY",e[e.MILLISECOND=1]="MILLISECOND"})(_n||(_n={}));var oe;(function(e){e[e.SECOND=0]="SECOND",e[e.MILLISECOND=1]="MILLISECOND",e[e.MICROSECOND=2]="MICROSECOND",e[e.NANOSECOND=3]="NANOSECOND"})(oe||(oe={}));var ri;(function(e){e[e.YEAR_MONTH=0]="YEAR_MONTH",e[e.DAY_TIME=1]="DAY_TIME",e[e.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(ri||(ri={}));var pe;(function(e){e[e.NONE=0]="NONE",e[e.Schema=1]="Schema",e[e.DictionaryBatch=2]="DictionaryBatch",e[e.RecordBatch=3]="RecordBatch",e[e.Tensor=4]="Tensor",e[e.SparseTensor=5]="SparseTensor"})(pe||(pe={}));var k;(function(e){e[e.NONE=0]="NONE",e[e.Null=1]="Null",e[e.Int=2]="Int",e[e.Float=3]="Float",e[e.Binary=4]="Binary",e[e.Utf8=5]="Utf8",e[e.Bool=6]="Bool",e[e.Decimal=7]="Decimal",e[e.Date=8]="Date",e[e.Time=9]="Time",e[e.Timestamp=10]="Timestamp",e[e.Interval=11]="Interval",e[e.List=12]="List",e[e.Struct=13]="Struct",e[e.Union=14]="Union",e[e.FixedSizeBinary=15]="FixedSizeBinary",e[e.FixedSizeList=16]="FixedSizeList",e[e.Map=17]="Map",e[e.Dictionary=-1]="Dictionary",e[e.Int8=-2]="Int8",e[e.Int16=-3]="Int16",e[e.Int32=-4]="Int32",e[e.Int64=-5]="Int64",e[e.Uint8=-6]="Uint8",e[e.Uint16=-7]="Uint16",e[e.Uint32=-8]="Uint32",e[e.Uint64=-9]="Uint64",e[e.Float16=-10]="Float16",e[e.Float32=-11]="Float32",e[e.Float64=-12]="Float64",e[e.DateDay=-13]="DateDay",e[e.DateMillisecond=-14]="DateMillisecond",e[e.TimestampSecond=-15]="TimestampSecond",e[e.TimestampMillisecond=-16]="TimestampMillisecond",e[e.TimestampMicrosecond=-17]="TimestampMicrosecond",e[e.TimestampNanosecond=-18]="TimestampNanosecond",e[e.TimeSecond=-19]="TimeSecond",e[e.TimeMillisecond=-20]="TimeMillisecond",e[e.TimeMicrosecond=-21]="TimeMicrosecond",e[e.TimeNanosecond=-22]="TimeNanosecond",e[e.DenseUnion=-23]="DenseUnion",e[e.SparseUnion=-24]="SparseUnion",e[e.IntervalDayTime=-25]="IntervalDayTime",e[e.IntervalYearMonth=-26]="IntervalYearMonth"})(k||(k={}));var Po;(function(e){e[e.OFFSET=0]="OFFSET",e[e.DATA=1]="DATA",e[e.VALIDITY=2]="VALIDITY",e[e.TYPE=3]="TYPE"})(Po||(Po={}));var NA={};Qr(NA,{clampIndex:()=>QG,clampRange:()=>Im,createElementComparator:()=>tl});var cG=void 0;function Os(e){if(e===null)return"null";if(e===cG)return"undefined";switch(typeof e){case"number":return`${e}`;case"bigint":return`${e}`;case"string":return`"${e}"`}return typeof e[Symbol.toPrimitive]=="function"?e[Symbol.toPrimitive]("string"):ArrayBuffer.isView(e)?e instanceof so||e instanceof ao?`[${[...e].map(t=>Os(t))}]`:`[${e}]`:ArrayBuffer.isView(e)?`[${e}]`:JSON.stringify(e,(t,r)=>typeof r=="bigint"?`${r}`:r)}var gA={};Qr(gA,{BN:()=>vm,bignumToBigInt:()=>iD,bignumToString:()=>wm,isArrowBigNumSymbol:()=>rD});var rD=Symbol.for("isArrowBigNum");function $o(e,...t){return t.length===0?Object.setPrototypeOf(Zt(this.TypedArray,e),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(e,...t),this.constructor.prototype)}$o.prototype[rD]=!0;$o.prototype.toJSON=function(){return`"${wm(this)}"`};$o.prototype.valueOf=function(){return nD(this)};$o.prototype.toString=function(){return wm(this)};$o.prototype[Symbol.toPrimitive]=function(e="default"){switch(e){case"number":return nD(this);case"string":return wm(this);case"default":return iD(this)}return wm(this)};function yd(...e){return $o.apply(this,e)}function gd(...e){return $o.apply(this,e)}function _m(...e){return $o.apply(this,e)}Object.setPrototypeOf(yd.prototype,Object.create(Int32Array.prototype));Object.setPrototypeOf(gd.prototype,Object.create(Uint32Array.prototype));Object.setPrototypeOf(_m.prototype,Object.create(Uint32Array.prototype));Object.assign(yd.prototype,$o.prototype,{constructor:yd,signed:!0,TypedArray:Int32Array,BigIntArray:so});Object.assign(gd.prototype,$o.prototype,{constructor:gd,signed:!1,TypedArray:Uint32Array,BigIntArray:ao});Object.assign(_m.prototype,$o.prototype,{constructor:_m,signed:!0,TypedArray:Uint32Array,BigIntArray:ao});function nD(e){let{buffer:t,byteOffset:r,length:n,signed:i}=e,o=new ao(t,r,n),s=i&&o[o.length-1]&BigInt(1)<<BigInt(63),a=BigInt(s?1:0),c=BigInt(0);if(s){for(let l of o)a+=~l*(BigInt(1)<<BigInt(32)*c++);a*=BigInt(-1)}else for(let l of o)a+=l*(BigInt(1)<<BigInt(32)*c++);return a}var wm=e=>e.byteLength===8?`${new e.BigIntArray(e.buffer,e.byteOffset,1)[0]}`:oD(e),iD=e=>e.byteLength===8?new e.BigIntArray(e.buffer,e.byteOffset,1)[0]:oD(e);function oD(e){let t="",r=new Uint32Array(2),n=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2),i=new Uint32Array((n=new Uint16Array(n).reverse()).buffer),o=-1,s=n.length-1;do{for(r[0]=n[o=0];o<s;)n[o++]=r[1]=r[0]/10,r[0]=(r[0]-r[1]*10<<16)+n[o];n[o]=r[1]=r[0]/10,r[0]=r[0]-r[1]*10,t=`${r[0]}${t}`}while(i[0]||i[1]||i[2]||i[3]);return t??"0"}var vm=class e{static new(t,r){switch(r){case!0:return new yd(t);case!1:return new gd(t)}switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:case so:return new yd(t)}return t.byteLength===16?new _m(t):new gd(t)}static signed(t){return new yd(t)}static unsigned(t){return new gd(t)}static decimal(t){return new _m(t)}constructor(t,r){return e.new(t,r)}};function ni(e){if(typeof e=="bigint"&&(e<Number.MIN_SAFE_INTEGER||e>Number.MAX_SAFE_INTEGER))throw new TypeError(`${e} is not safe to convert to a number.`);return Number(e)}var sD,aD,cD,lD,uD,fD,dD,hD,pD,mD,yD,gD,bD,xD,_D,wD,vD,SD,ID,pt=class e{static isNull(t){return t?.typeId===k.Null}static isInt(t){return t?.typeId===k.Int}static isFloat(t){return t?.typeId===k.Float}static isBinary(t){return t?.typeId===k.Binary}static isUtf8(t){return t?.typeId===k.Utf8}static isBool(t){return t?.typeId===k.Bool}static isDecimal(t){return t?.typeId===k.Decimal}static isDate(t){return t?.typeId===k.Date}static isTime(t){return t?.typeId===k.Time}static isTimestamp(t){return t?.typeId===k.Timestamp}static isInterval(t){return t?.typeId===k.Interval}static isList(t){return t?.typeId===k.List}static isStruct(t){return t?.typeId===k.Struct}static isUnion(t){return t?.typeId===k.Union}static isFixedSizeBinary(t){return t?.typeId===k.FixedSizeBinary}static isFixedSizeList(t){return t?.typeId===k.FixedSizeList}static isMap(t){return t?.typeId===k.Map}static isDictionary(t){return t?.typeId===k.Dictionary}static isDenseUnion(t){return e.isUnion(t)&&t.mode===sr.Dense}static isSparseUnion(t){return e.isUnion(t)&&t.mode===sr.Sparse}get typeId(){return k.NONE}};sD=Symbol.toStringTag;pt[sD]=(e=>(e.children=null,e.ArrayType=Array,e[Symbol.toStringTag]="DataType"))(pt.prototype);var Rn=class extends pt{toString(){return"Null"}get typeId(){return k.Null}};aD=Symbol.toStringTag;Rn[aD]=(e=>e[Symbol.toStringTag]="Null")(Rn.prototype);var mr=class extends pt{constructor(t,r){super(),this.isSigned=t,this.bitWidth=r}get typeId(){return k.Int}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?so:ao}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}};cD=Symbol.toStringTag;mr[cD]=(e=>(e.isSigned=null,e.bitWidth=null,e[Symbol.toStringTag]="Int"))(mr.prototype);var bx=class extends mr{constructor(){super(!0,8)}get ArrayType(){return Int8Array}},xx=class extends mr{constructor(){super(!0,16)}get ArrayType(){return Int16Array}},Fs=class extends mr{constructor(){super(!0,32)}get ArrayType(){return Int32Array}},_x=class extends mr{constructor(){super(!0,64)}get ArrayType(){return so}},wx=class extends mr{constructor(){super(!1,8)}get ArrayType(){return Uint8Array}},vx=class extends mr{constructor(){super(!1,16)}get ArrayType(){return Uint16Array}},Sx=class extends mr{constructor(){super(!1,32)}get ArrayType(){return Uint32Array}},Ix=class extends mr{constructor(){super(!1,64)}get ArrayType(){return ao}};Object.defineProperty(bx.prototype,"ArrayType",{value:Int8Array});Object.defineProperty(xx.prototype,"ArrayType",{value:Int16Array});Object.defineProperty(Fs.prototype,"ArrayType",{value:Int32Array});Object.defineProperty(_x.prototype,"ArrayType",{value:so});Object.defineProperty(wx.prototype,"ArrayType",{value:Uint8Array});Object.defineProperty(vx.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(Sx.prototype,"ArrayType",{value:Uint32Array});Object.defineProperty(Ix.prototype,"ArrayType",{value:ao});var ii=class extends pt{constructor(t){super(),this.precision=t}get typeId(){return k.Float}get ArrayType(){switch(this.precision){case He.HALF:return Uint16Array;case He.SINGLE:return Float32Array;case He.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}};lD=Symbol.toStringTag;ii[lD]=(e=>(e.precision=null,e[Symbol.toStringTag]="Float"))(ii.prototype);var Tx=class extends ii{constructor(){super(He.HALF)}},Ax=class extends ii{constructor(){super(He.SINGLE)}},Mx=class extends ii{constructor(){super(He.DOUBLE)}};Object.defineProperty(Tx.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(Ax.prototype,"ArrayType",{value:Float32Array});Object.defineProperty(Mx.prototype,"ArrayType",{value:Float64Array});var Ra=class extends pt{constructor(){super()}get typeId(){return k.Binary}toString(){return"Binary"}};uD=Symbol.toStringTag;Ra[uD]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Binary"))(Ra.prototype);var ka=class extends pt{constructor(){super()}get typeId(){return k.Utf8}toString(){return"Utf8"}};fD=Symbol.toStringTag;ka[fD]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Utf8"))(ka.prototype);var Ca=class extends pt{constructor(){super()}get typeId(){return k.Bool}toString(){return"Bool"}};dD=Symbol.toStringTag;Ca[dD]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Bool"))(Ca.prototype);var Ua=class extends pt{constructor(t,r,n=128){super(),this.scale=t,this.precision=r,this.bitWidth=n}get typeId(){return k.Decimal}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}};hD=Symbol.toStringTag;Ua[hD]=(e=>(e.scale=null,e.precision=null,e.ArrayType=Uint32Array,e[Symbol.toStringTag]="Decimal"))(Ua.prototype);var Pa=class extends pt{constructor(t){super(),this.unit=t}get typeId(){return k.Date}toString(){return`Date${(this.unit+1)*32}<${_n[this.unit]}>`}};pD=Symbol.toStringTag;Pa[pD]=(e=>(e.unit=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Date"))(Pa.prototype);var zo=class extends pt{constructor(t,r){super(),this.unit=t,this.bitWidth=r}get typeId(){return k.Time}toString(){return`Time${this.bitWidth}<${oe[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return so}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}};mD=Symbol.toStringTag;zo[mD]=(e=>(e.unit=null,e.bitWidth=null,e[Symbol.toStringTag]="Time"))(zo.prototype);var $a=class extends pt{constructor(t,r){super(),this.unit=t,this.timezone=r}get typeId(){return k.Timestamp}toString(){return`Timestamp<${oe[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}};yD=Symbol.toStringTag;$a[yD]=(e=>(e.unit=null,e.timezone=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Timestamp"))($a.prototype);var za=class extends pt{constructor(t){super(),this.unit=t}get typeId(){return k.Interval}toString(){return`Interval<${ri[this.unit]}>`}};gD=Symbol.toStringTag;za[gD]=(e=>(e.unit=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Interval"))(za.prototype);var Vo=class extends pt{constructor(t){super(),this.children=[t]}get typeId(){return k.List}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}};bD=Symbol.toStringTag;Vo[bD]=(e=>(e.children=null,e[Symbol.toStringTag]="List"))(Vo.prototype);var Ce=class extends pt{constructor(t){super(),this.children=t}get typeId(){return k.Struct}toString(){return`Struct<{${this.children.map(t=>`${t.name}:${t.type}`).join(", ")}}>`}};xD=Symbol.toStringTag;Ce[xD]=(e=>(e.children=null,e[Symbol.toStringTag]="Struct"))(Ce.prototype);var jo=class extends pt{constructor(t,r,n){super(),this.mode=t,this.children=n,this.typeIds=r=Int32Array.from(r),this.typeIdToChildIndex=r.reduce((i,o,s)=>(i[o]=s)&&i||i,Object.create(null))}get typeId(){return k.Union}toString(){return`${this[Symbol.toStringTag]}<${this.children.map(t=>`${t.type}`).join(" | ")}>`}};_D=Symbol.toStringTag;jo[_D]=(e=>(e.mode=null,e.typeIds=null,e.children=null,e.typeIdToChildIndex=null,e.ArrayType=Int8Array,e[Symbol.toStringTag]="Union"))(jo.prototype);var Va=class extends pt{constructor(t){super(),this.byteWidth=t}get typeId(){return k.FixedSizeBinary}toString(){return`FixedSizeBinary[${this.byteWidth}]`}};wD=Symbol.toStringTag;Va[wD]=(e=>(e.byteWidth=null,e.ArrayType=Uint8Array,e[Symbol.toStringTag]="FixedSizeBinary"))(Va.prototype);var qo=class extends pt{constructor(t,r){super(),this.listSize=t,this.children=[r]}get typeId(){return k.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}};vD=Symbol.toStringTag;qo[vD]=(e=>(e.children=null,e.listSize=null,e[Symbol.toStringTag]="FixedSizeList"))(qo.prototype);var Yo=class extends pt{constructor(t,r=!1){super(),this.children=[t],this.keysSorted=r}get typeId(){return k.Map}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map(t=>`${t.name}:${t.type}`).join(", ")}}>`}};SD=Symbol.toStringTag;Yo[SD]=(e=>(e.children=null,e.keysSorted=null,e[Symbol.toStringTag]="Map_"))(Yo.prototype);var lG=(e=>()=>++e)(-1),Ei=class extends pt{constructor(t,r,n,i){super(),this.indices=r,this.dictionary=t,this.isOrdered=i||!1,this.id=n==null?lG():ni(n)}get typeId(){return k.Dictionary}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}};ID=Symbol.toStringTag;Ei[ID]=(e=>(e.id=null,e.indices=null,e.isOrdered=null,e.dictionary=null,e[Symbol.toStringTag]="Dictionary"))(Ei.prototype);function Bi(e){let t=e;switch(e.typeId){case k.Decimal:return e.bitWidth/32;case k.Timestamp:return 2;case k.Date:return 1+t.unit;case k.Interval:return 1+t.unit;case k.FixedSizeList:return t.listSize;case k.FixedSizeBinary:return t.byteWidth;default:return 1}}var _t=class{visitMany(t,...r){return t.map((n,i)=>this.visit(n,...r.map(o=>o[i])))}visit(...t){return this.getVisitFn(t[0],!1).apply(this,t)}getVisitFn(t,r=!0){return uG(this,t,r)}getVisitFnByTypeId(t,r=!0){return bd(this,t,r)}visitNull(t,...r){return null}visitBool(t,...r){return null}visitInt(t,...r){return null}visitFloat(t,...r){return null}visitUtf8(t,...r){return null}visitBinary(t,...r){return null}visitFixedSizeBinary(t,...r){return null}visitDate(t,...r){return null}visitTimestamp(t,...r){return null}visitTime(t,...r){return null}visitDecimal(t,...r){return null}visitList(t,...r){return null}visitStruct(t,...r){return null}visitUnion(t,...r){return null}visitDictionary(t,...r){return null}visitInterval(t,...r){return null}visitFixedSizeList(t,...r){return null}visitMap(t,...r){return null}};function uG(e,t,r=!0){return typeof t=="number"?bd(e,t,r):typeof t=="string"&&t in k?bd(e,k[t],r):t&&t instanceof pt?bd(e,TD(t),r):t?.type&&t.type instanceof pt?bd(e,TD(t.type),r):bd(e,k.NONE,r)}function bd(e,t,r=!0){let n=null;switch(t){case k.Null:n=e.visitNull;break;case k.Bool:n=e.visitBool;break;case k.Int:n=e.visitInt;break;case k.Int8:n=e.visitInt8||e.visitInt;break;case k.Int16:n=e.visitInt16||e.visitInt;break;case k.Int32:n=e.visitInt32||e.visitInt;break;case k.Int64:n=e.visitInt64||e.visitInt;break;case k.Uint8:n=e.visitUint8||e.visitInt;break;case k.Uint16:n=e.visitUint16||e.visitInt;break;case k.Uint32:n=e.visitUint32||e.visitInt;break;case k.Uint64:n=e.visitUint64||e.visitInt;break;case k.Float:n=e.visitFloat;break;case k.Float16:n=e.visitFloat16||e.visitFloat;break;case k.Float32:n=e.visitFloat32||e.visitFloat;break;case k.Float64:n=e.visitFloat64||e.visitFloat;break;case k.Utf8:n=e.visitUtf8;break;case k.Binary:n=e.visitBinary;break;case k.FixedSizeBinary:n=e.visitFixedSizeBinary;break;case k.Date:n=e.visitDate;break;case k.DateDay:n=e.visitDateDay||e.visitDate;break;case k.DateMillisecond:n=e.visitDateMillisecond||e.visitDate;break;case k.Timestamp:n=e.visitTimestamp;break;case k.TimestampSecond:n=e.visitTimestampSecond||e.visitTimestamp;break;case k.TimestampMillisecond:n=e.visitTimestampMillisecond||e.visitTimestamp;break;case k.TimestampMicrosecond:n=e.visitTimestampMicrosecond||e.visitTimestamp;break;case k.TimestampNanosecond:n=e.visitTimestampNanosecond||e.visitTimestamp;break;case k.Time:n=e.visitTime;break;case k.TimeSecond:n=e.visitTimeSecond||e.visitTime;break;case k.TimeMillisecond:n=e.visitTimeMillisecond||e.visitTime;break;case k.TimeMicrosecond:n=e.visitTimeMicrosecond||e.visitTime;break;case k.TimeNanosecond:n=e.visitTimeNanosecond||e.visitTime;break;case k.Decimal:n=e.visitDecimal;break;case k.List:n=e.visitList;break;case k.Struct:n=e.visitStruct;break;case k.Union:n=e.visitUnion;break;case k.DenseUnion:n=e.visitDenseUnion||e.visitUnion;break;case k.SparseUnion:n=e.visitSparseUnion||e.visitUnion;break;case k.Dictionary:n=e.visitDictionary;break;case k.Interval:n=e.visitInterval;break;case k.IntervalDayTime:n=e.visitIntervalDayTime||e.visitInterval;break;case k.IntervalYearMonth:n=e.visitIntervalYearMonth||e.visitInterval;break;case k.FixedSizeList:n=e.visitFixedSizeList;break;case k.Map:n=e.visitMap;break}if(typeof n=="function")return n;if(!r)return()=>null;throw new Error(`Unrecognized type '${k[t]}'`)}function TD(e){switch(e.typeId){case k.Null:return k.Null;case k.Int:{let{bitWidth:t,isSigned:r}=e;switch(t){case 8:return r?k.Int8:k.Uint8;case 16:return r?k.Int16:k.Uint16;case 32:return r?k.Int32:k.Uint32;case 64:return r?k.Int64:k.Uint64}return k.Int}case k.Float:switch(e.precision){case He.HALF:return k.Float16;case He.SINGLE:return k.Float32;case He.DOUBLE:return k.Float64}return k.Float;case k.Binary:return k.Binary;case k.Utf8:return k.Utf8;case k.Bool:return k.Bool;case k.Decimal:return k.Decimal;case k.Time:switch(e.unit){case oe.SECOND:return k.TimeSecond;case oe.MILLISECOND:return k.TimeMillisecond;case oe.MICROSECOND:return k.TimeMicrosecond;case oe.NANOSECOND:return k.TimeNanosecond}return k.Time;case k.Timestamp:switch(e.unit){case oe.SECOND:return k.TimestampSecond;case oe.MILLISECOND:return k.TimestampMillisecond;case oe.MICROSECOND:return k.TimestampMicrosecond;case oe.NANOSECOND:return k.TimestampNanosecond}return k.Timestamp;case k.Date:switch(e.unit){case _n.DAY:return k.DateDay;case _n.MILLISECOND:return k.DateMillisecond}return k.Date;case k.Interval:switch(e.unit){case ri.DAY_TIME:return k.IntervalDayTime;case ri.YEAR_MONTH:return k.IntervalYearMonth}return k.Interval;case k.Map:return k.Map;case k.List:return k.List;case k.Struct:return k.Struct;case k.Union:switch(e.mode){case sr.Dense:return k.DenseUnion;case sr.Sparse:return k.SparseUnion}return k.Union;case k.FixedSizeBinary:return k.FixedSizeBinary;case k.FixedSizeList:return k.FixedSizeList;case k.Dictionary:return k.Dictionary}throw new Error(`Unrecognized type '${k[e.typeId]}'`)}_t.prototype.visitInt8=null;_t.prototype.visitInt16=null;_t.prototype.visitInt32=null;_t.prototype.visitInt64=null;_t.prototype.visitUint8=null;_t.prototype.visitUint16=null;_t.prototype.visitUint32=null;_t.prototype.visitUint64=null;_t.prototype.visitFloat16=null;_t.prototype.visitFloat32=null;_t.prototype.visitFloat64=null;_t.prototype.visitDateDay=null;_t.prototype.visitDateMillisecond=null;_t.prototype.visitTimestampSecond=null;_t.prototype.visitTimestampMillisecond=null;_t.prototype.visitTimestampMicrosecond=null;_t.prototype.visitTimestampNanosecond=null;_t.prototype.visitTimeSecond=null;_t.prototype.visitTimeMillisecond=null;_t.prototype.visitTimeMicrosecond=null;_t.prototype.visitTimeNanosecond=null;_t.prototype.visitDenseUnion=null;_t.prototype.visitSparseUnion=null;_t.prototype.visitIntervalDayTime=null;_t.prototype.visitIntervalYearMonth=null;var bA={};Qr(bA,{float64ToUint16:()=>Sm,uint16ToFloat64:()=>Ex});var AD=new Float64Array(1),xd=new Uint32Array(AD.buffer);function Ex(e){let t=(e&31744)>>10,r=(e&1023)/1024,n=Math.pow(-1,(e&32768)>>15);switch(t){case 31:return n*(r?Number.NaN:1/0);case 0:return n*(r?6103515625e-14*r:0)}return n*Math.pow(2,t-15)*(1+r)}function Sm(e){if(e!==e)return 32256;AD[0]=e;let t=(xd[1]&2147483648)>>16&65535,r=xd[1]&2146435072,n=0;return r>=1089470464?xd[0]>0?r=31744:(r=(r&2080374784)>>16,n=(xd[1]&1048575)>>10):r<=1056964608?(n=1048576+(xd[1]&1048575),n=1048576+(n<<(r>>20)-998)>>21,r=0):(r=r-1056964608>>10,n=(xd[1]&1048575)+512>>10),t|r|n&65535}var kt=class extends _t{};function Xt(e){return(t,r,n)=>{if(t.setValid(r,n!=null))return e(t,r,n)}}var fG=(e,t,r)=>{e[t]=Math.trunc(r/864e5)},xA=(e,t,r)=>{e[t]=Math.trunc(r%4294967296),e[t+1]=Math.trunc(r/4294967296)},dG=(e,t,r)=>{e[t]=Math.trunc(r*1e3%4294967296),e[t+1]=Math.trunc(r*1e3/4294967296)},hG=(e,t,r)=>{e[t]=Math.trunc(r*1e6%4294967296),e[t+1]=Math.trunc(r*1e6/4294967296)},MD=(e,t,r,n)=>{if(r+1<t.length){let{[r]:i,[r+1]:o}=t;e.set(n.subarray(0,o-i),i)}},pG=({offset:e,values:t},r,n)=>{let i=e+r;n?t[i>>3]|=1<<i%8:t[i>>3]&=~(1<<i%8)},ja=({values:e},t,r)=>{e[t]=r},_A=({values:e},t,r)=>{e[t]=r},ED=({values:e},t,r)=>{e[t]=Sm(r)},mG=(e,t,r)=>{switch(e.type.precision){case He.HALF:return ED(e,t,r);case He.SINGLE:case He.DOUBLE:return _A(e,t,r)}},Bx=({values:e},t,r)=>{fG(e,t,r.valueOf())},Ox=({values:e},t,r)=>{xA(e,t*2,r.valueOf())},wA=({stride:e,values:t},r,n)=>{t.set(n.subarray(0,e),e*r)},yG=({values:e,valueOffsets:t},r,n)=>MD(e,t,r,n),gG=({values:e,valueOffsets:t},r,n)=>{MD(e,t,r,Kc(n))},vA=(e,t,r)=>{e.type.unit===_n.DAY?Bx(e,t,r):Ox(e,t,r)},Fx=({values:e},t,r)=>xA(e,t*2,r/1e3),Nx=({values:e},t,r)=>xA(e,t*2,r),Dx=({values:e},t,r)=>dG(e,t*2,r),Lx=({values:e},t,r)=>hG(e,t*2,r),SA=(e,t,r)=>{switch(e.type.unit){case oe.SECOND:return Fx(e,t,r);case oe.MILLISECOND:return Nx(e,t,r);case oe.MICROSECOND:return Dx(e,t,r);case oe.NANOSECOND:return Lx(e,t,r)}},Rx=({values:e},t,r)=>{e[t]=r},kx=({values:e},t,r)=>{e[t]=r},Cx=({values:e},t,r)=>{e[t]=r},Ux=({values:e},t,r)=>{e[t]=r},IA=(e,t,r)=>{switch(e.type.unit){case oe.SECOND:return Rx(e,t,r);case oe.MILLISECOND:return kx(e,t,r);case oe.MICROSECOND:return Cx(e,t,r);case oe.NANOSECOND:return Ux(e,t,r)}},TA=({values:e,stride:t},r,n)=>{e.set(n.subarray(0,t),t*r)},bG=(e,t,r)=>{let n=e.children[0],i=e.valueOffsets,o=en.getVisitFn(n);if(Array.isArray(r))for(let s=-1,a=i[t],c=i[t+1];a<c;)o(n,a++,r[++s]);else for(let s=-1,a=i[t],c=i[t+1];a<c;)o(n,a++,r.get(++s))},xG=(e,t,r)=>{let n=e.children[0],{valueOffsets:i}=e,o=en.getVisitFn(n),{[t]:s,[t+1]:a}=i,c=r instanceof Map?r.entries():Object.entries(r);for(let l of c)if(o(n,s,l),++s>=a)break},_G=(e,t)=>(r,n,i,o)=>n&&r(n,e,t[o]),wG=(e,t)=>(r,n,i,o)=>n&&r(n,e,t.get(o)),vG=(e,t)=>(r,n,i,o)=>n&&r(n,e,t.get(i.name)),SG=(e,t)=>(r,n,i,o)=>n&&r(n,e,t[i.name]),IG=(e,t,r)=>{let n=e.type.children.map(o=>en.getVisitFn(o.type)),i=r instanceof Map?vG(t,r):r instanceof se?wG(t,r):Array.isArray(r)?_G(t,r):SG(t,r);e.type.children.forEach((o,s)=>i(n[s],e.children[s],o,s))},TG=(e,t,r)=>{e.type.mode===sr.Dense?BD(e,t,r):OD(e,t,r)},BD=(e,t,r)=>{let n=e.type.typeIdToChildIndex[e.typeIds[t]],i=e.children[n];en.visit(i,e.valueOffsets[t],r)},OD=(e,t,r)=>{let n=e.type.typeIdToChildIndex[e.typeIds[t]],i=e.children[n];en.visit(i,t,r)},AG=(e,t,r)=>{var n;(n=e.dictionary)===null||n===void 0||n.set(e.values[t],r)},AA=(e,t,r)=>{e.type.unit===ri.DAY_TIME?Px(e,t,r):$x(e,t,r)},Px=({values:e},t,r)=>{e.set(r.subarray(0,2),2*t)},$x=({values:e},t,r)=>{e[t]=r[0]*12+r[1]%12},MG=(e,t,r)=>{let{stride:n}=e,i=e.children[0],o=en.getVisitFn(i);if(Array.isArray(r))for(let s=-1,a=t*n;++s<n;)o(i,a+s,r[s]);else for(let s=-1,a=t*n;++s<n;)o(i,a+s,r.get(s))};kt.prototype.visitBool=Xt(pG);kt.prototype.visitInt=Xt(ja);kt.prototype.visitInt8=Xt(ja);kt.prototype.visitInt16=Xt(ja);kt.prototype.visitInt32=Xt(ja);kt.prototype.visitInt64=Xt(ja);kt.prototype.visitUint8=Xt(ja);kt.prototype.visitUint16=Xt(ja);kt.prototype.visitUint32=Xt(ja);kt.prototype.visitUint64=Xt(ja);kt.prototype.visitFloat=Xt(mG);kt.prototype.visitFloat16=Xt(ED);kt.prototype.visitFloat32=Xt(_A);kt.prototype.visitFloat64=Xt(_A);kt.prototype.visitUtf8=Xt(gG);kt.prototype.visitBinary=Xt(yG);kt.prototype.visitFixedSizeBinary=Xt(wA);kt.prototype.visitDate=Xt(vA);kt.prototype.visitDateDay=Xt(Bx);kt.prototype.visitDateMillisecond=Xt(Ox);kt.prototype.visitTimestamp=Xt(SA);kt.prototype.visitTimestampSecond=Xt(Fx);kt.prototype.visitTimestampMillisecond=Xt(Nx);kt.prototype.visitTimestampMicrosecond=Xt(Dx);kt.prototype.visitTimestampNanosecond=Xt(Lx);kt.prototype.visitTime=Xt(IA);kt.prototype.visitTimeSecond=Xt(Rx);kt.prototype.visitTimeMillisecond=Xt(kx);kt.prototype.visitTimeMicrosecond=Xt(Cx);kt.prototype.visitTimeNanosecond=Xt(Ux);kt.prototype.visitDecimal=Xt(TA);kt.prototype.visitList=Xt(bG);kt.prototype.visitStruct=Xt(IG);kt.prototype.visitUnion=Xt(TG);kt.prototype.visitDenseUnion=Xt(BD);kt.prototype.visitSparseUnion=Xt(OD);kt.prototype.visitDictionary=Xt(AG);kt.prototype.visitInterval=Xt(AA);kt.prototype.visitIntervalDayTime=Xt(Px);kt.prototype.visitIntervalYearMonth=Xt($x);kt.prototype.visitFixedSizeList=Xt(MG);kt.prototype.visitMap=Xt(xG);var en=new kt;var Wo=Symbol.for("parent"),_d=Symbol.for("rowIndex"),Qc=class{constructor(t,r){return this[Wo]=t,this[_d]=r,new Proxy(this,new EA)}toArray(){return Object.values(this.toJSON())}toJSON(){let t=this[_d],r=this[Wo],n=r.type.children,i={};for(let o=-1,s=n.length;++o<s;)i[n[o].name]=Sr.visit(r.children[o],t);return i}toString(){return`{${[...this].map(([t,r])=>`${Os(t)}: ${Os(r)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new MA(this[Wo],this[_d])}},MA=class{constructor(t,r){this.childIndex=0,this.children=t.children,this.rowIndex=r,this.childFields=t.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){let t=this.childIndex;return t<this.numChildren?(this.childIndex=t+1,{done:!1,value:[this.childFields[t].name,Sr.visit(this.children[t],this.rowIndex)]}):{done:!0,value:null}}};Object.defineProperties(Qc.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[Wo]:{writable:!0,enumerable:!1,configurable:!1,value:null},[_d]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});var EA=class{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[Wo].type.children.map(r=>r.name)}has(t,r){return t[Wo].type.children.findIndex(n=>n.name===r)!==-1}getOwnPropertyDescriptor(t,r){if(t[Wo].type.children.findIndex(n=>n.name===r)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(t,r){if(Reflect.has(t,r))return t[r];let n=t[Wo].type.children.findIndex(i=>i.name===r);if(n!==-1){let i=Sr.visit(t[Wo].children[n],t[_d]);return Reflect.set(t,r,i),i}}set(t,r,n){let i=t[Wo].type.children.findIndex(o=>o.name===r);return i!==-1?(en.visit(t[Wo].children[i],t[_d],n),Reflect.set(t,r,n)):Reflect.has(t,r)||typeof r=="symbol"?Reflect.set(t,r,n):!1}};var It=class extends _t{};function jt(e){return(t,r)=>t.getValid(r)?e(t,r):null}var EG=(e,t)=>864e5*e[t],BA=(e,t)=>4294967296*e[t+1]+(e[t]>>>0),BG=(e,t)=>4294967296*(e[t+1]/1e3)+(e[t]>>>0)/1e3,OG=(e,t)=>4294967296*(e[t+1]/1e6)+(e[t]>>>0)/1e6,FD=e=>new Date(e),FG=(e,t)=>FD(EG(e,t)),NG=(e,t)=>FD(BA(e,t)),DG=(e,t)=>null,ND=(e,t,r)=>{if(r+1>=t.length)return null;let n=t[r],i=t[r+1];return e.subarray(n,i)},LG=({offset:e,values:t},r)=>{let n=e+r;return(t[n>>3]&1<<n%8)!==0},DD=({values:e},t)=>FG(e,t),LD=({values:e},t)=>NG(e,t*2),Jc=({stride:e,values:t},r)=>t[e*r],RG=({stride:e,values:t},r)=>Ex(t[e*r]),RD=({values:e},t)=>e[t],kG=({stride:e,values:t},r)=>t.subarray(e*r,e*(r+1)),CG=({values:e,valueOffsets:t},r)=>ND(e,t,r),UG=({values:e,valueOffsets:t},r)=>{let n=ND(e,t,r);return n!==null?gm(n):null},PG=({values:e},t)=>e[t],$G=({type:e,values:t},r)=>e.precision!==He.HALF?t[r]:Ex(t[r]),zG=(e,t)=>e.type.unit===_n.DAY?DD(e,t):LD(e,t),kD=({values:e},t)=>1e3*BA(e,t*2),CD=({values:e},t)=>BA(e,t*2),UD=({values:e},t)=>BG(e,t*2),PD=({values:e},t)=>OG(e,t*2),VG=(e,t)=>{switch(e.type.unit){case oe.SECOND:return kD(e,t);case oe.MILLISECOND:return CD(e,t);case oe.MICROSECOND:return UD(e,t);case oe.NANOSECOND:return PD(e,t)}},$D=({values:e},t)=>e[t],zD=({values:e},t)=>e[t],VD=({values:e},t)=>e[t],jD=({values:e},t)=>e[t],jG=(e,t)=>{switch(e.type.unit){case oe.SECOND:return $D(e,t);case oe.MILLISECOND:return zD(e,t);case oe.MICROSECOND:return VD(e,t);case oe.NANOSECOND:return jD(e,t)}},qG=({values:e,stride:t},r)=>vm.decimal(e.subarray(t*r,t*(r+1))),YG=(e,t)=>{let{valueOffsets:r,stride:n,children:i}=e,{[t*n]:o,[t*n+1]:s}=r,c=i[0].slice(o,s-o);return new se([c])},WG=(e,t)=>{let{valueOffsets:r,children:n}=e,{[t]:i,[t+1]:o}=r,s=n[0];return new Ns(s.slice(i,o-i))},GG=(e,t)=>new Qc(e,t),XG=(e,t)=>e.type.mode===sr.Dense?qD(e,t):YD(e,t),qD=(e,t)=>{let r=e.type.typeIdToChildIndex[e.typeIds[t]],n=e.children[r];return Sr.visit(n,e.valueOffsets[t])},YD=(e,t)=>{let r=e.type.typeIdToChildIndex[e.typeIds[t]],n=e.children[r];return Sr.visit(n,t)},HG=(e,t)=>{var r;return(r=e.dictionary)===null||r===void 0?void 0:r.get(e.values[t])},ZG=(e,t)=>e.type.unit===ri.DAY_TIME?WD(e,t):GD(e,t),WD=({values:e},t)=>e.subarray(2*t,2*(t+1)),GD=({values:e},t)=>{let r=e[t],n=new Int32Array(2);return n[0]=Math.trunc(r/12),n[1]=Math.trunc(r%12),n},KG=(e,t)=>{let{stride:r,children:n}=e,o=n[0].slice(t*r,r);return new se([o])};It.prototype.visitNull=jt(DG);It.prototype.visitBool=jt(LG);It.prototype.visitInt=jt(PG);It.prototype.visitInt8=jt(Jc);It.prototype.visitInt16=jt(Jc);It.prototype.visitInt32=jt(Jc);It.prototype.visitInt64=jt(RD);It.prototype.visitUint8=jt(Jc);It.prototype.visitUint16=jt(Jc);It.prototype.visitUint32=jt(Jc);It.prototype.visitUint64=jt(RD);It.prototype.visitFloat=jt($G);It.prototype.visitFloat16=jt(RG);It.prototype.visitFloat32=jt(Jc);It.prototype.visitFloat64=jt(Jc);It.prototype.visitUtf8=jt(UG);It.prototype.visitBinary=jt(CG);It.prototype.visitFixedSizeBinary=jt(kG);It.prototype.visitDate=jt(zG);It.prototype.visitDateDay=jt(DD);It.prototype.visitDateMillisecond=jt(LD);It.prototype.visitTimestamp=jt(VG);It.prototype.visitTimestampSecond=jt(kD);It.prototype.visitTimestampMillisecond=jt(CD);It.prototype.visitTimestampMicrosecond=jt(UD);It.prototype.visitTimestampNanosecond=jt(PD);It.prototype.visitTime=jt(jG);It.prototype.visitTimeSecond=jt($D);It.prototype.visitTimeMillisecond=jt(zD);It.prototype.visitTimeMicrosecond=jt(VD);It.prototype.visitTimeNanosecond=jt(jD);It.prototype.visitDecimal=jt(qG);It.prototype.visitList=jt(YG);It.prototype.visitStruct=jt(GG);It.prototype.visitUnion=jt(XG);It.prototype.visitDenseUnion=jt(qD);It.prototype.visitSparseUnion=jt(YD);It.prototype.visitDictionary=jt(HG);It.prototype.visitInterval=jt(ZG);It.prototype.visitIntervalDayTime=jt(WD);It.prototype.visitIntervalYearMonth=jt(GD);It.prototype.visitFixedSizeList=jt(KG);It.prototype.visitMap=jt(WG);var Sr=new It;var lo=Symbol.for("keys"),wd=Symbol.for("vals"),Ns=class{constructor(t){return this[lo]=new se([t.children[0]]).memoize(),this[wd]=t.children[1],new Proxy(this,new FA)}[Symbol.iterator](){return new OA(this[lo],this[wd])}get size(){return this[lo].length}toArray(){return Object.values(this.toJSON())}toJSON(){let t=this[lo],r=this[wd],n={};for(let i=-1,o=t.length;++i<o;)n[t.get(i)]=Sr.visit(r,i);return n}toString(){return`{${[...this].map(([t,r])=>`${Os(t)}: ${Os(r)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}},OA=class{constructor(t,r){this.keys=t,this.vals=r,this.keyIndex=0,this.numKeys=t.length}[Symbol.iterator](){return this}next(){let t=this.keyIndex;return t===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(t),Sr.visit(this.vals,t)]})}},FA=class{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[lo].toArray().map(String)}has(t,r){return t[lo].includes(r)}getOwnPropertyDescriptor(t,r){if(t[lo].indexOf(r)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(t,r){if(Reflect.has(t,r))return t[r];let n=t[lo].indexOf(r);if(n!==-1){let i=Sr.visit(Reflect.get(t,wd),n);return Reflect.set(t,r,i),i}}set(t,r,n){let i=t[lo].indexOf(r);return i!==-1?(en.visit(Reflect.get(t,wd),i,n),Reflect.set(t,r,n)):Reflect.has(t,r)?Reflect.set(t,r,n):!1}};Object.defineProperties(Ns.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[lo]:{writable:!0,enumerable:!1,configurable:!1,value:null},[wd]:{writable:!0,enumerable:!1,configurable:!1,value:null}});function QG(e,t,r){let n=e.length,i=t>-1?t:n+t%n;return r?r(e,i):i}var XD;function Im(e,t,r,n){let{length:i=0}=e,o=typeof t!="number"?0:t,s=typeof r!="number"?i:r;return o<0&&(o=(o%i+i)%i),s<0&&(s=(s%i+i)%i),s<o&&(XD=o,o=s,s=XD),s>i&&(s=i),n?n(e,o,s):[o,s]}var HD=e=>e!==e;function tl(e){if(typeof e!=="object"||e===null)return HD(e)?HD:r=>r===e;if(e instanceof Date){let r=e.valueOf();return n=>n instanceof Date?n.valueOf()===r:!1}return ArrayBuffer.isView(e)?r=>r?hA(e,r):!1:e instanceof Map?tX(e):Array.isArray(e)?JG(e):e instanceof se?eX(e):rX(e,!0)}function JG(e){let t=[];for(let r=-1,n=e.length;++r<n;)t[r]=tl(e[r]);return zx(t)}function tX(e){let t=-1,r=[];for(let n of e.values())r[++t]=tl(n);return zx(r)}function eX(e){let t=[];for(let r=-1,n=e.length;++r<n;)t[r]=tl(e.get(r));return zx(t)}function rX(e,t=!1){let r=Object.keys(e);if(!t&&r.length===0)return()=>!1;let n=[];for(let i=-1,o=r.length;++i<o;)n[i]=tl(e[r[i]]);return zx(n,r)}function zx(e,t){return r=>{if(!r||typeof r!="object")return!1;switch(r.constructor){case Array:return nX(e,r);case Map:return ZD(e,r,r.keys());case Ns:case Qc:case Object:case void 0:return ZD(e,r,t||Object.keys(r))}return r instanceof se?iX(e,r):!1}}function nX(e,t){let r=e.length;if(t.length!==r)return!1;for(let n=-1;++n<r;)if(!e[n](t[n]))return!1;return!0}function iX(e,t){let r=e.length;if(t.length!==r)return!1;for(let n=-1;++n<r;)if(!e[n](t.get(n)))return!1;return!0}function ZD(e,t,r){let n=r[Symbol.iterator](),i=t instanceof Map?t.keys():Object.keys(t)[Symbol.iterator](),o=t instanceof Map?t.values():Object.values(t)[Symbol.iterator](),s=0,a=e.length,c=o.next(),l=n.next(),u=i.next();for(;s<a&&!l.done&&!u.done&&!c.done&&!(l.value!==u.value||!e[s](c.value));++s,l=n.next(),u=i.next(),c=o.next());return s===a&&l.done&&u.done&&c.done?!0:(n.return&&n.return(),i.return&&i.return(),o.return&&o.return(),!1)}var DA={};Qr(DA,{BitIterator:()=>Ou,getBit:()=>KD,getBool:()=>jx,packBools:()=>Fu,popcnt_array:()=>QD,popcnt_bit_range:()=>Tm,popcnt_uint32:()=>Vx,setBool:()=>oX,truncateBitmap:()=>vd});function jx(e,t,r,n){return(r&1<<n)!==0}function KD(e,t,r,n){return(r&1<<n)>>n}function oX(e,t,r){return r?!!(e[t>>3]|=1<<t%8)||!0:!(e[t>>3]&=~(1<<t%8))&&!1}function vd(e,t,r){let n=r.byteLength+7&-8;if(e>0||r.byteLength<n){let i=new Uint8Array(n);return i.set(e%8===0?r.subarray(e>>3):Fu(new Ou(r,e,t,null,jx)).subarray(0,n)),i}return r}function Fu(e){let t=[],r=0,n=0,i=0;for(let s of e)s&&(i|=1<<n),++n===8&&(t[r++]=i,i=n=0);(r===0||n>0)&&(t[r++]=i);let o=new Uint8Array(t.length+7&-8);return o.set(t),o}var Ou=class{constructor(t,r,n,i,o){this.bytes=t,this.length=n,this.context=i,this.get=o,this.bit=r%8,this.byteIndex=r>>3,this.byte=t[this.byteIndex++],this.index=0}next(){return this.index<this.length?(this.bit===8&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}};function Tm(e,t,r){if(r-t<=0)return 0;if(r-t<8){let o=0;for(let s of new Ou(e,t,r-t,e,KD))o+=s;return o}let n=r>>3<<3,i=t+(t%8===0?0:8-t%8);return Tm(e,t,i)+Tm(e,n,r)+QD(e,i>>3,n-i>>3)}function QD(e,t,r){let n=0,i=Math.trunc(t),o=new DataView(e.buffer,e.byteOffset,e.byteLength),s=r===void 0?e.byteLength:i+r;for(;s-i>=4;)n+=Vx(o.getUint32(i)),i+=4;for(;s-i>=2;)n+=Vx(o.getUint16(i)),i+=2;for(;s-i>=1;)n+=Vx(o.getUint8(i)),i+=1;return n}function Vx(e){let t=Math.trunc(e);return t=t-(t>>>1&1431655765),t=(t&858993459)+(t>>>2&858993459),(t+(t>>>4)&252645135)*16843009>>>24}var sX=-1,Me=class e{get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get byteLength(){let t=0,{valueOffsets:r,values:n,nullBitmap:i,typeIds:o}=this;return r&&(t+=r.byteLength),n&&(t+=n.byteLength),i&&(t+=i.byteLength),o&&(t+=o.byteLength),this.children.reduce((s,a)=>s+a.byteLength,t)}get nullCount(){let t=this._nullCount,r;return t<=sX&&(r=this.nullBitmap)&&(this._nullCount=t=this.length-Tm(r,this.offset,this.offset+this.length)),t}constructor(t,r,n,i,o,s=[],a){this.type=t,this.children=s,this.dictionary=a,this.offset=Math.floor(Math.max(r||0,0)),this.length=Math.floor(Math.max(n||0,0)),this._nullCount=Math.floor(Math.max(i||0,-1));let c;o instanceof e?(this.stride=o.stride,this.values=o.values,this.typeIds=o.typeIds,this.nullBitmap=o.nullBitmap,this.valueOffsets=o.valueOffsets):(this.stride=Bi(t),o&&((c=o[0])&&(this.valueOffsets=c),(c=o[1])&&(this.values=c),(c=o[2])&&(this.nullBitmap=c),(c=o[3])&&(this.typeIds=c))),this.nullable=this._nullCount!==0&&this.nullBitmap&&this.nullBitmap.byteLength>0}getValid(t){if(this.nullable&&this.nullCount>0){let r=this.offset+t;return(this.nullBitmap[r>>3]&1<<r%8)!==0}return!0}setValid(t,r){if(!this.nullable)return r;if(!this.nullBitmap||this.nullBitmap.byteLength<=t>>3){let{nullBitmap:c}=this._changeLengthAndBackfillNullBitmap(this.length);Object.assign(this,{nullBitmap:c,_nullCount:0})}let{nullBitmap:n,offset:i}=this,o=i+t>>3,s=(i+t)%8,a=n[o]>>s&1;return r?a===0&&(n[o]|=1<<s,this._nullCount=this.nullCount+1):a===1&&(n[o]&=~(1<<s),this._nullCount=this.nullCount-1),r}clone(t=this.type,r=this.offset,n=this.length,i=this._nullCount,o=this,s=this.children){return new e(t,r,n,i,o,s,this.dictionary)}slice(t,r){let{stride:n,typeId:i,children:o}=this,s=+(this._nullCount===0)-1,a=i===16?n:1,c=this._sliceBuffers(t,r,n,i);return this.clone(this.type,this.offset+t,r,s,c,o.length===0||this.valueOffsets?o:this._sliceChildren(o,a*t,a*r))}_changeLengthAndBackfillNullBitmap(t){if(this.typeId===k.Null)return this.clone(this.type,0,t,0);let{length:r,nullCount:n}=this,i=new Uint8Array((t+63&-64)>>3).fill(255,0,r>>3);i[r>>3]=(1<<r-(r&-8))-1,n>0&&i.set(vd(this.offset,r,this.nullBitmap),0);let o=this.buffers;return o[Po.VALIDITY]=i,this.clone(this.type,0,t,n+(t-r),o)}_sliceBuffers(t,r,n,i){let o,{buffers:s}=this;return(o=s[Po.TYPE])&&(s[Po.TYPE]=o.subarray(t,t+r)),(o=s[Po.OFFSET])&&(s[Po.OFFSET]=o.subarray(t,t+r+1))||(o=s[Po.DATA])&&(s[Po.DATA]=i===6?o:o.subarray(n*t,n*(t+r))),s}_sliceChildren(t,r,n){return t.map(i=>i.slice(r,n))}};Me.prototype.children=Object.freeze([]);var LA=class e extends _t{visit(t){return this.getVisitFn(t.type).call(this,t)}visitNull(t){let{["type"]:r,["offset"]:n=0,["length"]:i=0}=t;return new Me(r,n,i,0)}visitBool(t){let{["type"]:r,["offset"]:n=0}=t,i=Rt(t.nullBitmap),o=Zt(r.ArrayType,t.data),{["length"]:s=o.length>>3,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Me(r,n,s,a,[void 0,o,i])}visitInt(t){let{["type"]:r,["offset"]:n=0}=t,i=Rt(t.nullBitmap),o=Zt(r.ArrayType,t.data),{["length"]:s=o.length,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Me(r,n,s,a,[void 0,o,i])}visitFloat(t){let{["type"]:r,["offset"]:n=0}=t,i=Rt(t.nullBitmap),o=Zt(r.ArrayType,t.data),{["length"]:s=o.length,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Me(r,n,s,a,[void 0,o,i])}visitUtf8(t){let{["type"]:r,["offset"]:n=0}=t,i=Rt(t.data),o=Rt(t.nullBitmap),s=Bu(t.valueOffsets),{["length"]:a=s.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new Me(r,n,a,c,[s,i,o])}visitBinary(t){let{["type"]:r,["offset"]:n=0}=t,i=Rt(t.data),o=Rt(t.nullBitmap),s=Bu(t.valueOffsets),{["length"]:a=s.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new Me(r,n,a,c,[s,i,o])}visitFixedSizeBinary(t){let{["type"]:r,["offset"]:n=0}=t,i=Rt(t.nullBitmap),o=Zt(r.ArrayType,t.data),{["length"]:s=o.length/Bi(r),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Me(r,n,s,a,[void 0,o,i])}visitDate(t){let{["type"]:r,["offset"]:n=0}=t,i=Rt(t.nullBitmap),o=Zt(r.ArrayType,t.data),{["length"]:s=o.length/Bi(r),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Me(r,n,s,a,[void 0,o,i])}visitTimestamp(t){let{["type"]:r,["offset"]:n=0}=t,i=Rt(t.nullBitmap),o=Zt(r.ArrayType,t.data),{["length"]:s=o.length/Bi(r),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Me(r,n,s,a,[void 0,o,i])}visitTime(t){let{["type"]:r,["offset"]:n=0}=t,i=Rt(t.nullBitmap),o=Zt(r.ArrayType,t.data),{["length"]:s=o.length/Bi(r),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Me(r,n,s,a,[void 0,o,i])}visitDecimal(t){let{["type"]:r,["offset"]:n=0}=t,i=Rt(t.nullBitmap),o=Zt(r.ArrayType,t.data),{["length"]:s=o.length/Bi(r),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Me(r,n,s,a,[void 0,o,i])}visitList(t){let{["type"]:r,["offset"]:n=0,["child"]:i}=t,o=Rt(t.nullBitmap),s=Bu(t.valueOffsets),{["length"]:a=s.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new Me(r,n,a,c,[s,void 0,o],[i])}visitStruct(t){let{["type"]:r,["offset"]:n=0,["children"]:i=[]}=t,o=Rt(t.nullBitmap),{length:s=i.reduce((c,{length:l})=>Math.max(c,l),0),nullCount:a=t.nullBitmap?-1:0}=t;return new Me(r,n,s,a,[void 0,void 0,o],i)}visitUnion(t){let{["type"]:r,["offset"]:n=0,["children"]:i=[]}=t,o=Rt(t.nullBitmap),s=Zt(r.ArrayType,t.typeIds),{["length"]:a=s.length,["nullCount"]:c=t.nullBitmap?-1:0}=t;if(pt.isSparseUnion(r))return new Me(r,n,a,c,[void 0,void 0,o,s],i);let l=Bu(t.valueOffsets);return new Me(r,n,a,c,[l,void 0,o,s],i)}visitDictionary(t){let{["type"]:r,["offset"]:n=0}=t,i=Rt(t.nullBitmap),o=Zt(r.indices.ArrayType,t.data),{["dictionary"]:s=new se([new e().visit({type:r.dictionary})])}=t,{["length"]:a=o.length,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new Me(r,n,a,c,[void 0,o,i],[],s)}visitInterval(t){let{["type"]:r,["offset"]:n=0}=t,i=Rt(t.nullBitmap),o=Zt(r.ArrayType,t.data),{["length"]:s=o.length/Bi(r),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Me(r,n,s,a,[void 0,o,i])}visitFixedSizeList(t){let{["type"]:r,["offset"]:n=0,["child"]:i=new e().visit({type:r.valueType})}=t,o=Rt(t.nullBitmap),{["length"]:s=i.length/Bi(r),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Me(r,n,s,a,[void 0,void 0,o],[i])}visitMap(t){let{["type"]:r,["offset"]:n=0,["child"]:i=new e().visit({type:r.childType})}=t,o=Rt(t.nullBitmap),s=Bu(t.valueOffsets),{["length"]:a=s.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new Me(r,n,a,c,[s,void 0,o],[i])}};function $t(e){return new LA().visit(e)}var Am=class{constructor(t=0,r){this.numChunks=t,this.getChunkIterator=r,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){let t=this.chunkIterator.next();if(!t.done)return t;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}};function qx(e){return e.reduce((t,r)=>t+r.nullCount,0)}function Yx(e){return e.reduce((t,r,n)=>(t[n+1]=t[n]+r.length,t),new Uint32Array(e.length+1))}function Wx(e,t,r,n){let i=[];for(let o=-1,s=e.length;++o<s;){let a=e[o],c=t[o],{length:l}=a;if(c>=n)break;if(r>=c+l)continue;if(c>=r&&c+l<=n){i.push(a);continue}let u=Math.max(0,r-c),f=Math.min(n-c,l);i.push(a.slice(u,f-u))}return i.length===0&&i.push(e[0].slice(0,0)),i}function RA(e,t,r,n){let i=0,o=0,s=t.length-1;do{if(i>=s-1)return r<t[s]?n(e,i,r-t[i]):null;o=i+Math.trunc((s-i)*.5),r<t[o]?s=o:i=o}while(i<s)}function Mm(e,t){return e.getValid(t)}function el(e){function t(r,n,i){return e(r[n],i)}return function(r){let n=this.data;return RA(n,this._offsets,r,t)}}function Gx(e){let t;function r(n,i,o){return e(n[i],o,t)}return function(n,i){let o=this.data;t=i;let s=RA(o,this._offsets,n,r);return t=void 0,s}}function Xx(e){let t;function r(n,i,o){let s=o,a=0,c=0;for(let l=i-1,u=n.length;++l<u;){let f=n[l];if(~(a=e(f,t,s)))return c+a;s=0,c+=f.length}return-1}return function(n,i){t=n;let o=this.data,s=typeof i!="number"?r(o,0,0):RA(o,this._offsets,i,r);return t=void 0,s}}var Tt=class extends _t{};function aX(e,t){return t===null&&e.length>0?0:-1}function cX(e,t){let{nullBitmap:r}=e;if(!r||e.nullCount<=0)return-1;let n=0;for(let i of new Ou(r,e.offset+(t||0),e.length,r,jx)){if(!i)return n;++n}return-1}function Kt(e,t,r){if(t===void 0)return-1;if(t===null)return cX(e,r);let n=Sr.getVisitFn(e),i=tl(t);for(let o=(r||0)-1,s=e.length;++o<s;)if(i(n(e,o)))return o;return-1}function JD(e,t,r){let n=Sr.getVisitFn(e),i=tl(t);for(let o=(r||0)-1,s=e.length;++o<s;)if(i(n(e,o)))return o;return-1}Tt.prototype.visitNull=aX;Tt.prototype.visitBool=Kt;Tt.prototype.visitInt=Kt;Tt.prototype.visitInt8=Kt;Tt.prototype.visitInt16=Kt;Tt.prototype.visitInt32=Kt;Tt.prototype.visitInt64=Kt;Tt.prototype.visitUint8=Kt;Tt.prototype.visitUint16=Kt;Tt.prototype.visitUint32=Kt;Tt.prototype.visitUint64=Kt;Tt.prototype.visitFloat=Kt;Tt.prototype.visitFloat16=Kt;Tt.prototype.visitFloat32=Kt;Tt.prototype.visitFloat64=Kt;Tt.prototype.visitUtf8=Kt;Tt.prototype.visitBinary=Kt;Tt.prototype.visitFixedSizeBinary=Kt;Tt.prototype.visitDate=Kt;Tt.prototype.visitDateDay=Kt;Tt.prototype.visitDateMillisecond=Kt;Tt.prototype.visitTimestamp=Kt;Tt.prototype.visitTimestampSecond=Kt;Tt.prototype.visitTimestampMillisecond=Kt;Tt.prototype.visitTimestampMicrosecond=Kt;Tt.prototype.visitTimestampNanosecond=Kt;Tt.prototype.visitTime=Kt;Tt.prototype.visitTimeSecond=Kt;Tt.prototype.visitTimeMillisecond=Kt;Tt.prototype.visitTimeMicrosecond=Kt;Tt.prototype.visitTimeNanosecond=Kt;Tt.prototype.visitDecimal=Kt;Tt.prototype.visitList=Kt;Tt.prototype.visitStruct=Kt;Tt.prototype.visitUnion=Kt;Tt.prototype.visitDenseUnion=JD;Tt.prototype.visitSparseUnion=JD;Tt.prototype.visitDictionary=Kt;Tt.prototype.visitInterval=Kt;Tt.prototype.visitIntervalDayTime=Kt;Tt.prototype.visitIntervalYearMonth=Kt;Tt.prototype.visitFixedSizeList=Kt;Tt.prototype.visitMap=Kt;var Nu=new Tt;var At=class extends _t{};function qt(e){let{type:t}=e;if(e.nullCount===0&&e.stride===1&&(t.typeId===k.Timestamp||t instanceof mr&&t.bitWidth!==64||t instanceof zo&&t.bitWidth!==64||t instanceof ii&&t.precision!==He.HALF))return new Am(e.data.length,n=>{let i=e.data[n];return i.values.subarray(0,i.length)[Symbol.iterator]()});let r=0;return new Am(e.data.length,n=>{let o=e.data[n].length,s=e.slice(r,r+o);return r+=o,new kA(s)})}var kA=class{constructor(t){this.vector=t,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}};At.prototype.visitNull=qt;At.prototype.visitBool=qt;At.prototype.visitInt=qt;At.prototype.visitInt8=qt;At.prototype.visitInt16=qt;At.prototype.visitInt32=qt;At.prototype.visitInt64=qt;At.prototype.visitUint8=qt;At.prototype.visitUint16=qt;At.prototype.visitUint32=qt;At.prototype.visitUint64=qt;At.prototype.visitFloat=qt;At.prototype.visitFloat16=qt;At.prototype.visitFloat32=qt;At.prototype.visitFloat64=qt;At.prototype.visitUtf8=qt;At.prototype.visitBinary=qt;At.prototype.visitFixedSizeBinary=qt;At.prototype.visitDate=qt;At.prototype.visitDateDay=qt;At.prototype.visitDateMillisecond=qt;At.prototype.visitTimestamp=qt;At.prototype.visitTimestampSecond=qt;At.prototype.visitTimestampMillisecond=qt;At.prototype.visitTimestampMicrosecond=qt;At.prototype.visitTimestampNanosecond=qt;At.prototype.visitTime=qt;At.prototype.visitTimeSecond=qt;At.prototype.visitTimeMillisecond=qt;At.prototype.visitTimeMicrosecond=qt;At.prototype.visitTimeNanosecond=qt;At.prototype.visitDecimal=qt;At.prototype.visitList=qt;At.prototype.visitStruct=qt;At.prototype.visitUnion=qt;At.prototype.visitDenseUnion=qt;At.prototype.visitSparseUnion=qt;At.prototype.visitDictionary=qt;At.prototype.visitInterval=qt;At.prototype.visitIntervalDayTime=qt;At.prototype.visitIntervalYearMonth=qt;At.prototype.visitFixedSizeList=qt;At.prototype.visitMap=qt;var Sd=new At;var lX=(e,t)=>e+t,Ds=class extends _t{visitNull(t,r){return 0}visitInt(t,r){return t.type.bitWidth/8}visitFloat(t,r){return t.type.ArrayType.BYTES_PER_ELEMENT}visitBool(t,r){return 1/8}visitDecimal(t,r){return t.type.bitWidth/8}visitDate(t,r){return(t.type.unit+1)*4}visitTime(t,r){return t.type.bitWidth/8}visitTimestamp(t,r){return t.type.unit===oe.SECOND?4:8}visitInterval(t,r){return(t.type.unit+1)*4}visitStruct(t,r){return t.children.reduce((n,i)=>n+Oi.visit(i,r),0)}visitFixedSizeBinary(t,r){return t.type.byteWidth}visitMap(t,r){return 8+t.children.reduce((n,i)=>n+Oi.visit(i,r),0)}visitDictionary(t,r){var n;return t.type.indices.bitWidth/8+(((n=t.dictionary)===null||n===void 0?void 0:n.getByteLength(t.values[r]))||0)}},uX=({valueOffsets:e},t)=>8+(e[t+1]-e[t]),fX=({valueOffsets:e},t)=>8+(e[t+1]-e[t]),dX=({valueOffsets:e,stride:t,children:r},n)=>{let i=r[0],{[n*t]:o}=e,{[n*t+1]:s}=e,a=Oi.getVisitFn(i.type),c=i.slice(o,s-o),l=8;for(let u=-1,f=s-o;++u<f;)l+=a(c,u);return l},hX=({stride:e,children:t},r)=>{let n=t[0],i=n.slice(r*e,e),o=Oi.getVisitFn(n.type),s=0;for(let a=-1,c=i.length;++a<c;)s+=o(i,a);return s},pX=(e,t)=>e.type.mode===sr.Dense?t6(e,t):e6(e,t),t6=({type:e,children:t,typeIds:r,valueOffsets:n},i)=>{let o=e.typeIdToChildIndex[r[i]];return 8+Oi.visit(t[o],n[i])},e6=({children:e},t)=>4+Oi.visitMany(e,e.map(()=>t)).reduce(lX,0);Ds.prototype.visitUtf8=uX;Ds.prototype.visitBinary=fX;Ds.prototype.visitList=dX;Ds.prototype.visitFixedSizeList=hX;Ds.prototype.visitUnion=pX;Ds.prototype.visitDenseUnion=t6;Ds.prototype.visitSparseUnion=e6;var Oi=new Ds;var r6,n6={},i6={},se=class e{constructor(t){var r,n,i;let o=t[0]instanceof e?t.flatMap(a=>a.data):t;if(o.length===0||o.some(a=>!(a instanceof Me)))throw new TypeError("Vector constructor expects an Array of Data instances.");let s=(r=o[0])===null||r===void 0?void 0:r.type;switch(o.length){case 0:this._offsets=[0];break;case 1:{let{get:a,set:c,indexOf:l,byteLength:u}=n6[s.typeId],f=o[0];this.isValid=d=>Mm(f,d),this.get=d=>a(f,d),this.set=(d,h)=>c(f,d,h),this.indexOf=d=>l(f,d),this.getByteLength=d=>u(f,d),this._offsets=[0,f.length];break}default:Object.setPrototypeOf(this,i6[s.typeId]),this._offsets=Yx(o);break}this.data=o,this.type=s,this.stride=Bi(s),this.numChildren=(i=(n=s.children)===null||n===void 0?void 0:n.length)!==null&&i!==void 0?i:0,this.length=this._offsets[this._offsets.length-1]}get byteLength(){return this._byteLength===-1&&(this._byteLength=this.data.reduce((t,r)=>t+r.byteLength,0)),this._byteLength}get nullCount(){return this._nullCount===-1&&(this._nullCount=qx(this.data)),this._nullCount}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${k[this.type.typeId]}Vector`}isValid(t){return!1}get(t){return null}set(t,r){}indexOf(t,r){return-1}includes(t,r){return this.indexOf(t,r)>0}getByteLength(t){return 0}[Symbol.iterator](){return Sd.visit(this)}concat(...t){return new e(this.data.concat(t.flatMap(r=>r.data).flat(Number.POSITIVE_INFINITY)))}slice(t,r){return new e(Im(this,t,r,({data:n,_offsets:i},o,s)=>Wx(n,i,o,s)))}toJSON(){return[...this]}toArray(){let{type:t,data:r,length:n,stride:i,ArrayType:o}=this;switch(t.typeId){case k.Int:case k.Float:case k.Decimal:case k.Time:case k.Timestamp:switch(r.length){case 0:return new o;case 1:return r[0].values.subarray(0,n*i);default:return r.reduce((s,{values:a,length:c})=>(s.array.set(a.subarray(0,c*i),s.offset),s.offset+=c*i,s),{array:new o(n*i),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild(t){var r;return this.getChildAt((r=this.type.children)===null||r===void 0?void 0:r.findIndex(n=>n.name===t))}getChildAt(t){return t>-1&&t<this.numChildren?new e(this.data.map(({children:r})=>r[t])):null}get isMemoized(){return pt.isDictionary(this.type)?this.data[0].dictionary.isMemoized:!1}memoize(){if(pt.isDictionary(this.type)){let t=new Hx(this.data[0].dictionary),r=this.data.map(n=>{let i=n.clone();return i.dictionary=t,i});return new e(r)}return new Hx(this)}unmemoize(){if(pt.isDictionary(this.type)&&this.isMemoized){let t=this.data[0].dictionary.unmemoize(),r=this.data.map(n=>{let i=n.clone();return i.dictionary=t,i});return new e(r)}return this}};r6=Symbol.toStringTag;se[r6]=(e=>{e.type=pt.prototype,e.data=[],e.length=0,e.stride=1,e.numChildren=0,e._nullCount=-1,e._byteLength=-1,e._offsets=new Uint32Array([0]),e[Symbol.isConcatSpreadable]=!0;let t=Object.keys(k).map(r=>k[r]).filter(r=>typeof r=="number"&&r!==k.NONE);for(let r of t){let n=Sr.getVisitFnByTypeId(r),i=en.getVisitFnByTypeId(r),o=Nu.getVisitFnByTypeId(r),s=Oi.getVisitFnByTypeId(r);n6[r]={get:n,set:i,indexOf:o,byteLength:s},i6[r]=Object.create(e,{isValid:{value:el(Mm)},get:{value:el(Sr.getVisitFnByTypeId(r))},set:{value:Gx(en.getVisitFnByTypeId(r))},indexOf:{value:Xx(Nu.getVisitFnByTypeId(r))},getByteLength:{value:el(Oi.getVisitFnByTypeId(r))}})}return"Vector"})(se.prototype);var Hx=class e extends se{constructor(t){super(t.data);let r=this.get,n=this.set,i=this.slice,o=new Array(this.length);Object.defineProperty(this,"get",{value(s){let a=o[s];if(a!==void 0)return a;let c=r.call(this,s);return o[s]=c,c}}),Object.defineProperty(this,"set",{value(s,a){n.call(this,s,a),o[s]=a}}),Object.defineProperty(this,"slice",{value:(s,a)=>new e(i.call(this,s,a))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new se(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}};function o6(e){if(!e||e.length<=0)return function(i){return!0};let t="",r=e.filter(n=>n===n);return r.length>0&&(t=`
    switch (x) {${r.map(n=>`
        case ${mX(n)}:`).join("")}
            return false;
    }`),e.length!==r.length&&(t=`if (x !== x) return false;
${t}`),new Function("x",`${t}
return true;`)}function mX(e){return typeof e!="bigint"?Os(e):`${Os(e)}n`}var CA=(e,t)=>(Math.ceil(e)*t+63&-64||64)/t,yX=(e,t=0)=>e.length>=t?e.subarray(0,t):md(new e.constructor(t),e,0),rl=class{constructor(t,r=1){this.buffer=t,this.stride=r,this.BYTES_PER_ELEMENT=t.BYTES_PER_ELEMENT,this.ArrayType=t.constructor,this._resize(this.length=Math.ceil(t.length/r))}get byteLength(){return Math.ceil(this.length*this.stride)*this.BYTES_PER_ELEMENT}get reservedLength(){return this.buffer.length/this.stride}get reservedByteLength(){return this.buffer.byteLength}set(t,r){return this}append(t){return this.set(this.length,t)}reserve(t){if(t>0){this.length+=t;let r=this.stride,n=this.length*r,i=this.buffer.length;n>=i&&this._resize(i===0?CA(n*1,this.BYTES_PER_ELEMENT):CA(n*2,this.BYTES_PER_ELEMENT))}return this}flush(t=this.length){t=CA(t*this.stride,this.BYTES_PER_ELEMENT);let r=yX(this.buffer,t);return this.clear(),r}clear(){return this.length=0,this._resize(0),this}_resize(t){return this.buffer=md(new this.ArrayType(t),this.buffer)}};rl.prototype.offset=0;var qa=class extends rl{last(){return this.get(this.length-1)}get(t){return this.buffer[t]}set(t,r){return this.reserve(t-this.length+1),this.buffer[t*this.stride]=r,this}},Id=class extends qa{constructor(t=new Uint8Array(0)){super(t,1/8),this.numValid=0}get numInvalid(){return this.length-this.numValid}get(t){return this.buffer[t>>3]>>t%8&1}set(t,r){let{buffer:n}=this.reserve(t-this.length+1),i=t>>3,o=t%8,s=n[i]>>o&1;return r?s===0&&(n[i]|=1<<o,++this.numValid):s===1&&(n[i]&=~(1<<o),--this.numValid),this}clear(){return this.numValid=0,super.clear()}},Td=class extends qa{constructor(t=new Int32Array(1)){super(t,1)}append(t){return this.set(this.length-1,t)}set(t,r){let n=this.length-1,i=this.reserve(t-n+1).buffer;return n<t++&&i.fill(i[n],n,t),i[t]=i[t-1]+r,this}flush(t=this.length-1){return t>this.length&&this.set(t-1,0),super.flush(t+1)}};var Ve=class{static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t){throw new Error('"throughDOM" not available in this environment')}constructor({type:t,nullValues:r}){this.length=0,this.finished=!1,this.type=t,this.children=[],this.nullValues=r,this.stride=Bi(t),this._nulls=new Id,r&&r.length>0&&(this._isValid=o6(r))}toVector(){return new se([this.flush()])}get ArrayType(){return this.type.ArrayType}get nullCount(){return this._nulls.numInvalid}get numChildren(){return this.children.length}get byteLength(){let t=0,{_offsets:r,_values:n,_nulls:i,_typeIds:o,children:s}=this;return r&&(t+=r.byteLength),n&&(t+=n.byteLength),i&&(t+=i.byteLength),o&&(t+=o.byteLength),s.reduce((a,c)=>a+c.byteLength,t)}get reservedLength(){return this._nulls.reservedLength}get reservedByteLength(){let t=0;return this._offsets&&(t+=this._offsets.reservedByteLength),this._values&&(t+=this._values.reservedByteLength),this._nulls&&(t+=this._nulls.reservedByteLength),this._typeIds&&(t+=this._typeIds.reservedByteLength),this.children.reduce((r,n)=>r+n.reservedByteLength,t)}get valueOffsets(){return this._offsets?this._offsets.buffer:null}get values(){return this._values?this._values.buffer:null}get nullBitmap(){return this._nulls?this._nulls.buffer:null}get typeIds(){return this._typeIds?this._typeIds.buffer:null}append(t){return this.set(this.length,t)}isValid(t){return this._isValid(t)}set(t,r){return this.setValid(t,this.isValid(r))&&this.setValue(t,r),this}setValue(t,r){this._setValue(this,t,r)}setValid(t,r){return this.length=this._nulls.set(t,+r).length,r}addChild(t,r=`${this.numChildren}`){throw new Error(`Cannot append children to non-nested type "${this.type}"`)}getChildAt(t){return this.children[t]||null}flush(){let t,r,n,i,{type:o,length:s,nullCount:a,_typeIds:c,_offsets:l,_values:u,_nulls:f}=this;(r=c?.flush(s))?i=l?.flush(s):(i=l?.flush(s))?t=u?.flush(l.last()):t=u?.flush(s),a>0&&(n=f?.flush(s));let d=this.children.map(h=>h.flush());return this.clear(),$t({type:o,length:s,nullCount:a,children:d,child:d[0],data:t,typeIds:r,nullBitmap:n,valueOffsets:i})}finish(){this.finished=!0;for(let t of this.children)t.finish();return this}clear(){var t,r,n,i;this.length=0,(t=this._nulls)===null||t===void 0||t.clear(),(r=this._values)===null||r===void 0||r.clear(),(n=this._offsets)===null||n===void 0||n.clear(),(i=this._typeIds)===null||i===void 0||i.clear();for(let o of this.children)o.clear();return this}};Ve.prototype.length=1;Ve.prototype.stride=1;Ve.prototype.children=null;Ve.prototype.finished=!1;Ve.prototype.nullValues=null;Ve.prototype._isValid=()=>!0;var Pr=class extends Ve{constructor(t){super(t),this._values=new qa(new this.ArrayType(0),this.stride)}setValue(t,r){let n=this._values;return n.reserve(t-n.length+1),super.setValue(t,r)}},Ls=class extends Ve{constructor(t){super(t),this._pendingLength=0,this._offsets=new Td}setValue(t,r){let n=this._pending||(this._pending=new Map),i=n.get(t);i&&(this._pendingLength-=i.length),this._pendingLength+=r instanceof Ns?r[lo].length:r.length,n.set(t,r)}setValid(t,r){return super.setValid(t,r)?!0:((this._pending||(this._pending=new Map)).set(t,void 0),!1)}clear(){return this._pendingLength=0,this._pending=void 0,super.clear()}flush(){return this._flush(),super.flush()}finish(){return this._flush(),super.finish()}_flush(){let t=this._pending,r=this._pendingLength;return this._pendingLength=0,this._pending=void 0,t&&t.size>0&&this._flushPending(t,r),this}};var Du=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock(t,r,n,i){return t.prep(8,24),t.writeInt64(BigInt(i??0)),t.pad(4),t.writeInt32(n),t.writeInt64(BigInt(r??0)),t.offset()}};var Rs=new Int32Array(2),Zx=new Float32Array(Rs.buffer),Kx=new Float64Array(Rs.buffer),Ad=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;var Em;(function(e){e[e.UTF8_BYTES=1]="UTF8_BYTES",e[e.UTF16_STRING=2]="UTF16_STRING"})(Em||(Em={}));var Fi=class e{constructor(t){this.bytes_=t,this.position_=0,this.text_decoder_=new TextDecoder}static allocate(t){return new e(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return BigInt.asIntN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readUint64(t){return BigInt.asUintN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readFloat32(t){return Rs[0]=this.readInt32(t),Zx[0]}readFloat64(t){return Rs[Ad?0:1]=this.readInt32(t),Rs[Ad?1:0]=this.readInt32(t+4),Kx[0]}writeInt8(t,r){this.bytes_[t]=r}writeUint8(t,r){this.bytes_[t]=r}writeInt16(t,r){this.bytes_[t]=r,this.bytes_[t+1]=r>>8}writeUint16(t,r){this.bytes_[t]=r,this.bytes_[t+1]=r>>8}writeInt32(t,r){this.bytes_[t]=r,this.bytes_[t+1]=r>>8,this.bytes_[t+2]=r>>16,this.bytes_[t+3]=r>>24}writeUint32(t,r){this.bytes_[t]=r,this.bytes_[t+1]=r>>8,this.bytes_[t+2]=r>>16,this.bytes_[t+3]=r>>24}writeInt64(t,r){this.writeInt32(t,Number(BigInt.asIntN(32,r))),this.writeInt32(t+4,Number(BigInt.asIntN(32,r>>BigInt(32))))}writeUint64(t,r){this.writeUint32(t,Number(BigInt.asUintN(32,r))),this.writeUint32(t+4,Number(BigInt.asUintN(32,r>>BigInt(32))))}writeFloat32(t,r){Zx[0]=r,this.writeInt32(t,Rs[0])}writeFloat64(t,r){Kx[0]=r,this.writeInt32(t,Rs[Ad?0:1]),this.writeInt32(t+4,Rs[Ad?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+4+4)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let r=0;r<4;r++)t+=String.fromCharCode(this.readInt8(this.position_+4+r));return t}__offset(t,r){let n=t-this.readInt32(t);return r<this.readInt16(n)?this.readInt16(n+r):0}__union(t,r){return t.bb_pos=r+this.readInt32(r),t.bb=this,t}__string(t,r){t+=this.readInt32(t);let n=this.readInt32(t);t+=4;let i=this.bytes_.subarray(t,t+n);return r===Em.UTF8_BYTES?i:this.text_decoder_.decode(i)}__union_with_string(t,r){return typeof t=="string"?this.__string(r):this.__union(t,r)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+4}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(t.length!=4)throw new Error("FlatBuffers: file identifier must be length "+4);for(let r=0;r<4;r++)if(t.charCodeAt(r)!=this.readInt8(this.position()+4+r))return!1;return!0}createScalarList(t,r){let n=[];for(let i=0;i<r;++i){let o=t(i);o!==null&&n.push(o)}return n}createObjList(t,r){let n=[];for(let i=0;i<r;++i){let o=t(i);o!==null&&n.push(o.unpack())}return n}};var Lu=class e{constructor(t){this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null,this.text_encoder=new TextEncoder;let r;t?r=t:r=1024,this.bb=Fi.allocate(r),this.space=r}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(t){this.force_defaults=t}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(t,r){t>this.minalign&&(this.minalign=t);let n=~(this.bb.capacity()-this.space+r)+1&t-1;for(;this.space<n+t+r;){let i=this.bb.capacity();this.bb=e.growByteBuffer(this.bb),this.space+=this.bb.capacity()-i}this.pad(n)}pad(t){for(let r=0;r<t;r++)this.bb.writeInt8(--this.space,0)}writeInt8(t){this.bb.writeInt8(this.space-=1,t)}writeInt16(t){this.bb.writeInt16(this.space-=2,t)}writeInt32(t){this.bb.writeInt32(this.space-=4,t)}writeInt64(t){this.bb.writeInt64(this.space-=8,t)}writeFloat32(t){this.bb.writeFloat32(this.space-=4,t)}writeFloat64(t){this.bb.writeFloat64(this.space-=8,t)}addInt8(t){this.prep(1,0),this.writeInt8(t)}addInt16(t){this.prep(2,0),this.writeInt16(t)}addInt32(t){this.prep(4,0),this.writeInt32(t)}addInt64(t){this.prep(8,0),this.writeInt64(t)}addFloat32(t){this.prep(4,0),this.writeFloat32(t)}addFloat64(t){this.prep(8,0),this.writeFloat64(t)}addFieldInt8(t,r,n){(this.force_defaults||r!=n)&&(this.addInt8(r),this.slot(t))}addFieldInt16(t,r,n){(this.force_defaults||r!=n)&&(this.addInt16(r),this.slot(t))}addFieldInt32(t,r,n){(this.force_defaults||r!=n)&&(this.addInt32(r),this.slot(t))}addFieldInt64(t,r,n){(this.force_defaults||r!==n)&&(this.addInt64(r),this.slot(t))}addFieldFloat32(t,r,n){(this.force_defaults||r!=n)&&(this.addFloat32(r),this.slot(t))}addFieldFloat64(t,r,n){(this.force_defaults||r!=n)&&(this.addFloat64(r),this.slot(t))}addFieldOffset(t,r,n){(this.force_defaults||r!=n)&&(this.addOffset(r),this.slot(t))}addFieldStruct(t,r,n){r!=n&&(this.nested(r),this.slot(t))}nested(t){if(t!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")}slot(t){this.vtable!==null&&(this.vtable[t]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(t){let r=t.capacity();if(r&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");let n=r<<1,i=Fi.allocate(n);return i.setPosition(n-r),i.bytes().set(t.bytes(),n-r),i}addOffset(t){this.prep(4,0),this.writeInt32(this.offset()-t+4)}startObject(t){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=t;for(let r=0;r<t;r++)this.vtable[r]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);let t=this.offset(),r=this.vtable_in_use-1;for(;r>=0&&this.vtable[r]==0;r--);let n=r+1;for(;r>=0;r--)this.addInt16(this.vtable[r]!=0?t-this.vtable[r]:0);let i=2;this.addInt16(t-this.object_start);let o=(n+i)*2;this.addInt16(o);let s=0,a=this.space;t:for(r=0;r<this.vtables.length;r++){let c=this.bb.capacity()-this.vtables[r];if(o==this.bb.readInt16(c)){for(let l=2;l<o;l+=2)if(this.bb.readInt16(a+l)!=this.bb.readInt16(c+l))continue t;s=this.vtables[r];break}}return s?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,s-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t}finish(t,r,n){let i=n?4:0;if(r){let o=r;if(this.prep(this.minalign,4+4+i),o.length!=4)throw new Error("FlatBuffers: file identifier must be length "+4);for(let s=4-1;s>=0;s--)this.writeInt8(o.charCodeAt(s))}this.prep(this.minalign,4+i),this.addOffset(t),i&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(t,r){this.finish(t,r,!0)}requiredField(t,r){let n=this.bb.capacity()-t,i=n-this.bb.readInt32(n);if(!(r<this.bb.readInt16(i)&&this.bb.readInt16(i+r)!=0))throw new Error("FlatBuffers: field "+r+" must be set")}startVector(t,r,n){this.notNested(),this.vector_num_elems=r,this.prep(4,t*r),this.prep(n,t*r)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(t){if(!t)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(t))return this.string_maps.get(t);let r=this.createString(t);return this.string_maps.set(t,r),r}createString(t){if(t==null)return 0;let r;t instanceof Uint8Array?r=t:r=this.text_encoder.encode(t),this.addInt8(0),this.startVector(1,r.length,1),this.bb.setPosition(this.space-=r.length);for(let n=0,i=this.space,o=this.bb.bytes();n<r.length;n++)o[i++]=r[n];return this.endVector()}createObjectOffset(t){return t===null?0:typeof t=="string"?this.createString(t):t.pack(this)}createObjectOffsetList(t){let r=[];for(let n=0;n<t.length;++n){let i=t[n];if(i!==null)r.push(this.createObjectOffset(i));else throw new Error("FlatBuffers: Argument for createObjectOffsetList cannot contain null.")}return r}createStructOffsetList(t,r){return r(this,t.length),this.createObjectOffsetList(t.slice().reverse()),this.endVector()}};var Dr=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsKeyValue(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsKeyValue(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}key(t){let r=this.bb.__offset(this.bb_pos,4);return r?this.bb.__string(this.bb_pos+r,t):null}value(t){let r=this.bb.__offset(this.bb_pos,6);return r?this.bb.__string(this.bb_pos+r,t):null}static startKeyValue(t){t.startObject(2)}static addKey(t,r){t.addFieldOffset(0,r,0)}static addValue(t,r){t.addFieldOffset(1,r,0)}static endKeyValue(t){return t.endObject()}static createKeyValue(t,r,n){return e.startKeyValue(t),e.addKey(t,r),e.addValue(t,n),e.endKeyValue(t)}};var nl;(function(e){e[e.V1=0]="V1",e[e.V2=1]="V2",e[e.V3=2]="V3",e[e.V4=3]="V4",e[e.V5=4]="V5"})(nl||(nl={}));var il;(function(e){e[e.Little=0]="Little",e[e.Big=1]="Big"})(il||(il={}));var Bm;(function(e){e[e.DenseArray=0]="DenseArray"})(Bm||(Bm={}));var Xo=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsInt(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInt(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}bitWidth(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}isSigned(){let t=this.bb.__offset(this.bb_pos,6);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startInt(t){t.startObject(2)}static addBitWidth(t,r){t.addFieldInt32(0,r,0)}static addIsSigned(t,r){t.addFieldInt8(1,+r,0)}static endInt(t){return t.endObject()}static createInt(t,r,n){return e.startInt(t),e.addBitWidth(t,r),e.addIsSigned(t,n),e.endInt(t)}};var ks=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsDictionaryEncoding(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryEncoding(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}id(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):BigInt("0")}indexType(t){let r=this.bb.__offset(this.bb_pos,6);return r?(t||new Xo).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}isOrdered(){let t=this.bb.__offset(this.bb_pos,8);return t?!!this.bb.readInt8(this.bb_pos+t):!1}dictionaryKind(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt16(this.bb_pos+t):Bm.DenseArray}static startDictionaryEncoding(t){t.startObject(4)}static addId(t,r){t.addFieldInt64(0,r,BigInt("0"))}static addIndexType(t,r){t.addFieldOffset(1,r,0)}static addIsOrdered(t,r){t.addFieldInt8(2,+r,0)}static addDictionaryKind(t,r){t.addFieldInt16(3,r,Bm.DenseArray)}static endDictionaryEncoding(t){return t.endObject()}};var Om=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsBinary(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBinary(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static startBinary(t){t.startObject(0)}static endBinary(t){return t.endObject()}static createBinary(t){return e.startBinary(t),e.endBinary(t)}};var Fm=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsBool(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBool(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static startBool(t){t.startObject(0)}static endBool(t){return t.endObject()}static createBool(t){return e.startBool(t),e.endBool(t)}};var Nm;(function(e){e[e.DAY=0]="DAY",e[e.MILLISECOND=1]="MILLISECOND"})(Nm||(Nm={}));var ol=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsDate(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDate(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Nm.MILLISECOND}static startDate(t){t.startObject(1)}static addUnit(t,r){t.addFieldInt16(0,r,Nm.MILLISECOND)}static endDate(t){return t.endObject()}static createDate(t,r){return e.startDate(t),e.addUnit(t,r),e.endDate(t)}};var Cs=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsDecimal(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDecimal(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}precision(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}scale(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):0}bitWidth(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt32(this.bb_pos+t):128}static startDecimal(t){t.startObject(3)}static addPrecision(t,r){t.addFieldInt32(0,r,0)}static addScale(t,r){t.addFieldInt32(1,r,0)}static addBitWidth(t,r){t.addFieldInt32(2,r,128)}static endDecimal(t){return t.endObject()}static createDecimal(t,r,n,i){return e.startDecimal(t),e.addPrecision(t,r),e.addScale(t,n),e.addBitWidth(t,i),e.endDecimal(t)}};var sl;(function(e){e[e.SECOND=0]="SECOND",e[e.MILLISECOND=1]="MILLISECOND",e[e.MICROSECOND=2]="MICROSECOND",e[e.NANOSECOND=3]="NANOSECOND"})(sl||(sl={}));var al=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsFixedSizeBinary(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeBinary(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}byteWidth(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeBinary(t){t.startObject(1)}static addByteWidth(t,r){t.addFieldInt32(0,r,0)}static endFixedSizeBinary(t){return t.endObject()}static createFixedSizeBinary(t,r){return e.startFixedSizeBinary(t),e.addByteWidth(t,r),e.endFixedSizeBinary(t)}};var cl=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsFixedSizeList(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeList(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}listSize(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeList(t){t.startObject(1)}static addListSize(t,r){t.addFieldInt32(0,r,0)}static endFixedSizeList(t){return t.endObject()}static createFixedSizeList(t,r){return e.startFixedSizeList(t),e.addListSize(t,r),e.endFixedSizeList(t)}};var Dm;(function(e){e[e.HALF=0]="HALF",e[e.SINGLE=1]="SINGLE",e[e.DOUBLE=2]="DOUBLE"})(Dm||(Dm={}));var ll=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsFloatingPoint(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFloatingPoint(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}precision(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Dm.HALF}static startFloatingPoint(t){t.startObject(1)}static addPrecision(t,r){t.addFieldInt16(0,r,Dm.HALF)}static endFloatingPoint(t){return t.endObject()}static createFloatingPoint(t,r){return e.startFloatingPoint(t),e.addPrecision(t,r),e.endFloatingPoint(t)}};var Lm;(function(e){e[e.YEAR_MONTH=0]="YEAR_MONTH",e[e.DAY_TIME=1]="DAY_TIME",e[e.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(Lm||(Lm={}));var ul=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsInterval(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInterval(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Lm.YEAR_MONTH}static startInterval(t){t.startObject(1)}static addUnit(t,r){t.addFieldInt16(0,r,Lm.YEAR_MONTH)}static endInterval(t){return t.endObject()}static createInterval(t,r){return e.startInterval(t),e.addUnit(t,r),e.endInterval(t)}};var Rm=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsList(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsList(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static startList(t){t.startObject(0)}static endList(t){return t.endObject()}static createList(t){return e.startList(t),e.endList(t)}};var fl=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsMap(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMap(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}keysSorted(){let t=this.bb.__offset(this.bb_pos,4);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startMap(t){t.startObject(1)}static addKeysSorted(t,r){t.addFieldInt8(0,+r,0)}static endMap(t){return t.endObject()}static createMap(t,r){return e.startMap(t),e.addKeysSorted(t,r),e.endMap(t)}};var km=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsNull(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsNull(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static startNull(t){t.startObject(0)}static endNull(t){return t.endObject()}static createNull(t){return e.startNull(t),e.endNull(t)}};var Cm=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsStruct_(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsStruct_(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static startStruct_(t){t.startObject(0)}static endStruct_(t){return t.endObject()}static createStruct_(t){return e.startStruct_(t),e.endStruct_(t)}};var Ya=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsTime(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTime(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):sl.MILLISECOND}bitWidth(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):32}static startTime(t){t.startObject(2)}static addUnit(t,r){t.addFieldInt16(0,r,sl.MILLISECOND)}static addBitWidth(t,r){t.addFieldInt32(1,r,32)}static endTime(t){return t.endObject()}static createTime(t,r,n){return e.startTime(t),e.addUnit(t,r),e.addBitWidth(t,n),e.endTime(t)}};var Wa=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsTimestamp(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTimestamp(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):sl.SECOND}timezone(t){let r=this.bb.__offset(this.bb_pos,6);return r?this.bb.__string(this.bb_pos+r,t):null}static startTimestamp(t){t.startObject(2)}static addUnit(t,r){t.addFieldInt16(0,r,sl.SECOND)}static addTimezone(t,r){t.addFieldOffset(1,r,0)}static endTimestamp(t){return t.endObject()}static createTimestamp(t,r,n){return e.startTimestamp(t),e.addUnit(t,r),e.addTimezone(t,n),e.endTimestamp(t)}};var Um;(function(e){e[e.Sparse=0]="Sparse",e[e.Dense=1]="Dense"})(Um||(Um={}));var Ho=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsUnion(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUnion(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}mode(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Um.Sparse}typeIds(t){let r=this.bb.__offset(this.bb_pos,6);return r?this.bb.readInt32(this.bb.__vector(this.bb_pos+r)+t*4):0}typeIdsLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}typeIdsArray(){let t=this.bb.__offset(this.bb_pos,6);return t?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startUnion(t){t.startObject(2)}static addMode(t,r){t.addFieldInt16(0,r,Um.Sparse)}static addTypeIds(t,r){t.addFieldOffset(1,r,0)}static createTypeIdsVector(t,r){t.startVector(4,r.length,4);for(let n=r.length-1;n>=0;n--)t.addInt32(r[n]);return t.endVector()}static startTypeIdsVector(t,r){t.startVector(4,r,4)}static endUnion(t){return t.endObject()}static createUnion(t,r,n){return e.startUnion(t),e.addMode(t,r),e.addTypeIds(t,n),e.endUnion(t)}};var Pm=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsUtf8(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUtf8(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static startUtf8(t){t.startObject(0)}static endUtf8(t){return t.endObject()}static createUtf8(t){return e.startUtf8(t),e.endUtf8(t)}};var je;(function(e){e[e.NONE=0]="NONE",e[e.Null=1]="Null",e[e.Int=2]="Int",e[e.FloatingPoint=3]="FloatingPoint",e[e.Binary=4]="Binary",e[e.Utf8=5]="Utf8",e[e.Bool=6]="Bool",e[e.Decimal=7]="Decimal",e[e.Date=8]="Date",e[e.Time=9]="Time",e[e.Timestamp=10]="Timestamp",e[e.Interval=11]="Interval",e[e.List=12]="List",e[e.Struct_=13]="Struct_",e[e.Union=14]="Union",e[e.FixedSizeBinary=15]="FixedSizeBinary",e[e.FixedSizeList=16]="FixedSizeList",e[e.Map=17]="Map",e[e.Duration=18]="Duration",e[e.LargeBinary=19]="LargeBinary",e[e.LargeUtf8=20]="LargeUtf8",e[e.LargeList=21]="LargeList",e[e.RunEndEncoded=22]="RunEndEncoded"})(je||(je={}));var wn=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsField(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsField(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}name(t){let r=this.bb.__offset(this.bb_pos,4);return r?this.bb.__string(this.bb_pos+r,t):null}nullable(){let t=this.bb.__offset(this.bb_pos,6);return t?!!this.bb.readInt8(this.bb_pos+t):!1}typeType(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint8(this.bb_pos+t):je.NONE}type(t){let r=this.bb.__offset(this.bb_pos,10);return r?this.bb.__union(t,this.bb_pos+r):null}dictionary(t){let r=this.bb.__offset(this.bb_pos,12);return r?(t||new ks).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}children(t,r){let n=this.bb.__offset(this.bb_pos,14);return n?(r||new e).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}childrenLength(){let t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,r){let n=this.bb.__offset(this.bb_pos,16);return n?(r||new Dr).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}customMetadataLength(){let t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}static startField(t){t.startObject(7)}static addName(t,r){t.addFieldOffset(0,r,0)}static addNullable(t,r){t.addFieldInt8(1,+r,0)}static addTypeType(t,r){t.addFieldInt8(2,r,je.NONE)}static addType(t,r){t.addFieldOffset(3,r,0)}static addDictionary(t,r){t.addFieldOffset(4,r,0)}static addChildren(t,r){t.addFieldOffset(5,r,0)}static createChildrenVector(t,r){t.startVector(4,r.length,4);for(let n=r.length-1;n>=0;n--)t.addOffset(r[n]);return t.endVector()}static startChildrenVector(t,r){t.startVector(4,r,4)}static addCustomMetadata(t,r){t.addFieldOffset(6,r,0)}static createCustomMetadataVector(t,r){t.startVector(4,r.length,4);for(let n=r.length-1;n>=0;n--)t.addOffset(r[n]);return t.endVector()}static startCustomMetadataVector(t,r){t.startVector(4,r,4)}static endField(t){return t.endObject()}};var oi=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsSchema(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsSchema(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}endianness(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):il.Little}fields(t,r){let n=this.bb.__offset(this.bb_pos,6);return n?(r||new wn).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}fieldsLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,r){let n=this.bb.__offset(this.bb_pos,8);return n?(r||new Dr).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}customMetadataLength(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}features(t){let r=this.bb.__offset(this.bb_pos,10);return r?this.bb.readInt64(this.bb.__vector(this.bb_pos+r)+t*8):BigInt(0)}featuresLength(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}static startSchema(t){t.startObject(4)}static addEndianness(t,r){t.addFieldInt16(0,r,il.Little)}static addFields(t,r){t.addFieldOffset(1,r,0)}static createFieldsVector(t,r){t.startVector(4,r.length,4);for(let n=r.length-1;n>=0;n--)t.addOffset(r[n]);return t.endVector()}static startFieldsVector(t,r){t.startVector(4,r,4)}static addCustomMetadata(t,r){t.addFieldOffset(2,r,0)}static createCustomMetadataVector(t,r){t.startVector(4,r.length,4);for(let n=r.length-1;n>=0;n--)t.addOffset(r[n]);return t.endVector()}static startCustomMetadataVector(t,r){t.startVector(4,r,4)}static addFeatures(t,r){t.addFieldOffset(3,r,0)}static createFeaturesVector(t,r){t.startVector(8,r.length,8);for(let n=r.length-1;n>=0;n--)t.addInt64(r[n]);return t.endVector()}static startFeaturesVector(t,r){t.startVector(8,r,8)}static endSchema(t){return t.endObject()}static finishSchemaBuffer(t,r){t.finish(r)}static finishSizePrefixedSchemaBuffer(t,r){t.finish(r,void 0,!0)}static createSchema(t,r,n,i,o){return e.startSchema(t),e.addEndianness(t,r),e.addFields(t,n),e.addCustomMetadata(t,i),e.addFeatures(t,o),e.endSchema(t)}};var Ni=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsFooter(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFooter(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}version(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):nl.V1}schema(t){let r=this.bb.__offset(this.bb_pos,6);return r?(t||new oi).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}dictionaries(t,r){let n=this.bb.__offset(this.bb_pos,8);return n?(r||new Du).__init(this.bb.__vector(this.bb_pos+n)+t*24,this.bb):null}dictionariesLength(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}recordBatches(t,r){let n=this.bb.__offset(this.bb_pos,10);return n?(r||new Du).__init(this.bb.__vector(this.bb_pos+n)+t*24,this.bb):null}recordBatchesLength(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,r){let n=this.bb.__offset(this.bb_pos,12);return n?(r||new Dr).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}customMetadataLength(){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startFooter(t){t.startObject(5)}static addVersion(t,r){t.addFieldInt16(0,r,nl.V1)}static addSchema(t,r){t.addFieldOffset(1,r,0)}static addDictionaries(t,r){t.addFieldOffset(2,r,0)}static startDictionariesVector(t,r){t.startVector(24,r,8)}static addRecordBatches(t,r){t.addFieldOffset(3,r,0)}static startRecordBatchesVector(t,r){t.startVector(24,r,8)}static addCustomMetadata(t,r){t.addFieldOffset(4,r,0)}static createCustomMetadataVector(t,r){t.startVector(4,r.length,4);for(let n=r.length-1;n>=0;n--)t.addOffset(r[n]);return t.endVector()}static startCustomMetadataVector(t,r){t.startVector(4,r,4)}static endFooter(t){return t.endObject()}static finishFooterBuffer(t,r){t.finish(r)}static finishSizePrefixedFooterBuffer(t,r){t.finish(r,void 0,!0)}};var we=class e{constructor(t=[],r,n){this.fields=t||[],this.metadata=r||new Map,n||(n=UA(t)),this.dictionaries=n}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map(t=>t.name)}toString(){return`Schema<{ ${this.fields.map((t,r)=>`${r}: ${t}`).join(", ")} }>`}select(t){let r=new Set(t),n=this.fields.filter(i=>r.has(i.name));return new e(n,this.metadata)}selectAt(t){let r=t.map(n=>this.fields[n]).filter(Boolean);return new e(r,this.metadata)}assign(...t){let r=t[0]instanceof e?t[0]:Array.isArray(t[0])?new e(t[0]):new e(t),n=[...this.fields],i=Jx(Jx(new Map,this.metadata),r.metadata),o=r.fields.filter(a=>{let c=n.findIndex(l=>l.name===a.name);return~c?(n[c]=a.clone({metadata:Jx(Jx(new Map,n[c].metadata),a.metadata)}))&&!1:!0}),s=UA(o,new Map);return new e([...n,...o],i,new Map([...this.dictionaries,...s]))}};we.prototype.fields=null;we.prototype.metadata=null;we.prototype.dictionaries=null;var Qt=class e{static new(...t){let[r,n,i,o]=t;return t[0]&&typeof t[0]=="object"&&({name:r}=t[0],n===void 0&&(n=t[0].type),i===void 0&&(i=t[0].nullable),o===void 0&&(o=t[0].metadata)),new e(`${r}`,n,i,o)}constructor(t,r,n=!1,i){this.name=t,this.type=r,this.nullable=n,this.metadata=i||new Map}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...t){let[r,n,i,o]=t;return!t[0]||typeof t[0]!="object"?[r=this.name,n=this.type,i=this.nullable,o=this.metadata]=t:{name:r=this.name,type:n=this.type,nullable:i=this.nullable,metadata:o=this.metadata}=t[0],e.new(r,n,i,o)}};Qt.prototype.type=null;Qt.prototype.name=null;Qt.prototype.nullable=null;Qt.prototype.metadata=null;function Jx(e,t){return new Map([...e||new Map,...t||new Map])}function UA(e,t=new Map){for(let r=-1,n=e.length;++r<n;){let o=e[r].type;if(pt.isDictionary(o)){if(!t.has(o.id))t.set(o.id,o.dictionary);else if(t.get(o.id)!==o.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}o.children&&o.children.length>0&&UA(o.children,t)}return t}var gX=Lu,bX=Fi,Ga=class{static decode(t){t=new bX(Rt(t));let r=Ni.getRootAsFooter(t),n=we.decode(r.schema());return new PA(n,r)}static encode(t){let r=new gX,n=we.encode(r,t.schema);Ni.startRecordBatchesVector(r,t.numRecordBatches);for(let s of[...t.recordBatches()].slice().reverse())Xa.encode(r,s);let i=r.endVector();Ni.startDictionariesVector(r,t.numDictionaries);for(let s of[...t.dictionaryBatches()].slice().reverse())Xa.encode(r,s);let o=r.endVector();return Ni.startFooter(r),Ni.addSchema(r,n),Ni.addVersion(r,tn.V4),Ni.addRecordBatches(r,i),Ni.addDictionaries(r,o),Ni.finishFooterBuffer(r,Ni.endFooter(r)),r.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}constructor(t,r=tn.V4,n,i){this.schema=t,this.version=r,n&&(this._recordBatches=n),i&&(this._dictionaryBatches=i)}*recordBatches(){for(let t,r=-1,n=this.numRecordBatches;++r<n;)(t=this.getRecordBatch(r))&&(yield t)}*dictionaryBatches(){for(let t,r=-1,n=this.numDictionaries;++r<n;)(t=this.getDictionaryBatch(r))&&(yield t)}getRecordBatch(t){return t>=0&&t<this.numRecordBatches&&this._recordBatches[t]||null}getDictionaryBatch(t){return t>=0&&t<this.numDictionaries&&this._dictionaryBatches[t]||null}};var PA=class extends Ga{get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}constructor(t,r){super(t,r.version()),this._footer=r}getRecordBatch(t){if(t>=0&&t<this.numRecordBatches){let r=this._footer.recordBatches(t);if(r)return Xa.decode(r)}return null}getDictionaryBatch(t){if(t>=0&&t<this.numDictionaries){let r=this._footer.dictionaries(t);if(r)return Xa.decode(r)}return null}},Xa=class e{static decode(t){return new e(t.metaDataLength(),t.bodyLength(),t.offset())}static encode(t,r){let{metaDataLength:n}=r,i=BigInt(r.offset),o=BigInt(r.bodyLength);return Du.createBlock(t,i,n,o)}constructor(t,r,n){this.metaDataLength=t,this.offset=ni(n),this.bodyLength=ni(r)}};var Ue=Object.freeze({done:!0,value:void 0}),$m=class{constructor(t){this._json=t}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}},Ru=class{tee(){return this._getDOMStream().tee()}pipe(t,r){return this._getNodeStream().pipe(t,r)}pipeTo(t,r){return this._getDOMStream().pipeTo(t,r)}pipeThrough(t,r){return this._getDOMStream().pipeThrough(t,r)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}},t_=class extends Ru{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise(t=>this._closedPromiseResolve=t)}get closed(){return this._closedPromise}cancel(t){return P(this,void 0,void 0,function*(){yield this.return(t)})}write(t){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(t):this.resolvers.shift().resolve({done:!1,value:t}))}abort(t){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:t}:this.resolvers.shift().reject({done:!0,value:t}))}close(){if(this._closedPromiseResolve){let{resolvers:t}=this;for(;t.length>0;)t.shift().resolve(Ue);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(t){return Jr.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,t)}toNodeStream(t){return Jr.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,t)}throw(t){return P(this,void 0,void 0,function*(){return yield this.abort(t),Ue})}return(t){return P(this,void 0,void 0,function*(){return yield this.close(),Ue})}read(t){return P(this,void 0,void 0,function*(){return(yield this.next(t,"read")).value})}peek(t){return P(this,void 0,void 0,function*(){return(yield this.next(t,"peek")).value})}next(...t){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise((r,n)=>{this.resolvers.push({resolve:r,reject:n})}):Promise.resolve(Ue)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error("AsyncQueue is closed")}};var Us=class extends t_{write(t){if((t=Rt(t)).byteLength>0)return super.write(t)}toString(t=!1){return t?gm(this.toUint8Array(!0)):this.toUint8Array(!1).then(gm)}toUint8Array(t=!1){return t?Mi(this._values)[0]:(()=>P(this,void 0,void 0,function*(){var r,n,i,o;let s=[],a=0;try{for(var c=!0,l=or(this),u;u=yield l.next(),r=u.done,!r;){o=u.value,c=!1;try{let f=o;s.push(f),a+=f.byteLength}finally{c=!0}}}catch(f){n={error:f}}finally{try{!c&&!r&&(i=l.return)&&(yield i.call(l))}finally{if(n)throw n.error}}return Mi(s,a)[0]}))()}},Ps=class{constructor(t){t&&(this.source=new $A(Jr.fromIterable(t)))}[Symbol.iterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}},fo=class e{constructor(t){t instanceof e?this.source=t.source:t instanceof Us?this.source=new Ha(Jr.fromAsyncIterable(t)):yx(t)?this.source=new Ha(Jr.fromNodeStream(t)):bm(t)?this.source=new Ha(Jr.fromDOMStream(t)):px(t)?this.source=new Ha(Jr.fromDOMStream(t.body)):Co(t)?this.source=new Ha(Jr.fromIterable(t)):Ai(t)?this.source=new Ha(Jr.fromAsyncIterable(t)):co(t)&&(this.source=new Ha(Jr.fromAsyncIterable(t)))}[Symbol.asyncIterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}get closed(){return this.source.closed}cancel(t){return this.source.cancel(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}},$A=class{constructor(t){this.source=t}cancel(t){this.return(t)}peek(t){return this.next(t,"peek").value}read(t){return this.next(t,"read").value}next(t,r="read"){return this.source.next({cmd:r,size:t})}throw(t){return Object.create(this.source.throw&&this.source.throw(t)||Ue)}return(t){return Object.create(this.source.return&&this.source.return(t)||Ue)}},Ha=class{constructor(t){this.source=t,this._closedPromise=new Promise(r=>this._closedPromiseResolve=r)}cancel(t){return P(this,void 0,void 0,function*(){yield this.return(t)})}get closed(){return this._closedPromise}read(t){return P(this,void 0,void 0,function*(){return(yield this.next(t,"read")).value})}peek(t){return P(this,void 0,void 0,function*(){return(yield this.next(t,"peek")).value})}next(t,r="read"){return P(this,void 0,void 0,function*(){return yield this.source.next({cmd:r,size:t})})}throw(t){return P(this,void 0,void 0,function*(){let r=this.source.throw&&(yield this.source.throw(t))||Ue;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(r)})}return(t){return P(this,void 0,void 0,function*(){let r=this.source.return&&(yield this.source.return(t))||Ue;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(r)})}};var zm=class extends Ps{constructor(t,r){super(),this.position=0,this.buffer=Rt(t),this.size=r===void 0?this.buffer.byteLength:r}readInt32(t){let{buffer:r,byteOffset:n}=this.readAt(t,4);return new DataView(r,n).getInt32(0,!0)}seek(t){return this.position=Math.min(t,this.size),t<this.size}read(t){let{buffer:r,size:n,position:i}=this;return r&&i<n?(typeof t!="number"&&(t=Number.POSITIVE_INFINITY),this.position=Math.min(n,i+Math.min(n-i,t)),r.subarray(i,this.position)):null}readAt(t,r){let n=this.buffer,i=Math.min(this.size,t+r);return n?n.subarray(t,i):new Uint8Array(r)}close(){this.buffer&&(this.buffer=null)}throw(t){return this.close(),{done:!0,value:t}}return(t){return this.close(),{done:!0,value:t}}},dl=class extends fo{constructor(t,r){super(),this.position=0,this._handle=t,typeof r=="number"?this.size=r:this._pending=(()=>P(this,void 0,void 0,function*(){this.size=(yield t.stat()).size,delete this._pending}))()}readInt32(t){return P(this,void 0,void 0,function*(){let{buffer:r,byteOffset:n}=yield this.readAt(t,4);return new DataView(r,n).getInt32(0,!0)})}seek(t){return P(this,void 0,void 0,function*(){return this._pending&&(yield this._pending),this.position=Math.min(t,this.size),t<this.size})}read(t){return P(this,void 0,void 0,function*(){this._pending&&(yield this._pending);let{_handle:r,size:n,position:i}=this;if(r&&i<n){typeof t!="number"&&(t=Number.POSITIVE_INFINITY);let o=i,s=0,a=0,c=Math.min(n,o+Math.min(n-o,t)),l=new Uint8Array(Math.max(0,(this.position=c)-o));for(;(o+=a)<c&&(s+=a)<l.byteLength;)({bytesRead:a}=yield r.read(l,s,l.byteLength-s,o));return l}return null})}readAt(t,r){return P(this,void 0,void 0,function*(){this._pending&&(yield this._pending);let{_handle:n,size:i}=this;if(n&&t+r<i){let o=Math.min(i,t+r),s=new Uint8Array(o-t);return(yield n.read(s,0,r,t)).buffer}return new Uint8Array(r)})}close(){return P(this,void 0,void 0,function*(){let t=this._handle;this._handle=null,t&&(yield t.close())})}throw(t){return P(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:t}})}return(t){return P(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:t}})}};var VA={};Qr(VA,{BaseInt64:()=>Vm,Int128:()=>jm,Int64:()=>Za,Uint64:()=>Je});function Md(e){return e<0&&(e=4294967295+e+1),`0x${e.toString(16)}`}var Ed=8,zA=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8],Vm=class{constructor(t){this.buffer=t}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(t){let r=new Uint32Array([this.buffer[1]>>>16,this.buffer[1]&65535,this.buffer[0]>>>16,this.buffer[0]&65535]),n=new Uint32Array([t.buffer[1]>>>16,t.buffer[1]&65535,t.buffer[0]>>>16,t.buffer[0]&65535]),i=r[3]*n[3];this.buffer[0]=i&65535;let o=i>>>16;return i=r[2]*n[3],o+=i,i=r[3]*n[2]>>>0,o+=i,this.buffer[0]+=o<<16,this.buffer[1]=o>>>0<i?65536:0,this.buffer[1]+=o>>>16,this.buffer[1]+=r[1]*n[3]+r[2]*n[2]+r[3]*n[1],this.buffer[1]+=r[0]*n[3]+r[1]*n[2]+r[2]*n[1]+r[3]*n[0]<<16,this}_plus(t){let r=this.buffer[0]+t.buffer[0]>>>0;this.buffer[1]+=t.buffer[1],r<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=r}lessThan(t){return this.buffer[1]<t.buffer[1]||this.buffer[1]===t.buffer[1]&&this.buffer[0]<t.buffer[0]}equals(t){return this.buffer[1]===t.buffer[1]&&this.buffer[0]==t.buffer[0]}greaterThan(t){return t.lessThan(this)}hex(){return`${Md(this.buffer[1])} ${Md(this.buffer[0])}`}},Je=class e extends Vm{times(t){return this._times(t),this}plus(t){return this._plus(t),this}static from(t,r=new Uint32Array(2)){return e.fromString(typeof t=="string"?t:t.toString(),r)}static fromNumber(t,r=new Uint32Array(2)){return e.fromString(t.toString(),r)}static fromString(t,r=new Uint32Array(2)){let n=t.length,i=new e(r);for(let o=0;o<n;){let s=Ed<n-o?Ed:n-o,a=new e(new Uint32Array([Number.parseInt(t.slice(o,o+s),10),0])),c=new e(new Uint32Array([zA[s],0]));i.times(c),i.plus(a),o+=s}return i}static convertArray(t){let r=new Uint32Array(t.length*2);for(let n=-1,i=t.length;++n<i;)e.from(t[n],new Uint32Array(r.buffer,r.byteOffset+2*n*4,2));return r}static multiply(t,r){return new e(new Uint32Array(t.buffer)).times(r)}static add(t,r){return new e(new Uint32Array(t.buffer)).plus(r)}},Za=class e extends Vm{negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[0]==0&&++this.buffer[1],this}times(t){return this._times(t),this}plus(t){return this._plus(t),this}lessThan(t){let r=this.buffer[1]<<0,n=t.buffer[1]<<0;return r<n||r===n&&this.buffer[0]<t.buffer[0]}static from(t,r=new Uint32Array(2)){return e.fromString(typeof t=="string"?t:t.toString(),r)}static fromNumber(t,r=new Uint32Array(2)){return e.fromString(t.toString(),r)}static fromString(t,r=new Uint32Array(2)){let n=t.startsWith("-"),i=t.length,o=new e(r);for(let s=n?1:0;s<i;){let a=Ed<i-s?Ed:i-s,c=new e(new Uint32Array([Number.parseInt(t.slice(s,s+a),10),0])),l=new e(new Uint32Array([zA[a],0]));o.times(l),o.plus(c),s+=a}return n?o.negate():o}static convertArray(t){let r=new Uint32Array(t.length*2);for(let n=-1,i=t.length;++n<i;)e.from(t[n],new Uint32Array(r.buffer,r.byteOffset+2*n*4,2));return r}static multiply(t,r){return new e(new Uint32Array(t.buffer)).times(r)}static add(t,r){return new e(new Uint32Array(t.buffer)).plus(r)}},jm=class e{constructor(t){this.buffer=t}high(){return new Za(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new Za(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],this.buffer[0]==0&&++this.buffer[1],this.buffer[1]==0&&++this.buffer[2],this.buffer[2]==0&&++this.buffer[3],this}times(t){let r=new Je(new Uint32Array([this.buffer[3],0])),n=new Je(new Uint32Array([this.buffer[2],0])),i=new Je(new Uint32Array([this.buffer[1],0])),o=new Je(new Uint32Array([this.buffer[0],0])),s=new Je(new Uint32Array([t.buffer[3],0])),a=new Je(new Uint32Array([t.buffer[2],0])),c=new Je(new Uint32Array([t.buffer[1],0])),l=new Je(new Uint32Array([t.buffer[0],0])),u=Je.multiply(o,l);this.buffer[0]=u.low();let f=new Je(new Uint32Array([u.high(),0]));return u=Je.multiply(i,l),f.plus(u),u=Je.multiply(o,c),f.plus(u),this.buffer[1]=f.low(),this.buffer[3]=f.lessThan(u)?1:0,this.buffer[2]=f.high(),new Je(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(Je.multiply(n,l)).plus(Je.multiply(i,c)).plus(Je.multiply(o,a)),this.buffer[3]+=Je.multiply(r,l).plus(Je.multiply(n,c)).plus(Je.multiply(i,a)).plus(Je.multiply(o,s)).low(),this}plus(t){let r=new Uint32Array(4);return r[3]=this.buffer[3]+t.buffer[3]>>>0,r[2]=this.buffer[2]+t.buffer[2]>>>0,r[1]=this.buffer[1]+t.buffer[1]>>>0,r[0]=this.buffer[0]+t.buffer[0]>>>0,r[0]<this.buffer[0]>>>0&&++r[1],r[1]<this.buffer[1]>>>0&&++r[2],r[2]<this.buffer[2]>>>0&&++r[3],this.buffer[3]=r[3],this.buffer[2]=r[2],this.buffer[1]=r[1],this.buffer[0]=r[0],this}hex(){return`${Md(this.buffer[3])} ${Md(this.buffer[2])} ${Md(this.buffer[1])} ${Md(this.buffer[0])}`}static multiply(t,r){return new e(new Uint32Array(t.buffer)).times(r)}static add(t,r){return new e(new Uint32Array(t.buffer)).plus(r)}static from(t,r=new Uint32Array(4)){return e.fromString(typeof t=="string"?t:t.toString(),r)}static fromNumber(t,r=new Uint32Array(4)){return e.fromString(t.toString(),r)}static fromString(t,r=new Uint32Array(4)){let n=t.startsWith("-"),i=t.length,o=new e(r);for(let s=n?1:0;s<i;){let a=Ed<i-s?Ed:i-s,c=new e(new Uint32Array([Number.parseInt(t.slice(s,s+a),10),0,0,0])),l=new e(new Uint32Array([zA[a],0,0,0]));o.times(l),o.plus(c),s+=a}return n?o.negate():o}static convertArray(t){let r=new Uint32Array(t.length*4);for(let n=-1,i=t.length;++n<i;)e.from(t[n],new Uint32Array(r.buffer,r.byteOffset+4*4*n,4));return r}};var qm=class extends _t{constructor(t,r,n,i){super(),this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=t,this.nodes=r,this.buffers=n,this.dictionaries=i}visit(t){return super.visit(t instanceof Qt?t.type:t)}visitNull(t,{length:r}=this.nextFieldNode()){return $t({type:t,length:r})}visitBool(t,{length:r,nullCount:n}=this.nextFieldNode()){return $t({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitInt(t,{length:r,nullCount:n}=this.nextFieldNode()){return $t({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitFloat(t,{length:r,nullCount:n}=this.nextFieldNode()){return $t({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitUtf8(t,{length:r,nullCount:n}=this.nextFieldNode()){return $t({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitBinary(t,{length:r,nullCount:n}=this.nextFieldNode()){return $t({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitFixedSizeBinary(t,{length:r,nullCount:n}=this.nextFieldNode()){return $t({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitDate(t,{length:r,nullCount:n}=this.nextFieldNode()){return $t({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitTimestamp(t,{length:r,nullCount:n}=this.nextFieldNode()){return $t({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitTime(t,{length:r,nullCount:n}=this.nextFieldNode()){return $t({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitDecimal(t,{length:r,nullCount:n}=this.nextFieldNode()){return $t({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitList(t,{length:r,nullCount:n}=this.nextFieldNode()){return $t({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}visitStruct(t,{length:r,nullCount:n}=this.nextFieldNode()){return $t({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),children:this.visitMany(t.children)})}visitUnion(t){return t.mode===sr.Sparse?this.visitSparseUnion(t):this.visitDenseUnion(t)}visitDenseUnion(t,{length:r,nullCount:n}=this.nextFieldNode()){return $t({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),typeIds:this.readTypeIds(t),valueOffsets:this.readOffsets(t),children:this.visitMany(t.children)})}visitSparseUnion(t,{length:r,nullCount:n}=this.nextFieldNode()){return $t({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),typeIds:this.readTypeIds(t),children:this.visitMany(t.children)})}visitDictionary(t,{length:r,nullCount:n}=this.nextFieldNode()){return $t({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t.indices),dictionary:this.readDictionary(t)})}visitInterval(t,{length:r,nullCount:n}=this.nextFieldNode()){return $t({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitFixedSizeList(t,{length:r,nullCount:n}=this.nextFieldNode()){return $t({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),child:this.visit(t.children[0])})}visitMap(t,{length:r,nullCount:n}=this.nextFieldNode()){return $t({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(t,r,n=this.nextBufferRange()){return r>0&&this.readData(t,n)||new Uint8Array(0)}readOffsets(t,r){return this.readData(t,r)}readTypeIds(t,r){return this.readData(t,r)}readData(t,{length:r,offset:n}=this.nextBufferRange()){return this.bytes.subarray(n,n+r)}readDictionary(t){return this.dictionaries.get(t.id)}},e_=class extends qm{constructor(t,r,n,i){super(new Uint8Array(0),r,n,i),this.sources=t}readNullBitmap(t,r,{offset:n}=this.nextBufferRange()){return r<=0?new Uint8Array(0):Fu(this.sources[n])}readOffsets(t,{offset:r}=this.nextBufferRange()){return Zt(Uint8Array,Zt(Int32Array,this.sources[r]))}readTypeIds(t,{offset:r}=this.nextBufferRange()){return Zt(Uint8Array,Zt(t.ArrayType,this.sources[r]))}readData(t,{offset:r}=this.nextBufferRange()){let{sources:n}=this;return pt.isTimestamp(t)?Zt(Uint8Array,Za.convertArray(n[r])):(pt.isInt(t)||pt.isTime(t))&&t.bitWidth===64?Zt(Uint8Array,Za.convertArray(n[r])):pt.isDate(t)&&t.unit===_n.MILLISECOND?Zt(Uint8Array,Za.convertArray(n[r])):pt.isDecimal(t)?Zt(Uint8Array,jm.convertArray(n[r])):pt.isBinary(t)||pt.isFixedSizeBinary(t)?xX(n[r]):pt.isBool(t)?Fu(n[r]):pt.isUtf8(t)?Kc(n[r].join("")):Zt(Uint8Array,Zt(t.ArrayType,n[r].map(i=>+i)))}};function xX(e){let t=e.join(""),r=new Uint8Array(t.length/2);for(let n=0;n<t.length;n+=2)r[n>>1]=Number.parseInt(t.slice(n,n+2),16);return r}var Bd=class extends Ls{constructor(t){super(t),this._values=new rl(new Uint8Array(0))}get byteLength(){let t=this._pendingLength+this.length*4;return this._offsets&&(t+=this._offsets.byteLength),this._values&&(t+=this._values.byteLength),this._nulls&&(t+=this._nulls.byteLength),t}setValue(t,r){return super.setValue(t,Rt(r))}_flushPending(t,r){let n=this._offsets,i=this._values.reserve(r).buffer,o=0;for(let[s,a]of t)if(a===void 0)n.set(s,0);else{let c=a.length;i.set(a,o),n.set(s,c),o+=c}}};var r_=class extends Ve{constructor(t){super(t),this._values=new Id}setValue(t,r){this._values.set(t,+r)}};var ku=class extends Pr{};ku.prototype._setValue=vA;var Ym=class extends ku{};Ym.prototype._setValue=Bx;var Wm=class extends ku{};Wm.prototype._setValue=Ox;var Gm=class extends Pr{};Gm.prototype._setValue=TA;var n_=class extends Ve{constructor({type:t,nullValues:r,dictionaryHashFunction:n}){super({type:new Ei(t.dictionary,t.indices,t.id,t.isOrdered)}),this._nulls=null,this._dictionaryOffset=0,this._keysToIndices=Object.create(null),this.indices=Cu({type:this.type.indices,nullValues:r}),this.dictionary=Cu({type:this.type.dictionary,nullValues:null}),typeof n=="function"&&(this.valueToKey=n)}get values(){return this.indices.values}get nullCount(){return this.indices.nullCount}get nullBitmap(){return this.indices.nullBitmap}get byteLength(){return this.indices.byteLength+this.dictionary.byteLength}get reservedLength(){return this.indices.reservedLength+this.dictionary.reservedLength}get reservedByteLength(){return this.indices.reservedByteLength+this.dictionary.reservedByteLength}isValid(t){return this.indices.isValid(t)}setValid(t,r){let n=this.indices;return r=n.setValid(t,r),this.length=n.length,r}setValue(t,r){let n=this._keysToIndices,i=this.valueToKey(r),o=n[i];return o===void 0&&(n[i]=o=this._dictionaryOffset+this.dictionary.append(r).length-1),this.indices.setValue(t,o)}flush(){let t=this.type,r=this._dictionary,n=this.dictionary.toVector(),i=this.indices.flush().clone(t);return i.dictionary=r?r.concat(n):n,this.finished||(this._dictionaryOffset+=n.length),this._dictionary=i.dictionary,this.clear(),i}finish(){return this.indices.finish(),this.dictionary.finish(),this._dictionaryOffset=0,this._keysToIndices=Object.create(null),super.finish()}clear(){return this.indices.clear(),this.dictionary.clear(),super.clear()}valueToKey(t){return typeof t=="string"?t:`${t}`}};var Xm=class extends Pr{};Xm.prototype._setValue=wA;var i_=class extends Ve{setValue(t,r){let[n]=this.children,i=t*this.stride;for(let o=-1,s=r.length;++o<s;)n.set(i+o,r[o])}addChild(t,r="0"){if(this.numChildren>0)throw new Error("FixedSizeListBuilder can only have one child.");let n=this.children.push(t);return this.type=new qo(this.type.listSize,new Qt(r,t.type,!0)),n}};var Uu=class extends Pr{setValue(t,r){this._values.set(t,r)}},o_=class extends Uu{setValue(t,r){super.setValue(t,Sm(r))}},s_=class extends Uu{},a_=class extends Uu{};var Pu=class extends Pr{};Pu.prototype._setValue=AA;var Hm=class extends Pu{};Hm.prototype._setValue=Px;var Zm=class extends Pu{};Zm.prototype._setValue=$x;var ho=class extends Pr{setValue(t,r){this._values.set(t,r)}},c_=class extends ho{},l_=class extends ho{},u_=class extends ho{},f_=class extends ho{},d_=class extends ho{},h_=class extends ho{},p_=class extends ho{},m_=class extends ho{};var y_=class extends Ls{constructor(t){super(t),this._offsets=new Td}addChild(t,r="0"){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=t,this.type=new Vo(new Qt(r,t.type,!0)),this.numChildren-1}_flushPending(t){let r=this._offsets,[n]=this.children;for(let[i,o]of t)if(typeof o>"u")r.set(i,0);else{let s=o.length,a=r.set(i,s).buffer[i];for(let c=-1;++c<s;)n.set(a+c,o[c])}}};var g_=class extends Ls{set(t,r){return super.set(t,r)}setValue(t,r){let n=r instanceof Map?r:new Map(Object.entries(r)),i=this._pending||(this._pending=new Map),o=i.get(t);o&&(this._pendingLength-=o.size),this._pendingLength+=n.size,i.set(t,n)}addChild(t,r=`${this.numChildren}`){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=t,this.type=new Yo(new Qt(r,t.type,!0),this.type.keysSorted),this.numChildren-1}_flushPending(t){let r=this._offsets,[n]=this.children;for(let[i,o]of t)if(o===void 0)r.set(i,0);else{let{[i]:s,[i+1]:a}=r.set(i,o.size).buffer;for(let c of o.entries())if(n.set(s,c),++s>=a)break}}};var b_=class extends Ve{setValue(t,r){}setValid(t,r){return this.length=Math.max(t+1,this.length),r}};var x_=class extends Ve{setValue(t,r){let{children:n,type:i}=this;switch(Array.isArray(r)||r.constructor){case!0:return i.children.forEach((o,s)=>n[s].set(t,r[s]));case Map:return i.children.forEach((o,s)=>n[s].set(t,r.get(o.name)));default:return i.children.forEach((o,s)=>n[s].set(t,r[o.name]))}}setValid(t,r){return super.setValid(t,r)||this.children.forEach(n=>n.setValid(t,r)),r}addChild(t,r=`${this.numChildren}`){let n=this.children.push(t);return this.type=new Ce([...this.type.children,new Qt(r,t.type,!0)]),n}};var Ka=class extends Pr{};Ka.prototype._setValue=SA;var Km=class extends Ka{};Km.prototype._setValue=Fx;var Qm=class extends Ka{};Qm.prototype._setValue=Nx;var Jm=class extends Ka{};Jm.prototype._setValue=Dx;var ty=class extends Ka{};ty.prototype._setValue=Lx;var Qa=class extends Pr{};Qa.prototype._setValue=IA;var ey=class extends Qa{};ey.prototype._setValue=Rx;var ry=class extends Qa{};ry.prototype._setValue=kx;var ny=class extends Qa{};ny.prototype._setValue=Cx;var iy=class extends Qa{};iy.prototype._setValue=Ux;var Od=class extends Ve{constructor(t){super(t),this._typeIds=new qa(new Int8Array(0),1),typeof t.valueToChildTypeId=="function"&&(this._valueToChildTypeId=t.valueToChildTypeId)}get typeIdToChildIndex(){return this.type.typeIdToChildIndex}append(t,r){return this.set(this.length,t,r)}set(t,r,n){return n===void 0&&(n=this._valueToChildTypeId(this,r,t)),this.setValid(t,this.isValid(r))&&this.setValue(t,r,n),this}setValue(t,r,n){this._typeIds.set(t,n);let i=this.type.typeIdToChildIndex[n],o=this.children[i];o?.set(t,r)}addChild(t,r=`${this.children.length}`){let n=this.children.push(t),{type:{children:i,mode:o,typeIds:s}}=this,a=[...i,new Qt(r,t.type)];return this.type=new jo(o,[...s,n],a),n}_valueToChildTypeId(t,r,n){throw new Error("Cannot map UnionBuilder value to child typeId. Pass the `childTypeId` as the second argument to unionBuilder.append(), or supply a `valueToChildTypeId` function as part of the UnionBuilder constructor options.")}},__=class extends Od{},w_=class extends Od{constructor(t){super(t),this._offsets=new qa(new Int32Array(0))}setValue(t,r,n){let i=this._typeIds.set(t,n).buffer[t],o=this.getChildAt(this.type.typeIdToChildIndex[i]),s=this._offsets.set(t,o.length).buffer[t];o?.set(s,r)}};var oy=class extends Ls{constructor(t){super(t),this._values=new rl(new Uint8Array(0))}get byteLength(){let t=this._pendingLength+this.length*4;return this._offsets&&(t+=this._offsets.byteLength),this._values&&(t+=this._values.byteLength),this._nulls&&(t+=this._nulls.byteLength),t}setValue(t,r){return super.setValue(t,Kc(r))}_flushPending(t,r){}};oy.prototype._flushPending=Bd.prototype._flushPending;var jA=class extends _t{visitNull(){return b_}visitBool(){return r_}visitInt(){return ho}visitInt8(){return c_}visitInt16(){return l_}visitInt32(){return u_}visitInt64(){return f_}visitUint8(){return d_}visitUint16(){return h_}visitUint32(){return p_}visitUint64(){return m_}visitFloat(){return Uu}visitFloat16(){return o_}visitFloat32(){return s_}visitFloat64(){return a_}visitUtf8(){return oy}visitBinary(){return Bd}visitFixedSizeBinary(){return Xm}visitDate(){return ku}visitDateDay(){return Ym}visitDateMillisecond(){return Wm}visitTimestamp(){return Ka}visitTimestampSecond(){return Km}visitTimestampMillisecond(){return Qm}visitTimestampMicrosecond(){return Jm}visitTimestampNanosecond(){return ty}visitTime(){return Qa}visitTimeSecond(){return ey}visitTimeMillisecond(){return ry}visitTimeMicrosecond(){return ny}visitTimeNanosecond(){return iy}visitDecimal(){return Gm}visitList(){return y_}visitStruct(){return x_}visitUnion(){return Od}visitDenseUnion(){return w_}visitSparseUnion(){return __}visitDictionary(){return n_}visitInterval(){return Pu}visitIntervalDayTime(){return Hm}visitIntervalYearMonth(){return Zm}visitFixedSizeList(){return i_}visitMap(){return g_}},s6=new jA;var Mt=class extends _t{compareSchemas(t,r){return t===r||r instanceof t.constructor&&this.compareManyFields(t.fields,r.fields)}compareManyFields(t,r){return t===r||Array.isArray(t)&&Array.isArray(r)&&t.length===r.length&&t.every((n,i)=>this.compareFields(n,r[i]))}compareFields(t,r){return t===r||r instanceof t.constructor&&t.name===r.name&&t.nullable===r.nullable&&this.visit(t.type,r.type)}};function si(e,t){return t instanceof e.constructor}function sy(e,t){return e===t||si(e,t)}function Ja(e,t){return e===t||si(e,t)&&e.bitWidth===t.bitWidth&&e.isSigned===t.isSigned}function v_(e,t){return e===t||si(e,t)&&e.precision===t.precision}function _X(e,t){return e===t||si(e,t)&&e.byteWidth===t.byteWidth}function qA(e,t){return e===t||si(e,t)&&e.unit===t.unit}function ay(e,t){return e===t||si(e,t)&&e.unit===t.unit&&e.timezone===t.timezone}function cy(e,t){return e===t||si(e,t)&&e.unit===t.unit&&e.bitWidth===t.bitWidth}function wX(e,t){return e===t||si(e,t)&&e.children.length===t.children.length&&$s.compareManyFields(e.children,t.children)}function vX(e,t){return e===t||si(e,t)&&e.children.length===t.children.length&&$s.compareManyFields(e.children,t.children)}function YA(e,t){return e===t||si(e,t)&&e.mode===t.mode&&e.typeIds.every((r,n)=>r===t.typeIds[n])&&$s.compareManyFields(e.children,t.children)}function SX(e,t){return e===t||si(e,t)&&e.id===t.id&&e.isOrdered===t.isOrdered&&$s.visit(e.indices,t.indices)&&$s.visit(e.dictionary,t.dictionary)}function WA(e,t){return e===t||si(e,t)&&e.unit===t.unit}function IX(e,t){return e===t||si(e,t)&&e.listSize===t.listSize&&e.children.length===t.children.length&&$s.compareManyFields(e.children,t.children)}function TX(e,t){return e===t||si(e,t)&&e.keysSorted===t.keysSorted&&e.children.length===t.children.length&&$s.compareManyFields(e.children,t.children)}Mt.prototype.visitNull=sy;Mt.prototype.visitBool=sy;Mt.prototype.visitInt=Ja;Mt.prototype.visitInt8=Ja;Mt.prototype.visitInt16=Ja;Mt.prototype.visitInt32=Ja;Mt.prototype.visitInt64=Ja;Mt.prototype.visitUint8=Ja;Mt.prototype.visitUint16=Ja;Mt.prototype.visitUint32=Ja;Mt.prototype.visitUint64=Ja;Mt.prototype.visitFloat=v_;Mt.prototype.visitFloat16=v_;Mt.prototype.visitFloat32=v_;Mt.prototype.visitFloat64=v_;Mt.prototype.visitUtf8=sy;Mt.prototype.visitBinary=sy;Mt.prototype.visitFixedSizeBinary=_X;Mt.prototype.visitDate=qA;Mt.prototype.visitDateDay=qA;Mt.prototype.visitDateMillisecond=qA;Mt.prototype.visitTimestamp=ay;Mt.prototype.visitTimestampSecond=ay;Mt.prototype.visitTimestampMillisecond=ay;Mt.prototype.visitTimestampMicrosecond=ay;Mt.prototype.visitTimestampNanosecond=ay;Mt.prototype.visitTime=cy;Mt.prototype.visitTimeSecond=cy;Mt.prototype.visitTimeMillisecond=cy;Mt.prototype.visitTimeMicrosecond=cy;Mt.prototype.visitTimeNanosecond=cy;Mt.prototype.visitDecimal=sy;Mt.prototype.visitList=wX;Mt.prototype.visitStruct=vX;Mt.prototype.visitUnion=YA;Mt.prototype.visitDenseUnion=YA;Mt.prototype.visitSparseUnion=YA;Mt.prototype.visitDictionary=SX;Mt.prototype.visitInterval=WA;Mt.prototype.visitIntervalDayTime=WA;Mt.prototype.visitIntervalYearMonth=WA;Mt.prototype.visitFixedSizeList=IX;Mt.prototype.visitMap=TX;var $s=new Mt;function $u(e,t){return $s.compareSchemas(e,t)}function a6(e,t){return $s.compareFields(e,t)}function c6(e,t){return $s.visit(e,t)}function Cu(e){let t=e.type,r=new(s6.getVisitFn(t)())(e);if(t.children&&t.children.length>0){let n=e.children||[],i={nullValues:e.nullValues},o=Array.isArray(n)?(s,a)=>n[a]||i:({name:s})=>n[s]||i;for(let[s,a]of t.children.entries()){let{type:c}=a,l=o(a,s);r.children.push(Cu(Object.assign(Object.assign({},l),{type:c})))}}return r}function S_(e,t){return AX(e,t.map(r=>r.data.concat()))}function AX(e,t){let r=[...e.fields],n=[],i={numBatches:t.reduce((f,d)=>Math.max(f,d.length),0)},o=0,s=0,a=-1,c=t.length,l,u=[];for(;i.numBatches-- >0;){for(s=Number.POSITIVE_INFINITY,a=-1;++a<c;)u[a]=l=t[a].shift(),s=Math.min(s,l?l.length:s);Number.isFinite(s)&&(u=MX(r,s,u,t,i),s>0&&(n[o++]=$t({type:new Ce(r),length:s,nullCount:0,children:u.slice()})))}return[e=e.assign(r),n.map(f=>new ar(e,f))]}function MX(e,t,r,n,i){var o;let s=(t+63&-64)>>3;for(let a=-1,c=n.length;++a<c;){let l=r[a],u=l?.length;if(u>=t)u===t?r[a]=l:(r[a]=l.slice(0,t),i.numBatches=Math.max(i.numBatches,n[a].unshift(l.slice(t,u-t))));else{let f=e[a];e[a]=f.clone({nullable:!0}),r[a]=(o=l?._changeLengthAndBackfillNullBitmap(t))!==null&&o!==void 0?o:$t({type:f.type,length:t,nullCount:t,nullBitmap:new Uint8Array(s)})}}return r}var l6,ai=class e{constructor(...t){var r,n;if(t.length===0)return this.batches=[],this.schema=new we([]),this._offsets=[0],this;let i,o;t[0]instanceof we&&(i=t.shift()),t[t.length-1]instanceof Uint32Array&&(o=t.pop());let s=c=>{if(c){if(c instanceof ar)return[c];if(c instanceof e)return c.batches;if(c instanceof Me){if(c.type instanceof Ce)return[new ar(new we(c.type.children),c)]}else{if(Array.isArray(c))return c.flatMap(l=>s(l));if(typeof c[Symbol.iterator]=="function")return[...c].flatMap(l=>s(l));if(typeof c=="object"){let l=Object.keys(c),u=l.map(h=>new se([c[h]])),f=new we(l.map((h,p)=>new Qt(String(h),u[p].type))),[,d]=S_(f,u);return d.length===0?[new ar(c)]:d}}}return[]},a=t.flatMap(c=>s(c));if(i=(n=i??((r=a[0])===null||r===void 0?void 0:r.schema))!==null&&n!==void 0?n:new we([]),!(i instanceof we))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(let c of a){if(!(c instanceof ar))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!$u(i,c.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=i,this.batches=a,this._offsets=o??Yx(this.data)}get data(){return this.batches.map(({data:t})=>t)}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce((t,r)=>t+r.length,0)}get nullCount(){return this._nullCount===-1&&(this._nullCount=qx(this.data)),this._nullCount}isValid(t){return!1}get(t){return null}set(t,r){}indexOf(t,r){return-1}getByteLength(t){return 0}[Symbol.iterator](){return this.batches.length>0?Sd.visit(new se(this.data)):new Array(0)[Symbol.iterator]()}toArray(){return[...this]}toString(){return`[
  ${this.toArray().join(`,
  `)}
]`}concat(...t){let r=this.schema,n=this.data.concat(t.flatMap(({data:i})=>i));return new e(r,n.map(i=>new ar(r,i)))}slice(t,r){let n=this.schema;[t,r]=Im({length:this.numRows},t,r);let i=Wx(this.data,this._offsets,t,r);return new e(n,i.map(o=>new ar(n,o)))}getChild(t){return this.getChildAt(this.schema.fields.findIndex(r=>r.name===t))}getChildAt(t){if(t>-1&&t<this.schema.fields.length){let r=this.data.map(n=>n.children[t]);if(r.length===0){let{type:n}=this.schema.fields[t],i=$t({type:n,length:0,nullCount:0});r.push(i._changeLengthAndBackfillNullBitmap(this.numRows))}return new se(r)}return null}setChild(t,r){var n;return this.setChildAt((n=this.schema.fields)===null||n===void 0?void 0:n.findIndex(i=>i.name===t),r)}setChildAt(t,r){let n=this.schema,i=[...this.batches];if(t>-1&&t<this.numCols){r||(r=new se([$t({type:new Rn,length:this.numRows})]));let o=n.fields.slice(),s=o[t].clone({type:r.type}),a=this.schema.fields.map((c,l)=>this.getChildAt(l));[o[t],a[t]]=[s,r],[n,i]=S_(n,a)}return new e(n,i)}select(t){let r=this.schema.fields.reduce((n,i,o)=>n.set(i.name,o),new Map);return this.selectAt(t.map(n=>r.get(n)).filter(n=>n>-1))}selectAt(t){let r=this.schema.selectAt(t),n=this.batches.map(i=>i.selectAt(t));return new e(r,n)}assign(t){let r=this.schema.fields,[n,i]=t.schema.fields.reduce((a,c,l)=>{let[u,f]=a,d=r.findIndex(h=>h.name===c.name);return~d?f[d]=l:u.push(l),a},[[],[]]),o=this.schema.assign(t.schema),s=[...r.map((a,c)=>[c,i[c]]).map(([a,c])=>c===void 0?this.getChildAt(a):t.getChildAt(c)),...n.map(a=>t.getChildAt(a))].filter(Boolean);return new e(...S_(o,s))}};l6=Symbol.toStringTag;ai[l6]=(e=>(e.schema=null,e.batches=[],e._offsets=new Uint32Array([0]),e._nullCount=-1,e[Symbol.isConcatSpreadable]=!0,e.isValid=el(Mm),e.get=el(Sr.getVisitFn(k.Struct)),e.set=Gx(en.getVisitFn(k.Struct)),e.indexOf=Xx(Nu.getVisitFn(k.Struct)),e.getByteLength=el(Oi.getVisitFn(k.Struct)),"Table"))(ai.prototype);var f6,ar=class e{constructor(...t){switch(t.length){case 2:{if([this.schema]=t,!(this.schema instanceof we))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=$t({nullCount:0,type:new Ce(this.schema.fields),children:this.schema.fields.map(r=>$t({type:r.type,nullCount:0}))})]=t,!(this.data instanceof Me))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=u6(this.schema,this.data.children);break}case 1:{let[r]=t,{fields:n,children:i,length:o}=Object.keys(r).reduce((c,l,u)=>(c.children[u]=r[l],c.length=Math.max(c.length,r[l].length),c.fields[u]=Qt.new({name:l,type:r[l].type,nullable:!0}),c),{length:0,fields:new Array,children:new Array}),s=new we(n),a=$t({type:new Ce(n),length:o,children:i,nullCount:0});[this.schema,this.data]=u6(s,a.children,o);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=d6(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(t){return this.data.getValid(t)}get(t){return Sr.visit(this.data,t)}set(t,r){return en.visit(this.data,t,r)}indexOf(t,r){return Nu.visit(this.data,t,r)}getByteLength(t){return Oi.visit(this.data,t)}[Symbol.iterator](){return Sd.visit(new se([this.data]))}toArray(){return[...this]}concat(...t){return new ai(this.schema,[this,...t])}slice(t,r){let[n]=new se([this.data]).slice(t,r).data;return new e(this.schema,n)}getChild(t){var r;return this.getChildAt((r=this.schema.fields)===null||r===void 0?void 0:r.findIndex(n=>n.name===t))}getChildAt(t){return t>-1&&t<this.schema.fields.length?new se([this.data.children[t]]):null}setChild(t,r){var n;return this.setChildAt((n=this.schema.fields)===null||n===void 0?void 0:n.findIndex(i=>i.name===t),r)}setChildAt(t,r){let n=this.schema,i=this.data;if(t>-1&&t<this.numCols){r||(r=new se([$t({type:new Rn,length:this.numRows})]));let o=n.fields.slice(),s=i.children.slice(),a=o[t].clone({type:r.type});[o[t],s[t]]=[a,r.data[0]],n=new we(o,new Map(this.schema.metadata)),i=$t({type:new Ce(o),children:s})}return new e(n,i)}select(t){let r=this.schema.select(t),n=new Ce(r.fields),i=[];for(let o of t){let s=this.schema.fields.findIndex(a=>a.name===o);~s&&(i[s]=this.data.children[s])}return new e(r,$t({type:n,length:this.numRows,children:i}))}selectAt(t){let r=this.schema.selectAt(t),n=t.map(o=>this.data.children[o]).filter(Boolean),i=$t({type:new Ce(r.fields),length:this.numRows,children:n});return new e(r,i)}};f6=Symbol.toStringTag;ar[f6]=(e=>(e._nullCount=-1,e[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(ar.prototype);function u6(e,t,r=t.reduce((n,i)=>Math.max(n,i.length),0)){var n;let i=[...e.fields],o=[...t],s=(r+63&-64)>>3;for(let[a,c]of e.fields.entries()){let l=t[a];(!l||l.length!==r)&&(i[a]=c.clone({nullable:!0}),o[a]=(n=l?._changeLengthAndBackfillNullBitmap(r))!==null&&n!==void 0?n:$t({type:c.type,length:r,nullCount:r,nullBitmap:new Uint8Array(s)}))}return[e.assign(i),$t({type:new Ce(i),length:r,children:o})]}function d6(e,t,r=new Map){for(let n=-1,i=e.length;++n<i;){let s=e[n].type,a=t[n];if(pt.isDictionary(s)){if(!r.has(s.id))a.dictionary&&r.set(s.id,a.dictionary);else if(r.get(s.id)!==a.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}s.children&&s.children.length>0&&d6(s.children,a.children,r)}return r}var zu=class extends ar{constructor(t){let r=t.fields.map(i=>$t({type:i.type})),n=$t({type:new Ce(t.fields),nullCount:0,children:r});super(t,n)}};var ly;(function(e){e[e.BUFFER=0]="BUFFER"})(ly||(ly={}));var uy;(function(e){e[e.LZ4_FRAME=0]="LZ4_FRAME",e[e.ZSTD=1]="ZSTD"})(uy||(uy={}));var I_=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsBodyCompression(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBodyCompression(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}codec(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt8(this.bb_pos+t):uy.LZ4_FRAME}method(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt8(this.bb_pos+t):ly.BUFFER}static startBodyCompression(t){t.startObject(2)}static addCodec(t,r){t.addFieldInt8(0,r,uy.LZ4_FRAME)}static addMethod(t,r){t.addFieldInt8(1,r,ly.BUFFER)}static endBodyCompression(t){return t.endObject()}static createBodyCompression(t,r,n){return e.startBodyCompression(t),e.addCodec(t,r),e.addMethod(t,n),e.endBodyCompression(t)}};var Fd=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer(t,r,n){return t.prep(8,16),t.writeInt64(BigInt(n??0)),t.writeInt64(BigInt(r??0)),t.offset()}};var Nd=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode(t,r,n){return t.prep(8,16),t.writeInt64(BigInt(n??0)),t.writeInt64(BigInt(r??0)),t.offset()}};var Di=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsRecordBatch(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsRecordBatch(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}length(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):BigInt("0")}nodes(t,r){let n=this.bb.__offset(this.bb_pos,6);return n?(r||new Nd).__init(this.bb.__vector(this.bb_pos+n)+t*16,this.bb):null}nodesLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}buffers(t,r){let n=this.bb.__offset(this.bb_pos,8);return n?(r||new Fd).__init(this.bb.__vector(this.bb_pos+n)+t*16,this.bb):null}buffersLength(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}compression(t){let r=this.bb.__offset(this.bb_pos,10);return r?(t||new I_).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}static startRecordBatch(t){t.startObject(4)}static addLength(t,r){t.addFieldInt64(0,r,BigInt("0"))}static addNodes(t,r){t.addFieldOffset(1,r,0)}static startNodesVector(t,r){t.startVector(16,r,8)}static addBuffers(t,r){t.addFieldOffset(2,r,0)}static startBuffersVector(t,r){t.startVector(16,r,8)}static addCompression(t,r){t.addFieldOffset(3,r,0)}static endRecordBatch(t){return t.endObject()}};var tc=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsDictionaryBatch(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryBatch(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}id(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):BigInt("0")}data(t){let r=this.bb.__offset(this.bb_pos,6);return r?(t||new Di).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}isDelta(){let t=this.bb.__offset(this.bb_pos,8);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startDictionaryBatch(t){t.startObject(3)}static addId(t,r){t.addFieldInt64(0,r,BigInt("0"))}static addData(t,r){t.addFieldOffset(1,r,0)}static addIsDelta(t,r){t.addFieldInt8(2,+r,0)}static endDictionaryBatch(t){return t.endObject()}};var Dd;(function(e){e[e.NONE=0]="NONE",e[e.Schema=1]="Schema",e[e.DictionaryBatch=2]="DictionaryBatch",e[e.RecordBatch=3]="RecordBatch",e[e.Tensor=4]="Tensor",e[e.SparseTensor=5]="SparseTensor"})(Dd||(Dd={}));var Zo=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsMessage(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMessage(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}version(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):nl.V1}headerType(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):Dd.NONE}header(t){let r=this.bb.__offset(this.bb_pos,8);return r?this.bb.__union(t,this.bb_pos+r):null}bodyLength(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt64(this.bb_pos+t):BigInt("0")}customMetadata(t,r){let n=this.bb.__offset(this.bb_pos,12);return n?(r||new Dr).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}customMetadataLength(){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startMessage(t){t.startObject(5)}static addVersion(t,r){t.addFieldInt16(0,r,nl.V1)}static addHeaderType(t,r){t.addFieldInt8(1,r,Dd.NONE)}static addHeader(t,r){t.addFieldOffset(2,r,0)}static addBodyLength(t,r){t.addFieldInt64(3,r,BigInt("0"))}static addCustomMetadata(t,r){t.addFieldOffset(4,r,0)}static createCustomMetadataVector(t,r){t.startVector(4,r.length,4);for(let n=r.length-1;n>=0;n--)t.addOffset(r[n]);return t.endVector()}static startCustomMetadataVector(t,r){t.startVector(4,r,4)}static endMessage(t){return t.endObject()}static finishMessageBuffer(t,r){t.finish(r)}static finishSizePrefixedMessageBuffer(t,r){t.finish(r,void 0,!0)}static createMessage(t,r,n,i,o,s){return e.startMessage(t),e.addVersion(t,r),e.addHeaderType(t,n),e.addHeader(t,i),e.addBodyLength(t,o),e.addCustomMetadata(t,s),e.endMessage(t)}};var GA=class extends _t{visit(t,r){return t==null||r==null?void 0:super.visit(t,r)}visitNull(t,r){return km.startNull(r),km.endNull(r)}visitInt(t,r){return Xo.startInt(r),Xo.addBitWidth(r,t.bitWidth),Xo.addIsSigned(r,t.isSigned),Xo.endInt(r)}visitFloat(t,r){return ll.startFloatingPoint(r),ll.addPrecision(r,t.precision),ll.endFloatingPoint(r)}visitBinary(t,r){return Om.startBinary(r),Om.endBinary(r)}visitBool(t,r){return Fm.startBool(r),Fm.endBool(r)}visitUtf8(t,r){return Pm.startUtf8(r),Pm.endUtf8(r)}visitDecimal(t,r){return Cs.startDecimal(r),Cs.addScale(r,t.scale),Cs.addPrecision(r,t.precision),Cs.addBitWidth(r,t.bitWidth),Cs.endDecimal(r)}visitDate(t,r){return ol.startDate(r),ol.addUnit(r,t.unit),ol.endDate(r)}visitTime(t,r){return Ya.startTime(r),Ya.addUnit(r,t.unit),Ya.addBitWidth(r,t.bitWidth),Ya.endTime(r)}visitTimestamp(t,r){let n=t.timezone&&r.createString(t.timezone)||void 0;return Wa.startTimestamp(r),Wa.addUnit(r,t.unit),n!==void 0&&Wa.addTimezone(r,n),Wa.endTimestamp(r)}visitInterval(t,r){return ul.startInterval(r),ul.addUnit(r,t.unit),ul.endInterval(r)}visitList(t,r){return Rm.startList(r),Rm.endList(r)}visitStruct(t,r){return Cm.startStruct_(r),Cm.endStruct_(r)}visitUnion(t,r){Ho.startTypeIdsVector(r,t.typeIds.length);let n=Ho.createTypeIdsVector(r,t.typeIds);return Ho.startUnion(r),Ho.addMode(r,t.mode),Ho.addTypeIds(r,n),Ho.endUnion(r)}visitDictionary(t,r){let n=this.visit(t.indices,r);return ks.startDictionaryEncoding(r),ks.addId(r,BigInt(t.id)),ks.addIsOrdered(r,t.isOrdered),n!==void 0&&ks.addIndexType(r,n),ks.endDictionaryEncoding(r)}visitFixedSizeBinary(t,r){return al.startFixedSizeBinary(r),al.addByteWidth(r,t.byteWidth),al.endFixedSizeBinary(r)}visitFixedSizeList(t,r){return cl.startFixedSizeList(r),cl.addListSize(r,t.listSize),cl.endFixedSizeList(r)}visitMap(t,r){return fl.startMap(r),fl.addKeysSorted(r,t.keysSorted),fl.endMap(r)}},T_=new GA;function y6(e,t=new Map){return new we(BX(e,t),A_(e.customMetadata),t)}function XA(e){return new rn(e.count,b6(e.columns),x6(e.columns))}function g6(e){return new li(XA(e.data),e.id,e.isDelta)}function BX(e,t){return(e.fields||[]).filter(Boolean).map(r=>Qt.fromJSON(r,t))}function h6(e,t){return(e.children||[]).filter(Boolean).map(r=>Qt.fromJSON(r,t))}function b6(e){return(e||[]).reduce((t,r)=>[...t,new Ko(r.count,OX(r.VALIDITY)),...b6(r.children)],[])}function x6(e,t=[]){for(let r=-1,n=(e||[]).length;++r<n;){let i=e[r];i.VALIDITY&&t.push(new ci(t.length,i.VALIDITY.length)),i.TYPE&&t.push(new ci(t.length,i.TYPE.length)),i.OFFSET&&t.push(new ci(t.length,i.OFFSET.length)),i.DATA&&t.push(new ci(t.length,i.DATA.length)),t=x6(i.children,t)}return t}function OX(e){return(e||[]).reduce((t,r)=>t+ +(r===0),0)}function _6(e,t){let r,n,i,o,s,a;return!t||!(o=e.dictionary)?(s=m6(e,h6(e,t)),i=new Qt(e.name,s,e.nullable,A_(e.customMetadata))):t.has(r=o.id)?(n=(n=o.indexType)?p6(n):new Fs,a=new Ei(t.get(r),n,r,o.isOrdered),i=new Qt(e.name,a,e.nullable,A_(e.customMetadata))):(n=(n=o.indexType)?p6(n):new Fs,t.set(r,s=m6(e,h6(e,t))),a=new Ei(s,n,r,o.isOrdered),i=new Qt(e.name,a,e.nullable,A_(e.customMetadata))),i||null}function A_(e){return new Map(Object.entries(e||{}))}function p6(e){return new mr(e.isSigned,e.bitWidth)}function m6(e,t){let r=e.type.name;switch(r){case"NONE":return new Rn;case"null":return new Rn;case"binary":return new Ra;case"utf8":return new ka;case"bool":return new Ca;case"list":return new Vo((t||[])[0]);case"struct":return new Ce(t||[]);case"struct_":return new Ce(t||[])}switch(r){case"int":{let n=e.type;return new mr(n.isSigned,n.bitWidth)}case"floatingpoint":{let n=e.type;return new ii(He[n.precision])}case"decimal":{let n=e.type;return new Ua(n.scale,n.precision,n.bitWidth)}case"date":{let n=e.type;return new Pa(_n[n.unit])}case"time":{let n=e.type;return new zo(oe[n.unit],n.bitWidth)}case"timestamp":{let n=e.type;return new $a(oe[n.unit],n.timezone)}case"interval":{let n=e.type;return new za(ri[n.unit])}case"union":{let n=e.type;return new jo(sr[n.mode],n.typeIds||[],t||[])}case"fixedsizebinary":{let n=e.type;return new Va(n.byteWidth)}case"fixedsizelist":{let n=e.type;return new qo(n.listSize,(t||[])[0])}case"map":{let n=e.type;return new Yo((t||[])[0],n.keysSorted)}}throw new Error(`Unrecognized type: "${r}"`)}var FX=Lu,NX=Fi,ui=class e{static fromJSON(t,r){let n=new e(0,tn.V4,r);return n._createHeader=DX(t,r),n}static decode(t){t=new NX(Rt(t));let r=Zo.getRootAsMessage(t),n=r.bodyLength(),i=r.version(),o=r.headerType(),s=new e(n,i,o);return s._createHeader=LX(r,o),s}static encode(t){let r=new FX,n=-1;return t.isSchema()?n=we.encode(r,t.header()):t.isRecordBatch()?n=rn.encode(r,t.header()):t.isDictionaryBatch()&&(n=li.encode(r,t.header())),Zo.startMessage(r),Zo.addVersion(r,tn.V4),Zo.addHeader(r,n),Zo.addHeaderType(r,t.headerType),Zo.addBodyLength(r,BigInt(t.bodyLength)),Zo.finishMessageBuffer(r,Zo.endMessage(r)),r.asUint8Array()}static from(t,r=0){if(t instanceof we)return new e(0,tn.V4,pe.Schema,t);if(t instanceof rn)return new e(r,tn.V4,pe.RecordBatch,t);if(t instanceof li)return new e(r,tn.V4,pe.DictionaryBatch,t);throw new Error(`Unrecognized Message header: ${t}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===pe.Schema}isRecordBatch(){return this.headerType===pe.RecordBatch}isDictionaryBatch(){return this.headerType===pe.DictionaryBatch}constructor(t,r,n,i){this._version=r,this._headerType=n,this.body=new Uint8Array(0),i&&(this._createHeader=()=>i),this._bodyLength=ni(t)}},rn=class{get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}constructor(t,r,n){this._nodes=r,this._buffers=n,this._length=ni(t)}},li=class{get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}constructor(t,r,n=!1){this._data=t,this._isDelta=n,this._id=ni(r)}},ci=class{constructor(t,r){this.offset=ni(t),this.length=ni(r)}},Ko=class{constructor(t,r){this.length=ni(t),this.nullCount=ni(r)}};function DX(e,t){return()=>{switch(t){case pe.Schema:return we.fromJSON(e);case pe.RecordBatch:return rn.fromJSON(e);case pe.DictionaryBatch:return li.fromJSON(e)}throw new Error(`Unrecognized Message type: { name: ${pe[t]}, type: ${t} }`)}}function LX(e,t){return()=>{switch(t){case pe.Schema:return we.decode(e.header(new oi));case pe.RecordBatch:return rn.decode(e.header(new Di),e.version());case pe.DictionaryBatch:return li.decode(e.header(new tc),e.version())}throw new Error(`Unrecognized Message type: { name: ${pe[t]}, type: ${t} }`)}}Qt.encode=YX;Qt.decode=jX;Qt.fromJSON=_6;we.encode=qX;we.decode=RX;we.fromJSON=y6;rn.encode=WX;rn.decode=kX;rn.fromJSON=XA;li.encode=GX;li.decode=CX;li.fromJSON=g6;Ko.encode=XX;Ko.decode=PX;ci.encode=HX;ci.decode=UX;function RX(e,t=new Map){let r=VX(e,t);return new we(r,M_(e),t)}function kX(e,t=tn.V4){if(e.compression()!==null)throw new Error("Record batch compression not implemented");return new rn(e.length(),$X(e),zX(e,t))}function CX(e,t=tn.V4){return new li(rn.decode(e.data(),t),e.id(),e.isDelta())}function UX(e){return new ci(e.offset(),e.length())}function PX(e){return new Ko(e.length(),e.nullCount())}function $X(e){let t=[];for(let r,n=-1,i=-1,o=e.nodesLength();++n<o;)(r=e.nodes(n))&&(t[++i]=Ko.decode(r));return t}function zX(e,t){let r=[];for(let n,i=-1,o=-1,s=e.buffersLength();++i<s;)(n=e.buffers(i))&&(t<tn.V4&&(n.bb_pos+=8*(i+1)),r[++o]=ci.decode(n));return r}function VX(e,t){let r=[];for(let n,i=-1,o=-1,s=e.fieldsLength();++i<s;)(n=e.fields(i))&&(r[++o]=Qt.decode(n,t));return r}function w6(e,t){let r=[];for(let n,i=-1,o=-1,s=e.childrenLength();++i<s;)(n=e.children(i))&&(r[++o]=Qt.decode(n,t));return r}function jX(e,t){let r,n,i,o,s,a;return!t||!(a=e.dictionary())?(i=S6(e,w6(e,t)),n=new Qt(e.name(),i,e.nullable(),M_(e))):t.has(r=ni(a.id()))?(o=(o=a.indexType())?v6(o):new Fs,s=new Ei(t.get(r),o,r,a.isOrdered()),n=new Qt(e.name(),s,e.nullable(),M_(e))):(o=(o=a.indexType())?v6(o):new Fs,t.set(r,i=S6(e,w6(e,t))),s=new Ei(i,o,r,a.isOrdered()),n=new Qt(e.name(),s,e.nullable(),M_(e))),n||null}function M_(e){let t=new Map;if(e)for(let r,n,i=-1,o=Math.trunc(e.customMetadataLength());++i<o;)(r=e.customMetadata(i))&&(n=r.key())!=null&&t.set(n,r.value());return t}function v6(e){return new mr(e.isSigned(),e.bitWidth())}function S6(e,t){let r=e.typeType();switch(r){case je.NONE:return new Rn;case je.Null:return new Rn;case je.Binary:return new Ra;case je.Utf8:return new ka;case je.Bool:return new Ca;case je.List:return new Vo((t||[])[0]);case je.Struct_:return new Ce(t||[])}switch(r){case je.Int:{let n=e.type(new Xo);return new mr(n.isSigned(),n.bitWidth())}case je.FloatingPoint:{let n=e.type(new ll);return new ii(n.precision())}case je.Decimal:{let n=e.type(new Cs);return new Ua(n.scale(),n.precision(),n.bitWidth())}case je.Date:{let n=e.type(new ol);return new Pa(n.unit())}case je.Time:{let n=e.type(new Ya);return new zo(n.unit(),n.bitWidth())}case je.Timestamp:{let n=e.type(new Wa);return new $a(n.unit(),n.timezone())}case je.Interval:{let n=e.type(new ul);return new za(n.unit())}case je.Union:{let n=e.type(new Ho);return new jo(n.mode(),n.typeIdsArray()||[],t||[])}case je.FixedSizeBinary:{let n=e.type(new al);return new Va(n.byteWidth())}case je.FixedSizeList:{let n=e.type(new cl);return new qo(n.listSize(),(t||[])[0])}case je.Map:{let n=e.type(new fl);return new Yo((t||[])[0],n.keysSorted())}}throw new Error(`Unrecognized type: "${je[r]}" (${r})`)}function qX(e,t){let r=t.fields.map(o=>Qt.encode(e,o));oi.startFieldsVector(e,r.length);let n=oi.createFieldsVector(e,r),i=t.metadata&&t.metadata.size>0?oi.createCustomMetadataVector(e,[...t.metadata].map(([o,s])=>{let a=e.createString(`${o}`),c=e.createString(`${s}`);return Dr.startKeyValue(e),Dr.addKey(e,a),Dr.addValue(e,c),Dr.endKeyValue(e)})):-1;return oi.startSchema(e),oi.addFields(e,n),oi.addEndianness(e,ZX?il.Little:il.Big),i!==-1&&oi.addCustomMetadata(e,i),oi.endSchema(e)}function YX(e,t){let r=-1,n=-1,i=-1,o=t.type,s=t.typeId;pt.isDictionary(o)?(s=o.dictionary.typeId,i=T_.visit(o,e),n=T_.visit(o.dictionary,e)):n=T_.visit(o,e);let a=(o.children||[]).map(u=>Qt.encode(e,u)),c=wn.createChildrenVector(e,a),l=t.metadata&&t.metadata.size>0?wn.createCustomMetadataVector(e,[...t.metadata].map(([u,f])=>{let d=e.createString(`${u}`),h=e.createString(`${f}`);return Dr.startKeyValue(e),Dr.addKey(e,d),Dr.addValue(e,h),Dr.endKeyValue(e)})):-1;return t.name&&(r=e.createString(t.name)),wn.startField(e),wn.addType(e,n),wn.addTypeType(e,s),wn.addChildren(e,c),wn.addNullable(e,!!t.nullable),r!==-1&&wn.addName(e,r),i!==-1&&wn.addDictionary(e,i),l!==-1&&wn.addCustomMetadata(e,l),wn.endField(e)}function WX(e,t){let r=t.nodes||[],n=t.buffers||[];Di.startNodesVector(e,r.length);for(let s of r.slice().reverse())Ko.encode(e,s);let i=e.endVector();Di.startBuffersVector(e,n.length);for(let s of n.slice().reverse())ci.encode(e,s);let o=e.endVector();return Di.startRecordBatch(e),Di.addLength(e,BigInt(t.length)),Di.addNodes(e,i),Di.addBuffers(e,o),Di.endRecordBatch(e)}function GX(e,t){let r=rn.encode(e,t.data);return tc.startDictionaryBatch(e),tc.addId(e,BigInt(t.id)),tc.addIsDelta(e,t.isDelta),tc.addData(e,r),tc.endDictionaryBatch(e)}function XX(e,t){return Nd.createFieldNode(e,BigInt(t.length),BigInt(t.nullCount))}function HX(e,t){return Fd.createBuffer(e,BigInt(t.offset),BigInt(t.length))}var ZX=(()=>{let e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),new Int16Array(e)[0]===256})();var ZA=e=>`Expected ${pe[e]} Message in stream, but was null or length 0.`,KA=e=>`Header pointer of flatbuffer-encoded ${pe[e]} Message is null or length 0.`,I6=(e,t)=>`Expected to read ${e} metadata bytes, but only read ${t}.`,T6=(e,t)=>`Expected to read ${e} bytes for message body, but only read ${t}.`,Ld=class{constructor(t){this.source=t instanceof Ps?t:new Ps(t)}[Symbol.iterator](){return this}next(){let t;return(t=this.readMetadataLength()).done?Ue:t.value===-1&&(t=this.readMetadataLength()).done?Ue:(t=this.readMetadata(t.value)).done?Ue:t}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}readMessage(t){let r;if((r=this.next()).done)return null;if(t!=null&&r.value.headerType!==t)throw new Error(ZA(t));return r.value}readMessageBody(t){if(t<=0)return new Uint8Array(0);let r=Rt(this.source.read(t));if(r.byteLength<t)throw new Error(T6(t,r.byteLength));return r.byteOffset%8===0&&r.byteOffset+r.byteLength<=r.buffer.byteLength?r:r.slice()}readSchema(t=!1){let r=pe.Schema,n=this.readMessage(r),i=n?.header();if(t&&!i)throw new Error(KA(r));return i}readMetadataLength(){let t=this.source.read(E_),r=t&&new Fi(t),n=r?.readInt32(0)||0;return{done:n===0,value:n}}readMetadata(t){let r=this.source.read(t);if(!r)return Ue;if(r.byteLength<t)throw new Error(I6(t,r.byteLength));return{done:!1,value:ui.decode(r)}}},fy=class{constructor(t,r){this.source=t instanceof fo?t:hx(t)?new dl(t,r):new fo(t)}[Symbol.asyncIterator](){return this}next(){return P(this,void 0,void 0,function*(){let t;return(t=yield this.readMetadataLength()).done?Ue:t.value===-1&&(t=yield this.readMetadataLength()).done?Ue:(t=yield this.readMetadata(t.value)).done?Ue:t})}throw(t){return P(this,void 0,void 0,function*(){return yield this.source.throw(t)})}return(t){return P(this,void 0,void 0,function*(){return yield this.source.return(t)})}readMessage(t){return P(this,void 0,void 0,function*(){let r;if((r=yield this.next()).done)return null;if(t!=null&&r.value.headerType!==t)throw new Error(ZA(t));return r.value})}readMessageBody(t){return P(this,void 0,void 0,function*(){if(t<=0)return new Uint8Array(0);let r=Rt(yield this.source.read(t));if(r.byteLength<t)throw new Error(T6(t,r.byteLength));return r.byteOffset%8===0&&r.byteOffset+r.byteLength<=r.buffer.byteLength?r:r.slice()})}readSchema(t=!1){return P(this,void 0,void 0,function*(){let r=pe.Schema,n=yield this.readMessage(r),i=n?.header();if(t&&!i)throw new Error(KA(r));return i})}readMetadataLength(){return P(this,void 0,void 0,function*(){let t=yield this.source.read(E_),r=t&&new Fi(t),n=r?.readInt32(0)||0;return{done:n===0,value:n}})}readMetadata(t){return P(this,void 0,void 0,function*(){let r=yield this.source.read(t);if(!r)return Ue;if(r.byteLength<t)throw new Error(I6(t,r.byteLength));return{done:!1,value:ui.decode(r)}})}},dy=class extends Ld{constructor(t){super(new Uint8Array(0)),this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=t instanceof $m?t:new $m(t)}next(){let{_json:t}=this;if(!this._schema)return this._schema=!0,{done:!1,value:ui.fromJSON(t.schema,pe.Schema)};if(this._dictionaryIndex<t.dictionaries.length){let r=t.dictionaries[this._dictionaryIndex++];return this._body=r.data.columns,{done:!1,value:ui.fromJSON(r,pe.DictionaryBatch)}}if(this._batchIndex<t.batches.length){let r=t.batches[this._batchIndex++];return this._body=r.columns,{done:!1,value:ui.fromJSON(r,pe.RecordBatch)}}return this._body=[],Ue}readMessageBody(t){return r(this._body);function r(n){return(n||[]).reduce((i,o)=>[...i,...o.VALIDITY&&[o.VALIDITY]||[],...o.TYPE&&[o.TYPE]||[],...o.OFFSET&&[o.OFFSET]||[],...o.DATA&&[o.DATA]||[],...r(o.children)],[])}}readMessage(t){let r;if((r=this.next()).done)return null;if(t!=null&&r.value.headerType!==t)throw new Error(ZA(t));return r.value}readSchema(){let t=pe.Schema,r=this.readMessage(t),n=r?.header();if(!r||!n)throw new Error(KA(t));return n}},E_=4,HA="ARROW1",Rd=new Uint8Array(HA.length);for(let e=0;e<HA.length;e+=1)Rd[e]=HA.codePointAt(e);function B_(e,t=0){for(let r=-1,n=Rd.length;++r<n;)if(Rd[r]!==e[t+r])return!1;return!0}var kd=Rd.length,QA=kd+E_,A6=kd*2+E_;var Li=class e extends Ru{constructor(t){super(),this._impl=t}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(t){return this._impl.throw(t)}return(t){return this._impl.return(t)}cancel(){return this._impl.cancel()}reset(t){return this._impl.reset(t),this._DOMStream=void 0,this._nodeStream=void 0,this}open(t){let r=this._impl.open(t);return Ai(r)?r.then(()=>this):this}readRecordBatch(t){return this._impl.isFile()?this._impl.readRecordBatch(t):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return Jr.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return Jr.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,r){throw new Error('"throughDOM" not available in this environment')}static from(t){return t instanceof e?t:fx(t)?QX(t):hx(t)?eH(t):Ai(t)?(()=>P(this,void 0,void 0,function*(){return yield e.from(yield t)}))():px(t)||bm(t)||yx(t)||co(t)?tH(new fo(t)):JX(new Ps(t))}static readAll(t){return t instanceof e?t.isSync()?M6(t):E6(t):fx(t)||ArrayBuffer.isView(t)||Co(t)||dx(t)?M6(t):E6(t)}},ec=class extends Li{constructor(t){super(t),this._impl=t}readAll(){return[...this]}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return ke(this,arguments,function*(){yield G(yield*oo(or(this[Symbol.iterator]())))})}},Vu=class extends Li{constructor(t){super(t),this._impl=t}readAll(){var t,r,n,i;return P(this,void 0,void 0,function*(){let o=new Array;try{for(var s=!0,a=or(this),c;c=yield a.next(),t=c.done,!t;){i=c.value,s=!1;try{let l=i;o.push(l)}finally{s=!0}}}catch(l){r={error:l}}finally{try{!s&&!t&&(n=a.return)&&(yield n.call(a))}finally{if(r)throw r.error}}return o})}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}},ju=class extends ec{constructor(t){super(t),this._impl=t}},O_=class extends Vu{constructor(t){super(t),this._impl=t}},F_=class{get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}constructor(t=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=t}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(t){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=t,this.dictionaries=new Map,this}_loadRecordBatch(t,r){let n=this._loadVectors(t,r,this.schema.fields),i=$t({type:new Ce(this.schema.fields),length:t.length,children:n});return new ar(this.schema,i)}_loadDictionaryBatch(t,r){let{id:n,isDelta:i}=t,{dictionaries:o,schema:s}=this,a=o.get(n);if(i||!a){let c=s.dictionaries.get(n),l=this._loadVectors(t.data,r,[c]);return(a&&i?a.concat(new se(l)):new se(l)).memoize()}return a.memoize()}_loadVectors(t,r,n){return new qm(r,t.nodes,t.buffers,this.dictionaries).visitMany(n)}},Cd=class extends F_{constructor(t,r){super(r),this._reader=fx(t)?new dy(this._handle=t):new Ld(this._handle=t)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(t){return this.closed||(this.autoDestroy=B6(this,t),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(t):Ue}return(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(t):Ue}next(){if(this.closed)return Ue;let t,{_reader:r}=this;for(;t=this._readNextMessageAndValidate();)if(t.isSchema())this.reset(t.header());else if(t.isRecordBatch()){this._recordBatchIndex++;let n=t.header(),i=r.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(n,i)}}else if(t.isDictionaryBatch()){this._dictionaryIndex++;let n=t.header(),i=r.readMessageBody(t.bodyLength),o=this._loadDictionaryBatch(n,i);this.dictionaries.set(n.id,o)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new zu(this.schema)}):this.return()}_readNextMessageAndValidate(t){return this._reader.readMessage(t)}},Ud=class extends F_{constructor(t,r){super(r),this._reader=new fy(this._handle=t)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){return P(this,void 0,void 0,function*(){!this.closed&&(this.closed=!0)&&(yield this.reset()._reader.return(),this._reader=null,this.dictionaries=null)})}open(t){return P(this,void 0,void 0,function*(){return this.closed||(this.autoDestroy=B6(this,t),this.schema||(this.schema=yield this._reader.readSchema())||(yield this.cancel())),this})}throw(t){return P(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.throw(t):Ue})}return(t){return P(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.return(t):Ue})}next(){return P(this,void 0,void 0,function*(){if(this.closed)return Ue;let t,{_reader:r}=this;for(;t=yield this._readNextMessageAndValidate();)if(t.isSchema())yield this.reset(t.header());else if(t.isRecordBatch()){this._recordBatchIndex++;let n=t.header(),i=yield r.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(n,i)}}else if(t.isDictionaryBatch()){this._dictionaryIndex++;let n=t.header(),i=yield r.readMessageBody(t.bodyLength),o=this._loadDictionaryBatch(n,i);this.dictionaries.set(n.id,o)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new zu(this.schema)}):yield this.return()})}_readNextMessageAndValidate(t){return P(this,void 0,void 0,function*(){return yield this._reader.readMessage(t)})}},N_=class extends Cd{get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}constructor(t,r){super(t instanceof zm?t:new zm(t),r)}isSync(){return!0}isFile(){return!0}open(t){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(let r of this._footer.dictionaryBatches())r&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(t)}readRecordBatch(t){var r;if(this.closed)return null;this._footer||this.open();let n=(r=this._footer)===null||r===void 0?void 0:r.getRecordBatch(t);if(n&&this._handle.seek(n.offset)){let i=this._reader.readMessage(pe.RecordBatch);if(i?.isRecordBatch()){let o=i.header(),s=this._reader.readMessageBody(i.bodyLength);return this._loadRecordBatch(o,s)}}return null}_readDictionaryBatch(t){var r;let n=(r=this._footer)===null||r===void 0?void 0:r.getDictionaryBatch(t);if(n&&this._handle.seek(n.offset)){let i=this._reader.readMessage(pe.DictionaryBatch);if(i?.isDictionaryBatch()){let o=i.header(),s=this._reader.readMessageBody(i.bodyLength),a=this._loadDictionaryBatch(o,s);this.dictionaries.set(o.id,a)}}}_readFooter(){let{_handle:t}=this,r=t.size-QA,n=t.readInt32(r),i=t.readAt(r-n,n);return Ga.decode(i)}_readNextMessageAndValidate(t){var r;if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){let n=(r=this._footer)===null||r===void 0?void 0:r.getRecordBatch(this._recordBatchIndex);if(n&&this._handle.seek(n.offset))return this._reader.readMessage(t)}return null}},JA=class extends Ud{get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}constructor(t,...r){let n=typeof r[0]!="number"?r.shift():void 0,i=r[0]instanceof Map?r.shift():void 0;super(t instanceof dl?t:new dl(t,n),i)}isFile(){return!0}isAsync(){return!0}open(t){let r=Object.create(null,{open:{get:()=>super.open}});return P(this,void 0,void 0,function*(){if(!this.closed&&!this._footer){this.schema=(this._footer=yield this._readFooter()).schema;for(let n of this._footer.dictionaryBatches())n&&(yield this._readDictionaryBatch(this._dictionaryIndex++))}return yield r.open.call(this,t)})}readRecordBatch(t){var r;return P(this,void 0,void 0,function*(){if(this.closed)return null;this._footer||(yield this.open());let n=(r=this._footer)===null||r===void 0?void 0:r.getRecordBatch(t);if(n&&(yield this._handle.seek(n.offset))){let i=yield this._reader.readMessage(pe.RecordBatch);if(i?.isRecordBatch()){let o=i.header(),s=yield this._reader.readMessageBody(i.bodyLength);return this._loadRecordBatch(o,s)}}return null})}_readDictionaryBatch(t){var r;return P(this,void 0,void 0,function*(){let n=(r=this._footer)===null||r===void 0?void 0:r.getDictionaryBatch(t);if(n&&(yield this._handle.seek(n.offset))){let i=yield this._reader.readMessage(pe.DictionaryBatch);if(i?.isDictionaryBatch()){let o=i.header(),s=yield this._reader.readMessageBody(i.bodyLength),a=this._loadDictionaryBatch(o,s);this.dictionaries.set(o.id,a)}}})}_readFooter(){return P(this,void 0,void 0,function*(){let{_handle:t}=this;t._pending&&(yield t._pending);let r=t.size-QA,n=yield t.readInt32(r),i=yield t.readAt(r-n,n);return Ga.decode(i)})}_readNextMessageAndValidate(t){return P(this,void 0,void 0,function*(){if(this._footer||(yield this.open()),this._footer&&this._recordBatchIndex<this.numRecordBatches){let r=this._footer.getRecordBatch(this._recordBatchIndex);if(r&&(yield this._handle.seek(r.offset)))return yield this._reader.readMessage(t)}return null})}},tM=class extends Cd{constructor(t,r){super(t,r)}_loadVectors(t,r,n){return new e_(r,t.nodes,t.buffers,this.dictionaries).visitMany(n)}};function B6(e,t){return t&&typeof t.autoDestroy=="boolean"?t.autoDestroy:e.autoDestroy}function*M6(e){let t=Li.from(e);try{if(!t.open({autoDestroy:!1}).closed)do yield t;while(!t.reset().open().closed)}finally{t.cancel()}}function E6(e){return ke(this,arguments,function*(){let r=yield G(Li.from(e));try{if(!(yield G(r.open({autoDestroy:!1}))).closed)do yield yield G(r);while(!(yield G(r.reset().open())).closed)}finally{yield G(r.cancel())}})}function QX(e){return new ec(new tM(e))}function JX(e){let t=e.peek(kd+7&-8);return t&&t.byteLength>=4?B_(t)?new ju(new N_(e.read())):new ec(new Cd(e)):new ec(new Cd(function*(){}()))}function tH(e){return P(this,void 0,void 0,function*(){let t=yield e.peek(kd+7&-8);return t&&t.byteLength>=4?B_(t)?new ju(new N_(yield e.read())):new Vu(new Ud(e)):new Vu(new Ud(function(){return ke(this,arguments,function*(){})}()))})}function eH(e){return P(this,void 0,void 0,function*(){let{size:t}=yield e.stat(),r=new dl(e,t);return t>=A6&&B_(yield r.readAt(0,kd+7&-8))?new O_(new JA(r)):new Vu(new Ud(r))})}var yr=class e extends _t{static assemble(...t){let r=i=>i.flatMap(o=>Array.isArray(o)?r(o):o instanceof ar?o.data.children:o.data),n=new e;return n.visitMany(r(t)),n}constructor(){super(),this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}visit(t){if(t instanceof se)return this.visitMany(t.data),this;let{type:r}=t;if(!pt.isDictionary(r)){let{length:n,nullCount:i}=t;if(n>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");pt.isNull(r)||Qo.call(this,i<=0?new Uint8Array(0):vd(t.offset,n,t.nullBitmap)),this.nodes.push(new Ko(n,i))}return super.visit(t)}visitNull(t){return this}visitDictionary(t){return this.visit(t.clone(t.type.indices))}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}};function Qo(e){let t=e.byteLength+7&-8;return this.buffers.push(e),this.bufferRegions.push(new ci(this._byteLength,t)),this._byteLength+=t,this}function rH(e){let{type:t,length:r,typeIds:n,valueOffsets:i}=e;if(Qo.call(this,n),t.mode===sr.Sparse)return eM.call(this,e);if(t.mode===sr.Dense){if(e.offset<=0)return Qo.call(this,i),eM.call(this,e);{let o=n.reduce((u,f)=>Math.max(u,f),n[0]),s=new Int32Array(o+1),a=new Int32Array(o+1).fill(-1),c=new Int32Array(r),l=xm(-i[0],r,i);for(let u,f,d=-1;++d<r;)(f=a[u=n[d]])===-1&&(f=a[u]=l[u]),c[d]=l[d]-f,++s[u];Qo.call(this,c);for(let u,f=-1,d=t.children.length;++f<d;)if(u=e.children[f]){let h=t.typeIds[f],p=Math.min(r,s[h]);this.visit(u.slice(a[h],p))}}}return this}function nH(e){let t;return e.nullCount>=e.length?Qo.call(this,new Uint8Array(0)):(t=e.values)instanceof Uint8Array?Qo.call(this,vd(e.offset,e.length,t)):Qo.call(this,Fu(e.values))}function hl(e){return Qo.call(this,e.values.subarray(0,e.length*e.stride))}function O6(e){let{length:t,values:r,valueOffsets:n}=e,i=n[0],o=n[t],s=Math.min(o-i,r.byteLength-i);return Qo.call(this,xm(-n[0],t,n)),Qo.call(this,r.subarray(i,i+s)),this}function rM(e){let{length:t,valueOffsets:r}=e;return r&&Qo.call(this,xm(r[0],t,r)),this.visit(e.children[0])}function eM(e){return this.visitMany(e.type.children.map((t,r)=>e.children[r]).filter(Boolean))[0]}yr.prototype.visitBool=nH;yr.prototype.visitInt=hl;yr.prototype.visitFloat=hl;yr.prototype.visitUtf8=O6;yr.prototype.visitBinary=O6;yr.prototype.visitFixedSizeBinary=hl;yr.prototype.visitDate=hl;yr.prototype.visitTimestamp=hl;yr.prototype.visitTime=hl;yr.prototype.visitDecimal=hl;yr.prototype.visitList=rM;yr.prototype.visitStruct=eM;yr.prototype.visitUnion=rH;yr.prototype.visitInterval=hl;yr.prototype.visitFixedSizeList=rM;yr.prototype.visitMap=rM;var qu=class extends Ru{static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,r){throw new Error('"throughDOM" not available in this environment')}constructor(t){super(),this._position=0,this._started=!1,this._sink=new Us,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,Ln(t)||(t={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy=typeof t.autoDestroy=="boolean"?t.autoDestroy:!0,this._writeLegacyIpcFormat=typeof t.writeLegacyIpcFormat=="boolean"?t.writeLegacyIpcFormat:!1}toString(t=!1){return this._sink.toString(t)}toUint8Array(t=!1){return this._sink.toUint8Array(t)}writeAll(t){return Ai(t)?t.then(r=>this.writeAll(r)):co(t)?iM(this,t):nM(this,t)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream(t){return this._sink.toDOMStream(t)}toNodeStream(t){return this._sink.toNodeStream(t)}close(){return this.reset()._sink.close()}abort(t){return this.reset()._sink.abort(t)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset(t=this._sink,r=null){return t===this._sink||t instanceof Us?this._sink=t:(this._sink=new Us,t&&JN(t)?this.toDOMStream({type:"bytes"}).pipeTo(t):t&&tD(t)&&this.toNodeStream({objectMode:!1}).pipe(t)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,(!r||!$u(r,this._schema))&&(r==null?(this._position=0,this._schema=null):(this._started=!0,this._schema=r,this._writeSchema(r))),this}write(t){let r=null;if(this._sink){if(t==null)return this.finish()&&void 0;if(t instanceof ai&&!(r=t.schema))return this.finish()&&void 0;if(t instanceof ar&&!(r=t.schema))return this.finish()&&void 0}else throw new Error("RecordBatchWriter is closed");if(r&&!$u(r,this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,r)}t instanceof ar?t instanceof zu||this._writeRecordBatch(t):t instanceof ai?this.writeAll(t.batches):Co(t)&&this.writeAll(t)}_writeMessage(t,r=8){let n=r-1,i=ui.encode(t),o=i.byteLength,s=this._writeLegacyIpcFormat?4:8,a=o+s+n&~n,c=a-o-s;return t.headerType===pe.RecordBatch?this._recordBatchBlocks.push(new Xa(a,t.bodyLength,this._position)):t.headerType===pe.DictionaryBatch&&this._dictionaryBlocks.push(new Xa(a,t.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(a-s)),o>0&&this._write(i),this._writePadding(c)}_write(t){if(this._started){let r=Rt(t);r&&r.byteLength>0&&(this._sink.write(r),this._position+=r.byteLength)}return this}_writeSchema(t){return this._writeMessage(ui.from(t))}_writeFooter(t){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(Rd)}_writePadding(t){return t>0?this._write(new Uint8Array(t)):this}_writeRecordBatch(t){let{byteLength:r,nodes:n,bufferRegions:i,buffers:o}=yr.assemble(t),s=new rn(t.numRows,n,i),a=ui.from(s,r);return this._writeDictionaries(t)._writeMessage(a)._writeBodyBuffers(o)}_writeDictionaryBatch(t,r,n=!1){this._dictionaryDeltaOffsets.set(r,t.length+(this._dictionaryDeltaOffsets.get(r)||0));let{byteLength:i,nodes:o,bufferRegions:s,buffers:a}=yr.assemble(new se([t])),c=new rn(t.length,o,s),l=new li(c,r,n),u=ui.from(l,i);return this._writeMessage(u)._writeBodyBuffers(a)}_writeBodyBuffers(t){let r,n,i;for(let o=-1,s=t.length;++o<s;)(r=t[o])&&(n=r.byteLength)>0&&(this._write(r),(i=(n+7&-8)-n)>0&&this._writePadding(i));return this}_writeDictionaries(t){for(let[r,n]of t.dictionaries){let i=this._dictionaryDeltaOffsets.get(r)||0;if(i===0||(n=n?.slice(i)).length>0)for(let o of n.data)this._writeDictionaryBatch(o,r,i>0),i+=o.length}return this}},hy=class e extends qu{static writeAll(t,r){let n=new e(r);return Ai(t)?t.then(i=>n.writeAll(i)):co(t)?iM(n,t):nM(n,t)}},py=class e extends qu{static writeAll(t){let r=new e;return Ai(t)?t.then(n=>r.writeAll(n)):co(t)?iM(r,t):nM(r,t)}constructor(){super(),this._autoDestroy=!0}_writeSchema(t){return this._writeMagic()._writePadding(2)}_writeFooter(t){let r=Ga.encode(new Ga(t,tn.V4,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter(t)._write(r)._write(Int32Array.of(r.byteLength))._writeMagic()}};function nM(e,t){let r=t;t instanceof ai&&(r=t.batches,e.reset(void 0,t.schema));for(let n of r)e.write(n);return e.finish()}function iM(e,t){var r,n,i,o,s,a,c;return P(this,void 0,void 0,function*(){try{for(r=!0,n=or(t);i=yield n.next(),o=i.done,!o;){c=i.value,r=!1;try{let l=c;e.write(l)}finally{r=!0}}}catch(l){s={error:l}}finally{try{!r&&!o&&(a=n.return)&&(yield a.call(n))}finally{if(s)throw s.error}}return e.finish()})}function F6(e,t){if(co(e))return oH(e,t);if(Co(e))return iH(e,t);throw new Error("toDOMStream() must be called with an Iterable or AsyncIterable")}function iH(e,t){let r=null,n=t?.type==="bytes"||!1,i=t?.highWaterMark||Math.pow(2,24);return new ReadableStream(Object.assign(Object.assign({},t),{start(s){o(s,r||(r=e[Symbol.iterator]()))},pull(s){r?o(s,r):s.close()},cancel(){(r?.return&&r.return()||!0)&&(r=null)}}),Object.assign({highWaterMark:n?i:void 0},t));function o(s,a){let c,l=null,u=s.desiredSize||null;for(;!(l=a.next(n?u:null)).done;)if(ArrayBuffer.isView(l.value)&&(c=Rt(l.value))&&(u!=null&&n&&(u=u-c.byteLength+1),l.value=c),s.enqueue(l.value),u!=null&&--u<=0)return;s.close()}}function oH(e,t){let r=null,n=t?.type==="bytes"||!1,i=t?.highWaterMark||Math.pow(2,24);return new ReadableStream(Object.assign(Object.assign({},t),{start(s){return P(this,void 0,void 0,function*(){yield o(s,r||(r=e[Symbol.asyncIterator]()))})},pull(s){return P(this,void 0,void 0,function*(){r?yield o(s,r):s.close()})},cancel(){return P(this,void 0,void 0,function*(){(r?.return&&(yield r.return())||!0)&&(r=null)})}}),Object.assign({highWaterMark:n?i:void 0},t));function o(s,a){return P(this,void 0,void 0,function*(){let c,l=null,u=s.desiredSize||null;for(;!(l=yield a.next(n?u:null)).done;)if(ArrayBuffer.isView(l.value)&&(c=Rt(l.value))&&(u!=null&&n&&(u=u-c.byteLength+1),l.value=c),s.enqueue(l.value),u!=null&&--u<=0)return;s.close()})}}function L6(e){return new oM(e)}var oM=class{constructor(t){this._numChunks=0,this._finished=!1,this._bufferedSize=0;let{["readableStrategy"]:r,["writableStrategy"]:n,["queueingStrategy"]:i="count"}=t,o=ux(t,["readableStrategy","writableStrategy","queueingStrategy"]);this._controller=null,this._builder=Cu(o),this._getSize=i!=="bytes"?N6:D6;let{["highWaterMark"]:s=i==="bytes"?Math.pow(2,14):1e3}=Object.assign({},r),{["highWaterMark"]:a=i==="bytes"?Math.pow(2,14):1e3}=Object.assign({},n);this.readable=new ReadableStream({cancel:()=>{this._builder.clear()},pull:c=>{this._maybeFlush(this._builder,this._controller=c)},start:c=>{this._maybeFlush(this._builder,this._controller=c)}},{highWaterMark:s,size:i!=="bytes"?N6:D6}),this.writable=new WritableStream({abort:()=>{this._builder.clear()},write:()=>{this._maybeFlush(this._builder,this._controller)},close:()=>{this._maybeFlush(this._builder.finish(),this._controller)}},{highWaterMark:a,size:c=>this._writeValueAndReturnChunkSize(c)})}_writeValueAndReturnChunkSize(t){let r=this._bufferedSize;return this._bufferedSize=this._getSize(this._builder.append(t)),this._bufferedSize-r}_maybeFlush(t,r){r!=null&&(this._bufferedSize>=r.desiredSize&&++this._numChunks&&this._enqueue(r,t.toVector()),t.finished&&((t.length>0||this._numChunks===0)&&++this._numChunks&&this._enqueue(r,t.toVector()),!this._finished&&(this._finished=!0)&&this._enqueue(r,null)))}_enqueue(t,r){this._bufferedSize=0,this._controller=null,r==null?t.close():t.enqueue(r)}},N6=e=>{var t;return(t=e?.length)!==null&&t!==void 0?t:0},D6=e=>{var t;return(t=e?.byteLength)!==null&&t!==void 0?t:0};function D_(e,t){let r=new Us,n=null,i=new ReadableStream({cancel(){return P(this,void 0,void 0,function*(){yield r.close()})},start(a){return P(this,void 0,void 0,function*(){yield s(a,n||(n=yield o()))})},pull(a){return P(this,void 0,void 0,function*(){n?yield s(a,n):a.close()})}});return{writable:new WritableStream(r,Object.assign({highWaterMark:Math.pow(2,14)},e)),readable:i};function o(){return P(this,void 0,void 0,function*(){return yield(yield Li.from(r)).open(t)})}function s(a,c){return P(this,void 0,void 0,function*(){let l=a.desiredSize,u=null;for(;!(u=yield c.next()).done;)if(a.enqueue(u.value),l!=null&&--l<=0)return;a.close()})}}function L_(e,t){let r=new this(e),n=new fo(r),i=new ReadableStream({cancel(){return P(this,void 0,void 0,function*(){yield n.cancel()})},pull(s){return P(this,void 0,void 0,function*(){yield o(s)})},start(s){return P(this,void 0,void 0,function*(){yield o(s)})}},Object.assign({highWaterMark:Math.pow(2,14)},t));return{writable:new WritableStream(r,e),readable:i};function o(s){return P(this,void 0,void 0,function*(){let a=null,c=s.desiredSize;for(;a=yield n.read(c||null);)if(s.enqueue(a),c!=null&&(c-=a.byteLength)<=0)return;s.close()})}}function Yu(e){let t=Li.from(e);return Ai(t)?t.then(r=>Yu(r)):t.isAsync()?t.readAll().then(r=>new ai(r)):new ai(t.readAll())}var aH=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},gA),VA),DA),bA),pA),NA),{compareSchemas:$u,compareFields:a6,compareTypes:c6});Jr.toDOMStream=F6;Ve.throughDOM=L6;Li.throughDOM=D_;ju.throughDOM=D_;ec.throughDOM=D_;qu.throughDOM=L_;py.throughDOM=L_;hy.throughDOM=L_;function R_(e="ws://localhost:3000/"){let t=[],r=!1,n=null,i,o={open(){r=!0,c()},close(){for(r=!1,n=null,i=null;t.length;)t.shift().reject("Socket closed")},error(l){if(n){let{reject:u}=n;n=null,c(),u(l)}else console.error("WebSocket error: ",l)},message({data:l}){if(n){let{query:u,resolve:f,reject:d}=n;if(n=null,c(),typeof l=="string"){let h=JSON.parse(l);h.error?d(h.error):f(h)}else if(u.type==="exec")f();else if(u.type==="arrow")f(Yu(l.arrayBuffer()));else throw new Error(`Unexpected socket data: ${l}`)}else console.log("WebSocket message: ",l)}};function s(){i=new WebSocket(e);for(let l in o)i.addEventListener(l,o[l])}function a(l,u,f){i==null&&s(),t.push({query:l,resolve:u,reject:f}),r&&!n&&c()}function c(){t.length&&(n=t.shift(),i.send(JSON.stringify(n.query)))}return{get connected(){return r},query(l){return new Promise((u,f)=>a(l,u,f))}}}function R6(e){switch(e){case"BIGINT":case"HUGEINT":case"INTEGER":case"SMALLINT":case"TINYINT":case"UBIGINT":case"UINTEGER":case"USMALLINT":case"UTINYINT":case"DOUBLE":case"FLOAT":case"REAL":case"DECIMAL":return"number";case"DATE":case"TIMESTAMP":case"TIMESTAMPTZ":case"TIME":return"date";case"BOOLEAN":return"boolean";case"VARCHAR":case"UUID":return"string";case"LIST":return"array";case"BLOB":case"STRUCT":case"MAP":return"object";default:throw new Error(`Unsupported type: ${e}`)}}var fi=class{constructor(t,r){t&&(this.table=String(t)),r&&(this.column=r)}get columns(){return this.column?[this.column]:[]}toString(){let{table:t,column:r}=this;if(r){let n=r.startsWith("*")?r:`"${r}"`;return`${t?`"${t}".`:""}${n}`}else return t?`"${t}"`:"NULL"}};function k6(e,t){return e instanceof fi&&e.column===t}function ae(e){return typeof e=="string"?Wu(e):e}function my(e){return typeof e=="string"?C6(e):e}function C6(e){return new fi(e)}function Wu(e,t){return arguments.length===1&&(t=e,e=null),new fi(e,t)}function zs(e){switch(typeof e){case"boolean":return e?"TRUE":"FALSE";case"string":return`'${e}'`;case"number":return Number.isFinite(e)?String(e):"NULL";default:if(e==null)return"NULL";if(e instanceof Date){let t=+e;if(Number.isNaN(t))return"NULL";let r=e.getUTCFullYear(),n=e.getUTCMonth(),i=e.getUTCDate();return t===Date.UTC(r,n,i)?`MAKE_DATE(${r}, ${n+1}, ${i})`:`EPOCH_MS(${t})`}else return e instanceof RegExp?`'${e.source}'`:String(e)}}var rc=e=>typeof e?.addEventListener=="function";function k_(e){return e instanceof pl}var pl=class{constructor(t,r,n){this._expr=Array.isArray(t)?t:[t],this._deps=r||[],this.annotate(n);let i=this._expr.filter(o=>rc(o));i.length>0?(this._params=Array.from(new Set(i)),this._params.forEach(o=>{o.addEventListener("value",()=>cH(this,this.map?.get("value")))})):this.addEventListener=void 0}get value(){return this}get columns(){let{_params:t,_deps:r}=this;if(t){let n=new Set(t.flatMap(i=>{let o=i.value?.columns;return Array.isArray(o)?o:[]}));if(n.size){let i=new Set(r);return n.forEach(o=>i.add(o)),Array.from(i)}}return r}get column(){return this._deps.length?this._deps[0]:this.columns[0]}annotate(...t){return Object.assign(this,...t)}toString(){return this._expr.map(t=>rc(t)&&!k_(t)?zs(t.value):t).join("")}addEventListener(t,r){let n=this.map||(this.map=new Map);(n.get(t)||(n.set(t,new Set),n.get(t))).add(r)}};function cH(e,t){if(t?.size)return Promise.allSettled(Array.from(t,r=>r(e)))}function sM(e,t){let r=[e[0]],n=new Set,i=t.length;for(let o=0,s=0;o<i;){let a=t[o];rc(a)?r[++s]=a:(Array.isArray(a?.columns)&&a.columns.forEach(l=>n.add(l)),r[s]+=typeof a=="string"?a:zs(a));let c=e[++o];rc(r[s])?r[++s]=c:r[s]+=c}return{spans:r,cols:Array.from(n)}}function Y(e,...t){let{spans:r,cols:n}=sM(e,t);return new pl(r,n)}function aM(e){let t=ae(e);return Y`${t} DESC NULLS LAST`.annotate({label:t?.label,desc:!0})}var po=e=>({value:e,toString:()=>zs(e)});function yy(e){e(this.op,this),this.children?.forEach(t=>t.visit(e))}function U6(e,t){let r=t.filter(i=>i!=null).map(ae),n=r.map((i,o)=>o?` ${e} `:"");return t.length&&n.push(""),Y(n,...r).annotate({op:e,children:r,visit:yy})}var di=(...e)=>U6("AND",e.flat()),Pd=(...e)=>U6("OR",e.flat()),lH=e=>t=>Y`(${e} ${ae(t)})`.annotate({op:e,a:t,visit:yy}),P6=lH("NOT"),$6=e=>t=>Y`(${ae(t)} ${e})`.annotate({op:e,a:t,visit:yy}),$d=$6("IS NULL"),ml=$6("IS NOT NULL"),yl=e=>(t,r)=>Y`(${ae(t)} ${e} ${ae(r)})`.annotate({op:e,a:t,b:r,visit:yy}),Vs=yl("="),C_=yl("<>"),gl=yl("<"),zd=yl(">"),bl=yl("<="),z6=yl(">="),V6=yl("IS DISTINCT FROM"),j6=yl("IS NOT DISTINCT FROM");function q6(e,t,r,n){t=ae(t);let i=e.startsWith("NOT ")?"NOT ":"";return(r?n?Y`${i}(${r[0]} <= ${t} AND ${t} < ${r[1]})`:Y`(${t} ${e} ${r[0]} AND ${r[1]})`:Y``).annotate({op:e,visit:yy,field:t,range:r})}var tr=(e,t,r)=>q6("BETWEEN",e,t,r),Y6=(e,t,r)=>q6("NOT BETWEEN",e,t,r);function Gu(e,t){return Array.from({length:e},()=>t)}function mo(e,t){return(...r)=>{let n=r.map(ae),i=t?`::${t}`:"";return(n.length?Y([`${e}(`,...Gu(n.length-1,", "),`)${i}`],...n):Y`${e}()${i}`).annotate({func:e,args:n})}}var cM=mo("REGEXP_MATCHES"),lM=mo("CONTAINS"),uM=mo("PREFIX"),fM=mo("SUFFIX"),uH=mo("LOWER"),fH=mo("UPPER"),dH=mo("LENGTH"),hH=mo("ISNAN"),pH=mo("ISFINITE"),mH=mo("ISINF");var gy=class e extends pl{constructor(t,r,n,i,o="",s="",a=""){let c;if(i&&!(o||s||a))c=i?Y`${r} OVER "${i}"`:Y`${r} OVER ()`;else{let d=o&&s?" ":"",h=(o||s)&&a?" ":"";c=Y`${r} OVER (${i?`"${i}" `:""}${o}${d}${s}${h}${a})`}n&&(c=Y`(${c})::${n}`);let{_expr:u,_deps:f}=c;super(u,f,{window:t,func:r,type:n,name:i,group:o,order:s,frame:a})}get basis(){return this.column}get label(){let{func:t}=this;return t.label??t.toString()}over(t){let{window:r,func:n,type:i,group:o,order:s,frame:a}=this;return new e(r,n,i,t,o,s,a)}partitionby(...t){let r=t.flat().filter(u=>u).map(ae),n=Y(["PARTITION BY ",Gu(r.length-1,", "),""],...r),{window:i,func:o,type:s,name:a,order:c,frame:l}=this;return new e(i,o,s,a,n,c,l)}orderby(...t){let r=t.flat().filter(u=>u).map(ae),n=Y(["ORDER BY ",Gu(r.length-1,", "),""],...r),{window:i,func:o,type:s,name:a,group:c,frame:l}=this;return new e(i,o,s,a,c,n,l)}rows(t){let r=W6("ROWS",t),{window:n,func:i,type:o,name:s,group:a,order:c}=this;return new e(n,i,o,s,a,c,r)}range(t){let r=W6("RANGE",t),{window:n,func:i,type:o,name:s,group:a,order:c}=this;return new e(n,i,o,s,a,c,r)}};function W6(e,t){if(rc(t)){let r=Y`${t}`;return r.toString=()=>`${e} ${G6(t.value)}`,r}return`${e} ${G6(t)}`}function G6(e){let[t,r]=e,n=t===0?"CURRENT ROW":Number.isFinite(t)?`${Math.abs(t)} PRECEDING`:"UNBOUNDED PRECEDING",i=r===0?"CURRENT ROW":Number.isFinite(r)?`${Math.abs(r)} FOLLOWING`:"UNBOUNDED FOLLOWING";return`BETWEEN ${n} AND ${i}`}function Jo(e,t){return(...r)=>{let n=mo(e)(...r);return new gy(e,n,t)}}var U_=Jo("ROW_NUMBER","INTEGER"),P_=Jo("RANK","INTEGER"),$_=Jo("DENSE_RANK","INTEGER"),z_=Jo("PERCENT_RANK"),V_=Jo("CUME_DIST"),j_=Jo("NTILE"),q_=Jo("LAG"),Y_=Jo("LEAD"),W_=Jo("FIRST_VALUE"),G_=Jo("LAST_VALUE"),X_=Jo("NTH_VALUE");function X6(e,...t){return Y(e,...t).annotate({aggregate:!0})}var dM=class e extends pl{constructor(t,r,n,i,o){r=(r||[]).map(ae);let{strings:s,exprs:a}=yH(t,r,n,i,o),{spans:c,cols:l}=sM(s,a);super(c,l,{aggregate:t,args:r,type:n,isDistinct:i,filter:o})}get basis(){return this.column}get label(){let{aggregate:t,args:r,isDistinct:n}=this,i=n?"DISTINCT"+(r.length?" ":""):"",o=r.length?`(${i}${r.map(gH).join(", ")})`:"";return`${t.toLowerCase()}${o}`}distinct(){let{aggregate:t,args:r,type:n,filter:i}=this;return new e(t,r,n,!0,i)}where(t){let{aggregate:r,args:n,type:i,isDistinct:o}=this;return new e(r,n,i,o,t)}window(){let{aggregate:t,args:r,type:n,isDistinct:i}=this,o=new e(t,r,null,i);return new gy(t,o,n)}partitionby(...t){return this.window().partitionby(...t)}orderby(...t){return this.window().orderby(...t)}rows(t,r){return this.window().rows(t,r)}range(t,r){return this.window().range(t,r)}};function yH(e,t,r,n,i){let o=`)${r?`::${r}`:""}`,s=[`${e}(${n?"DISTINCT ":""}`],a=[];return t.length?(s=s.concat([...Gu(t.length-1,", "),`${o}${i?" FILTER (WHERE ":""}`,...i?[")"]:[]]),a=[...t,...i?[i]:[]]):s[0]+="*"+o,{exprs:a,strings:s}}function gH(e){let t=zs(e);return t&&t.startsWith('"')&&t.endsWith('"')?t.slice(1,-1):t}function de(e,t){return(...r)=>new dM(e,r,t)}var hi=de("COUNT","INTEGER"),H_=de("AVG"),bH=de("AVG"),H6=de("MAD"),Ri=de("MAX"),ki=de("MIN"),pi=de("SUM","DOUBLE"),Z6=de("PRODUCT"),Z_=de("MEDIAN"),K_=de("QUANTILE"),Q_=de("MODE"),K6=de("VARIANCE"),Q6=de("STDDEV"),J6=de("SKEWNESS"),tL=de("KURTOSIS"),eL=de("ENTROPY"),rL=de("VAR_POP"),nL=de("STDDEV_POP"),iL=de("CORR"),oL=de("COVAR_POP"),hM=de("REGR_INTERCEPT"),pM=de("REGR_SLOPE"),mM=de("REGR_COUNT"),xH=de("REGR_R2"),yM=de("REGR_SYY"),gM=de("REGR_SXX"),_H=de("REGR_SXY"),bM=de("REGR_AVGX"),wH=de("REGR_AVGY"),vH=de("FIRST"),sL=de("LAST"),by=de("ARG_MIN"),xy=de("ARG_MAX"),aL=de("STRING_AGG"),cL=de("ARRAY_AGG");function J_(e,t){let r=ae(e),n=Y`CAST(${r} AS ${t})`;return Object.defineProperty(n,"label",{enumerable:!0,get(){return e.label}}),Object.defineProperty(n,"aggregate",{enumerable:!0,get(){return e.aggregate||!1}}),n}var _y=e=>J_(e,"DOUBLE"),lL=e=>J_(e,"INTEGER");var wy=e=>{let t=ae(e);return Y`(1000 * (epoch(${t}) - second(${t})) + millisecond(${t}))::DOUBLE`},t1=e=>{let t=ae(e);return Y`MAKE_DATE(2012, MONTH(${t}), 1)`.annotate({label:"month"})},e1=e=>{let t=ae(e);return Y`MAKE_DATE(2012, MONTH(${t}), DAY(${t}))`.annotate({label:"date"})},r1=e=>{let t=ae(e);return Y`MAKE_DATE(2012, 1, DAY(${t}))`.annotate({label:"date"})};var yt=class e{static select(...t){return new e().select(...t)}static from(...t){return new e().from(...t)}static with(...t){return new e().with(...t)}static union(...t){return new Xu("UNION",t.flat())}static unionAll(...t){return new Xu("UNION ALL",t.flat())}static intersect(...t){return new Xu("INTERSECT",t.flat())}static except(...t){return new Xu("EXCEPT",t.flat())}constructor(){this.query={with:[],select:[],from:[],where:[],groupby:[],having:[],window:[],qualify:[],orderby:[]}}clone(){let t=new e;return t.query={...this.query},t}with(...t){let{query:r}=this;if(t.length===0)return r.with;{let n=[],i=(o,s)=>{let a=s.clone();a.cteFor=this,n.push({as:o,query:a})};return t.flat().forEach(o=>{if(o!=null)if(o.as&&o.query)i(o.as,o.query);else for(let s in o)i(s,o[s])}),r.with=r.with.concat(n),this}}select(...t){let{query:r}=this;if(t.length===0)return r.select;{let n=[];for(let i of t.flat())if(i!=null)if(typeof i=="string")n.push({as:i,expr:ae(i)});else if(i instanceof fi)n.push({as:i.column,expr:i});else if(Array.isArray(i))n.push({as:i[0],expr:i[1]});else for(let o in i)n.push({as:n1(o),expr:ae(i[o])});return r.select=r.select.concat(n),this}}$select(...t){return this.query.select=[],this.select(...t)}distinct(t=!0){return this.query.distinct=!!t,this}from(...t){let{query:r}=this;if(t.length===0)return r.from;{let n=[];return t.flat().forEach(i=>{if(i!=null)if(typeof i=="string")n.push({as:i,from:my(i)});else if(i instanceof fi)n.push({as:i.table,from:i});else if(i1(i)||k_(i))n.push({from:i});else if(Array.isArray(i))n.push({as:n1(i[0]),from:my(i[1])});else for(let o in i)n.push({as:n1(o),from:my(i[o])})}),r.from=r.from.concat(n),this}}$from(...t){return this.query.from=[],this.from(...t)}sample(t,r){let{query:n}=this;if(arguments.length===0)return n.sample;{let i=t;return typeof t=="number"&&(i=t>0&&t<1?{perc:100*t,method:r}:{rows:Math.round(t),method:r}),n.sample=i,this}}where(...t){let{query:r}=this;return t.length===0?r.where:(r.where=r.where.concat(t.flat().filter(n=>n)),this)}$where(...t){return this.query.where=[],this.where(...t)}groupby(...t){let{query:r}=this;return t.length===0?r.groupby:(r.groupby=r.groupby.concat(t.flat().filter(n=>n).map(ae)),this)}$groupby(...t){return this.query.groupby=[],this.groupby(...t)}having(...t){let{query:r}=this;return t.length===0?r.having:(r.having=r.having.concat(t.flat().filter(n=>n)),this)}window(...t){let{query:r}=this;if(t.length===0)return r.window;{let n=[];return t.flat().forEach(i=>{if(i!=null)for(let o in i)n.push({as:n1(o),expr:i[o]})}),r.window=r.window.concat(n),this}}qualify(...t){let{query:r}=this;return t.length===0?r.qualify:(r.qualify=r.qualify.concat(t.flat().filter(n=>n)),this)}orderby(...t){let{query:r}=this;return t.length===0?r.orderby:(r.orderby=r.orderby.concat(t.flat().filter(n=>n).map(ae)),this)}limit(t){let{query:r}=this;return arguments.length===0?r.limit:(r.limit=Number.isFinite(t)?t:void 0,this)}offset(t){let{query:r}=this;return arguments.length===0?r.offset:(r.offset=Number.isFinite(t)?t:void 0,this)}get subqueries(){let{query:t,cteFor:r}=this,i=(r?.query||t).with?.reduce((s,{as:a,query:c})=>(s[a]=c,s),{}),o=[];return t.from.forEach(({from:s})=>{if(i1(s))o.push(s);else if(i[s.table]){let a=i[s.table];o.push(a)}}),o}toString(){let{select:t,distinct:r,from:n,sample:i,where:o,groupby:s,having:a,window:c,qualify:l,orderby:u,limit:f,offset:d,with:h}=this.query,p=[];if(h.length){let g=h.map(({as:y,query:b})=>`"${y}" AS (${b})`);p.push(`WITH ${g.join(", ")}`)}let m=t.map(({as:g,expr:y})=>k6(y,g)&&!y.table?`${y}`:`${y} AS "${g}"`);if(p.push(`SELECT${r?" DISTINCT":""} ${m.join(", ")}`),n.length){let g=n.map(({as:y,from:b})=>{let x=i1(b)?`(${b})`:`${b}`;return!y||y===b.table?x:`${x} AS "${y}"`});p.push(`FROM ${g.join(", ")}`)}if(o.length){let g=o.map(String).filter(y=>y).join(" AND ");g&&p.push(`WHERE ${g}`)}if(i){let{rows:g,perc:y,method:b,seed:x}=i,_=g?`${g} ROWS`:`${y} PERCENT`,w=b?` (${b}${x!=null?`, ${x}`:""})`:"";p.push(`USING SAMPLE ${_}${w}`)}if(s.length&&p.push(`GROUP BY ${s.join(", ")}`),a.length){let g=a.map(String).filter(y=>y).join(" AND ");g&&p.push(`HAVING ${g}`)}if(c.length){let g=c.map(({as:y,expr:b})=>`"${y}" AS (${b})`);p.push(`WINDOW ${g.join(", ")}`)}if(l.length){let g=l.map(String).filter(y=>y).join(" AND ");g&&p.push(`QUALIFY ${g}`)}return u.length&&p.push(`ORDER BY ${u.join(", ")}`),Number.isFinite(f)&&p.push(`LIMIT ${f}`),Number.isFinite(d)&&p.push(`OFFSET ${d}`),p.join(" ")}},Xu=class e{constructor(t,r){this.op=t,this.queries=r.map(n=>n.clone()),this.query={orderby:[]}}clone(){let t=new e(this.op,this.queries);return t.query={...this.query},t}orderby(...t){let{query:r}=this;return t.length===0?r.orderby:(r.orderby=r.orderby.concat(t.flat().filter(n=>n).map(ae)),this)}limit(t){let{query:r}=this;return arguments.length===0?r.limit:(r.limit=Number.isFinite(t)?t:void 0,this)}offset(t){let{query:r}=this;return arguments.length===0?r.offset:(r.offset=Number.isFinite(t)?t:void 0,this)}get subqueries(){let{queries:t,cteFor:r}=this;return r&&t.forEach(n=>n.cteFor=r),t}toString(){let{op:t,queries:r,query:{orderby:n,limit:i,offset:o}}=this,s=[r.join(` ${t} `)];return n.length&&s.push(`ORDER BY ${n.join(", ")}`),Number.isFinite(i)&&s.push(`LIMIT ${i}`),Number.isFinite(o)&&s.push(`OFFSET ${o}`),s.join(" ")}};function i1(e){return e instanceof yt||e instanceof Xu}function n1(e){return SH(e)?e.slice(1,-1):e}function SH(e){return e[0]==='"'&&e[e.length-1]==='"'}function xl(e,t,{replace:r=!1,temp:n=!0,view:i=!1}={}){return"CREATE"+(r?" OR REPLACE ":" ")+(n?"TEMP ":"")+(i?"VIEW":"TABLE")+(r?" ":" IF NOT EXISTS ")+e+" AS "+t}function uL(e,{columns:t=Object.keys(e?.[0]||{})}={}){let r=[];if(Array.isArray(t)?(r=t,t=r.reduce((i,o)=>(i[o]=o,i),{})):t&&(r=Object.keys(t)),!r.length)throw new Error("Can not create table from empty column set.");let n=[];for(let i of e){let o=r.map(s=>`${zs(i[s])} AS "${t[s]}"`);n.push(`(SELECT ${o.join(", ")})`)}return n.join(" UNION ALL ")}function xM(e,t,r,n={},i={}){let{select:o=["*"],where:s,view:a,temp:c,replace:l,...u}=n,f=IH({...i,...u}),d=`${e}('${r}'${f?", "+f:""})`,h=s?` WHERE ${s}`:"",p=`SELECT ${o.join(", ")} FROM ${d}${h}`;return xl(t,p,{view:a,temp:c,replace:l})}function o1(e,t,r){return xM("read_csv",e,t,r,{auto_detect:!0,sample_size:-1})}function s1(e,t,r){return xM("read_json",e,t,r,{auto_detect:!0,json_format:"auto"})}function a1(e,t,r){return xM("read_parquet",e,t,r)}function c1(e,t,r={}){let{select:n=["*"],...i}=r,o=uL(t),s=n.length===1&&n[0]==="*"?o:`SELECT ${n} FROM ${o}`;return xl(e,s,i)}function IH(e){return Object.entries(e).map(([t,r])=>{let n=typeof r,i=n==="boolean"?String(r):n==="string"?`'${r}'`:r;return`${t}=${i}`}).join(", ")}var TH="count",AH="nulls",MH="max",EH="min",BH="distinct";var OH={[TH]:hi,[BH]:e=>hi(e).distinct(),[MH]:Ri,[EH]:ki,[AH]:e=>hi().where($d(e))};function fL({table:e,column:t},r){return yt.from(e).select(r.map(n=>[n,OH[n](t)]))}var dL=()=>Object.create(null),l1=class{constructor(t){this.mc=t,this.clear()}clear(){this.tables=dL()}tableInfo(t){let r=this.tables;if(r[t])return r[t];let n=FH(this.mc,t).catch(i=>{throw r[t]=null,i});return r[t]=n}async fieldInfo({table:t,column:r,stats:n}){let o=(await this.tableInfo(t))[r];if(o==null)return;if(!n?.length)return o;let s=await this.mc.query(fL(o,n),{persist:!0}),a={...o,...Array.from(s)[0]};for(let c in a){let l=a[c];typeof l=="bigint"&&(a[c]=Number(l))}return a}async queryFields(t){let r=await NH(this,t);return(await Promise.all(r.map(i=>this.fieldInfo(i)))).filter(i=>i)}};async function FH(e,t){let r=await e.query(`DESCRIBE "${t}"`,{type:"json",cache:!1}),n=dL();for(let i of r)n[i.column_name]={table:t,column:i.column_name,sqlType:i.column_type,type:R6(i.column_type),nullable:i.null==="YES"};return n}async function NH(e,t){return t.length===1&&t[0].column==="*"?Object.values(await e.tableInfo(t[0].table)):t}function pL(e){let t=2166136261;for(let r=0,n=e.length;r<n;++r){let i=e.charCodeAt(r),o=i&65280;o&&(t=hL(t^o>>8)),t=hL(t^i&255)}return DH(t)}function hL(e){return e+(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24)}function DH(e){return e+=e<<13,e^=e>>>7,e+=e<<3,e^=e>>>17,e+=e<<5,e&4294967295}var gL=e=>e,u1=class{constructor(t,r){this.mc=t,this.selection=r,this.reset()}reset(){this.enabled=!1,this.clients=null,this.indices=null,this.activeView=null}clear(){this.indices&&(this.mc.cancel(Array.from(this.indices.values(),t=>t.result)),this.indices=null)}index(t,r){if(this.clients!==t){let a=Array.from(t,yL),c=a[0]?.from;this.enabled=a.every(l=>l&&l.from===c),this.clients=t,this.activeView=null,this.clear()}if(!this.enabled)return!1;r=r||this.selection.active;let{source:n}=r;if(n&&n===this.activeView?.source)return!0;if(this.clear(),!n)return!1;let i=this.activeView=LH(r);if(!i)return!1;this.mc.logger().warn("DATA TILE INDEX CONSTRUCTION");let o=this.selection.remove(n),s=this.indices=new Map;for(let a of t){if(o.skip(a,r))continue;let c=yL(a),l=a.query(o.predicate(a)).select({...i.columns,...c.count}).groupby(Object.keys(i.columns)),[u]=l.subqueries;if(u){let m=Object.values(i.columns).map(g=>g.columns[0]);UH(u,m)}let f=l.toString(),h=`tile_index_${(pL(f)>>>0).toString(16)}`,p=CH(this.mc,h,f);s.set(a,{table:h,result:p,...c})}}async update(){let{clients:t,selection:r,activeView:n}=this,i=n.predicate(r.active.predicate);return Promise.all(Array.from(t).map(o=>this.updateClient(o,i)))}async updateClient(t,r){let n=this.indices.get(t);if(!n)return;r||(r=this.activeView.predicate(this.selection.active.predicate));let{table:i,dims:o,aggr:s}=n,a=yt.select(o,s).from(i).groupby(o).where(r);return this.mc.updateClient(t,a)}};function LH(e){let{source:t,schema:r}=e,n=e.predicate?.columns;if(!r||!n)return null;let{type:i,scales:o,pixelSize:s=1}=r,a;if(i==="interval"&&o){let c=o.map(l=>RH(l,s));if(c.some(l=>l==null))return null;c.length===1?(a=l=>l?tr("active0",l.range.map(c[0])):[],n={active0:c[0](e.predicate.field)}):(a=l=>l?di(l.children.map(({range:u},f)=>tr(`active${f}`,u.map(c[f])))):[],n=Object.fromEntries(e.predicate.children.map((l,u)=>[`active${u}`,c[u](l.field)])))}else if(i==="point")a=gL,n=Object.fromEntries(n.map(c=>[c.toString(),c]));else return null;return{source:t,columns:n,predicate:a}}function RH(e,t){let{type:r,domain:n,range:i}=e,o,s;switch(r){case"linear":o=gL,s=ae;break;case"log":o=Math.log,s=a=>Y`LN(${ae(a)})`;break;case"symlog":o=a=>Math.sign(a)*Math.log1p(Math.abs(a)),s=a=>(a=ae(a),Y`SIGN(${a}) * LN(1 + ABS(${a}))`);break;case"sqrt":o=Math.sqrt,s=a=>Y`SQRT(${ae(a)})`;break;case"utc":case"time":o=a=>+a,s=a=>a instanceof Date?+a:wy(ae(a));break}return o?kH(n,i,t,o,s):null}function kH(e,t,r,n,i){let o=n(Math.min(e[0],e[1])),s=n(Math.max(e[0],e[1])),a=Math.abs(n(t[1])-n(t[0]))/(s-o)/r,c=r===1?"":`${r}::INTEGER * `;return l=>Y`${c}FLOOR(${a}::DOUBLE * (${i(l)} - ${o}::DOUBLE))::INTEGER`}function CH(e,t,r){return e.exec(`CREATE TEMP TABLE IF NOT EXISTS ${t} AS ${r}`)}var mL={from:NaN};function yL(e){if(!e.filterIndexable)return mL;let t=e.query(),r=_M(t);if(!r||!t.groupby)return mL;let n=new Set(t.groupby().map(a=>a.column)),i=[],o=[],s;for(let{as:a,expr:{aggregate:c}}of t.select())switch(c?.toUpperCase()){case"COUNT":case"SUM":i.push({[a]:Y`SUM("${a}")::DOUBLE`});break;case"AVG":s="_count_",i.push({[a]:Y`(SUM("${a}" * ${s}) / SUM(${s}))::DOUBLE`});break;case"MAX":i.push({[a]:Y`MAX("${a}")`});break;case"MIN":i.push({[a]:Y`MIN("${a}")`});break;default:if(n.has(a))o.push(a);else return null}return{aggr:i,dims:o,count:s?{[s]:Y`COUNT(*)`}:{},from:r}}function _M(e){let t=e.subqueries;if(e.select){let n=e.from();if(!n.length)return;if(t.length===0)return n[0].from.table}let r=_M(t[0]);for(let n=1;n<t.length;++n){let i=_M(t[n]);if(i!==void 0&&i!==r)return NaN}return r}function UH(e,t){let r=new Set,n=i=>{r.has(i)||(r.add(i),i.select&&i.from().length&&i.select(t),i.subqueries.forEach(n))};n(e)}var f1=class{constructor(t,r,n=!0){this.mc=t,this.selection=r,this.clients=new Set,this.indexer=n?new u1(this.mc,r):null;let{value:i,activate:o}=this.handlers={value:()=>this.update(),activate:s=>this.indexer?.index(this.clients,s)};r.addEventListener("value",i),r.addEventListener("activate",o)}finalize(){let{value:t,activate:r}=this.handlers;this.selection.removeEventListener("value",t),this.selection.removeEventListener("activate",r)}reset(){this.indexer?.reset()}add(t){return(this.clients=new Set(this.clients)).add(t),this}remove(t){return this.clients.has(t)&&(this.clients=new Set(this.clients)).delete(t),this}update(){let{mc:t,indexer:r,clients:n,selection:i}=this;return r?.index(n)?r.update():PH(t,n,i)}};function PH(e,t,r){return Promise.all(Array.from(t).map(n=>{let i=r.predicate(n);if(i!=null)return e.updateClient(n,n.query(i))}))}function d1(){let e,t,r=new Promise((n,i)=>{e=n,t=i});return r.fulfill=n=>(e(n),r),r.reject=n=>(t(n),r),r}function bL(e,t,r){let n=[],i=0;function o(){let s=$H(n,t);n=[],i=0;for(let a of s)VH(a,e,r),YH(a,t)}return{add(s,a){s.request.type==="arrow"?(i=i||requestAnimationFrame(()=>o()),n.push({entry:s,priority:a,index:n.length})):e(s,a)}}}function $H(e,t){let r=[],n=new Map;for(let i of e){let{entry:{request:o}}=i,s=zH(o.query,t);if(!n.has(s)){let a=[];r.push(a),n.set(s,a)}n.get(s).push(i)}return r}function zH(e,t){let r=`${e}`;if(e instanceof yt&&!t.get(r)){if(e.orderby().length||e.where().length||e.qualify().length||e.having().length)return r;let n=e.clone().$select("*"),i=e.groupby();if(i.length){let o={};e.select().forEach(({as:s,expr:a})=>o[s]=a),n.$groupby(i.map(s=>s instanceof fi&&o[s.column]||s))}return`${n}`}else return r}function VH(e,t,r){if(jH(e))t({request:{type:"arrow",cache:!1,record:!1,query:qH(e,r)},result:e.result=d1()});else for(let{entry:n,priority:i}of e)t(n,i)}function jH(e){if(e.length>1){let t=`${e[0].entry.request.query}`;for(let r=1;r<e.length;++r)if(t!==`${e[r].entry.request.query}`)return!0}return!1}function qH(e,t){let r=e.maps=[],n=new Map;for(let s of e){let{query:a}=s.entry.request,c=[];r.push(c);for(let{as:l,expr:u}of a.select()){let f=`${u}`;n.has(f)||n.set(f,[`col${n.size}`,u]);let[d]=n.get(f);c.push([d,l])}t(`${a}`)}let i=e[0].entry.request.query.clone(),o=i.groupby();if(o.length){let s={};e.maps[0].forEach(([a,c])=>s[c]=a),i.$groupby(o.map(a=>a instanceof fi&&s[a.column]||a))}return i.$select(Array.from(n.values()))}async function YH(e,t){let{maps:r,result:n}=e;if(!r)return;let i;try{i=await n}catch(o){for(let{entry:s}of e)s.result.reject(o);return}e.forEach(({entry:o},s)=>{let{request:a,result:c}=o,l=WH(i,r[s]);a.cache&&t.set(String(a.query),l),c.fulfill(l)})}function WH(e,t){if(t){let r={};for(let[n,i]of t)r[i]=e.getChild(n);return new e.constructor(r)}else return e}var GH=typeof requestIdleCallback<"u"?requestIdleCallback:setTimeout,xL=()=>({get:()=>{},set:(e,t)=>t,clear:()=>{}});function _L({max:e=1e3,ttl:t=3*60*60*1e3}={}){let r=new Map;function n(){let i=performance.now()-t,o=null,s=1/0;for(let[a,c]of r){let{last:l}=c;l<s&&(o=a,s=l),i>l&&r.delete(a)}o&&r.delete(o)}return{get(i){let o=r.get(i);if(o)return o.last=performance.now(),o.value},set(i,o){return r.set(i,{last:performance.now(),value:o}),r.size>e&&GH(n),o},clear(){r=new Map}}}function wL(e){let t=Array.from({length:e},()=>({head:null,tail:null}));return{isEmpty(){return t.every(r=>!r.head)},insert(r,n){let i=t[n];if(!i)throw new Error(`Invalid queue priority rank: ${n}`);let o={item:r,next:null};i.head===null?i.head=i.tail=o:i.tail=i.tail.next=o},remove(r){for(let n of t){let{head:i,tail:o}=n;for(let s=null,a=i;a;s=a,a=a.next)r(a.item)&&(a===i?i=a.next:s.next=a.next,a===o&&(o=s||i));n.head=i,n.tail=o}},next(){for(let r of t){let{head:n}=r;if(n!==null)return r.head=n.next,r.tail===n&&(r.tail=null),n.item}}}}var js={High:0,Normal:1,Low:2};function vL(){let e=wL(3),t,r,n,i=[],o=null,s;function a(){if(o||e.isEmpty())return;let{request:f,result:d}=e.next();o=u(f,d),o.finally(()=>{o=null,a()})}function c(f,d=js.Normal){e.insert(f,d),a()}function l(f){i.length&&f&&i.forEach(d=>d.add(f))}async function u(f,d){try{let{query:h,type:p,cache:m=!1,record:g=!0,options:y}=f,b=h?`${h}`:null;if(g&&l(b),m){let w=r.get(b);if(w){n.debug("Cache"),d.fulfill(w);return}}let x=performance.now(),_=await t.query({type:p,sql:b,...y});m&&r.set(b,_),n.debug(`Request: ${(performance.now()-x).toFixed(1)}`),d.fulfill(_)}catch(h){d.reject(h)}}return{cache(f){return f!==void 0?r=f===!0?_L():f||xL():r},logger(f){return f?n=f:n},connector(f){return f?t=f:t},consolidate(f){f&&!s?s=bL(c,r,l):!f&&s&&(s=null)},request(f,d=js.Normal){let h=d1(),p={request:f,result:h};return s?s.add(p,d):c(p,d),h},cancel(f){let d=new Set(f);e.remove(({result:h})=>d.has(h))},clear(){e.remove(({result:f})=>(f.reject("Cleared"),!0))},record(){let f=[],d={add(h){f.push(h)},reset(){f=[]},snapshot(){return f.slice()},stop(){return i=i.filter(h=>h!==d),f}};return i.push(d),d}}}function SL(){return{debug(){},info(){},log(){},warn(){},error(){}}}var h1;function nn(e){return e?h1=e:h1==null&&(h1=new vy),h1}var vy=class{constructor(t=R_(),r={}){this.catalog=new l1(this),this.manager=r.manager||vL(),this.logger(r.logger||console),this.configure(r),this.databaseConnector(t),this.clear()}logger(t){return arguments.length&&(this._logger=t||SL(),this.manager.logger(this._logger)),this._logger}configure({cache:t=!0,consolidate:r=!0,indexes:n=!0}){this.manager.cache(t),this.manager.consolidate(r),this.indexes=n}clear({clients:t=!0,cache:r=!0,catalog:n=!1}={}){this.manager.clear(),t&&(this.clients?.forEach(i=>this.disconnect(i)),this.filterGroups?.forEach(i=>i.finalize()),this.clients=new Set,this.filterGroups=new Map),r&&this.manager.cache().clear(),n&&this.catalog.clear()}databaseConnector(t){return this.manager.connector(t)}cancel(t){this.manager.cancel(t)}exec(t,{priority:r=js.Normal}={}){return this.manager.request({type:"exec",query:t},r)}query(t,{type:r="arrow",cache:n=!0,priority:i=js.Normal,...o}={}){return this.manager.request({type:r,query:t,cache:n,options:o},i)}prefetch(t,r={}){return this.query(t,{...r,cache:!0,priority:js.Low})}createBundle(t,r,n=js.Low){let i={name:t,queries:r};return this.manager.request({type:"create-bundle",options:i},n)}loadBundle(t,r=js.High){let n={name:t};return this.manager.request({type:"load-bundle",options:n},r)}updateClient(t,r,n=js.Normal){return t.queryPending(),this.query(r,{priority:n}).then(i=>t.queryResult(i).update(),i=>{t.queryError(i),this._logger.error(i)})}requestQuery(t,r){return this.filterGroups.get(t.filterBy)?.reset(),r?this.updateClient(t,r):t.update()}async connect(t){let{catalog:r,clients:n,filterGroups:i,indexes:o}=this;if(n.has(t))throw new Error("Client already connected.");n.add(t);let s=t.fields();s?.length&&t.fieldInfo(await r.queryFields(s));let a=t.filterBy;if(a)if(i.has(a))i.get(a).add(t);else{let c=new f1(this,a,o);i.set(a,c.add(t))}t.requestQuery()}disconnect(t){let{clients:r,filterGroups:n}=this;r.has(t)&&(r.delete(t),n.get(t.filterBy)?.remove(t))}};var IL={};function Sy(e,t=!1){let r,n,i=IL;function o(l){r=e(l).then(()=>{if(n){let{value:u}=n;n=null,o(u)}else r=null})}function s(l){n={event:l}}function a(l){r?s(l):o(l)}function c(l){i!==l&&requestAnimationFrame(()=>{let u=i;i=IL,a(u)}),i=l}return t?c:a}var mi=class{constructor(t){this._filterBy=t,this._requestUpdate=Sy(()=>this.requestQuery(),!0)}get filterBy(){return this._filterBy}get filterIndexable(){return!0}fields(){return null}fieldInfo(){return this}query(){return null}queryPending(){return this}queryResult(){return this}queryError(t){return console.error(t),this}requestQuery(t){let r=t||this.query(this.filterBy?.predicate(this));return nn().requestQuery(this,r)}requestUpdate(){this._requestUpdate()}update(){return this}};var p1=class{constructor(){this._callbacks=new Map}addEventListener(t,r){this._callbacks.has(t)||this._callbacks.set(t,{callbacks:new Set,pending:null,queue:new wM}),this._callbacks.get(t).callbacks.add(r)}removeEventListener(t,r){let n=this._callbacks.get(t);n&&n.callbacks.delete(r)}willEmit(t,r){return r}emitQueueFilter(){return null}cancel(t){this._callbacks.get(t)?.queue.clear()}emit(t,r){let n=this._callbacks.get(t)||{};if(n.pending)n.queue.enqueue(r,this.emitQueueFilter(t,r));else{let i=this.willEmit(t,r),{callbacks:o,queue:s}=n;if(o?.size){let a=Promise.allSettled(Array.from(o,c=>c(i))).then(()=>{n.pending=null,s.isEmpty()||this.emit(t,s.dequeue())});n.pending=a}}}},wM=class{constructor(){this.clear()}clear(){this.next=null}isEmpty(){return!this.next}enqueue(t,r){let n={value:t};if(r&&this.next){let i=this;for(;i.next;)r(i.next.value)?i=i.next:i.next=i.next.next;i.next=n}else this.next=n}dequeue(){let{next:t}=this;return this.next=t?.next,t?.value}};function Iy(e,t){return e===t?!1:e instanceof Date&&t instanceof Date?+e!=+t:Array.isArray(e)&&Array.isArray(t)?XH(e,t):!0}function XH(e,t){if(e.length!==t.length)return!0;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!0;return!1}function yi(e){return e instanceof ts}var ts=class e extends p1{constructor(t){super(),this._value=t}static value(t){return new e(t)}static array(t){if(t.some(r=>yi(r))){let r=new e,n=()=>r.update(t.map(i=>yi(i)?i.value:i));return n(),t.forEach(i=>yi(i)?i.addEventListener("value",n):0),r}return new e(t)}get value(){return this._value}update(t,{force:r}={}){return Iy(this._value,t)||r?this.emit("value",t):this.cancel("value"),this}willEmit(t,r){return t==="value"&&(this._value=r),r}};function yo(e){return e instanceof gi}var gi=class e extends ts{static intersect({cross:t=!1}={}){return new e(new Hu({cross:t}))}static union({cross:t=!1}={}){return new e(new Hu({cross:t,union:!0}))}static single({cross:t=!1}={}){return new e(new Hu({cross:t,single:!0}))}static crossfilter(){return new e(new Hu({cross:!0}))}constructor(t=new Hu){super([]),this._resolved=this._value,this._resolver=t}clone(){let t=new e(this._resolver);return t._value=t._resolved=this._value,t}remove(t){let r=this.clone();return r._value=r._resolved=r._resolver.resolve(this._resolved,{source:t}),r._value.active={source:t},r}get active(){return this.clauses.active}get value(){return this.active?.value}get clauses(){return super.value}get single(){return this._resolver.single}activate(t){this.emit("activate",t)}update(t){return this._resolved=this._resolver.resolve(this._resolved,t,!0),this._resolved.active=t,super.update(this._resolved)}willEmit(t,r){return t==="value"?(this._value=r,this.value):r}emitQueueFilter(t,r){return t==="value"?this._resolver.queueFilter(r):null}skip(t,r){return this._resolver.skip(t,r)}predicate(t){let{clauses:r}=this;return this._resolver.predicate(r,r.active,t)}},Hu=class{constructor({union:t,cross:r,single:n}={}){this.union=!!t,this.cross=!!r,this.single=!!n}resolve(t,r,n=!1){let{source:i,predicate:o}=r,s=t.filter(c=>i!==c.source),a=this.single?[]:s;return this.single&&n&&s.forEach(c=>c.source?.reset?.()),o&&a.push(r),a}skip(t,r){return this.cross&&r?.clients?.has(t)}predicate(t,r,n){let{union:i}=this;if(this.skip(n,r))return;let o=t.filter(s=>!this.skip(n,s)).map(s=>s.predicate);return i&&o.length>1?Pd(o):o}queueFilter(t){if(this.cross){let r=t.active?.source;return n=>n.active?.source!==r}}};function TL(e="http://localhost:3000/"){return{async query(t){let r=fetch(e,{method:"POST",mode:"cors",cache:"no-cache",credentials:"omit",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return t.type==="exec"?r:t.type==="arrow"?Yu(r):(await r).json()}}}var MM={};Qr(MM,{compareArrayLike:()=>AM,joinUint8Arrays:()=>Ci,memcpy:()=>Vd,rebaseValueOffsets:()=>My,toArrayBufferView:()=>Jt,toArrayBufferViewAsyncIterator:()=>ns,toArrayBufferViewIterator:()=>qs,toBigInt64Array:()=>eZ,toBigUint64Array:()=>iZ,toFloat32Array:()=>oZ,toFloat32ArrayAsyncIterator:()=>wZ,toFloat32ArrayIterator:()=>hZ,toFloat64Array:()=>sZ,toFloat64ArrayAsyncIterator:()=>vZ,toFloat64ArrayIterator:()=>pZ,toInt16Array:()=>tZ,toInt16ArrayAsyncIterator:()=>gZ,toInt16ArrayIterator:()=>lZ,toInt32Array:()=>Zu,toInt32ArrayAsyncIterator:()=>bZ,toInt32ArrayIterator:()=>uZ,toInt8Array:()=>JH,toInt8ArrayAsyncIterator:()=>yZ,toInt8ArrayIterator:()=>cZ,toUint16Array:()=>rZ,toUint16ArrayAsyncIterator:()=>xZ,toUint16ArrayIterator:()=>fZ,toUint32Array:()=>nZ,toUint32ArrayAsyncIterator:()=>_Z,toUint32ArrayIterator:()=>dZ,toUint8Array:()=>Ct,toUint8ArrayAsyncIterator:()=>TM,toUint8ArrayIterator:()=>IM,toUint8ClampedArray:()=>aZ,toUint8ClampedArrayAsyncIterator:()=>SZ,toUint8ClampedArrayIterator:()=>mZ});var HH=new TextDecoder("utf-8"),Ty=e=>HH.decode(e),ZH=new TextEncoder,_l=e=>ZH.encode(e);var[G1t,m1]=(()=>{let e=()=>{throw new Error("BigInt is not available in this environment")};function t(){throw e()}return t.asIntN=()=>{throw e()},t.asUintN=()=>{throw e()},typeof BigInt<"u"?[BigInt,!0]:[t,!1]})(),[go,X1t]=(()=>{let e=()=>{throw new Error("BigInt64Array is not available in this environment")};class t{static get BYTES_PER_ELEMENT(){return 8}static of(){throw e()}static from(){throw e()}constructor(){throw e()}}return typeof BigInt64Array<"u"?[BigInt64Array,!0]:[t,!1]})(),[bo,H1t]=(()=>{let e=()=>{throw new Error("BigUint64Array is not available in this environment")};class t{static get BYTES_PER_ELEMENT(){return 8}static of(){throw e()}static from(){throw e()}constructor(){throw e()}}return typeof BigUint64Array<"u"?[BigUint64Array,!0]:[t,!1]})();var KH=e=>typeof e=="number",AL=e=>typeof e=="boolean",Lr=e=>typeof e=="function",kn=e=>e!=null&&Object(e)===e,es=e=>kn(e)&&Lr(e.then);var rs=e=>kn(e)&&Lr(e[Symbol.iterator]),xo=e=>kn(e)&&Lr(e[Symbol.asyncIterator]),y1=e=>kn(e)&&kn(e.schema);var g1=e=>kn(e)&&"done"in e&&"value"in e;var b1=e=>kn(e)&&Lr(e.stat)&&KH(e.fd);var x1=e=>kn(e)&&Ay(e.body),_1=e=>"_getDOMStream"in e&&"_getNodeStream"in e,ML=e=>kn(e)&&Lr(e.abort)&&Lr(e.getWriter)&&!_1(e),Ay=e=>kn(e)&&Lr(e.cancel)&&Lr(e.getReader)&&!_1(e),EL=e=>kn(e)&&Lr(e.end)&&Lr(e.write)&&AL(e.writable)&&!_1(e),w1=e=>kn(e)&&Lr(e.read)&&Lr(e.pipe)&&AL(e.readable)&&!_1(e),BL=e=>kn(e)&&Lr(e.clear)&&Lr(e.bytes)&&Lr(e.position)&&Lr(e.setPosition)&&Lr(e.capacity)&&Lr(e.getBufferIdentifier)&&Lr(e.createLong);var SM=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:ArrayBuffer;function QH(e){let t=e[0]?[e[0]]:[],r,n,i,o;for(let s,a,c=0,l=0,u=e.length;++c<u;){if(s=t[l],a=e[c],!s||!a||s.buffer!==a.buffer||a.byteOffset<s.byteOffset){a&&(t[++l]=a);continue}if({byteOffset:r,byteLength:i}=s,{byteOffset:n,byteLength:o}=a,r+i<n||n+o<r){a&&(t[++l]=a);continue}t[l]=new Uint8Array(s.buffer,r,n-r+o)}return t}function Vd(e,t,r=0,n=t.byteLength){let i=e.byteLength,o=new Uint8Array(e.buffer,e.byteOffset,i),s=new Uint8Array(t.buffer,t.byteOffset,Math.min(n,i));return o.set(s,r),e}function Ci(e,t){let r=QH(e),n=r.reduce((u,f)=>u+f.byteLength,0),i,o,s,a=0,c=-1,l=Math.min(t||Number.POSITIVE_INFINITY,n);for(let u=r.length;++c<u;){if(i=r[c],o=i.subarray(0,Math.min(i.length,l-a)),l<=a+o.length){o.length<i.length?r[c]=i.subarray(o.length):o.length===i.length&&c++,s?Vd(s,o,a):s=o;break}Vd(s||(s=new Uint8Array(l)),o,a),a+=o.length}return[s||new Uint8Array(0),r.slice(c),n-(s?s.byteLength:0)]}function Jt(e,t){let r=g1(t)?t.value:t;return r instanceof e?e===Uint8Array?new e(r.buffer,r.byteOffset,r.byteLength):r:r?(typeof r=="string"&&(r=_l(r)),r instanceof ArrayBuffer?new e(r):r instanceof SM?new e(r):BL(r)?Jt(e,r.bytes()):ArrayBuffer.isView(r)?r.byteLength<=0?new e(0):new e(r.buffer,r.byteOffset,r.byteLength/e.BYTES_PER_ELEMENT):e.from(r)):new e(0)}var JH=e=>Jt(Int8Array,e),tZ=e=>Jt(Int16Array,e),Zu=e=>Jt(Int32Array,e),eZ=e=>Jt(go,e),Ct=e=>Jt(Uint8Array,e),rZ=e=>Jt(Uint16Array,e),nZ=e=>Jt(Uint32Array,e),iZ=e=>Jt(bo,e),oZ=e=>Jt(Float32Array,e),sZ=e=>Jt(Float64Array,e),aZ=e=>Jt(Uint8ClampedArray,e),vM=e=>(e.next(),e);function*qs(e,t){let r=function*(i){yield i},n=typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof SM?r(t):rs(t)?t:r(t);return yield*vM(function*(i){let o=null;do o=i.next(yield Jt(e,o));while(!o.done)}(n[Symbol.iterator]())),new e}var cZ=e=>qs(Int8Array,e),lZ=e=>qs(Int16Array,e),uZ=e=>qs(Int32Array,e),IM=e=>qs(Uint8Array,e),fZ=e=>qs(Uint16Array,e),dZ=e=>qs(Uint32Array,e),hZ=e=>qs(Float32Array,e),pZ=e=>qs(Float64Array,e),mZ=e=>qs(Uint8ClampedArray,e);function ns(e,t){return ke(this,arguments,function*(){if(es(t))return yield G(yield G(yield*oo(or(ns(e,yield G(t))))));let n=function(s){return ke(this,arguments,function*(){yield yield G(yield G(s))})},i=function(s){return ke(this,arguments,function*(){yield G(yield*oo(or(vM(function*(a){let c=null;do c=a.next(yield c?.value);while(!c.done)}(s[Symbol.iterator]())))))})},o=typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof SM?n(t):rs(t)?i(t):xo(t)?t:n(t);return yield G(yield*oo(or(vM(function(s){return ke(this,arguments,function*(){let a=null;do a=yield G(s.next(yield yield G(Jt(e,a))));while(!a.done)})}(o[Symbol.asyncIterator]()))))),yield G(new e)})}var yZ=e=>ns(Int8Array,e),gZ=e=>ns(Int16Array,e),bZ=e=>ns(Int32Array,e),TM=e=>ns(Uint8Array,e),xZ=e=>ns(Uint16Array,e),_Z=e=>ns(Uint32Array,e),wZ=e=>ns(Float32Array,e),vZ=e=>ns(Float64Array,e),SZ=e=>ns(Uint8ClampedArray,e);function My(e,t,r){if(e!==0){r=r.slice(0,t+1);for(let n=-1;++n<=t;)r[n]+=e}return r}function AM(e,t){let r=0,n=e.length;if(n!==t.length)return!1;if(n>0)do if(e[r]!==t[r])return!1;while(++r<n);return!0}var on={fromIterable(e){return v1(IZ(e))},fromAsyncIterable(e){return v1(TZ(e))},fromDOMStream(e){return v1(AZ(e))},fromNodeStream(e){return v1(MZ(e))},toDOMStream(e,t){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(e,t){throw new Error('"toNodeStream" not available in this environment')}},v1=e=>(e.next(),e);function*IZ(e){let t,r=!1,n=[],i,o,s,a=0;function c(){return o==="peek"?Ci(n,s)[0]:([i,n,a]=Ci(n,s),i)}({cmd:o,size:s}=yield null);let l=IM(e)[Symbol.iterator]();try{do if({done:t,value:i}=Number.isNaN(s-a)?l.next():l.next(s-a),!t&&i.byteLength>0&&(n.push(i),a+=i.byteLength),t||s<=a)do({cmd:o,size:s}=yield c());while(s<a);while(!t)}catch(u){(r=!0)&&typeof l.throw=="function"&&l.throw(u)}finally{r===!1&&typeof l.return=="function"&&l.return(null)}return null}function TZ(e){return ke(this,arguments,function*(){let r,n=!1,i=[],o,s,a,c=0;function l(){return s==="peek"?Ci(i,a)[0]:([o,i,c]=Ci(i,a),o)}({cmd:s,size:a}=yield yield G(null));let u=TM(e)[Symbol.asyncIterator]();try{do if({done:r,value:o}=Number.isNaN(a-c)?yield G(u.next()):yield G(u.next(a-c)),!r&&o.byteLength>0&&(i.push(o),c+=o.byteLength),r||a<=c)do({cmd:s,size:a}=yield yield G(l()));while(a<c);while(!r)}catch(f){(n=!0)&&typeof u.throw=="function"&&(yield G(u.throw(f)))}finally{n===!1&&typeof u.return=="function"&&(yield G(u.return(new Uint8Array(0))))}return yield G(null)})}function AZ(e){return ke(this,arguments,function*(){let r=!1,n=!1,i=[],o,s,a,c=0;function l(){return s==="peek"?Ci(i,a)[0]:([o,i,c]=Ci(i,a),o)}({cmd:s,size:a}=yield yield G(null));let u=new BM(e);try{do if({done:r,value:o}=Number.isNaN(a-c)?yield G(u.read()):yield G(u.read(a-c)),!r&&o.byteLength>0&&(i.push(Ct(o)),c+=o.byteLength),r||a<=c)do({cmd:s,size:a}=yield yield G(l()));while(a<c);while(!r)}catch(f){(n=!0)&&(yield G(u.cancel(f)))}finally{n===!1?yield G(u.cancel()):e.locked&&u.releaseLock()}return yield G(null)})}var BM=class{constructor(t){this.source=t,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch(()=>{})}get closed(){return this.reader?this.reader.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=null}cancel(t){return P(this,void 0,void 0,function*(){let{reader:r,source:n}=this;r&&(yield r.cancel(t).catch(()=>{})),n&&n.locked&&this.releaseLock()})}read(t){return P(this,void 0,void 0,function*(){if(t===0)return{done:this.reader==null,value:new Uint8Array(0)};let r=yield this.reader.read();return!r.done&&(r.value=Ct(r)),r})}},EM=(e,t)=>{let r=i=>n([t,i]),n;return[t,r,new Promise(i=>(n=i)&&e.once(t,r))]};function MZ(e){return ke(this,arguments,function*(){let r=[],n="error",i=!1,o=null,s,a,c=0,l=[],u;function f(){return s==="peek"?Ci(l,a)[0]:([u,l,c]=Ci(l,a),u)}if({cmd:s,size:a}=yield yield G(null),e.isTTY)return yield yield G(new Uint8Array(0)),yield G(null);try{r[0]=EM(e,"end"),r[1]=EM(e,"error");do{if(r[2]=EM(e,"readable"),[n,o]=yield G(Promise.race(r.map(h=>h[2]))),n==="error")break;if((i=n==="end")||(Number.isFinite(a-c)?(u=Ct(e.read(a-c)),u.byteLength<a-c&&(u=Ct(e.read()))):u=Ct(e.read()),u.byteLength>0&&(l.push(u),c+=u.byteLength)),i||a<=c)do({cmd:s,size:a}=yield yield G(f()));while(a<c)}while(!i)}finally{yield G(d(r,n==="error"?o:null))}return yield G(null);function d(h,p){return u=l=null,new Promise((m,g)=>{for(let[y,b]of h)e.off(y,b);try{let y=e.destroy;y&&y.call(e,p),p=void 0}catch(y){p=y||p}finally{p!=null?g(p):m()}})}})}var $r;(function(e){e[e.V1=0]="V1",e[e.V2=1]="V2",e[e.V3=2]="V3",e[e.V4=3]="V4",e[e.V5=4]="V5"})($r||($r={}));var er;(function(e){e[e.Sparse=0]="Sparse",e[e.Dense=1]="Dense"})(er||(er={}));var qe;(function(e){e[e.HALF=0]="HALF",e[e.SINGLE=1]="SINGLE",e[e.DOUBLE=2]="DOUBLE"})(qe||(qe={}));var sn;(function(e){e[e.DAY=0]="DAY",e[e.MILLISECOND=1]="MILLISECOND"})(sn||(sn={}));var re;(function(e){e[e.SECOND=0]="SECOND",e[e.MILLISECOND=1]="MILLISECOND",e[e.MICROSECOND=2]="MICROSECOND",e[e.NANOSECOND=3]="NANOSECOND"})(re||(re={}));var Cn;(function(e){e[e.YEAR_MONTH=0]="YEAR_MONTH",e[e.DAY_TIME=1]="DAY_TIME",e[e.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(Cn||(Cn={}));var me;(function(e){e[e.NONE=0]="NONE",e[e.Schema=1]="Schema",e[e.DictionaryBatch=2]="DictionaryBatch",e[e.RecordBatch=3]="RecordBatch",e[e.Tensor=4]="Tensor",e[e.SparseTensor=5]="SparseTensor"})(me||(me={}));var N;(function(e){e[e.NONE=0]="NONE",e[e.Null=1]="Null",e[e.Int=2]="Int",e[e.Float=3]="Float",e[e.Binary=4]="Binary",e[e.Utf8=5]="Utf8",e[e.Bool=6]="Bool",e[e.Decimal=7]="Decimal",e[e.Date=8]="Date",e[e.Time=9]="Time",e[e.Timestamp=10]="Timestamp",e[e.Interval=11]="Interval",e[e.List=12]="List",e[e.Struct=13]="Struct",e[e.Union=14]="Union",e[e.FixedSizeBinary=15]="FixedSizeBinary",e[e.FixedSizeList=16]="FixedSizeList",e[e.Map=17]="Map",e[e.Dictionary=-1]="Dictionary",e[e.Int8=-2]="Int8",e[e.Int16=-3]="Int16",e[e.Int32=-4]="Int32",e[e.Int64=-5]="Int64",e[e.Uint8=-6]="Uint8",e[e.Uint16=-7]="Uint16",e[e.Uint32=-8]="Uint32",e[e.Uint64=-9]="Uint64",e[e.Float16=-10]="Float16",e[e.Float32=-11]="Float32",e[e.Float64=-12]="Float64",e[e.DateDay=-13]="DateDay",e[e.DateMillisecond=-14]="DateMillisecond",e[e.TimestampSecond=-15]="TimestampSecond",e[e.TimestampMillisecond=-16]="TimestampMillisecond",e[e.TimestampMicrosecond=-17]="TimestampMicrosecond",e[e.TimestampNanosecond=-18]="TimestampNanosecond",e[e.TimeSecond=-19]="TimeSecond",e[e.TimeMillisecond=-20]="TimeMillisecond",e[e.TimeMicrosecond=-21]="TimeMicrosecond",e[e.TimeNanosecond=-22]="TimeNanosecond",e[e.DenseUnion=-23]="DenseUnion",e[e.SparseUnion=-24]="SparseUnion",e[e.IntervalDayTime=-25]="IntervalDayTime",e[e.IntervalYearMonth=-26]="IntervalYearMonth"})(N||(N={}));var _o;(function(e){e[e.OFFSET=0]="OFFSET",e[e.DATA=1]="DATA",e[e.VALIDITY=2]="VALIDITY",e[e.TYPE=3]="TYPE"})(_o||(_o={}));var WM={};Qr(WM,{clampIndex:()=>bK,clampRange:()=>Fy,createElementComparator:()=>Il});var EZ=void 0;function is(e){if(e===null)return"null";if(e===EZ)return"undefined";switch(typeof e){case"number":return`${e}`;case"bigint":return`${e}`;case"string":return`"${e}"`}return typeof e[Symbol.toPrimitive]=="function"?e[Symbol.toPrimitive]("string"):ArrayBuffer.isView(e)?e instanceof go||e instanceof bo?`[${[...e].map(t=>is(t))}]`:`[${e}]`:ArrayBuffer.isView(e)?`[${e}]`:JSON.stringify(e,(t,r)=>typeof r=="bigint"?`${r}`:r)}var FM={};Qr(FM,{BN:()=>By,bignumToBigInt:()=>S1,bignumToString:()=>wl,isArrowBigNumSymbol:()=>OL});var OL=Symbol.for("isArrowBigNum");function os(e,...t){return t.length===0?Object.setPrototypeOf(Jt(this.TypedArray,e),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(e,...t),this.constructor.prototype)}os.prototype[OL]=!0;os.prototype.toJSON=function(){return`"${wl(this)}"`};os.prototype.valueOf=function(){return FL(this)};os.prototype.toString=function(){return wl(this)};os.prototype[Symbol.toPrimitive]=function(e="default"){switch(e){case"number":return FL(this);case"string":return wl(this);case"default":return S1(this)}return wl(this)};function jd(...e){return os.apply(this,e)}function qd(...e){return os.apply(this,e)}function Ey(...e){return os.apply(this,e)}Object.setPrototypeOf(jd.prototype,Object.create(Int32Array.prototype));Object.setPrototypeOf(qd.prototype,Object.create(Uint32Array.prototype));Object.setPrototypeOf(Ey.prototype,Object.create(Uint32Array.prototype));Object.assign(jd.prototype,os.prototype,{constructor:jd,signed:!0,TypedArray:Int32Array,BigIntArray:go});Object.assign(qd.prototype,os.prototype,{constructor:qd,signed:!1,TypedArray:Uint32Array,BigIntArray:bo});Object.assign(Ey.prototype,os.prototype,{constructor:Ey,signed:!0,TypedArray:Uint32Array,BigIntArray:bo});function FL(e){let{buffer:t,byteOffset:r,length:n,signed:i}=e,o=new bo(t,r,n),s=i&&o[o.length-1]&BigInt(1)<<BigInt(63),a=BigInt(s?1:0),c=BigInt(0);if(s){for(let l of o)a+=~l*(BigInt(1)<<BigInt(32)*c++);a*=BigInt(-1)}else for(let l of o)a+=l*(BigInt(1)<<BigInt(32)*c++);return a}var wl,S1;m1?(S1=e=>e.byteLength===8?new e.BigIntArray(e.buffer,e.byteOffset,1)[0]:OM(e),wl=e=>e.byteLength===8?`${new e.BigIntArray(e.buffer,e.byteOffset,1)[0]}`:OM(e)):(wl=OM,S1=wl);function OM(e){let t="",r=new Uint32Array(2),n=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2),i=new Uint32Array((n=new Uint16Array(n).reverse()).buffer),o=-1,s=n.length-1;do{for(r[0]=n[o=0];o<s;)n[o++]=r[1]=r[0]/10,r[0]=(r[0]-r[1]*10<<16)+n[o];n[o]=r[1]=r[0]/10,r[0]=r[0]-r[1]*10,t=`${r[0]}${t}`}while(i[0]||i[1]||i[2]||i[3]);return t??"0"}var By=class e{static new(t,r){switch(r){case!0:return new jd(t);case!1:return new qd(t)}switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:case go:return new jd(t)}return t.byteLength===16?new Ey(t):new qd(t)}static signed(t){return new jd(t)}static unsigned(t){return new qd(t)}static decimal(t){return new Ey(t)}constructor(t,r){return e.new(t,r)}};var NL,DL,LL,RL,kL,CL,UL,PL,$L,zL,VL,jL,qL,YL,WL,GL,XL,HL,ZL,mt=class e{static isNull(t){return t?.typeId===N.Null}static isInt(t){return t?.typeId===N.Int}static isFloat(t){return t?.typeId===N.Float}static isBinary(t){return t?.typeId===N.Binary}static isUtf8(t){return t?.typeId===N.Utf8}static isBool(t){return t?.typeId===N.Bool}static isDecimal(t){return t?.typeId===N.Decimal}static isDate(t){return t?.typeId===N.Date}static isTime(t){return t?.typeId===N.Time}static isTimestamp(t){return t?.typeId===N.Timestamp}static isInterval(t){return t?.typeId===N.Interval}static isList(t){return t?.typeId===N.List}static isStruct(t){return t?.typeId===N.Struct}static isUnion(t){return t?.typeId===N.Union}static isFixedSizeBinary(t){return t?.typeId===N.FixedSizeBinary}static isFixedSizeList(t){return t?.typeId===N.FixedSizeList}static isMap(t){return t?.typeId===N.Map}static isDictionary(t){return t?.typeId===N.Dictionary}static isDenseUnion(t){return e.isUnion(t)&&t.mode===er.Dense}static isSparseUnion(t){return e.isUnion(t)&&t.mode===er.Sparse}get typeId(){return N.NONE}};NL=Symbol.toStringTag;mt[NL]=(e=>(e.children=null,e.ArrayType=Array,e[Symbol.toStringTag]="DataType"))(mt.prototype);var Un=class extends mt{toString(){return"Null"}get typeId(){return N.Null}};DL=Symbol.toStringTag;Un[DL]=(e=>e[Symbol.toStringTag]="Null")(Un.prototype);var gr=class extends mt{constructor(t,r){super(),this.isSigned=t,this.bitWidth=r}get typeId(){return N.Int}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?go:bo}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}};LL=Symbol.toStringTag;gr[LL]=(e=>(e.isSigned=null,e.bitWidth=null,e[Symbol.toStringTag]="Int"))(gr.prototype);var I1=class extends gr{constructor(){super(!0,8)}get ArrayType(){return Int8Array}},T1=class extends gr{constructor(){super(!0,16)}get ArrayType(){return Int16Array}},Ys=class extends gr{constructor(){super(!0,32)}get ArrayType(){return Int32Array}},A1=class extends gr{constructor(){super(!0,64)}get ArrayType(){return go}},M1=class extends gr{constructor(){super(!1,8)}get ArrayType(){return Uint8Array}},E1=class extends gr{constructor(){super(!1,16)}get ArrayType(){return Uint16Array}},B1=class extends gr{constructor(){super(!1,32)}get ArrayType(){return Uint32Array}},O1=class extends gr{constructor(){super(!1,64)}get ArrayType(){return bo}};Object.defineProperty(I1.prototype,"ArrayType",{value:Int8Array});Object.defineProperty(T1.prototype,"ArrayType",{value:Int16Array});Object.defineProperty(Ys.prototype,"ArrayType",{value:Int32Array});Object.defineProperty(A1.prototype,"ArrayType",{value:go});Object.defineProperty(M1.prototype,"ArrayType",{value:Uint8Array});Object.defineProperty(E1.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(B1.prototype,"ArrayType",{value:Uint32Array});Object.defineProperty(O1.prototype,"ArrayType",{value:bo});var bi=class extends mt{constructor(t){super(),this.precision=t}get typeId(){return N.Float}get ArrayType(){switch(this.precision){case qe.HALF:return Uint16Array;case qe.SINGLE:return Float32Array;case qe.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}};RL=Symbol.toStringTag;bi[RL]=(e=>(e.precision=null,e[Symbol.toStringTag]="Float"))(bi.prototype);var F1=class extends bi{constructor(){super(qe.HALF)}},N1=class extends bi{constructor(){super(qe.SINGLE)}},D1=class extends bi{constructor(){super(qe.DOUBLE)}};Object.defineProperty(F1.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(N1.prototype,"ArrayType",{value:Float32Array});Object.defineProperty(D1.prototype,"ArrayType",{value:Float64Array});var nc=class extends mt{constructor(){super()}get typeId(){return N.Binary}toString(){return"Binary"}};kL=Symbol.toStringTag;nc[kL]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Binary"))(nc.prototype);var ic=class extends mt{constructor(){super()}get typeId(){return N.Utf8}toString(){return"Utf8"}};CL=Symbol.toStringTag;ic[CL]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Utf8"))(ic.prototype);var oc=class extends mt{constructor(){super()}get typeId(){return N.Bool}toString(){return"Bool"}};UL=Symbol.toStringTag;oc[UL]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Bool"))(oc.prototype);var sc=class extends mt{constructor(t,r,n=128){super(),this.scale=t,this.precision=r,this.bitWidth=n}get typeId(){return N.Decimal}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}};PL=Symbol.toStringTag;sc[PL]=(e=>(e.scale=null,e.precision=null,e.ArrayType=Uint32Array,e[Symbol.toStringTag]="Decimal"))(sc.prototype);var ac=class extends mt{constructor(t){super(),this.unit=t}get typeId(){return N.Date}toString(){return`Date${(this.unit+1)*32}<${sn[this.unit]}>`}};$L=Symbol.toStringTag;ac[$L]=(e=>(e.unit=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Date"))(ac.prototype);var ss=class extends mt{constructor(t,r){super(),this.unit=t,this.bitWidth=r}get typeId(){return N.Time}toString(){return`Time${this.bitWidth}<${re[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return go}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}};zL=Symbol.toStringTag;ss[zL]=(e=>(e.unit=null,e.bitWidth=null,e[Symbol.toStringTag]="Time"))(ss.prototype);var cc=class extends mt{constructor(t,r){super(),this.unit=t,this.timezone=r}get typeId(){return N.Timestamp}toString(){return`Timestamp<${re[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}};VL=Symbol.toStringTag;cc[VL]=(e=>(e.unit=null,e.timezone=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Timestamp"))(cc.prototype);var lc=class extends mt{constructor(t){super(),this.unit=t}get typeId(){return N.Interval}toString(){return`Interval<${Cn[this.unit]}>`}};jL=Symbol.toStringTag;lc[jL]=(e=>(e.unit=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Interval"))(lc.prototype);var as=class extends mt{constructor(t){super(),this.children=[t]}get typeId(){return N.List}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}};qL=Symbol.toStringTag;as[qL]=(e=>(e.children=null,e[Symbol.toStringTag]="List"))(as.prototype);var Pe=class extends mt{constructor(t){super(),this.children=t}get typeId(){return N.Struct}toString(){return`Struct<{${this.children.map(t=>`${t.name}:${t.type}`).join(", ")}}>`}};YL=Symbol.toStringTag;Pe[YL]=(e=>(e.children=null,e[Symbol.toStringTag]="Struct"))(Pe.prototype);var cs=class extends mt{constructor(t,r,n){super(),this.mode=t,this.children=n,this.typeIds=r=Int32Array.from(r),this.typeIdToChildIndex=r.reduce((i,o,s)=>(i[o]=s)&&i||i,Object.create(null))}get typeId(){return N.Union}toString(){return`${this[Symbol.toStringTag]}<${this.children.map(t=>`${t.type}`).join(" | ")}>`}};WL=Symbol.toStringTag;cs[WL]=(e=>(e.mode=null,e.typeIds=null,e.children=null,e.typeIdToChildIndex=null,e.ArrayType=Int8Array,e[Symbol.toStringTag]="Union"))(cs.prototype);var uc=class extends mt{constructor(t){super(),this.byteWidth=t}get typeId(){return N.FixedSizeBinary}toString(){return`FixedSizeBinary[${this.byteWidth}]`}};GL=Symbol.toStringTag;uc[GL]=(e=>(e.byteWidth=null,e.ArrayType=Uint8Array,e[Symbol.toStringTag]="FixedSizeBinary"))(uc.prototype);var ls=class extends mt{constructor(t,r){super(),this.listSize=t,this.children=[r]}get typeId(){return N.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}};XL=Symbol.toStringTag;ls[XL]=(e=>(e.children=null,e.listSize=null,e[Symbol.toStringTag]="FixedSizeList"))(ls.prototype);var us=class extends mt{constructor(t,r=!1){super(),this.children=[t],this.keysSorted=r}get typeId(){return N.Map}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map(t=>`${t.name}:${t.type}`).join(", ")}}>`}};HL=Symbol.toStringTag;us[HL]=(e=>(e.children=null,e.keysSorted=null,e[Symbol.toStringTag]="Map_"))(us.prototype);var BZ=(e=>()=>++e)(-1),Ui=class extends mt{constructor(t,r,n,i){super(),this.indices=r,this.dictionary=t,this.isOrdered=i||!1,this.id=n==null?BZ():typeof n=="number"?n:n.low}get typeId(){return N.Dictionary}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}};ZL=Symbol.toStringTag;Ui[ZL]=(e=>(e.id=null,e.indices=null,e.isOrdered=null,e.dictionary=null,e[Symbol.toStringTag]="Dictionary"))(Ui.prototype);function Pi(e){let t=e;switch(e.typeId){case N.Decimal:return e.bitWidth/32;case N.Timestamp:return 2;case N.Date:return 1+t.unit;case N.Interval:return 1+t.unit;case N.FixedSizeList:return t.listSize;case N.FixedSizeBinary:return t.byteWidth;default:return 1}}var wt=class{visitMany(t,...r){return t.map((n,i)=>this.visit(n,...r.map(o=>o[i])))}visit(...t){return this.getVisitFn(t[0],!1).apply(this,t)}getVisitFn(t,r=!0){return OZ(this,t,r)}getVisitFnByTypeId(t,r=!0){return Yd(this,t,r)}visitNull(t,...r){return null}visitBool(t,...r){return null}visitInt(t,...r){return null}visitFloat(t,...r){return null}visitUtf8(t,...r){return null}visitBinary(t,...r){return null}visitFixedSizeBinary(t,...r){return null}visitDate(t,...r){return null}visitTimestamp(t,...r){return null}visitTime(t,...r){return null}visitDecimal(t,...r){return null}visitList(t,...r){return null}visitStruct(t,...r){return null}visitUnion(t,...r){return null}visitDictionary(t,...r){return null}visitInterval(t,...r){return null}visitFixedSizeList(t,...r){return null}visitMap(t,...r){return null}};function OZ(e,t,r=!0){return typeof t=="number"?Yd(e,t,r):typeof t=="string"&&t in N?Yd(e,N[t],r):t&&t instanceof mt?Yd(e,KL(t),r):t?.type&&t.type instanceof mt?Yd(e,KL(t.type),r):Yd(e,N.NONE,r)}function Yd(e,t,r=!0){let n=null;switch(t){case N.Null:n=e.visitNull;break;case N.Bool:n=e.visitBool;break;case N.Int:n=e.visitInt;break;case N.Int8:n=e.visitInt8||e.visitInt;break;case N.Int16:n=e.visitInt16||e.visitInt;break;case N.Int32:n=e.visitInt32||e.visitInt;break;case N.Int64:n=e.visitInt64||e.visitInt;break;case N.Uint8:n=e.visitUint8||e.visitInt;break;case N.Uint16:n=e.visitUint16||e.visitInt;break;case N.Uint32:n=e.visitUint32||e.visitInt;break;case N.Uint64:n=e.visitUint64||e.visitInt;break;case N.Float:n=e.visitFloat;break;case N.Float16:n=e.visitFloat16||e.visitFloat;break;case N.Float32:n=e.visitFloat32||e.visitFloat;break;case N.Float64:n=e.visitFloat64||e.visitFloat;break;case N.Utf8:n=e.visitUtf8;break;case N.Binary:n=e.visitBinary;break;case N.FixedSizeBinary:n=e.visitFixedSizeBinary;break;case N.Date:n=e.visitDate;break;case N.DateDay:n=e.visitDateDay||e.visitDate;break;case N.DateMillisecond:n=e.visitDateMillisecond||e.visitDate;break;case N.Timestamp:n=e.visitTimestamp;break;case N.TimestampSecond:n=e.visitTimestampSecond||e.visitTimestamp;break;case N.TimestampMillisecond:n=e.visitTimestampMillisecond||e.visitTimestamp;break;case N.TimestampMicrosecond:n=e.visitTimestampMicrosecond||e.visitTimestamp;break;case N.TimestampNanosecond:n=e.visitTimestampNanosecond||e.visitTimestamp;break;case N.Time:n=e.visitTime;break;case N.TimeSecond:n=e.visitTimeSecond||e.visitTime;break;case N.TimeMillisecond:n=e.visitTimeMillisecond||e.visitTime;break;case N.TimeMicrosecond:n=e.visitTimeMicrosecond||e.visitTime;break;case N.TimeNanosecond:n=e.visitTimeNanosecond||e.visitTime;break;case N.Decimal:n=e.visitDecimal;break;case N.List:n=e.visitList;break;case N.Struct:n=e.visitStruct;break;case N.Union:n=e.visitUnion;break;case N.DenseUnion:n=e.visitDenseUnion||e.visitUnion;break;case N.SparseUnion:n=e.visitSparseUnion||e.visitUnion;break;case N.Dictionary:n=e.visitDictionary;break;case N.Interval:n=e.visitInterval;break;case N.IntervalDayTime:n=e.visitIntervalDayTime||e.visitInterval;break;case N.IntervalYearMonth:n=e.visitIntervalYearMonth||e.visitInterval;break;case N.FixedSizeList:n=e.visitFixedSizeList;break;case N.Map:n=e.visitMap;break}if(typeof n=="function")return n;if(!r)return()=>null;throw new Error(`Unrecognized type '${N[t]}'`)}function KL(e){switch(e.typeId){case N.Null:return N.Null;case N.Int:{let{bitWidth:t,isSigned:r}=e;switch(t){case 8:return r?N.Int8:N.Uint8;case 16:return r?N.Int16:N.Uint16;case 32:return r?N.Int32:N.Uint32;case 64:return r?N.Int64:N.Uint64}return N.Int}case N.Float:switch(e.precision){case qe.HALF:return N.Float16;case qe.SINGLE:return N.Float32;case qe.DOUBLE:return N.Float64}return N.Float;case N.Binary:return N.Binary;case N.Utf8:return N.Utf8;case N.Bool:return N.Bool;case N.Decimal:return N.Decimal;case N.Time:switch(e.unit){case re.SECOND:return N.TimeSecond;case re.MILLISECOND:return N.TimeMillisecond;case re.MICROSECOND:return N.TimeMicrosecond;case re.NANOSECOND:return N.TimeNanosecond}return N.Time;case N.Timestamp:switch(e.unit){case re.SECOND:return N.TimestampSecond;case re.MILLISECOND:return N.TimestampMillisecond;case re.MICROSECOND:return N.TimestampMicrosecond;case re.NANOSECOND:return N.TimestampNanosecond}return N.Timestamp;case N.Date:switch(e.unit){case sn.DAY:return N.DateDay;case sn.MILLISECOND:return N.DateMillisecond}return N.Date;case N.Interval:switch(e.unit){case Cn.DAY_TIME:return N.IntervalDayTime;case Cn.YEAR_MONTH:return N.IntervalYearMonth}return N.Interval;case N.Map:return N.Map;case N.List:return N.List;case N.Struct:return N.Struct;case N.Union:switch(e.mode){case er.Dense:return N.DenseUnion;case er.Sparse:return N.SparseUnion}return N.Union;case N.FixedSizeBinary:return N.FixedSizeBinary;case N.FixedSizeList:return N.FixedSizeList;case N.Dictionary:return N.Dictionary}throw new Error(`Unrecognized type '${N[e.typeId]}'`)}wt.prototype.visitInt8=null;wt.prototype.visitInt16=null;wt.prototype.visitInt32=null;wt.prototype.visitInt64=null;wt.prototype.visitUint8=null;wt.prototype.visitUint16=null;wt.prototype.visitUint32=null;wt.prototype.visitUint64=null;wt.prototype.visitFloat16=null;wt.prototype.visitFloat32=null;wt.prototype.visitFloat64=null;wt.prototype.visitDateDay=null;wt.prototype.visitDateMillisecond=null;wt.prototype.visitTimestampSecond=null;wt.prototype.visitTimestampMillisecond=null;wt.prototype.visitTimestampMicrosecond=null;wt.prototype.visitTimestampNanosecond=null;wt.prototype.visitTimeSecond=null;wt.prototype.visitTimeMillisecond=null;wt.prototype.visitTimeMicrosecond=null;wt.prototype.visitTimeNanosecond=null;wt.prototype.visitDenseUnion=null;wt.prototype.visitSparseUnion=null;wt.prototype.visitIntervalDayTime=null;wt.prototype.visitIntervalYearMonth=null;var NM={};Qr(NM,{float64ToUint16:()=>Oy,uint16ToFloat64:()=>L1});var QL=new Float64Array(1),Wd=new Uint32Array(QL.buffer);function L1(e){let t=(e&31744)>>10,r=(e&1023)/1024,n=Math.pow(-1,(e&32768)>>15);switch(t){case 31:return n*(r?Number.NaN:1/0);case 0:return n*(r?6103515625e-14*r:0)}return n*Math.pow(2,t-15)*(1+r)}function Oy(e){if(e!==e)return 32256;QL[0]=e;let t=(Wd[1]&2147483648)>>16&65535,r=Wd[1]&2146435072,n=0;return r>=1089470464?Wd[0]>0?r=31744:(r=(r&2080374784)>>16,n=(Wd[1]&1048575)>>10):r<=1056964608?(n=1048576+(Wd[1]&1048575),n=1048576+(n<<(r>>20)-998)>>21,r=0):(r=r-1056964608>>10,n=(Wd[1]&1048575)+512>>10),t|r|n&65535}var Ut=class extends wt{};function Ht(e){return(t,r,n)=>{if(t.setValid(r,n!=null))return e(t,r,n)}}var FZ=(e,t,r)=>{e[t]=Math.trunc(r/864e5)},DM=(e,t,r)=>{e[t]=Math.trunc(r%4294967296),e[t+1]=Math.trunc(r/4294967296)},NZ=(e,t,r)=>{e[t]=Math.trunc(r*1e3%4294967296),e[t+1]=Math.trunc(r*1e3/4294967296)},DZ=(e,t,r)=>{e[t]=Math.trunc(r*1e6%4294967296),e[t+1]=Math.trunc(r*1e6/4294967296)},JL=(e,t,r,n)=>{if(r+1<t.length){let{[r]:i,[r+1]:o}=t;e.set(n.subarray(0,o-i),i)}},LZ=({offset:e,values:t},r,n)=>{let i=e+r;n?t[i>>3]|=1<<i%8:t[i>>3]&=~(1<<i%8)},fc=({values:e},t,r)=>{e[t]=r},LM=({values:e},t,r)=>{e[t]=r},t4=({values:e},t,r)=>{e[t]=Oy(r)},RZ=(e,t,r)=>{switch(e.type.precision){case qe.HALF:return t4(e,t,r);case qe.SINGLE:case qe.DOUBLE:return LM(e,t,r)}},R1=({values:e},t,r)=>{FZ(e,t,r.valueOf())},k1=({values:e},t,r)=>{DM(e,t*2,r.valueOf())},RM=({stride:e,values:t},r,n)=>{t.set(n.subarray(0,e),e*r)},kZ=({values:e,valueOffsets:t},r,n)=>JL(e,t,r,n),CZ=({values:e,valueOffsets:t},r,n)=>{JL(e,t,r,_l(n))},kM=(e,t,r)=>{e.type.unit===sn.DAY?R1(e,t,r):k1(e,t,r)},C1=({values:e},t,r)=>DM(e,t*2,r/1e3),U1=({values:e},t,r)=>DM(e,t*2,r),P1=({values:e},t,r)=>NZ(e,t*2,r),$1=({values:e},t,r)=>DZ(e,t*2,r),CM=(e,t,r)=>{switch(e.type.unit){case re.SECOND:return C1(e,t,r);case re.MILLISECOND:return U1(e,t,r);case re.MICROSECOND:return P1(e,t,r);case re.NANOSECOND:return $1(e,t,r)}},z1=({values:e},t,r)=>{e[t]=r},V1=({values:e},t,r)=>{e[t]=r},j1=({values:e},t,r)=>{e[t]=r},q1=({values:e},t,r)=>{e[t]=r},UM=(e,t,r)=>{switch(e.type.unit){case re.SECOND:return z1(e,t,r);case re.MILLISECOND:return V1(e,t,r);case re.MICROSECOND:return j1(e,t,r);case re.NANOSECOND:return q1(e,t,r)}},PM=({values:e,stride:t},r,n)=>{e.set(n.subarray(0,t),t*r)},UZ=(e,t,r)=>{let n=e.children[0],i=e.valueOffsets,o=an.getVisitFn(n);if(Array.isArray(r))for(let s=-1,a=i[t],c=i[t+1];a<c;)o(n,a++,r[++s]);else for(let s=-1,a=i[t],c=i[t+1];a<c;)o(n,a++,r.get(++s))},PZ=(e,t,r)=>{let n=e.children[0],{valueOffsets:i}=e,o=an.getVisitFn(n),{[t]:s,[t+1]:a}=i,c=r instanceof Map?r.entries():Object.entries(r);for(let l of c)if(o(n,s,l),++s>=a)break},$Z=(e,t)=>(r,n,i,o)=>n&&r(n,e,t[o]),zZ=(e,t)=>(r,n,i,o)=>n&&r(n,e,t.get(o)),VZ=(e,t)=>(r,n,i,o)=>n&&r(n,e,t.get(i.name)),jZ=(e,t)=>(r,n,i,o)=>n&&r(n,e,t[i.name]),qZ=(e,t,r)=>{let n=e.type.children.map(o=>an.getVisitFn(o.type)),i=r instanceof Map?VZ(t,r):r instanceof ce?zZ(t,r):Array.isArray(r)?$Z(t,r):jZ(t,r);e.type.children.forEach((o,s)=>i(n[s],e.children[s],o,s))},YZ=(e,t,r)=>{e.type.mode===er.Dense?e4(e,t,r):r4(e,t,r)},e4=(e,t,r)=>{let n=e.type.typeIdToChildIndex[e.typeIds[t]],i=e.children[n];an.visit(i,e.valueOffsets[t],r)},r4=(e,t,r)=>{let n=e.type.typeIdToChildIndex[e.typeIds[t]],i=e.children[n];an.visit(i,t,r)},WZ=(e,t,r)=>{var n;(n=e.dictionary)===null||n===void 0||n.set(e.values[t],r)},$M=(e,t,r)=>{e.type.unit===Cn.DAY_TIME?Y1(e,t,r):W1(e,t,r)},Y1=({values:e},t,r)=>{e.set(r.subarray(0,2),2*t)},W1=({values:e},t,r)=>{e[t]=r[0]*12+r[1]%12},GZ=(e,t,r)=>{let{stride:n}=e,i=e.children[0],o=an.getVisitFn(i);if(Array.isArray(r))for(let s=-1,a=t*n;++s<n;)o(i,a+s,r[s]);else for(let s=-1,a=t*n;++s<n;)o(i,a+s,r.get(s))};Ut.prototype.visitBool=Ht(LZ);Ut.prototype.visitInt=Ht(fc);Ut.prototype.visitInt8=Ht(fc);Ut.prototype.visitInt16=Ht(fc);Ut.prototype.visitInt32=Ht(fc);Ut.prototype.visitInt64=Ht(fc);Ut.prototype.visitUint8=Ht(fc);Ut.prototype.visitUint16=Ht(fc);Ut.prototype.visitUint32=Ht(fc);Ut.prototype.visitUint64=Ht(fc);Ut.prototype.visitFloat=Ht(RZ);Ut.prototype.visitFloat16=Ht(t4);Ut.prototype.visitFloat32=Ht(LM);Ut.prototype.visitFloat64=Ht(LM);Ut.prototype.visitUtf8=Ht(CZ);Ut.prototype.visitBinary=Ht(kZ);Ut.prototype.visitFixedSizeBinary=Ht(RM);Ut.prototype.visitDate=Ht(kM);Ut.prototype.visitDateDay=Ht(R1);Ut.prototype.visitDateMillisecond=Ht(k1);Ut.prototype.visitTimestamp=Ht(CM);Ut.prototype.visitTimestampSecond=Ht(C1);Ut.prototype.visitTimestampMillisecond=Ht(U1);Ut.prototype.visitTimestampMicrosecond=Ht(P1);Ut.prototype.visitTimestampNanosecond=Ht($1);Ut.prototype.visitTime=Ht(UM);Ut.prototype.visitTimeSecond=Ht(z1);Ut.prototype.visitTimeMillisecond=Ht(V1);Ut.prototype.visitTimeMicrosecond=Ht(j1);Ut.prototype.visitTimeNanosecond=Ht(q1);Ut.prototype.visitDecimal=Ht(PM);Ut.prototype.visitList=Ht(UZ);Ut.prototype.visitStruct=Ht(qZ);Ut.prototype.visitUnion=Ht(YZ);Ut.prototype.visitDenseUnion=Ht(e4);Ut.prototype.visitSparseUnion=Ht(r4);Ut.prototype.visitDictionary=Ht(WZ);Ut.prototype.visitInterval=Ht($M);Ut.prototype.visitIntervalDayTime=Ht(Y1);Ut.prototype.visitIntervalYearMonth=Ht(W1);Ut.prototype.visitFixedSizeList=Ht(GZ);Ut.prototype.visitMap=Ht(PZ);var an=new Ut;var fs=Symbol.for("parent"),Gd=Symbol.for("rowIndex"),vl=class{constructor(t,r){return this[fs]=t,this[Gd]=r,new Proxy(this,new VM)}toArray(){return Object.values(this.toJSON())}toJSON(){let t=this[Gd],r=this[fs],n=r.type.children,i={};for(let o=-1,s=n.length;++o<s;)i[n[o].name]=Ir.visit(r.children[o],t);return i}toString(){return`{${[...this].map(([t,r])=>`${is(t)}: ${is(r)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new zM(this[fs],this[Gd])}},zM=class{constructor(t,r){this.childIndex=0,this.children=t.children,this.rowIndex=r,this.childFields=t.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){let t=this.childIndex;return t<this.numChildren?(this.childIndex=t+1,{done:!1,value:[this.childFields[t].name,Ir.visit(this.children[t],this.rowIndex)]}):{done:!0,value:null}}};Object.defineProperties(vl.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[fs]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Gd]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});var VM=class{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[fs].type.children.map(r=>r.name)}has(t,r){return t[fs].type.children.findIndex(n=>n.name===r)!==-1}getOwnPropertyDescriptor(t,r){if(t[fs].type.children.findIndex(n=>n.name===r)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(t,r){if(Reflect.has(t,r))return t[r];let n=t[fs].type.children.findIndex(i=>i.name===r);if(n!==-1){let i=Ir.visit(t[fs].children[n],t[Gd]);return Reflect.set(t,r,i),i}}set(t,r,n){let i=t[fs].type.children.findIndex(o=>o.name===r);return i!==-1?(an.visit(t[fs].children[i],t[Gd],n),Reflect.set(t,r,n)):Reflect.has(t,r)||typeof r=="symbol"?Reflect.set(t,r,n):!1}};var Et=class extends wt{};function Yt(e){return(t,r)=>t.getValid(r)?e(t,r):null}var XZ=(e,t)=>864e5*e[t],jM=(e,t)=>4294967296*e[t+1]+(e[t]>>>0),HZ=(e,t)=>4294967296*(e[t+1]/1e3)+(e[t]>>>0)/1e3,ZZ=(e,t)=>4294967296*(e[t+1]/1e6)+(e[t]>>>0)/1e6,n4=e=>new Date(e),KZ=(e,t)=>n4(XZ(e,t)),QZ=(e,t)=>n4(jM(e,t)),JZ=(e,t)=>null,i4=(e,t,r)=>{if(r+1>=t.length)return null;let n=t[r],i=t[r+1];return e.subarray(n,i)},tK=({offset:e,values:t},r)=>{let n=e+r;return(t[n>>3]&1<<n%8)!==0},o4=({values:e},t)=>KZ(e,t),s4=({values:e},t)=>QZ(e,t*2),Sl=({stride:e,values:t},r)=>t[e*r],eK=({stride:e,values:t},r)=>L1(t[e*r]),a4=({values:e},t)=>e[t],rK=({stride:e,values:t},r)=>t.subarray(e*r,e*(r+1)),nK=({values:e,valueOffsets:t},r)=>i4(e,t,r),iK=({values:e,valueOffsets:t},r)=>{let n=i4(e,t,r);return n!==null?Ty(n):null},oK=({values:e},t)=>e[t],sK=({type:e,values:t},r)=>e.precision!==qe.HALF?t[r]:L1(t[r]),aK=(e,t)=>e.type.unit===sn.DAY?o4(e,t):s4(e,t),c4=({values:e},t)=>1e3*jM(e,t*2),l4=({values:e},t)=>jM(e,t*2),u4=({values:e},t)=>HZ(e,t*2),f4=({values:e},t)=>ZZ(e,t*2),cK=(e,t)=>{switch(e.type.unit){case re.SECOND:return c4(e,t);case re.MILLISECOND:return l4(e,t);case re.MICROSECOND:return u4(e,t);case re.NANOSECOND:return f4(e,t)}},d4=({values:e},t)=>e[t],h4=({values:e},t)=>e[t],p4=({values:e},t)=>e[t],m4=({values:e},t)=>e[t],lK=(e,t)=>{switch(e.type.unit){case re.SECOND:return d4(e,t);case re.MILLISECOND:return h4(e,t);case re.MICROSECOND:return p4(e,t);case re.NANOSECOND:return m4(e,t)}},uK=({values:e,stride:t},r)=>By.decimal(e.subarray(t*r,t*(r+1))),fK=(e,t)=>{let{valueOffsets:r,stride:n,children:i}=e,{[t*n]:o,[t*n+1]:s}=r,c=i[0].slice(o,s-o);return new ce([c])},dK=(e,t)=>{let{valueOffsets:r,children:n}=e,{[t]:i,[t+1]:o}=r,s=n[0];return new Ws(s.slice(i,o-i))},hK=(e,t)=>new vl(e,t),pK=(e,t)=>e.type.mode===er.Dense?y4(e,t):g4(e,t),y4=(e,t)=>{let r=e.type.typeIdToChildIndex[e.typeIds[t]],n=e.children[r];return Ir.visit(n,e.valueOffsets[t])},g4=(e,t)=>{let r=e.type.typeIdToChildIndex[e.typeIds[t]],n=e.children[r];return Ir.visit(n,t)},mK=(e,t)=>{var r;return(r=e.dictionary)===null||r===void 0?void 0:r.get(e.values[t])},yK=(e,t)=>e.type.unit===Cn.DAY_TIME?b4(e,t):x4(e,t),b4=({values:e},t)=>e.subarray(2*t,2*(t+1)),x4=({values:e},t)=>{let r=e[t],n=new Int32Array(2);return n[0]=Math.trunc(r/12),n[1]=Math.trunc(r%12),n},gK=(e,t)=>{let{stride:r,children:n}=e,o=n[0].slice(t*r,r);return new ce([o])};Et.prototype.visitNull=Yt(JZ);Et.prototype.visitBool=Yt(tK);Et.prototype.visitInt=Yt(oK);Et.prototype.visitInt8=Yt(Sl);Et.prototype.visitInt16=Yt(Sl);Et.prototype.visitInt32=Yt(Sl);Et.prototype.visitInt64=Yt(a4);Et.prototype.visitUint8=Yt(Sl);Et.prototype.visitUint16=Yt(Sl);Et.prototype.visitUint32=Yt(Sl);Et.prototype.visitUint64=Yt(a4);Et.prototype.visitFloat=Yt(sK);Et.prototype.visitFloat16=Yt(eK);Et.prototype.visitFloat32=Yt(Sl);Et.prototype.visitFloat64=Yt(Sl);Et.prototype.visitUtf8=Yt(iK);Et.prototype.visitBinary=Yt(nK);Et.prototype.visitFixedSizeBinary=Yt(rK);Et.prototype.visitDate=Yt(aK);Et.prototype.visitDateDay=Yt(o4);Et.prototype.visitDateMillisecond=Yt(s4);Et.prototype.visitTimestamp=Yt(cK);Et.prototype.visitTimestampSecond=Yt(c4);Et.prototype.visitTimestampMillisecond=Yt(l4);Et.prototype.visitTimestampMicrosecond=Yt(u4);Et.prototype.visitTimestampNanosecond=Yt(f4);Et.prototype.visitTime=Yt(lK);Et.prototype.visitTimeSecond=Yt(d4);Et.prototype.visitTimeMillisecond=Yt(h4);Et.prototype.visitTimeMicrosecond=Yt(p4);Et.prototype.visitTimeNanosecond=Yt(m4);Et.prototype.visitDecimal=Yt(uK);Et.prototype.visitList=Yt(fK);Et.prototype.visitStruct=Yt(hK);Et.prototype.visitUnion=Yt(pK);Et.prototype.visitDenseUnion=Yt(y4);Et.prototype.visitSparseUnion=Yt(g4);Et.prototype.visitDictionary=Yt(mK);Et.prototype.visitInterval=Yt(yK);Et.prototype.visitIntervalDayTime=Yt(b4);Et.prototype.visitIntervalYearMonth=Yt(x4);Et.prototype.visitFixedSizeList=Yt(gK);Et.prototype.visitMap=Yt(dK);var Ir=new Et;var wo=Symbol.for("keys"),Xd=Symbol.for("vals"),Ws=class{constructor(t){return this[wo]=new ce([t.children[0]]).memoize(),this[Xd]=t.children[1],new Proxy(this,new YM)}[Symbol.iterator](){return new qM(this[wo],this[Xd])}get size(){return this[wo].length}toArray(){return Object.values(this.toJSON())}toJSON(){let t=this[wo],r=this[Xd],n={};for(let i=-1,o=t.length;++i<o;)n[t.get(i)]=Ir.visit(r,i);return n}toString(){return`{${[...this].map(([t,r])=>`${is(t)}: ${is(r)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}},qM=class{constructor(t,r){this.keys=t,this.vals=r,this.keyIndex=0,this.numKeys=t.length}[Symbol.iterator](){return this}next(){let t=this.keyIndex;return t===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(t),Ir.visit(this.vals,t)]})}},YM=class{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[wo].toArray().map(String)}has(t,r){return t[wo].includes(r)}getOwnPropertyDescriptor(t,r){if(t[wo].indexOf(r)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(t,r){if(Reflect.has(t,r))return t[r];let n=t[wo].indexOf(r);if(n!==-1){let i=Ir.visit(Reflect.get(t,Xd),n);return Reflect.set(t,r,i),i}}set(t,r,n){let i=t[wo].indexOf(r);return i!==-1?(an.visit(Reflect.get(t,Xd),i,n),Reflect.set(t,r,n)):Reflect.has(t,r)?Reflect.set(t,r,n):!1}};Object.defineProperties(Ws.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[wo]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Xd]:{writable:!0,enumerable:!1,configurable:!1,value:null}});function bK(e,t,r){let n=e.length,i=t>-1?t:n+t%n;return r?r(e,i):i}var _4;function Fy(e,t,r,n){let{length:i=0}=e,o=typeof t!="number"?0:t,s=typeof r!="number"?i:r;return o<0&&(o=(o%i+i)%i),s<0&&(s=(s%i+i)%i),s<o&&(_4=o,o=s,s=_4),s>i&&(s=i),n?n(e,o,s):[o,s]}var w4=e=>e!==e;function Il(e){if(typeof e!=="object"||e===null)return w4(e)?w4:r=>r===e;if(e instanceof Date){let r=e.valueOf();return n=>n instanceof Date?n.valueOf()===r:!1}return ArrayBuffer.isView(e)?r=>r?AM(e,r):!1:e instanceof Map?_K(e):Array.isArray(e)?xK(e):e instanceof ce?wK(e):vK(e,!0)}function xK(e){let t=[];for(let r=-1,n=e.length;++r<n;)t[r]=Il(e[r]);return G1(t)}function _K(e){let t=-1,r=[];for(let n of e.values())r[++t]=Il(n);return G1(r)}function wK(e){let t=[];for(let r=-1,n=e.length;++r<n;)t[r]=Il(e.get(r));return G1(t)}function vK(e,t=!1){let r=Object.keys(e);if(!t&&r.length===0)return()=>!1;let n=[];for(let i=-1,o=r.length;++i<o;)n[i]=Il(e[r[i]]);return G1(n,r)}function G1(e,t){return r=>{if(!r||typeof r!="object")return!1;switch(r.constructor){case Array:return SK(e,r);case Map:return v4(e,r,r.keys());case Ws:case vl:case Object:case void 0:return v4(e,r,t||Object.keys(r))}return r instanceof ce?IK(e,r):!1}}function SK(e,t){let r=e.length;if(t.length!==r)return!1;for(let n=-1;++n<r;)if(!e[n](t[n]))return!1;return!0}function IK(e,t){let r=e.length;if(t.length!==r)return!1;for(let n=-1;++n<r;)if(!e[n](t.get(n)))return!1;return!0}function v4(e,t,r){let n=r[Symbol.iterator](),i=t instanceof Map?t.keys():Object.keys(t)[Symbol.iterator](),o=t instanceof Map?t.values():Object.values(t)[Symbol.iterator](),s=0,a=e.length,c=o.next(),l=n.next(),u=i.next();for(;s<a&&!l.done&&!u.done&&!c.done&&!(l.value!==u.value||!e[s](c.value));++s,l=n.next(),u=i.next(),c=o.next());return s===a&&l.done&&u.done&&c.done?!0:(n.return&&n.return(),i.return&&i.return(),o.return&&o.return(),!1)}var GM={};Qr(GM,{BitIterator:()=>Ku,getBit:()=>S4,getBool:()=>H1,packBools:()=>Qu,popcnt_array:()=>I4,popcnt_bit_range:()=>Ny,popcnt_uint32:()=>X1,setBool:()=>TK,truncateBitmap:()=>Hd});function H1(e,t,r,n){return(r&1<<n)!==0}function S4(e,t,r,n){return(r&1<<n)>>n}function TK(e,t,r){return r?!!(e[t>>3]|=1<<t%8)||!0:!(e[t>>3]&=~(1<<t%8))&&!1}function Hd(e,t,r){let n=r.byteLength+7&-8;if(e>0||r.byteLength<n){let i=new Uint8Array(n);return i.set(e%8===0?r.subarray(e>>3):Qu(new Ku(r,e,t,null,H1)).subarray(0,n)),i}return r}function Qu(e){let t=[],r=0,n=0,i=0;for(let s of e)s&&(i|=1<<n),++n===8&&(t[r++]=i,i=n=0);(r===0||n>0)&&(t[r++]=i);let o=new Uint8Array(t.length+7&-8);return o.set(t),o}var Ku=class{constructor(t,r,n,i,o){this.bytes=t,this.length=n,this.context=i,this.get=o,this.bit=r%8,this.byteIndex=r>>3,this.byte=t[this.byteIndex++],this.index=0}next(){return this.index<this.length?(this.bit===8&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}};function Ny(e,t,r){if(r-t<=0)return 0;if(r-t<8){let o=0;for(let s of new Ku(e,t,r-t,e,S4))o+=s;return o}let n=r>>3<<3,i=t+(t%8===0?0:8-t%8);return Ny(e,t,i)+Ny(e,n,r)+I4(e,i>>3,n-i>>3)}function I4(e,t,r){let n=0,i=Math.trunc(t),o=new DataView(e.buffer,e.byteOffset,e.byteLength),s=r===void 0?e.byteLength:i+r;for(;s-i>=4;)n+=X1(o.getUint32(i)),i+=4;for(;s-i>=2;)n+=X1(o.getUint16(i)),i+=2;for(;s-i>=1;)n+=X1(o.getUint8(i)),i+=1;return n}function X1(e){let t=Math.trunc(e);return t=t-(t>>>1&1431655765),t=(t&858993459)+(t>>>2&858993459),(t+(t>>>4)&252645135)*16843009>>>24}var AK=-1,Ee=class e{constructor(t,r,n,i,o,s=[],a){this.type=t,this.children=s,this.dictionary=a,this.offset=Math.floor(Math.max(r||0,0)),this.length=Math.floor(Math.max(n||0,0)),this._nullCount=Math.floor(Math.max(i||0,-1));let c;o instanceof e?(this.stride=o.stride,this.values=o.values,this.typeIds=o.typeIds,this.nullBitmap=o.nullBitmap,this.valueOffsets=o.valueOffsets):(this.stride=Pi(t),o&&((c=o[0])&&(this.valueOffsets=c),(c=o[1])&&(this.values=c),(c=o[2])&&(this.nullBitmap=c),(c=o[3])&&(this.typeIds=c))),this.nullable=this._nullCount!==0&&this.nullBitmap&&this.nullBitmap.byteLength>0}get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get byteLength(){let t=0,{valueOffsets:r,values:n,nullBitmap:i,typeIds:o}=this;return r&&(t+=r.byteLength),n&&(t+=n.byteLength),i&&(t+=i.byteLength),o&&(t+=o.byteLength),this.children.reduce((s,a)=>s+a.byteLength,t)}get nullCount(){let t=this._nullCount,r;return t<=AK&&(r=this.nullBitmap)&&(this._nullCount=t=this.length-Ny(r,this.offset,this.offset+this.length)),t}getValid(t){if(this.nullable&&this.nullCount>0){let r=this.offset+t;return(this.nullBitmap[r>>3]&1<<r%8)!==0}return!0}setValid(t,r){if(!this.nullable)return r;if(!this.nullBitmap||this.nullBitmap.byteLength<=t>>3){let{nullBitmap:c}=this._changeLengthAndBackfillNullBitmap(this.length);Object.assign(this,{nullBitmap:c,_nullCount:0})}let{nullBitmap:n,offset:i}=this,o=i+t>>3,s=(i+t)%8,a=n[o]>>s&1;return r?a===0&&(n[o]|=1<<s,this._nullCount=this.nullCount+1):a===1&&(n[o]&=~(1<<s),this._nullCount=this.nullCount-1),r}clone(t=this.type,r=this.offset,n=this.length,i=this._nullCount,o=this,s=this.children){return new e(t,r,n,i,o,s,this.dictionary)}slice(t,r){let{stride:n,typeId:i,children:o}=this,s=+(this._nullCount===0)-1,a=i===16?n:1,c=this._sliceBuffers(t,r,n,i);return this.clone(this.type,this.offset+t,r,s,c,o.length===0||this.valueOffsets?o:this._sliceChildren(o,a*t,a*r))}_changeLengthAndBackfillNullBitmap(t){if(this.typeId===N.Null)return this.clone(this.type,0,t,0);let{length:r,nullCount:n}=this,i=new Uint8Array((t+63&-64)>>3).fill(255,0,r>>3);i[r>>3]=(1<<r-(r&-8))-1,n>0&&i.set(Hd(this.offset,r,this.nullBitmap),0);let o=this.buffers;return o[_o.VALIDITY]=i,this.clone(this.type,0,t,n+(t-r),o)}_sliceBuffers(t,r,n,i){let o,{buffers:s}=this;return(o=s[_o.TYPE])&&(s[_o.TYPE]=o.subarray(t,t+r)),(o=s[_o.OFFSET])&&(s[_o.OFFSET]=o.subarray(t,t+r+1))||(o=s[_o.DATA])&&(s[_o.DATA]=i===6?o:o.subarray(n*t,n*(t+r))),s}_sliceChildren(t,r,n){return t.map(i=>i.slice(r,n))}};Ee.prototype.children=Object.freeze([]);var XM=class e extends wt{visit(t){return this.getVisitFn(t.type).call(this,t)}visitNull(t){let{["type"]:r,["offset"]:n=0,["length"]:i=0}=t;return new Ee(r,n,i,0)}visitBool(t){let{["type"]:r,["offset"]:n=0}=t,i=Ct(t.nullBitmap),o=Jt(r.ArrayType,t.data),{["length"]:s=o.length>>3,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Ee(r,n,s,a,[void 0,o,i])}visitInt(t){let{["type"]:r,["offset"]:n=0}=t,i=Ct(t.nullBitmap),o=Jt(r.ArrayType,t.data),{["length"]:s=o.length,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Ee(r,n,s,a,[void 0,o,i])}visitFloat(t){let{["type"]:r,["offset"]:n=0}=t,i=Ct(t.nullBitmap),o=Jt(r.ArrayType,t.data),{["length"]:s=o.length,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Ee(r,n,s,a,[void 0,o,i])}visitUtf8(t){let{["type"]:r,["offset"]:n=0}=t,i=Ct(t.data),o=Ct(t.nullBitmap),s=Zu(t.valueOffsets),{["length"]:a=s.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new Ee(r,n,a,c,[s,i,o])}visitBinary(t){let{["type"]:r,["offset"]:n=0}=t,i=Ct(t.data),o=Ct(t.nullBitmap),s=Zu(t.valueOffsets),{["length"]:a=s.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new Ee(r,n,a,c,[s,i,o])}visitFixedSizeBinary(t){let{["type"]:r,["offset"]:n=0}=t,i=Ct(t.nullBitmap),o=Jt(r.ArrayType,t.data),{["length"]:s=o.length/Pi(r),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Ee(r,n,s,a,[void 0,o,i])}visitDate(t){let{["type"]:r,["offset"]:n=0}=t,i=Ct(t.nullBitmap),o=Jt(r.ArrayType,t.data),{["length"]:s=o.length/Pi(r),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Ee(r,n,s,a,[void 0,o,i])}visitTimestamp(t){let{["type"]:r,["offset"]:n=0}=t,i=Ct(t.nullBitmap),o=Jt(r.ArrayType,t.data),{["length"]:s=o.length/Pi(r),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Ee(r,n,s,a,[void 0,o,i])}visitTime(t){let{["type"]:r,["offset"]:n=0}=t,i=Ct(t.nullBitmap),o=Jt(r.ArrayType,t.data),{["length"]:s=o.length/Pi(r),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Ee(r,n,s,a,[void 0,o,i])}visitDecimal(t){let{["type"]:r,["offset"]:n=0}=t,i=Ct(t.nullBitmap),o=Jt(r.ArrayType,t.data),{["length"]:s=o.length/Pi(r),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Ee(r,n,s,a,[void 0,o,i])}visitList(t){let{["type"]:r,["offset"]:n=0,["child"]:i}=t,o=Ct(t.nullBitmap),s=Zu(t.valueOffsets),{["length"]:a=s.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new Ee(r,n,a,c,[s,void 0,o],[i])}visitStruct(t){let{["type"]:r,["offset"]:n=0,["children"]:i=[]}=t,o=Ct(t.nullBitmap),{length:s=i.reduce((c,{length:l})=>Math.max(c,l),0),nullCount:a=t.nullBitmap?-1:0}=t;return new Ee(r,n,s,a,[void 0,void 0,o],i)}visitUnion(t){let{["type"]:r,["offset"]:n=0,["children"]:i=[]}=t,o=Ct(t.nullBitmap),s=Jt(r.ArrayType,t.typeIds),{["length"]:a=s.length,["nullCount"]:c=t.nullBitmap?-1:0}=t;if(mt.isSparseUnion(r))return new Ee(r,n,a,c,[void 0,void 0,o,s],i);let l=Zu(t.valueOffsets);return new Ee(r,n,a,c,[l,void 0,o,s],i)}visitDictionary(t){let{["type"]:r,["offset"]:n=0}=t,i=Ct(t.nullBitmap),o=Jt(r.indices.ArrayType,t.data),{["dictionary"]:s=new ce([new e().visit({type:r.dictionary})])}=t,{["length"]:a=o.length,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new Ee(r,n,a,c,[void 0,o,i],[],s)}visitInterval(t){let{["type"]:r,["offset"]:n=0}=t,i=Ct(t.nullBitmap),o=Jt(r.ArrayType,t.data),{["length"]:s=o.length/Pi(r),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Ee(r,n,s,a,[void 0,o,i])}visitFixedSizeList(t){let{["type"]:r,["offset"]:n=0,["child"]:i=new e().visit({type:r.valueType})}=t,o=Ct(t.nullBitmap),{["length"]:s=i.length/Pi(r),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Ee(r,n,s,a,[void 0,void 0,o],[i])}visitMap(t){let{["type"]:r,["offset"]:n=0,["child"]:i=new e().visit({type:r.childType})}=t,o=Ct(t.nullBitmap),s=Zu(t.valueOffsets),{["length"]:a=s.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new Ee(r,n,a,c,[s,void 0,o],[i])}};function zt(e){return new XM().visit(e)}var Dy=class{constructor(t=0,r){this.numChunks=t,this.getChunkIterator=r,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){let t=this.chunkIterator.next();if(!t.done)return t;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}};function Z1(e){return e.reduce((t,r)=>t+r.nullCount,0)}function K1(e){return e.reduce((t,r,n)=>(t[n+1]=t[n]+r.length,t),new Uint32Array(e.length+1))}function Q1(e,t,r,n){let i=[];for(let o=-1,s=e.length;++o<s;){let a=e[o],c=t[o],{length:l}=a;if(c>=n)break;if(r>=c+l)continue;if(c>=r&&c+l<=n){i.push(a);continue}let u=Math.max(0,r-c),f=Math.min(n-c,l);i.push(a.slice(u,f-u))}return i.length===0&&i.push(e[0].slice(0,0)),i}function HM(e,t,r,n){let i=0,o=0,s=t.length-1;do{if(i>=s-1)return r<t[s]?n(e,i,r-t[i]):null;o=i+Math.trunc((s-i)*.5),r<t[o]?s=o:i=o}while(i<s)}function Ly(e,t){return e.getValid(t)}function Tl(e){function t(r,n,i){return e(r[n],i)}return function(r){let n=this.data;return HM(n,this._offsets,r,t)}}function J1(e){let t;function r(n,i,o){return e(n[i],o,t)}return function(n,i){let o=this.data;t=i;let s=HM(o,this._offsets,n,r);return t=void 0,s}}function tw(e){let t;function r(n,i,o){let s=o,a=0,c=0;for(let l=i-1,u=n.length;++l<u;){let f=n[l];if(~(a=e(f,t,s)))return c+a;s=0,c+=f.length}return-1}return function(n,i){t=n;let o=this.data,s=typeof i!="number"?r(o,0,0):HM(o,this._offsets,i,r);return t=void 0,s}}var Bt=class extends wt{};function MK(e,t){return t===null&&e.length>0?0:-1}function EK(e,t){let{nullBitmap:r}=e;if(!r||e.nullCount<=0)return-1;let n=0;for(let i of new Ku(r,e.offset+(t||0),e.length,r,H1)){if(!i)return n;++n}return-1}function te(e,t,r){if(t===void 0)return-1;if(t===null)return EK(e,r);let n=Ir.getVisitFn(e),i=Il(t);for(let o=(r||0)-1,s=e.length;++o<s;)if(i(n(e,o)))return o;return-1}function T4(e,t,r){let n=Ir.getVisitFn(e),i=Il(t);for(let o=(r||0)-1,s=e.length;++o<s;)if(i(n(e,o)))return o;return-1}Bt.prototype.visitNull=MK;Bt.prototype.visitBool=te;Bt.prototype.visitInt=te;Bt.prototype.visitInt8=te;Bt.prototype.visitInt16=te;Bt.prototype.visitInt32=te;Bt.prototype.visitInt64=te;Bt.prototype.visitUint8=te;Bt.prototype.visitUint16=te;Bt.prototype.visitUint32=te;Bt.prototype.visitUint64=te;Bt.prototype.visitFloat=te;Bt.prototype.visitFloat16=te;Bt.prototype.visitFloat32=te;Bt.prototype.visitFloat64=te;Bt.prototype.visitUtf8=te;Bt.prototype.visitBinary=te;Bt.prototype.visitFixedSizeBinary=te;Bt.prototype.visitDate=te;Bt.prototype.visitDateDay=te;Bt.prototype.visitDateMillisecond=te;Bt.prototype.visitTimestamp=te;Bt.prototype.visitTimestampSecond=te;Bt.prototype.visitTimestampMillisecond=te;Bt.prototype.visitTimestampMicrosecond=te;Bt.prototype.visitTimestampNanosecond=te;Bt.prototype.visitTime=te;Bt.prototype.visitTimeSecond=te;Bt.prototype.visitTimeMillisecond=te;Bt.prototype.visitTimeMicrosecond=te;Bt.prototype.visitTimeNanosecond=te;Bt.prototype.visitDecimal=te;Bt.prototype.visitList=te;Bt.prototype.visitStruct=te;Bt.prototype.visitUnion=te;Bt.prototype.visitDenseUnion=T4;Bt.prototype.visitSparseUnion=T4;Bt.prototype.visitDictionary=te;Bt.prototype.visitInterval=te;Bt.prototype.visitIntervalDayTime=te;Bt.prototype.visitIntervalYearMonth=te;Bt.prototype.visitFixedSizeList=te;Bt.prototype.visitMap=te;var Ju=new Bt;var Ot=class extends wt{};function Wt(e){let{type:t}=e;if(e.nullCount===0&&e.stride===1&&(t.typeId===N.Timestamp||t instanceof gr&&t.bitWidth!==64||t instanceof ss&&t.bitWidth!==64||t instanceof bi&&t.precision!==qe.HALF))return new Dy(e.data.length,n=>{let i=e.data[n];return i.values.subarray(0,i.length)[Symbol.iterator]()});let r=0;return new Dy(e.data.length,n=>{let o=e.data[n].length,s=e.slice(r,r+o);return r+=o,new ZM(s)})}var ZM=class{constructor(t){this.vector=t,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}};Ot.prototype.visitNull=Wt;Ot.prototype.visitBool=Wt;Ot.prototype.visitInt=Wt;Ot.prototype.visitInt8=Wt;Ot.prototype.visitInt16=Wt;Ot.prototype.visitInt32=Wt;Ot.prototype.visitInt64=Wt;Ot.prototype.visitUint8=Wt;Ot.prototype.visitUint16=Wt;Ot.prototype.visitUint32=Wt;Ot.prototype.visitUint64=Wt;Ot.prototype.visitFloat=Wt;Ot.prototype.visitFloat16=Wt;Ot.prototype.visitFloat32=Wt;Ot.prototype.visitFloat64=Wt;Ot.prototype.visitUtf8=Wt;Ot.prototype.visitBinary=Wt;Ot.prototype.visitFixedSizeBinary=Wt;Ot.prototype.visitDate=Wt;Ot.prototype.visitDateDay=Wt;Ot.prototype.visitDateMillisecond=Wt;Ot.prototype.visitTimestamp=Wt;Ot.prototype.visitTimestampSecond=Wt;Ot.prototype.visitTimestampMillisecond=Wt;Ot.prototype.visitTimestampMicrosecond=Wt;Ot.prototype.visitTimestampNanosecond=Wt;Ot.prototype.visitTime=Wt;Ot.prototype.visitTimeSecond=Wt;Ot.prototype.visitTimeMillisecond=Wt;Ot.prototype.visitTimeMicrosecond=Wt;Ot.prototype.visitTimeNanosecond=Wt;Ot.prototype.visitDecimal=Wt;Ot.prototype.visitList=Wt;Ot.prototype.visitStruct=Wt;Ot.prototype.visitUnion=Wt;Ot.prototype.visitDenseUnion=Wt;Ot.prototype.visitSparseUnion=Wt;Ot.prototype.visitDictionary=Wt;Ot.prototype.visitInterval=Wt;Ot.prototype.visitIntervalDayTime=Wt;Ot.prototype.visitIntervalYearMonth=Wt;Ot.prototype.visitFixedSizeList=Wt;Ot.prototype.visitMap=Wt;var Zd=new Ot;var BK=(e,t)=>e+t,Gs=class extends wt{visitNull(t,r){return 0}visitInt(t,r){return t.type.bitWidth/8}visitFloat(t,r){return t.type.ArrayType.BYTES_PER_ELEMENT}visitBool(t,r){return 1/8}visitDecimal(t,r){return t.type.bitWidth/8}visitDate(t,r){return(t.type.unit+1)*4}visitTime(t,r){return t.type.bitWidth/8}visitTimestamp(t,r){return t.type.unit===re.SECOND?4:8}visitInterval(t,r){return(t.type.unit+1)*4}visitStruct(t,r){return t.children.reduce((n,i)=>n+$i.visit(i,r),0)}visitFixedSizeBinary(t,r){return t.type.byteWidth}visitMap(t,r){return 8+t.children.reduce((n,i)=>n+$i.visit(i,r),0)}visitDictionary(t,r){var n;return t.type.indices.bitWidth/8+(((n=t.dictionary)===null||n===void 0?void 0:n.getByteLength(t.values[r]))||0)}},OK=({valueOffsets:e},t)=>8+(e[t+1]-e[t]),FK=({valueOffsets:e},t)=>8+(e[t+1]-e[t]),NK=({valueOffsets:e,stride:t,children:r},n)=>{let i=r[0],{[n*t]:o}=e,{[n*t+1]:s}=e,a=$i.getVisitFn(i.type),c=i.slice(o,s-o),l=8;for(let u=-1,f=s-o;++u<f;)l+=a(c,u);return l},DK=({stride:e,children:t},r)=>{let n=t[0],i=n.slice(r*e,e),o=$i.getVisitFn(n.type),s=0;for(let a=-1,c=i.length;++a<c;)s+=o(i,a);return s},LK=(e,t)=>e.type.mode===er.Dense?A4(e,t):M4(e,t),A4=({type:e,children:t,typeIds:r,valueOffsets:n},i)=>{let o=e.typeIdToChildIndex[r[i]];return 8+$i.visit(t[o],n[i])},M4=({children:e},t)=>4+$i.visitMany(e,e.map(()=>t)).reduce(BK,0);Gs.prototype.visitUtf8=OK;Gs.prototype.visitBinary=FK;Gs.prototype.visitList=NK;Gs.prototype.visitFixedSizeList=DK;Gs.prototype.visitUnion=LK;Gs.prototype.visitDenseUnion=A4;Gs.prototype.visitSparseUnion=M4;var $i=new Gs;var E4,B4={},O4={},ce=class e{constructor(t){var r,n,i;let o=t[0]instanceof e?t.flatMap(a=>a.data):t;if(o.length===0||o.some(a=>!(a instanceof Ee)))throw new TypeError("Vector constructor expects an Array of Data instances.");let s=(r=o[0])===null||r===void 0?void 0:r.type;switch(o.length){case 0:this._offsets=[0];break;case 1:{let{get:a,set:c,indexOf:l,byteLength:u}=B4[s.typeId],f=o[0];this.isValid=d=>Ly(f,d),this.get=d=>a(f,d),this.set=(d,h)=>c(f,d,h),this.indexOf=d=>l(f,d),this.getByteLength=d=>u(f,d),this._offsets=[0,f.length];break}default:Object.setPrototypeOf(this,O4[s.typeId]),this._offsets=K1(o);break}this.data=o,this.type=s,this.stride=Pi(s),this.numChildren=(i=(n=s.children)===null||n===void 0?void 0:n.length)!==null&&i!==void 0?i:0,this.length=this._offsets[this._offsets.length-1]}get byteLength(){return this._byteLength===-1&&(this._byteLength=this.data.reduce((t,r)=>t+r.byteLength,0)),this._byteLength}get nullCount(){return this._nullCount===-1&&(this._nullCount=Z1(this.data)),this._nullCount}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${N[this.type.typeId]}Vector`}isValid(t){return!1}get(t){return null}set(t,r){}indexOf(t,r){return-1}includes(t,r){return this.indexOf(t,r)>0}getByteLength(t){return 0}[Symbol.iterator](){return Zd.visit(this)}concat(...t){return new e(this.data.concat(t.flatMap(r=>r.data).flat(Number.POSITIVE_INFINITY)))}slice(t,r){return new e(Fy(this,t,r,({data:n,_offsets:i},o,s)=>Q1(n,i,o,s)))}toJSON(){return[...this]}toArray(){let{type:t,data:r,length:n,stride:i,ArrayType:o}=this;switch(t.typeId){case N.Int:case N.Float:case N.Decimal:case N.Time:case N.Timestamp:switch(r.length){case 0:return new o;case 1:return r[0].values.subarray(0,n*i);default:return r.reduce((s,{values:a,length:c})=>(s.array.set(a.subarray(0,c*i),s.offset),s.offset+=c*i,s),{array:new o(n*i),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild(t){var r;return this.getChildAt((r=this.type.children)===null||r===void 0?void 0:r.findIndex(n=>n.name===t))}getChildAt(t){return t>-1&&t<this.numChildren?new e(this.data.map(({children:r})=>r[t])):null}get isMemoized(){return mt.isDictionary(this.type)?this.data[0].dictionary.isMemoized:!1}memoize(){if(mt.isDictionary(this.type)){let t=new ew(this.data[0].dictionary),r=this.data.map(n=>{let i=n.clone();return i.dictionary=t,i});return new e(r)}return new ew(this)}unmemoize(){if(mt.isDictionary(this.type)&&this.isMemoized){let t=this.data[0].dictionary.unmemoize(),r=this.data.map(n=>{let i=n.clone();return i.dictionary=t,i});return new e(r)}return this}};E4=Symbol.toStringTag;ce[E4]=(e=>{e.type=mt.prototype,e.data=[],e.length=0,e.stride=1,e.numChildren=0,e._nullCount=-1,e._byteLength=-1,e._offsets=new Uint32Array([0]),e[Symbol.isConcatSpreadable]=!0;let t=Object.keys(N).map(r=>N[r]).filter(r=>typeof r=="number"&&r!==N.NONE);for(let r of t){let n=Ir.getVisitFnByTypeId(r),i=an.getVisitFnByTypeId(r),o=Ju.getVisitFnByTypeId(r),s=$i.getVisitFnByTypeId(r);B4[r]={get:n,set:i,indexOf:o,byteLength:s},O4[r]=Object.create(e,{isValid:{value:Tl(Ly)},get:{value:Tl(Ir.getVisitFnByTypeId(r))},set:{value:J1(an.getVisitFnByTypeId(r))},indexOf:{value:tw(Ju.getVisitFnByTypeId(r))},getByteLength:{value:Tl($i.getVisitFnByTypeId(r))}})}return"Vector"})(ce.prototype);var ew=class e extends ce{constructor(t){super(t.data);let r=this.get,n=this.set,i=this.slice,o=new Array(this.length);Object.defineProperty(this,"get",{value(s){let a=o[s];if(a!==void 0)return a;let c=r.call(this,s);return o[s]=c,c}}),Object.defineProperty(this,"set",{value(s,a){n.call(this,s,a),o[s]=a}}),Object.defineProperty(this,"slice",{value:(s,a)=>new e(i.call(this,s,a))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new ce(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}};function F4(e){if(!e||e.length<=0)return function(i){return!0};let t="",r=e.filter(n=>n===n);return r.length>0&&(t=`
    switch (x) {${r.map(n=>`
        case ${RK(n)}:`).join("")}
            return false;
    }`),e.length!==r.length&&(t=`if (x !== x) return false;
${t}`),new Function("x",`${t}
return true;`)}function RK(e){return typeof e!="bigint"?is(e):m1?`${is(e)}n`:`"${is(e)}"`}var KM=(e,t)=>(Math.ceil(e)*t+63&-64||64)/t,kK=(e,t=0)=>e.length>=t?e.subarray(0,t):Vd(new e.constructor(t),e,0),Al=class{constructor(t,r=1){this.buffer=t,this.stride=r,this.BYTES_PER_ELEMENT=t.BYTES_PER_ELEMENT,this.ArrayType=t.constructor,this._resize(this.length=Math.ceil(t.length/r))}get byteLength(){return Math.ceil(this.length*this.stride)*this.BYTES_PER_ELEMENT}get reservedLength(){return this.buffer.length/this.stride}get reservedByteLength(){return this.buffer.byteLength}set(t,r){return this}append(t){return this.set(this.length,t)}reserve(t){if(t>0){this.length+=t;let r=this.stride,n=this.length*r,i=this.buffer.length;n>=i&&this._resize(i===0?KM(n*1,this.BYTES_PER_ELEMENT):KM(n*2,this.BYTES_PER_ELEMENT))}return this}flush(t=this.length){t=KM(t*this.stride,this.BYTES_PER_ELEMENT);let r=kK(this.buffer,t);return this.clear(),r}clear(){return this.length=0,this._resize(0),this}_resize(t){return this.buffer=Vd(new this.ArrayType(t),this.buffer)}};Al.prototype.offset=0;var dc=class extends Al{last(){return this.get(this.length-1)}get(t){return this.buffer[t]}set(t,r){return this.reserve(t-this.length+1),this.buffer[t*this.stride]=r,this}},Kd=class extends dc{constructor(t=new Uint8Array(0)){super(t,1/8),this.numValid=0}get numInvalid(){return this.length-this.numValid}get(t){return this.buffer[t>>3]>>t%8&1}set(t,r){let{buffer:n}=this.reserve(t-this.length+1),i=t>>3,o=t%8,s=n[i]>>o&1;return r?s===0&&(n[i]|=1<<o,++this.numValid):s===1&&(n[i]&=~(1<<o),--this.numValid),this}clear(){return this.numValid=0,super.clear()}},Qd=class extends dc{constructor(t=new Int32Array(1)){super(t,1)}append(t){return this.set(this.length-1,t)}set(t,r){let n=this.length-1,i=this.reserve(t-n+1).buffer;return n<t++&&i.fill(i[n],n,t),i[t]=i[t-1]+r,this}flush(t=this.length-1){return t>this.length&&this.set(t-1,0),super.flush(t+1)}};var Ye=class{constructor({type:t,nullValues:r}){this.length=0,this.finished=!1,this.type=t,this.children=[],this.nullValues=r,this.stride=Pi(t),this._nulls=new Kd,r&&r.length>0&&(this._isValid=F4(r))}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t){throw new Error('"throughDOM" not available in this environment')}toVector(){return new ce([this.flush()])}get ArrayType(){return this.type.ArrayType}get nullCount(){return this._nulls.numInvalid}get numChildren(){return this.children.length}get byteLength(){let t=0,{_offsets:r,_values:n,_nulls:i,_typeIds:o,children:s}=this;return r&&(t+=r.byteLength),n&&(t+=n.byteLength),i&&(t+=i.byteLength),o&&(t+=o.byteLength),s.reduce((a,c)=>a+c.byteLength,t)}get reservedLength(){return this._nulls.reservedLength}get reservedByteLength(){let t=0;return this._offsets&&(t+=this._offsets.reservedByteLength),this._values&&(t+=this._values.reservedByteLength),this._nulls&&(t+=this._nulls.reservedByteLength),this._typeIds&&(t+=this._typeIds.reservedByteLength),this.children.reduce((r,n)=>r+n.reservedByteLength,t)}get valueOffsets(){return this._offsets?this._offsets.buffer:null}get values(){return this._values?this._values.buffer:null}get nullBitmap(){return this._nulls?this._nulls.buffer:null}get typeIds(){return this._typeIds?this._typeIds.buffer:null}append(t){return this.set(this.length,t)}isValid(t){return this._isValid(t)}set(t,r){return this.setValid(t,this.isValid(r))&&this.setValue(t,r),this}setValue(t,r){this._setValue(this,t,r)}setValid(t,r){return this.length=this._nulls.set(t,+r).length,r}addChild(t,r=`${this.numChildren}`){throw new Error(`Cannot append children to non-nested type "${this.type}"`)}getChildAt(t){return this.children[t]||null}flush(){let t,r,n,i,{type:o,length:s,nullCount:a,_typeIds:c,_offsets:l,_values:u,_nulls:f}=this;(r=c?.flush(s))?i=l?.flush(s):(i=l?.flush(s))?t=u?.flush(l.last()):t=u?.flush(s),a>0&&(n=f?.flush(s));let d=this.children.map(h=>h.flush());return this.clear(),zt({type:o,length:s,nullCount:a,children:d,child:d[0],data:t,typeIds:r,nullBitmap:n,valueOffsets:i})}finish(){this.finished=!0;for(let t of this.children)t.finish();return this}clear(){var t,r,n,i;this.length=0,(t=this._nulls)===null||t===void 0||t.clear(),(r=this._values)===null||r===void 0||r.clear(),(n=this._offsets)===null||n===void 0||n.clear(),(i=this._typeIds)===null||i===void 0||i.clear();for(let o of this.children)o.clear();return this}};Ye.prototype.length=1;Ye.prototype.stride=1;Ye.prototype.children=null;Ye.prototype.finished=!1;Ye.prototype.nullValues=null;Ye.prototype._isValid=()=>!0;var zr=class extends Ye{constructor(t){super(t),this._values=new dc(new this.ArrayType(0),this.stride)}setValue(t,r){let n=this._values;return n.reserve(t-n.length+1),super.setValue(t,r)}},Xs=class extends Ye{constructor(t){super(t),this._pendingLength=0,this._offsets=new Qd}setValue(t,r){let n=this._pending||(this._pending=new Map),i=n.get(t);i&&(this._pendingLength-=i.length),this._pendingLength+=r instanceof Ws?r[wo].length:r.length,n.set(t,r)}setValid(t,r){return super.setValid(t,r)?!0:((this._pending||(this._pending=new Map)).set(t,void 0),!1)}clear(){return this._pendingLength=0,this._pending=void 0,super.clear()}flush(){return this._flush(),super.flush()}finish(){return this._flush(),super.finish()}_flush(){let t=this._pending,r=this._pendingLength;return this._pendingLength=0,this._pending=void 0,t&&t.size>0&&this._flushPending(t,r),this}};var tf=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock(t,r,n,i){return t.prep(8,24),t.writeInt64(i),t.pad(4),t.writeInt32(n),t.writeInt64(r),t.offset()}};var Hs=new Int32Array(2),rw=new Float32Array(Hs.buffer),nw=new Float64Array(Hs.buffer),Jd=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;var cn=class e{constructor(t,r){this.low=t|0,this.high=r|0}static create(t,r){return t==0&&r==0?e.ZERO:new e(t,r)}toFloat64(){return(this.low>>>0)+this.high*4294967296}equals(t){return this.low==t.low&&this.high==t.high}};cn.ZERO=new cn(0,0);var Ry;(function(e){e[e.UTF8_BYTES=1]="UTF8_BYTES",e[e.UTF16_STRING=2]="UTF16_STRING"})(Ry||(Ry={}));var zi=class e{constructor(t){this.bytes_=t,this.position_=0}static allocate(t){return new e(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return new cn(this.readInt32(t),this.readInt32(t+4))}readUint64(t){return new cn(this.readUint32(t),this.readUint32(t+4))}readFloat32(t){return Hs[0]=this.readInt32(t),rw[0]}readFloat64(t){return Hs[Jd?0:1]=this.readInt32(t),Hs[Jd?1:0]=this.readInt32(t+4),nw[0]}writeInt8(t,r){this.bytes_[t]=r}writeUint8(t,r){this.bytes_[t]=r}writeInt16(t,r){this.bytes_[t]=r,this.bytes_[t+1]=r>>8}writeUint16(t,r){this.bytes_[t]=r,this.bytes_[t+1]=r>>8}writeInt32(t,r){this.bytes_[t]=r,this.bytes_[t+1]=r>>8,this.bytes_[t+2]=r>>16,this.bytes_[t+3]=r>>24}writeUint32(t,r){this.bytes_[t]=r,this.bytes_[t+1]=r>>8,this.bytes_[t+2]=r>>16,this.bytes_[t+3]=r>>24}writeInt64(t,r){this.writeInt32(t,r.low),this.writeInt32(t+4,r.high)}writeUint64(t,r){this.writeUint32(t,r.low),this.writeUint32(t+4,r.high)}writeFloat32(t,r){rw[0]=r,this.writeInt32(t,Hs[0])}writeFloat64(t,r){nw[0]=r,this.writeInt32(t,Hs[Jd?0:1]),this.writeInt32(t+4,Hs[Jd?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+4+4)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let r=0;r<4;r++)t+=String.fromCharCode(this.readInt8(this.position_+4+r));return t}__offset(t,r){let n=t-this.readInt32(t);return r<this.readInt16(n)?this.readInt16(n+r):0}__union(t,r){return t.bb_pos=r+this.readInt32(r),t.bb=this,t}__string(t,r){t+=this.readInt32(t);let n=this.readInt32(t),i="",o=0;if(t+=4,r===Ry.UTF8_BYTES)return this.bytes_.subarray(t,t+n);for(;o<n;){let s,a=this.readUint8(t+o++);if(a<192)s=a;else{let c=this.readUint8(t+o++);if(a<224)s=(a&31)<<6|c&63;else{let l=this.readUint8(t+o++);if(a<240)s=(a&15)<<12|(c&63)<<6|l&63;else{let u=this.readUint8(t+o++);s=(a&7)<<18|(c&63)<<12|(l&63)<<6|u&63}}}s<65536?i+=String.fromCharCode(s):(s-=65536,i+=String.fromCharCode((s>>10)+55296,(s&1024-1)+56320))}return i}__union_with_string(t,r){return typeof t=="string"?this.__string(r):this.__union(t,r)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+4}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(t.length!=4)throw new Error("FlatBuffers: file identifier must be length "+4);for(let r=0;r<4;r++)if(t.charCodeAt(r)!=this.readInt8(this.position()+4+r))return!1;return!0}createLong(t,r){return cn.create(t,r)}createScalarList(t,r){let n=[];for(let i=0;i<r;++i)t(i)!==null&&n.push(t(i));return n}createObjList(t,r){let n=[];for(let i=0;i<r;++i){let o=t(i);o!==null&&n.push(o.unpack())}return n}};var ef=class e{constructor(t){this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null;let r;t?r=t:r=1024,this.bb=zi.allocate(r),this.space=r}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(t){this.force_defaults=t}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(t,r){t>this.minalign&&(this.minalign=t);let n=~(this.bb.capacity()-this.space+r)+1&t-1;for(;this.space<n+t+r;){let i=this.bb.capacity();this.bb=e.growByteBuffer(this.bb),this.space+=this.bb.capacity()-i}this.pad(n)}pad(t){for(let r=0;r<t;r++)this.bb.writeInt8(--this.space,0)}writeInt8(t){this.bb.writeInt8(this.space-=1,t)}writeInt16(t){this.bb.writeInt16(this.space-=2,t)}writeInt32(t){this.bb.writeInt32(this.space-=4,t)}writeInt64(t){this.bb.writeInt64(this.space-=8,t)}writeFloat32(t){this.bb.writeFloat32(this.space-=4,t)}writeFloat64(t){this.bb.writeFloat64(this.space-=8,t)}addInt8(t){this.prep(1,0),this.writeInt8(t)}addInt16(t){this.prep(2,0),this.writeInt16(t)}addInt32(t){this.prep(4,0),this.writeInt32(t)}addInt64(t){this.prep(8,0),this.writeInt64(t)}addFloat32(t){this.prep(4,0),this.writeFloat32(t)}addFloat64(t){this.prep(8,0),this.writeFloat64(t)}addFieldInt8(t,r,n){(this.force_defaults||r!=n)&&(this.addInt8(r),this.slot(t))}addFieldInt16(t,r,n){(this.force_defaults||r!=n)&&(this.addInt16(r),this.slot(t))}addFieldInt32(t,r,n){(this.force_defaults||r!=n)&&(this.addInt32(r),this.slot(t))}addFieldInt64(t,r,n){(this.force_defaults||!r.equals(n))&&(this.addInt64(r),this.slot(t))}addFieldFloat32(t,r,n){(this.force_defaults||r!=n)&&(this.addFloat32(r),this.slot(t))}addFieldFloat64(t,r,n){(this.force_defaults||r!=n)&&(this.addFloat64(r),this.slot(t))}addFieldOffset(t,r,n){(this.force_defaults||r!=n)&&(this.addOffset(r),this.slot(t))}addFieldStruct(t,r,n){r!=n&&(this.nested(r),this.slot(t))}nested(t){if(t!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")}slot(t){this.vtable!==null&&(this.vtable[t]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(t){let r=t.capacity();if(r&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");let n=r<<1,i=zi.allocate(n);return i.setPosition(n-r),i.bytes().set(t.bytes(),n-r),i}addOffset(t){this.prep(4,0),this.writeInt32(this.offset()-t+4)}startObject(t){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=t;for(let r=0;r<t;r++)this.vtable[r]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);let t=this.offset(),r=this.vtable_in_use-1;for(;r>=0&&this.vtable[r]==0;r--);let n=r+1;for(;r>=0;r--)this.addInt16(this.vtable[r]!=0?t-this.vtable[r]:0);let i=2;this.addInt16(t-this.object_start);let o=(n+i)*2;this.addInt16(o);let s=0,a=this.space;t:for(r=0;r<this.vtables.length;r++){let c=this.bb.capacity()-this.vtables[r];if(o==this.bb.readInt16(c)){for(let l=2;l<o;l+=2)if(this.bb.readInt16(a+l)!=this.bb.readInt16(c+l))continue t;s=this.vtables[r];break}}return s?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,s-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t}finish(t,r,n){let i=n?4:0;if(r){let o=r;if(this.prep(this.minalign,4+4+i),o.length!=4)throw new Error("FlatBuffers: file identifier must be length "+4);for(let s=4-1;s>=0;s--)this.writeInt8(o.charCodeAt(s))}this.prep(this.minalign,4+i),this.addOffset(t),i&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(t,r){this.finish(t,r,!0)}requiredField(t,r){let n=this.bb.capacity()-t,i=n-this.bb.readInt32(n);if(!(this.bb.readInt16(i+r)!=0))throw new Error("FlatBuffers: field "+r+" must be set")}startVector(t,r,n){this.notNested(),this.vector_num_elems=r,this.prep(4,t*r),this.prep(n,t*r)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(t){if(!t)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(t))return this.string_maps.get(t);let r=this.createString(t);return this.string_maps.set(t,r),r}createString(t){if(!t)return 0;let r;if(t instanceof Uint8Array)r=t;else{r=[];let n=0;for(;n<t.length;){let i,o=t.charCodeAt(n++);if(o<55296||o>=56320)i=o;else{let s=t.charCodeAt(n++);i=(o<<10)+s+(65536-56623104-56320)}i<128?r.push(i):(i<2048?r.push(i>>6&31|192):(i<65536?r.push(i>>12&15|224):r.push(i>>18&7|240,i>>12&63|128),r.push(i>>6&63|128)),r.push(i&63|128))}}this.addInt8(0),this.startVector(1,r.length,1),this.bb.setPosition(this.space-=r.length);for(let n=0,i=this.space,o=this.bb.bytes();n<r.length;n++)o[i++]=r[n];return this.endVector()}createLong(t,r){return cn.create(t,r)}createObjectOffset(t){return t===null?0:typeof t=="string"?this.createString(t):t.pack(this)}createObjectOffsetList(t){let r=[];for(let n=0;n<t.length;++n){let i=t[n];if(i!==null)r.push(this.createObjectOffset(i));else throw new Error("FlatBuffers: Argument for createObjectOffsetList cannot contain null.")}return r}createStructOffsetList(t,r){return r(this,t.length),this.createObjectOffsetList(t),this.endVector()}};var Rr=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsKeyValue(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsKeyValue(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}key(t){let r=this.bb.__offset(this.bb_pos,4);return r?this.bb.__string(this.bb_pos+r,t):null}value(t){let r=this.bb.__offset(this.bb_pos,6);return r?this.bb.__string(this.bb_pos+r,t):null}static startKeyValue(t){t.startObject(2)}static addKey(t,r){t.addFieldOffset(0,r,0)}static addValue(t,r){t.addFieldOffset(1,r,0)}static endKeyValue(t){return t.endObject()}static createKeyValue(t,r,n){return e.startKeyValue(t),e.addKey(t,r),e.addValue(t,n),e.endKeyValue(t)}};var Ml;(function(e){e[e.V1=0]="V1",e[e.V2=1]="V2",e[e.V3=2]="V3",e[e.V4=3]="V4",e[e.V5=4]="V5"})(Ml||(Ml={}));var El;(function(e){e[e.Little=0]="Little",e[e.Big=1]="Big"})(El||(El={}));var ky;(function(e){e[e.DenseArray=0]="DenseArray"})(ky||(ky={}));var hs=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsInt(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInt(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}bitWidth(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}isSigned(){let t=this.bb.__offset(this.bb_pos,6);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startInt(t){t.startObject(2)}static addBitWidth(t,r){t.addFieldInt32(0,r,0)}static addIsSigned(t,r){t.addFieldInt8(1,+r,0)}static endInt(t){return t.endObject()}static createInt(t,r,n){return e.startInt(t),e.addBitWidth(t,r),e.addIsSigned(t,n),e.endInt(t)}};var Zs=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsDictionaryEncoding(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryEncoding(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}id(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}indexType(t){let r=this.bb.__offset(this.bb_pos,6);return r?(t||new hs).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}isOrdered(){let t=this.bb.__offset(this.bb_pos,8);return t?!!this.bb.readInt8(this.bb_pos+t):!1}dictionaryKind(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt16(this.bb_pos+t):ky.DenseArray}static startDictionaryEncoding(t){t.startObject(4)}static addId(t,r){t.addFieldInt64(0,r,t.createLong(0,0))}static addIndexType(t,r){t.addFieldOffset(1,r,0)}static addIsOrdered(t,r){t.addFieldInt8(2,+r,0)}static addDictionaryKind(t,r){t.addFieldInt16(3,r,ky.DenseArray)}static endDictionaryEncoding(t){return t.endObject()}};var Cy=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsBinary(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBinary(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static startBinary(t){t.startObject(0)}static endBinary(t){return t.endObject()}static createBinary(t){return e.startBinary(t),e.endBinary(t)}};var Uy=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsBool(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBool(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static startBool(t){t.startObject(0)}static endBool(t){return t.endObject()}static createBool(t){return e.startBool(t),e.endBool(t)}};var Py;(function(e){e[e.DAY=0]="DAY",e[e.MILLISECOND=1]="MILLISECOND"})(Py||(Py={}));var Bl=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsDate(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDate(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Py.MILLISECOND}static startDate(t){t.startObject(1)}static addUnit(t,r){t.addFieldInt16(0,r,Py.MILLISECOND)}static endDate(t){return t.endObject()}static createDate(t,r){return e.startDate(t),e.addUnit(t,r),e.endDate(t)}};var Ks=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsDecimal(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDecimal(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}precision(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}scale(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):0}bitWidth(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt32(this.bb_pos+t):128}static startDecimal(t){t.startObject(3)}static addPrecision(t,r){t.addFieldInt32(0,r,0)}static addScale(t,r){t.addFieldInt32(1,r,0)}static addBitWidth(t,r){t.addFieldInt32(2,r,128)}static endDecimal(t){return t.endObject()}static createDecimal(t,r,n,i){return e.startDecimal(t),e.addPrecision(t,r),e.addScale(t,n),e.addBitWidth(t,i),e.endDecimal(t)}};var Ol;(function(e){e[e.SECOND=0]="SECOND",e[e.MILLISECOND=1]="MILLISECOND",e[e.MICROSECOND=2]="MICROSECOND",e[e.NANOSECOND=3]="NANOSECOND"})(Ol||(Ol={}));var Fl=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsFixedSizeBinary(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeBinary(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}byteWidth(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeBinary(t){t.startObject(1)}static addByteWidth(t,r){t.addFieldInt32(0,r,0)}static endFixedSizeBinary(t){return t.endObject()}static createFixedSizeBinary(t,r){return e.startFixedSizeBinary(t),e.addByteWidth(t,r),e.endFixedSizeBinary(t)}};var Nl=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsFixedSizeList(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeList(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}listSize(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeList(t){t.startObject(1)}static addListSize(t,r){t.addFieldInt32(0,r,0)}static endFixedSizeList(t){return t.endObject()}static createFixedSizeList(t,r){return e.startFixedSizeList(t),e.addListSize(t,r),e.endFixedSizeList(t)}};var $y;(function(e){e[e.HALF=0]="HALF",e[e.SINGLE=1]="SINGLE",e[e.DOUBLE=2]="DOUBLE"})($y||($y={}));var Dl=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsFloatingPoint(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFloatingPoint(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}precision(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):$y.HALF}static startFloatingPoint(t){t.startObject(1)}static addPrecision(t,r){t.addFieldInt16(0,r,$y.HALF)}static endFloatingPoint(t){return t.endObject()}static createFloatingPoint(t,r){return e.startFloatingPoint(t),e.addPrecision(t,r),e.endFloatingPoint(t)}};var zy;(function(e){e[e.YEAR_MONTH=0]="YEAR_MONTH",e[e.DAY_TIME=1]="DAY_TIME",e[e.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(zy||(zy={}));var Ll=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsInterval(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInterval(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):zy.YEAR_MONTH}static startInterval(t){t.startObject(1)}static addUnit(t,r){t.addFieldInt16(0,r,zy.YEAR_MONTH)}static endInterval(t){return t.endObject()}static createInterval(t,r){return e.startInterval(t),e.addUnit(t,r),e.endInterval(t)}};var Vy=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsList(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsList(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static startList(t){t.startObject(0)}static endList(t){return t.endObject()}static createList(t){return e.startList(t),e.endList(t)}};var Rl=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsMap(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMap(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}keysSorted(){let t=this.bb.__offset(this.bb_pos,4);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startMap(t){t.startObject(1)}static addKeysSorted(t,r){t.addFieldInt8(0,+r,0)}static endMap(t){return t.endObject()}static createMap(t,r){return e.startMap(t),e.addKeysSorted(t,r),e.endMap(t)}};var jy=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsNull(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsNull(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static startNull(t){t.startObject(0)}static endNull(t){return t.endObject()}static createNull(t){return e.startNull(t),e.endNull(t)}};var qy=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsStruct_(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsStruct_(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static startStruct_(t){t.startObject(0)}static endStruct_(t){return t.endObject()}static createStruct_(t){return e.startStruct_(t),e.endStruct_(t)}};var hc=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsTime(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTime(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Ol.MILLISECOND}bitWidth(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):32}static startTime(t){t.startObject(2)}static addUnit(t,r){t.addFieldInt16(0,r,Ol.MILLISECOND)}static addBitWidth(t,r){t.addFieldInt32(1,r,32)}static endTime(t){return t.endObject()}static createTime(t,r,n){return e.startTime(t),e.addUnit(t,r),e.addBitWidth(t,n),e.endTime(t)}};var pc=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsTimestamp(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTimestamp(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Ol.SECOND}timezone(t){let r=this.bb.__offset(this.bb_pos,6);return r?this.bb.__string(this.bb_pos+r,t):null}static startTimestamp(t){t.startObject(2)}static addUnit(t,r){t.addFieldInt16(0,r,Ol.SECOND)}static addTimezone(t,r){t.addFieldOffset(1,r,0)}static endTimestamp(t){return t.endObject()}static createTimestamp(t,r,n){return e.startTimestamp(t),e.addUnit(t,r),e.addTimezone(t,n),e.endTimestamp(t)}};var Yy;(function(e){e[e.Sparse=0]="Sparse",e[e.Dense=1]="Dense"})(Yy||(Yy={}));var ps=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsUnion(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUnion(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}mode(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Yy.Sparse}typeIds(t){let r=this.bb.__offset(this.bb_pos,6);return r?this.bb.readInt32(this.bb.__vector(this.bb_pos+r)+t*4):0}typeIdsLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}typeIdsArray(){let t=this.bb.__offset(this.bb_pos,6);return t?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startUnion(t){t.startObject(2)}static addMode(t,r){t.addFieldInt16(0,r,Yy.Sparse)}static addTypeIds(t,r){t.addFieldOffset(1,r,0)}static createTypeIdsVector(t,r){t.startVector(4,r.length,4);for(let n=r.length-1;n>=0;n--)t.addInt32(r[n]);return t.endVector()}static startTypeIdsVector(t,r){t.startVector(4,r,4)}static endUnion(t){return t.endObject()}static createUnion(t,r,n){return e.startUnion(t),e.addMode(t,r),e.addTypeIds(t,n),e.endUnion(t)}};var Wy=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsUtf8(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUtf8(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static startUtf8(t){t.startObject(0)}static endUtf8(t){return t.endObject()}static createUtf8(t){return e.startUtf8(t),e.endUtf8(t)}};var We;(function(e){e[e.NONE=0]="NONE",e[e.Null=1]="Null",e[e.Int=2]="Int",e[e.FloatingPoint=3]="FloatingPoint",e[e.Binary=4]="Binary",e[e.Utf8=5]="Utf8",e[e.Bool=6]="Bool",e[e.Decimal=7]="Decimal",e[e.Date=8]="Date",e[e.Time=9]="Time",e[e.Timestamp=10]="Timestamp",e[e.Interval=11]="Interval",e[e.List=12]="List",e[e.Struct_=13]="Struct_",e[e.Union=14]="Union",e[e.FixedSizeBinary=15]="FixedSizeBinary",e[e.FixedSizeList=16]="FixedSizeList",e[e.Map=17]="Map",e[e.Duration=18]="Duration",e[e.LargeBinary=19]="LargeBinary",e[e.LargeUtf8=20]="LargeUtf8",e[e.LargeList=21]="LargeList"})(We||(We={}));var vn=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsField(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsField(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}name(t){let r=this.bb.__offset(this.bb_pos,4);return r?this.bb.__string(this.bb_pos+r,t):null}nullable(){let t=this.bb.__offset(this.bb_pos,6);return t?!!this.bb.readInt8(this.bb_pos+t):!1}typeType(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint8(this.bb_pos+t):We.NONE}type(t){let r=this.bb.__offset(this.bb_pos,10);return r?this.bb.__union(t,this.bb_pos+r):null}dictionary(t){let r=this.bb.__offset(this.bb_pos,12);return r?(t||new Zs).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}children(t,r){let n=this.bb.__offset(this.bb_pos,14);return n?(r||new e).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}childrenLength(){let t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,r){let n=this.bb.__offset(this.bb_pos,16);return n?(r||new Rr).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}customMetadataLength(){let t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}static startField(t){t.startObject(7)}static addName(t,r){t.addFieldOffset(0,r,0)}static addNullable(t,r){t.addFieldInt8(1,+r,0)}static addTypeType(t,r){t.addFieldInt8(2,r,We.NONE)}static addType(t,r){t.addFieldOffset(3,r,0)}static addDictionary(t,r){t.addFieldOffset(4,r,0)}static addChildren(t,r){t.addFieldOffset(5,r,0)}static createChildrenVector(t,r){t.startVector(4,r.length,4);for(let n=r.length-1;n>=0;n--)t.addOffset(r[n]);return t.endVector()}static startChildrenVector(t,r){t.startVector(4,r,4)}static addCustomMetadata(t,r){t.addFieldOffset(6,r,0)}static createCustomMetadataVector(t,r){t.startVector(4,r.length,4);for(let n=r.length-1;n>=0;n--)t.addOffset(r[n]);return t.endVector()}static startCustomMetadataVector(t,r){t.startVector(4,r,4)}static endField(t){return t.endObject()}};var xi=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsSchema(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsSchema(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}endianness(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):El.Little}fields(t,r){let n=this.bb.__offset(this.bb_pos,6);return n?(r||new vn).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}fieldsLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,r){let n=this.bb.__offset(this.bb_pos,8);return n?(r||new Rr).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}customMetadataLength(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}features(t){let r=this.bb.__offset(this.bb_pos,10);return r?this.bb.readInt64(this.bb.__vector(this.bb_pos+r)+t*8):this.bb.createLong(0,0)}featuresLength(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}static startSchema(t){t.startObject(4)}static addEndianness(t,r){t.addFieldInt16(0,r,El.Little)}static addFields(t,r){t.addFieldOffset(1,r,0)}static createFieldsVector(t,r){t.startVector(4,r.length,4);for(let n=r.length-1;n>=0;n--)t.addOffset(r[n]);return t.endVector()}static startFieldsVector(t,r){t.startVector(4,r,4)}static addCustomMetadata(t,r){t.addFieldOffset(2,r,0)}static createCustomMetadataVector(t,r){t.startVector(4,r.length,4);for(let n=r.length-1;n>=0;n--)t.addOffset(r[n]);return t.endVector()}static startCustomMetadataVector(t,r){t.startVector(4,r,4)}static addFeatures(t,r){t.addFieldOffset(3,r,0)}static createFeaturesVector(t,r){t.startVector(8,r.length,8);for(let n=r.length-1;n>=0;n--)t.addInt64(r[n]);return t.endVector()}static startFeaturesVector(t,r){t.startVector(8,r,8)}static endSchema(t){return t.endObject()}static finishSchemaBuffer(t,r){t.finish(r)}static finishSizePrefixedSchemaBuffer(t,r){t.finish(r,void 0,!0)}static createSchema(t,r,n,i,o){return e.startSchema(t),e.addEndianness(t,r),e.addFields(t,n),e.addCustomMetadata(t,i),e.addFeatures(t,o),e.endSchema(t)}};var Vi=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsFooter(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFooter(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}version(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Ml.V1}schema(t){let r=this.bb.__offset(this.bb_pos,6);return r?(t||new xi).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}dictionaries(t,r){let n=this.bb.__offset(this.bb_pos,8);return n?(r||new tf).__init(this.bb.__vector(this.bb_pos+n)+t*24,this.bb):null}dictionariesLength(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}recordBatches(t,r){let n=this.bb.__offset(this.bb_pos,10);return n?(r||new tf).__init(this.bb.__vector(this.bb_pos+n)+t*24,this.bb):null}recordBatchesLength(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,r){let n=this.bb.__offset(this.bb_pos,12);return n?(r||new Rr).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}customMetadataLength(){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startFooter(t){t.startObject(5)}static addVersion(t,r){t.addFieldInt16(0,r,Ml.V1)}static addSchema(t,r){t.addFieldOffset(1,r,0)}static addDictionaries(t,r){t.addFieldOffset(2,r,0)}static startDictionariesVector(t,r){t.startVector(24,r,8)}static addRecordBatches(t,r){t.addFieldOffset(3,r,0)}static startRecordBatchesVector(t,r){t.startVector(24,r,8)}static addCustomMetadata(t,r){t.addFieldOffset(4,r,0)}static createCustomMetadataVector(t,r){t.startVector(4,r.length,4);for(let n=r.length-1;n>=0;n--)t.addOffset(r[n]);return t.endVector()}static startCustomMetadataVector(t,r){t.startVector(4,r,4)}static endFooter(t){return t.endObject()}static finishFooterBuffer(t,r){t.finish(r)}static finishSizePrefixedFooterBuffer(t,r){t.finish(r,void 0,!0)}};var ve=class e{constructor(t=[],r,n){this.fields=t||[],this.metadata=r||new Map,n||(n=QM(t)),this.dictionaries=n}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map(t=>t.name)}toString(){return`Schema<{ ${this.fields.map((t,r)=>`${r}: ${t}`).join(", ")} }>`}select(t){let r=new Set(t),n=this.fields.filter(i=>r.has(i.name));return new e(n,this.metadata)}selectAt(t){let r=t.map(n=>this.fields[n]).filter(Boolean);return new e(r,this.metadata)}assign(...t){let r=t[0]instanceof e?t[0]:Array.isArray(t[0])?new e(t[0]):new e(t),n=[...this.fields],i=ow(ow(new Map,this.metadata),r.metadata),o=r.fields.filter(a=>{let c=n.findIndex(l=>l.name===a.name);return~c?(n[c]=a.clone({metadata:ow(ow(new Map,n[c].metadata),a.metadata)}))&&!1:!0}),s=QM(o,new Map);return new e([...n,...o],i,new Map([...this.dictionaries,...s]))}};ve.prototype.fields=null;ve.prototype.metadata=null;ve.prototype.dictionaries=null;var ee=class e{constructor(t,r,n=!1,i){this.name=t,this.type=r,this.nullable=n,this.metadata=i||new Map}static new(...t){let[r,n,i,o]=t;return t[0]&&typeof t[0]=="object"&&({name:r}=t[0],n===void 0&&(n=t[0].type),i===void 0&&(i=t[0].nullable),o===void 0&&(o=t[0].metadata)),new e(`${r}`,n,i,o)}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...t){let[r,n,i,o]=t;return!t[0]||typeof t[0]!="object"?[r=this.name,n=this.type,i=this.nullable,o=this.metadata]=t:{name:r=this.name,type:n=this.type,nullable:i=this.nullable,metadata:o=this.metadata}=t[0],e.new(r,n,i,o)}};ee.prototype.type=null;ee.prototype.name=null;ee.prototype.nullable=null;ee.prototype.metadata=null;function ow(e,t){return new Map([...e||new Map,...t||new Map])}function QM(e,t=new Map){for(let r=-1,n=e.length;++r<n;){let o=e[r].type;if(mt.isDictionary(o)){if(!t.has(o.id))t.set(o.id,o.dictionary);else if(t.get(o.id)!==o.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}o.children&&o.children.length>0&&QM(o.children,t)}return t}var N4=cn,CK=ef,UK=zi,mc=class{constructor(t,r=$r.V4,n,i){this.schema=t,this.version=r,n&&(this._recordBatches=n),i&&(this._dictionaryBatches=i)}static decode(t){t=new UK(Ct(t));let r=Vi.getRootAsFooter(t),n=ve.decode(r.schema());return new JM(n,r)}static encode(t){let r=new CK,n=ve.encode(r,t.schema);Vi.startRecordBatchesVector(r,t.numRecordBatches);for(let s of[...t.recordBatches()].slice().reverse())yc.encode(r,s);let i=r.endVector();Vi.startDictionariesVector(r,t.numDictionaries);for(let s of[...t.dictionaryBatches()].slice().reverse())yc.encode(r,s);let o=r.endVector();return Vi.startFooter(r),Vi.addSchema(r,n),Vi.addVersion(r,$r.V4),Vi.addRecordBatches(r,i),Vi.addDictionaries(r,o),Vi.finishFooterBuffer(r,Vi.endFooter(r)),r.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}*recordBatches(){for(let t,r=-1,n=this.numRecordBatches;++r<n;)(t=this.getRecordBatch(r))&&(yield t)}*dictionaryBatches(){for(let t,r=-1,n=this.numDictionaries;++r<n;)(t=this.getDictionaryBatch(r))&&(yield t)}getRecordBatch(t){return t>=0&&t<this.numRecordBatches&&this._recordBatches[t]||null}getDictionaryBatch(t){return t>=0&&t<this.numDictionaries&&this._dictionaryBatches[t]||null}};var JM=class extends mc{constructor(t,r){super(t,r.version()),this._footer=r}get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}getRecordBatch(t){if(t>=0&&t<this.numRecordBatches){let r=this._footer.recordBatches(t);if(r)return yc.decode(r)}return null}getDictionaryBatch(t){if(t>=0&&t<this.numDictionaries){let r=this._footer.dictionaries(t);if(r)return yc.decode(r)}return null}},yc=class e{constructor(t,r,n){this.metaDataLength=t,this.offset=typeof n=="number"?n:n.low,this.bodyLength=typeof r=="number"?r:r.low}static decode(t){return new e(t.metaDataLength(),t.bodyLength(),t.offset())}static encode(t,r){let{metaDataLength:n}=r,i=new N4(r.offset,0),o=new N4(r.bodyLength,0);return tf.createBlock(t,i,n,o)}};var $e=Object.freeze({done:!0,value:void 0}),Gy=class{constructor(t){this._json=t}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}},rf=class{tee(){return this._getDOMStream().tee()}pipe(t,r){return this._getNodeStream().pipe(t,r)}pipeTo(t,r){return this._getDOMStream().pipeTo(t,r)}pipeThrough(t,r){return this._getDOMStream().pipeThrough(t,r)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}},sw=class extends rf{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise(t=>this._closedPromiseResolve=t)}get closed(){return this._closedPromise}cancel(t){return P(this,void 0,void 0,function*(){yield this.return(t)})}write(t){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(t):this.resolvers.shift().resolve({done:!1,value:t}))}abort(t){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:t}:this.resolvers.shift().reject({done:!0,value:t}))}close(){if(this._closedPromiseResolve){let{resolvers:t}=this;for(;t.length>0;)t.shift().resolve($e);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(t){return on.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,t)}toNodeStream(t){return on.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,t)}throw(t){return P(this,void 0,void 0,function*(){return yield this.abort(t),$e})}return(t){return P(this,void 0,void 0,function*(){return yield this.close(),$e})}read(t){return P(this,void 0,void 0,function*(){return(yield this.next(t,"read")).value})}peek(t){return P(this,void 0,void 0,function*(){return(yield this.next(t,"peek")).value})}next(...t){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise((r,n)=>{this.resolvers.push({resolve:r,reject:n})}):Promise.resolve($e)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error("AsyncQueue is closed")}};var Qs=class extends sw{write(t){if((t=Ct(t)).byteLength>0)return super.write(t)}toString(t=!1){return t?Ty(this.toUint8Array(!0)):this.toUint8Array(!1).then(Ty)}toUint8Array(t=!1){return t?Ci(this._values)[0]:(()=>P(this,void 0,void 0,function*(){var r,n;let i=[],o=0;try{for(var s=or(this),a;a=yield s.next(),!a.done;){let c=a.value;i.push(c),o+=c.byteLength}}catch(c){r={error:c}}finally{try{a&&!a.done&&(n=s.return)&&(yield n.call(s))}finally{if(r)throw r.error}}return Ci(i,o)[0]}))()}},Js=class{constructor(t){t&&(this.source=new tE(on.fromIterable(t)))}[Symbol.iterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}},So=class e{constructor(t){t instanceof e?this.source=t.source:t instanceof Qs?this.source=new gc(on.fromAsyncIterable(t)):w1(t)?this.source=new gc(on.fromNodeStream(t)):Ay(t)?this.source=new gc(on.fromDOMStream(t)):x1(t)?this.source=new gc(on.fromDOMStream(t.body)):rs(t)?this.source=new gc(on.fromIterable(t)):es(t)?this.source=new gc(on.fromAsyncIterable(t)):xo(t)&&(this.source=new gc(on.fromAsyncIterable(t)))}[Symbol.asyncIterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}get closed(){return this.source.closed}cancel(t){return this.source.cancel(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}},tE=class{constructor(t){this.source=t}cancel(t){this.return(t)}peek(t){return this.next(t,"peek").value}read(t){return this.next(t,"read").value}next(t,r="read"){return this.source.next({cmd:r,size:t})}throw(t){return Object.create(this.source.throw&&this.source.throw(t)||$e)}return(t){return Object.create(this.source.return&&this.source.return(t)||$e)}},gc=class{constructor(t){this.source=t,this._closedPromise=new Promise(r=>this._closedPromiseResolve=r)}cancel(t){return P(this,void 0,void 0,function*(){yield this.return(t)})}get closed(){return this._closedPromise}read(t){return P(this,void 0,void 0,function*(){return(yield this.next(t,"read")).value})}peek(t){return P(this,void 0,void 0,function*(){return(yield this.next(t,"peek")).value})}next(t,r="read"){return P(this,void 0,void 0,function*(){return yield this.source.next({cmd:r,size:t})})}throw(t){return P(this,void 0,void 0,function*(){let r=this.source.throw&&(yield this.source.throw(t))||$e;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(r)})}return(t){return P(this,void 0,void 0,function*(){let r=this.source.return&&(yield this.source.return(t))||$e;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(r)})}};var Xy=class extends Js{constructor(t,r){super(),this.position=0,this.buffer=Ct(t),this.size=typeof r>"u"?this.buffer.byteLength:r}readInt32(t){let{buffer:r,byteOffset:n}=this.readAt(t,4);return new DataView(r,n).getInt32(0,!0)}seek(t){return this.position=Math.min(t,this.size),t<this.size}read(t){let{buffer:r,size:n,position:i}=this;return r&&i<n?(typeof t!="number"&&(t=Number.POSITIVE_INFINITY),this.position=Math.min(n,i+Math.min(n-i,t)),r.subarray(i,this.position)):null}readAt(t,r){let n=this.buffer,i=Math.min(this.size,t+r);return n?n.subarray(t,i):new Uint8Array(r)}close(){this.buffer&&(this.buffer=null)}throw(t){return this.close(),{done:!0,value:t}}return(t){return this.close(),{done:!0,value:t}}},kl=class extends So{constructor(t,r){super(),this.position=0,this._handle=t,typeof r=="number"?this.size=r:this._pending=(()=>P(this,void 0,void 0,function*(){this.size=(yield t.stat()).size,delete this._pending}))()}readInt32(t){return P(this,void 0,void 0,function*(){let{buffer:r,byteOffset:n}=yield this.readAt(t,4);return new DataView(r,n).getInt32(0,!0)})}seek(t){return P(this,void 0,void 0,function*(){return this._pending&&(yield this._pending),this.position=Math.min(t,this.size),t<this.size})}read(t){return P(this,void 0,void 0,function*(){this._pending&&(yield this._pending);let{_handle:r,size:n,position:i}=this;if(r&&i<n){typeof t!="number"&&(t=Number.POSITIVE_INFINITY);let o=i,s=0,a=0,c=Math.min(n,o+Math.min(n-o,t)),l=new Uint8Array(Math.max(0,(this.position=c)-o));for(;(o+=a)<c&&(s+=a)<l.byteLength;)({bytesRead:a}=yield r.read(l,s,l.byteLength-s,o));return l}return null})}readAt(t,r){return P(this,void 0,void 0,function*(){this._pending&&(yield this._pending);let{_handle:n,size:i}=this;if(n&&t+r<i){let o=Math.min(i,t+r),s=new Uint8Array(o-t);return(yield n.read(s,0,r,t)).buffer}return new Uint8Array(r)})}close(){return P(this,void 0,void 0,function*(){let t=this._handle;this._handle=null,t&&(yield t.close())})}throw(t){return P(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:t}})}return(t){return P(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:t}})}};var rE={};Qr(rE,{BaseInt64:()=>Hy,Int128:()=>Zy,Int64:()=>bc,Uint64:()=>rr});function th(e){return e<0&&(e=4294967295+e+1),`0x${e.toString(16)}`}var eh=8,eE=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8],Hy=class{constructor(t){this.buffer=t}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(t){let r=new Uint32Array([this.buffer[1]>>>16,this.buffer[1]&65535,this.buffer[0]>>>16,this.buffer[0]&65535]),n=new Uint32Array([t.buffer[1]>>>16,t.buffer[1]&65535,t.buffer[0]>>>16,t.buffer[0]&65535]),i=r[3]*n[3];this.buffer[0]=i&65535;let o=i>>>16;return i=r[2]*n[3],o+=i,i=r[3]*n[2]>>>0,o+=i,this.buffer[0]+=o<<16,this.buffer[1]=o>>>0<i?65536:0,this.buffer[1]+=o>>>16,this.buffer[1]+=r[1]*n[3]+r[2]*n[2]+r[3]*n[1],this.buffer[1]+=r[0]*n[3]+r[1]*n[2]+r[2]*n[1]+r[3]*n[0]<<16,this}_plus(t){let r=this.buffer[0]+t.buffer[0]>>>0;this.buffer[1]+=t.buffer[1],r<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=r}lessThan(t){return this.buffer[1]<t.buffer[1]||this.buffer[1]===t.buffer[1]&&this.buffer[0]<t.buffer[0]}equals(t){return this.buffer[1]===t.buffer[1]&&this.buffer[0]==t.buffer[0]}greaterThan(t){return t.lessThan(this)}hex(){return`${th(this.buffer[1])} ${th(this.buffer[0])}`}},rr=class e extends Hy{times(t){return this._times(t),this}plus(t){return this._plus(t),this}static from(t,r=new Uint32Array(2)){return e.fromString(typeof t=="string"?t:t.toString(),r)}static fromNumber(t,r=new Uint32Array(2)){return e.fromString(t.toString(),r)}static fromString(t,r=new Uint32Array(2)){let n=t.length,i=new e(r);for(let o=0;o<n;){let s=eh<n-o?eh:n-o,a=new e(new Uint32Array([Number.parseInt(t.slice(o,o+s),10),0])),c=new e(new Uint32Array([eE[s],0]));i.times(c),i.plus(a),o+=s}return i}static convertArray(t){let r=new Uint32Array(t.length*2);for(let n=-1,i=t.length;++n<i;)e.from(t[n],new Uint32Array(r.buffer,r.byteOffset+2*n*4,2));return r}static multiply(t,r){return new e(new Uint32Array(t.buffer)).times(r)}static add(t,r){return new e(new Uint32Array(t.buffer)).plus(r)}},bc=class e extends Hy{negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[0]==0&&++this.buffer[1],this}times(t){return this._times(t),this}plus(t){return this._plus(t),this}lessThan(t){let r=this.buffer[1]<<0,n=t.buffer[1]<<0;return r<n||r===n&&this.buffer[0]<t.buffer[0]}static from(t,r=new Uint32Array(2)){return e.fromString(typeof t=="string"?t:t.toString(),r)}static fromNumber(t,r=new Uint32Array(2)){return e.fromString(t.toString(),r)}static fromString(t,r=new Uint32Array(2)){let n=t.startsWith("-"),i=t.length,o=new e(r);for(let s=n?1:0;s<i;){let a=eh<i-s?eh:i-s,c=new e(new Uint32Array([Number.parseInt(t.slice(s,s+a),10),0])),l=new e(new Uint32Array([eE[a],0]));o.times(l),o.plus(c),s+=a}return n?o.negate():o}static convertArray(t){let r=new Uint32Array(t.length*2);for(let n=-1,i=t.length;++n<i;)e.from(t[n],new Uint32Array(r.buffer,r.byteOffset+2*n*4,2));return r}static multiply(t,r){return new e(new Uint32Array(t.buffer)).times(r)}static add(t,r){return new e(new Uint32Array(t.buffer)).plus(r)}},Zy=class e{constructor(t){this.buffer=t}high(){return new bc(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new bc(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],this.buffer[0]==0&&++this.buffer[1],this.buffer[1]==0&&++this.buffer[2],this.buffer[2]==0&&++this.buffer[3],this}times(t){let r=new rr(new Uint32Array([this.buffer[3],0])),n=new rr(new Uint32Array([this.buffer[2],0])),i=new rr(new Uint32Array([this.buffer[1],0])),o=new rr(new Uint32Array([this.buffer[0],0])),s=new rr(new Uint32Array([t.buffer[3],0])),a=new rr(new Uint32Array([t.buffer[2],0])),c=new rr(new Uint32Array([t.buffer[1],0])),l=new rr(new Uint32Array([t.buffer[0],0])),u=rr.multiply(o,l);this.buffer[0]=u.low();let f=new rr(new Uint32Array([u.high(),0]));return u=rr.multiply(i,l),f.plus(u),u=rr.multiply(o,c),f.plus(u),this.buffer[1]=f.low(),this.buffer[3]=f.lessThan(u)?1:0,this.buffer[2]=f.high(),new rr(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(rr.multiply(n,l)).plus(rr.multiply(i,c)).plus(rr.multiply(o,a)),this.buffer[3]+=rr.multiply(r,l).plus(rr.multiply(n,c)).plus(rr.multiply(i,a)).plus(rr.multiply(o,s)).low(),this}plus(t){let r=new Uint32Array(4);return r[3]=this.buffer[3]+t.buffer[3]>>>0,r[2]=this.buffer[2]+t.buffer[2]>>>0,r[1]=this.buffer[1]+t.buffer[1]>>>0,r[0]=this.buffer[0]+t.buffer[0]>>>0,r[0]<this.buffer[0]>>>0&&++r[1],r[1]<this.buffer[1]>>>0&&++r[2],r[2]<this.buffer[2]>>>0&&++r[3],this.buffer[3]=r[3],this.buffer[2]=r[2],this.buffer[1]=r[1],this.buffer[0]=r[0],this}hex(){return`${th(this.buffer[3])} ${th(this.buffer[2])} ${th(this.buffer[1])} ${th(this.buffer[0])}`}static multiply(t,r){return new e(new Uint32Array(t.buffer)).times(r)}static add(t,r){return new e(new Uint32Array(t.buffer)).plus(r)}static from(t,r=new Uint32Array(4)){return e.fromString(typeof t=="string"?t:t.toString(),r)}static fromNumber(t,r=new Uint32Array(4)){return e.fromString(t.toString(),r)}static fromString(t,r=new Uint32Array(4)){let n=t.startsWith("-"),i=t.length,o=new e(r);for(let s=n?1:0;s<i;){let a=eh<i-s?eh:i-s,c=new e(new Uint32Array([Number.parseInt(t.slice(s,s+a),10),0,0,0])),l=new e(new Uint32Array([eE[a],0,0,0]));o.times(l),o.plus(c),s+=a}return n?o.negate():o}static convertArray(t){let r=new Uint32Array(t.length*4);for(let n=-1,i=t.length;++n<i;)e.from(t[n],new Uint32Array(r.buffer,r.byteOffset+4*4*n,4));return r}};var Ky=class extends wt{constructor(t,r,n,i){super(),this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=t,this.nodes=r,this.buffers=n,this.dictionaries=i}visit(t){return super.visit(t instanceof ee?t.type:t)}visitNull(t,{length:r}=this.nextFieldNode()){return zt({type:t,length:r})}visitBool(t,{length:r,nullCount:n}=this.nextFieldNode()){return zt({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitInt(t,{length:r,nullCount:n}=this.nextFieldNode()){return zt({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitFloat(t,{length:r,nullCount:n}=this.nextFieldNode()){return zt({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitUtf8(t,{length:r,nullCount:n}=this.nextFieldNode()){return zt({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitBinary(t,{length:r,nullCount:n}=this.nextFieldNode()){return zt({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitFixedSizeBinary(t,{length:r,nullCount:n}=this.nextFieldNode()){return zt({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitDate(t,{length:r,nullCount:n}=this.nextFieldNode()){return zt({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitTimestamp(t,{length:r,nullCount:n}=this.nextFieldNode()){return zt({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitTime(t,{length:r,nullCount:n}=this.nextFieldNode()){return zt({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitDecimal(t,{length:r,nullCount:n}=this.nextFieldNode()){return zt({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitList(t,{length:r,nullCount:n}=this.nextFieldNode()){return zt({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}visitStruct(t,{length:r,nullCount:n}=this.nextFieldNode()){return zt({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),children:this.visitMany(t.children)})}visitUnion(t){return t.mode===er.Sparse?this.visitSparseUnion(t):this.visitDenseUnion(t)}visitDenseUnion(t,{length:r,nullCount:n}=this.nextFieldNode()){return zt({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),typeIds:this.readTypeIds(t),valueOffsets:this.readOffsets(t),children:this.visitMany(t.children)})}visitSparseUnion(t,{length:r,nullCount:n}=this.nextFieldNode()){return zt({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),typeIds:this.readTypeIds(t),children:this.visitMany(t.children)})}visitDictionary(t,{length:r,nullCount:n}=this.nextFieldNode()){return zt({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t.indices),dictionary:this.readDictionary(t)})}visitInterval(t,{length:r,nullCount:n}=this.nextFieldNode()){return zt({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitFixedSizeList(t,{length:r,nullCount:n}=this.nextFieldNode()){return zt({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),child:this.visit(t.children[0])})}visitMap(t,{length:r,nullCount:n}=this.nextFieldNode()){return zt({type:t,length:r,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(t,r,n=this.nextBufferRange()){return r>0&&this.readData(t,n)||new Uint8Array(0)}readOffsets(t,r){return this.readData(t,r)}readTypeIds(t,r){return this.readData(t,r)}readData(t,{length:r,offset:n}=this.nextBufferRange()){return this.bytes.subarray(n,n+r)}readDictionary(t){return this.dictionaries.get(t.id)}},aw=class extends Ky{constructor(t,r,n,i){super(new Uint8Array(0),r,n,i),this.sources=t}readNullBitmap(t,r,{offset:n}=this.nextBufferRange()){return r<=0?new Uint8Array(0):Qu(this.sources[n])}readOffsets(t,{offset:r}=this.nextBufferRange()){return Jt(Uint8Array,Jt(Int32Array,this.sources[r]))}readTypeIds(t,{offset:r}=this.nextBufferRange()){return Jt(Uint8Array,Jt(t.ArrayType,this.sources[r]))}readData(t,{offset:r}=this.nextBufferRange()){let{sources:n}=this;return mt.isTimestamp(t)?Jt(Uint8Array,bc.convertArray(n[r])):(mt.isInt(t)||mt.isTime(t))&&t.bitWidth===64?Jt(Uint8Array,bc.convertArray(n[r])):mt.isDate(t)&&t.unit===sn.MILLISECOND?Jt(Uint8Array,bc.convertArray(n[r])):mt.isDecimal(t)?Jt(Uint8Array,Zy.convertArray(n[r])):mt.isBinary(t)||mt.isFixedSizeBinary(t)?PK(n[r]):mt.isBool(t)?Qu(n[r]):mt.isUtf8(t)?_l(n[r].join("")):Jt(Uint8Array,Jt(t.ArrayType,n[r].map(i=>+i)))}};function PK(e){let t=e.join(""),r=new Uint8Array(t.length/2);for(let n=0;n<t.length;n+=2)r[n>>1]=Number.parseInt(t.slice(n,n+2),16);return r}var rh=class extends Xs{constructor(t){super(t),this._values=new Al(new Uint8Array(0))}get byteLength(){let t=this._pendingLength+this.length*4;return this._offsets&&(t+=this._offsets.byteLength),this._values&&(t+=this._values.byteLength),this._nulls&&(t+=this._nulls.byteLength),t}setValue(t,r){return super.setValue(t,Ct(r))}_flushPending(t,r){let n=this._offsets,i=this._values.reserve(r).buffer,o=0;for(let[s,a]of t)if(a===void 0)n.set(s,0);else{let c=a.length;i.set(a,o),n.set(s,c),o+=c}}};var cw=class extends Ye{constructor(t){super(t),this._values=new Kd}setValue(t,r){this._values.set(t,+r)}};var nf=class extends zr{};nf.prototype._setValue=kM;var Qy=class extends nf{};Qy.prototype._setValue=R1;var Jy=class extends nf{};Jy.prototype._setValue=k1;var tg=class extends zr{};tg.prototype._setValue=PM;var lw=class extends Ye{constructor({type:t,nullValues:r,dictionaryHashFunction:n}){super({type:new Ui(t.dictionary,t.indices,t.id,t.isOrdered)}),this._nulls=null,this._dictionaryOffset=0,this._keysToIndices=Object.create(null),this.indices=of({type:this.type.indices,nullValues:r}),this.dictionary=of({type:this.type.dictionary,nullValues:null}),typeof n=="function"&&(this.valueToKey=n)}get values(){return this.indices.values}get nullCount(){return this.indices.nullCount}get nullBitmap(){return this.indices.nullBitmap}get byteLength(){return this.indices.byteLength+this.dictionary.byteLength}get reservedLength(){return this.indices.reservedLength+this.dictionary.reservedLength}get reservedByteLength(){return this.indices.reservedByteLength+this.dictionary.reservedByteLength}isValid(t){return this.indices.isValid(t)}setValid(t,r){let n=this.indices;return r=n.setValid(t,r),this.length=n.length,r}setValue(t,r){let n=this._keysToIndices,i=this.valueToKey(r),o=n[i];return o===void 0&&(n[i]=o=this._dictionaryOffset+this.dictionary.append(r).length-1),this.indices.setValue(t,o)}flush(){let t=this.type,r=this._dictionary,n=this.dictionary.toVector(),i=this.indices.flush().clone(t);return i.dictionary=r?r.concat(n):n,this.finished||(this._dictionaryOffset+=n.length),this._dictionary=i.dictionary,this.clear(),i}finish(){return this.indices.finish(),this.dictionary.finish(),this._dictionaryOffset=0,this._keysToIndices=Object.create(null),super.finish()}clear(){return this.indices.clear(),this.dictionary.clear(),super.clear()}valueToKey(t){return typeof t=="string"?t:`${t}`}};var eg=class extends zr{};eg.prototype._setValue=RM;var uw=class extends Ye{setValue(t,r){let[n]=this.children,i=t*this.stride;for(let o=-1,s=r.length;++o<s;)n.set(i+o,r[o])}addChild(t,r="0"){if(this.numChildren>0)throw new Error("FixedSizeListBuilder can only have one child.");let n=this.children.push(t);return this.type=new ls(this.type.listSize,new ee(r,t.type,!0)),n}};var sf=class extends zr{setValue(t,r){this._values.set(t,r)}},fw=class extends sf{setValue(t,r){super.setValue(t,Oy(r))}},dw=class extends sf{},hw=class extends sf{};var af=class extends zr{};af.prototype._setValue=$M;var rg=class extends af{};rg.prototype._setValue=Y1;var ng=class extends af{};ng.prototype._setValue=W1;var Io=class extends zr{setValue(t,r){this._values.set(t,r)}},pw=class extends Io{},mw=class extends Io{},yw=class extends Io{},gw=class extends Io{},bw=class extends Io{},xw=class extends Io{},_w=class extends Io{},ww=class extends Io{};var vw=class extends Xs{constructor(t){super(t),this._offsets=new Qd}addChild(t,r="0"){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=t,this.type=new as(new ee(r,t.type,!0)),this.numChildren-1}_flushPending(t){let r=this._offsets,[n]=this.children;for(let[i,o]of t)if(typeof o>"u")r.set(i,0);else{let s=o.length,a=r.set(i,s).buffer[i];for(let c=-1;++c<s;)n.set(a+c,o[c])}}};var Sw=class extends Xs{set(t,r){return super.set(t,r)}setValue(t,r){let n=r instanceof Map?r:new Map(Object.entries(r)),i=this._pending||(this._pending=new Map),o=i.get(t);o&&(this._pendingLength-=o.size),this._pendingLength+=n.size,i.set(t,n)}addChild(t,r=`${this.numChildren}`){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=t,this.type=new us(new ee(r,t.type,!0),this.type.keysSorted),this.numChildren-1}_flushPending(t){let r=this._offsets,[n]=this.children;for(let[i,o]of t)if(o===void 0)r.set(i,0);else{let{[i]:s,[i+1]:a}=r.set(i,o.size).buffer;for(let c of o.entries())if(n.set(s,c),++s>=a)break}}};var Iw=class extends Ye{setValue(t,r){}setValid(t,r){return this.length=Math.max(t+1,this.length),r}};var Tw=class extends Ye{setValue(t,r){let{children:n,type:i}=this;switch(Array.isArray(r)||r.constructor){case!0:return i.children.forEach((o,s)=>n[s].set(t,r[s]));case Map:return i.children.forEach((o,s)=>n[s].set(t,r.get(o.name)));default:return i.children.forEach((o,s)=>n[s].set(t,r[o.name]))}}setValid(t,r){return super.setValid(t,r)||this.children.forEach(n=>n.setValid(t,r)),r}addChild(t,r=`${this.numChildren}`){let n=this.children.push(t);return this.type=new Pe([...this.type.children,new ee(r,t.type,!0)]),n}};var xc=class extends zr{};xc.prototype._setValue=CM;var ig=class extends xc{};ig.prototype._setValue=C1;var og=class extends xc{};og.prototype._setValue=U1;var sg=class extends xc{};sg.prototype._setValue=P1;var ag=class extends xc{};ag.prototype._setValue=$1;var _c=class extends zr{};_c.prototype._setValue=UM;var cg=class extends _c{};cg.prototype._setValue=z1;var lg=class extends _c{};lg.prototype._setValue=V1;var ug=class extends _c{};ug.prototype._setValue=j1;var fg=class extends _c{};fg.prototype._setValue=q1;var nh=class extends Ye{constructor(t){super(t),this._typeIds=new dc(new Int8Array(0),1),typeof t.valueToChildTypeId=="function"&&(this._valueToChildTypeId=t.valueToChildTypeId)}get typeIdToChildIndex(){return this.type.typeIdToChildIndex}append(t,r){return this.set(this.length,t,r)}set(t,r,n){return n===void 0&&(n=this._valueToChildTypeId(this,r,t)),this.setValid(t,this.isValid(r))&&this.setValue(t,r,n),this}setValue(t,r,n){this._typeIds.set(t,n);let i=this.type.typeIdToChildIndex[n],o=this.children[i];o?.set(t,r)}addChild(t,r=`${this.children.length}`){let n=this.children.push(t),{type:{children:i,mode:o,typeIds:s}}=this,a=[...i,new ee(r,t.type)];return this.type=new cs(o,[...s,n],a),n}_valueToChildTypeId(t,r,n){throw new Error("Cannot map UnionBuilder value to child typeId. Pass the `childTypeId` as the second argument to unionBuilder.append(), or supply a `valueToChildTypeId` function as part of the UnionBuilder constructor options.")}},Aw=class extends nh{},Mw=class extends nh{constructor(t){super(t),this._offsets=new dc(new Int32Array(0))}setValue(t,r,n){let i=this._typeIds.set(t,n).buffer[t],o=this.getChildAt(this.type.typeIdToChildIndex[i]),s=this._offsets.set(t,o.length).buffer[t];o?.set(s,r)}};var dg=class extends Xs{constructor(t){super(t),this._values=new Al(new Uint8Array(0))}get byteLength(){let t=this._pendingLength+this.length*4;return this._offsets&&(t+=this._offsets.byteLength),this._values&&(t+=this._values.byteLength),this._nulls&&(t+=this._nulls.byteLength),t}setValue(t,r){return super.setValue(t,_l(r))}_flushPending(t,r){}};dg.prototype._flushPending=rh.prototype._flushPending;var nE=class extends wt{visitNull(){return Iw}visitBool(){return cw}visitInt(){return Io}visitInt8(){return pw}visitInt16(){return mw}visitInt32(){return yw}visitInt64(){return gw}visitUint8(){return bw}visitUint16(){return xw}visitUint32(){return _w}visitUint64(){return ww}visitFloat(){return sf}visitFloat16(){return fw}visitFloat32(){return dw}visitFloat64(){return hw}visitUtf8(){return dg}visitBinary(){return rh}visitFixedSizeBinary(){return eg}visitDate(){return nf}visitDateDay(){return Qy}visitDateMillisecond(){return Jy}visitTimestamp(){return xc}visitTimestampSecond(){return ig}visitTimestampMillisecond(){return og}visitTimestampMicrosecond(){return sg}visitTimestampNanosecond(){return ag}visitTime(){return _c}visitTimeSecond(){return cg}visitTimeMillisecond(){return lg}visitTimeMicrosecond(){return ug}visitTimeNanosecond(){return fg}visitDecimal(){return tg}visitList(){return vw}visitStruct(){return Tw}visitUnion(){return nh}visitDenseUnion(){return Mw}visitSparseUnion(){return Aw}visitDictionary(){return lw}visitInterval(){return af}visitIntervalDayTime(){return rg}visitIntervalYearMonth(){return ng}visitFixedSizeList(){return uw}visitMap(){return Sw}},D4=new nE;var Ft=class extends wt{compareSchemas(t,r){return t===r||r instanceof t.constructor&&this.compareManyFields(t.fields,r.fields)}compareManyFields(t,r){return t===r||Array.isArray(t)&&Array.isArray(r)&&t.length===r.length&&t.every((n,i)=>this.compareFields(n,r[i]))}compareFields(t,r){return t===r||r instanceof t.constructor&&t.name===r.name&&t.nullable===r.nullable&&this.visit(t.type,r.type)}};function _i(e,t){return t instanceof e.constructor}function hg(e,t){return e===t||_i(e,t)}function wc(e,t){return e===t||_i(e,t)&&e.bitWidth===t.bitWidth&&e.isSigned===t.isSigned}function Ew(e,t){return e===t||_i(e,t)&&e.precision===t.precision}function $K(e,t){return e===t||_i(e,t)&&e.byteWidth===t.byteWidth}function iE(e,t){return e===t||_i(e,t)&&e.unit===t.unit}function pg(e,t){return e===t||_i(e,t)&&e.unit===t.unit&&e.timezone===t.timezone}function mg(e,t){return e===t||_i(e,t)&&e.unit===t.unit&&e.bitWidth===t.bitWidth}function zK(e,t){return e===t||_i(e,t)&&e.children.length===t.children.length&&ta.compareManyFields(e.children,t.children)}function VK(e,t){return e===t||_i(e,t)&&e.children.length===t.children.length&&ta.compareManyFields(e.children,t.children)}function oE(e,t){return e===t||_i(e,t)&&e.mode===t.mode&&e.typeIds.every((r,n)=>r===t.typeIds[n])&&ta.compareManyFields(e.children,t.children)}function jK(e,t){return e===t||_i(e,t)&&e.id===t.id&&e.isOrdered===t.isOrdered&&ta.visit(e.indices,t.indices)&&ta.visit(e.dictionary,t.dictionary)}function sE(e,t){return e===t||_i(e,t)&&e.unit===t.unit}function qK(e,t){return e===t||_i(e,t)&&e.listSize===t.listSize&&e.children.length===t.children.length&&ta.compareManyFields(e.children,t.children)}function YK(e,t){return e===t||_i(e,t)&&e.keysSorted===t.keysSorted&&e.children.length===t.children.length&&ta.compareManyFields(e.children,t.children)}Ft.prototype.visitNull=hg;Ft.prototype.visitBool=hg;Ft.prototype.visitInt=wc;Ft.prototype.visitInt8=wc;Ft.prototype.visitInt16=wc;Ft.prototype.visitInt32=wc;Ft.prototype.visitInt64=wc;Ft.prototype.visitUint8=wc;Ft.prototype.visitUint16=wc;Ft.prototype.visitUint32=wc;Ft.prototype.visitUint64=wc;Ft.prototype.visitFloat=Ew;Ft.prototype.visitFloat16=Ew;Ft.prototype.visitFloat32=Ew;Ft.prototype.visitFloat64=Ew;Ft.prototype.visitUtf8=hg;Ft.prototype.visitBinary=hg;Ft.prototype.visitFixedSizeBinary=$K;Ft.prototype.visitDate=iE;Ft.prototype.visitDateDay=iE;Ft.prototype.visitDateMillisecond=iE;Ft.prototype.visitTimestamp=pg;Ft.prototype.visitTimestampSecond=pg;Ft.prototype.visitTimestampMillisecond=pg;Ft.prototype.visitTimestampMicrosecond=pg;Ft.prototype.visitTimestampNanosecond=pg;Ft.prototype.visitTime=mg;Ft.prototype.visitTimeSecond=mg;Ft.prototype.visitTimeMillisecond=mg;Ft.prototype.visitTimeMicrosecond=mg;Ft.prototype.visitTimeNanosecond=mg;Ft.prototype.visitDecimal=hg;Ft.prototype.visitList=zK;Ft.prototype.visitStruct=VK;Ft.prototype.visitUnion=oE;Ft.prototype.visitDenseUnion=oE;Ft.prototype.visitSparseUnion=oE;Ft.prototype.visitDictionary=jK;Ft.prototype.visitInterval=sE;Ft.prototype.visitIntervalDayTime=sE;Ft.prototype.visitIntervalYearMonth=sE;Ft.prototype.visitFixedSizeList=qK;Ft.prototype.visitMap=YK;var ta=new Ft;function cf(e,t){return ta.compareSchemas(e,t)}function L4(e,t){return ta.compareFields(e,t)}function R4(e,t){return ta.visit(e,t)}function of(e){let t=e.type,r=new(D4.getVisitFn(t)())(e);if(t.children&&t.children.length>0){let n=e.children||[],i={nullValues:e.nullValues},o=Array.isArray(n)?(s,a)=>n[a]||i:({name:s})=>n[s]||i;for(let[s,a]of t.children.entries()){let{type:c}=a,l=o(a,s);r.children.push(of(Object.assign(Object.assign({},l),{type:c})))}}return r}function Bw(e,t){return WK(e,t.map(r=>r.data.concat()))}function WK(e,t){let r=[...e.fields],n=[],i={numBatches:t.reduce((f,d)=>Math.max(f,d.length),0)},o=0,s=0,a=-1,c=t.length,l,u=[];for(;i.numBatches-- >0;){for(s=Number.POSITIVE_INFINITY,a=-1;++a<c;)u[a]=l=t[a].shift(),s=Math.min(s,l?l.length:s);Number.isFinite(s)&&(u=GK(r,s,u,t,i),s>0&&(n[o++]=zt({type:new Pe(r),length:s,nullCount:0,children:u.slice()})))}return[e=e.assign(r),n.map(f=>new cr(e,f))]}function GK(e,t,r,n,i){var o;let s=(t+63&-64)>>3;for(let a=-1,c=n.length;++a<c;){let l=r[a],u=l?.length;if(u>=t)u===t?r[a]=l:(r[a]=l.slice(0,t),i.numBatches=Math.max(i.numBatches,n[a].unshift(l.slice(t,u-t))));else{let f=e[a];e[a]=f.clone({nullable:!0}),r[a]=(o=l?._changeLengthAndBackfillNullBitmap(t))!==null&&o!==void 0?o:zt({type:f.type,length:t,nullCount:t,nullBitmap:new Uint8Array(s)})}}return r}var k4,Pn=class e{constructor(...t){var r,n;if(t.length===0)return this.batches=[],this.schema=new ve([]),this._offsets=[0],this;let i,o;t[0]instanceof ve&&(i=t.shift()),t[t.length-1]instanceof Uint32Array&&(o=t.pop());let s=c=>{if(c){if(c instanceof cr)return[c];if(c instanceof e)return c.batches;if(c instanceof Ee){if(c.type instanceof Pe)return[new cr(new ve(c.type.children),c)]}else{if(Array.isArray(c))return c.flatMap(l=>s(l));if(typeof c[Symbol.iterator]=="function")return[...c].flatMap(l=>s(l));if(typeof c=="object"){let l=Object.keys(c),u=l.map(h=>new ce([c[h]])),f=new ve(l.map((h,p)=>new ee(String(h),u[p].type))),[,d]=Bw(f,u);return d.length===0?[new cr(c)]:d}}}return[]},a=t.flatMap(c=>s(c));if(i=(n=i??((r=a[0])===null||r===void 0?void 0:r.schema))!==null&&n!==void 0?n:new ve([]),!(i instanceof ve))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(let c of a){if(!(c instanceof cr))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!cf(i,c.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=i,this.batches=a,this._offsets=o??K1(this.data)}get data(){return this.batches.map(({data:t})=>t)}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce((t,r)=>t+r.length,0)}get nullCount(){return this._nullCount===-1&&(this._nullCount=Z1(this.data)),this._nullCount}isValid(t){return!1}get(t){return null}set(t,r){}indexOf(t,r){return-1}getByteLength(t){return 0}[Symbol.iterator](){return this.batches.length>0?Zd.visit(new ce(this.data)):new Array(0)[Symbol.iterator]()}toArray(){return[...this]}toString(){return`[
  ${this.toArray().join(`,
  `)}
]`}concat(...t){let r=this.schema,n=this.data.concat(t.flatMap(({data:i})=>i));return new e(r,n.map(i=>new cr(r,i)))}slice(t,r){let n=this.schema;[t,r]=Fy({length:this.numRows},t,r);let i=Q1(this.data,this._offsets,t,r);return new e(n,i.map(o=>new cr(n,o)))}getChild(t){return this.getChildAt(this.schema.fields.findIndex(r=>r.name===t))}getChildAt(t){if(t>-1&&t<this.schema.fields.length){let r=this.data.map(n=>n.children[t]);if(r.length===0){let{type:n}=this.schema.fields[t],i=zt({type:n,length:0,nullCount:0});r.push(i._changeLengthAndBackfillNullBitmap(this.numRows))}return new ce(r)}return null}setChild(t,r){var n;return this.setChildAt((n=this.schema.fields)===null||n===void 0?void 0:n.findIndex(i=>i.name===t),r)}setChildAt(t,r){let n=this.schema,i=[...this.batches];if(t>-1&&t<this.numCols){r||(r=new ce([zt({type:new Un,length:this.numRows})]));let o=n.fields.slice(),s=o[t].clone({type:r.type}),a=this.schema.fields.map((c,l)=>this.getChildAt(l));[o[t],a[t]]=[s,r],[n,i]=Bw(n,a)}return new e(n,i)}select(t){let r=this.schema.fields.reduce((n,i,o)=>n.set(i.name,o),new Map);return this.selectAt(t.map(n=>r.get(n)).filter(n=>n>-1))}selectAt(t){let r=this.schema.selectAt(t),n=this.batches.map(i=>i.selectAt(t));return new e(r,n)}assign(t){let r=this.schema.fields,[n,i]=t.schema.fields.reduce((a,c,l)=>{let[u,f]=a,d=r.findIndex(h=>h.name===c.name);return~d?f[d]=l:u.push(l),a},[[],[]]),o=this.schema.assign(t.schema),s=[...r.map((a,c)=>[c,i[c]]).map(([a,c])=>c===void 0?this.getChildAt(a):t.getChildAt(c)),...n.map(a=>t.getChildAt(a))].filter(Boolean);return new e(...Bw(o,s))}};k4=Symbol.toStringTag;Pn[k4]=(e=>(e.schema=null,e.batches=[],e._offsets=new Uint32Array([0]),e._nullCount=-1,e[Symbol.isConcatSpreadable]=!0,e.isValid=Tl(Ly),e.get=Tl(Ir.getVisitFn(N.Struct)),e.set=J1(an.getVisitFn(N.Struct)),e.indexOf=tw(Ju.getVisitFn(N.Struct)),e.getByteLength=Tl($i.getVisitFn(N.Struct)),"Table"))(Pn.prototype);var U4,cr=class e{constructor(...t){switch(t.length){case 2:{if([this.schema]=t,!(this.schema instanceof ve))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=zt({nullCount:0,type:new Pe(this.schema.fields),children:this.schema.fields.map(r=>zt({type:r.type,nullCount:0}))})]=t,!(this.data instanceof Ee))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=C4(this.schema,this.data.children);break}case 1:{let[r]=t,{fields:n,children:i,length:o}=Object.keys(r).reduce((c,l,u)=>(c.children[u]=r[l],c.length=Math.max(c.length,r[l].length),c.fields[u]=ee.new({name:l,type:r[l].type,nullable:!0}),c),{length:0,fields:new Array,children:new Array}),s=new ve(n),a=zt({type:new Pe(n),length:o,children:i,nullCount:0});[this.schema,this.data]=C4(s,a.children,o);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=P4(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(t){return this.data.getValid(t)}get(t){return Ir.visit(this.data,t)}set(t,r){return an.visit(this.data,t,r)}indexOf(t,r){return Ju.visit(this.data,t,r)}getByteLength(t){return $i.visit(this.data,t)}[Symbol.iterator](){return Zd.visit(new ce([this.data]))}toArray(){return[...this]}concat(...t){return new Pn(this.schema,[this,...t])}slice(t,r){let[n]=new ce([this.data]).slice(t,r).data;return new e(this.schema,n)}getChild(t){var r;return this.getChildAt((r=this.schema.fields)===null||r===void 0?void 0:r.findIndex(n=>n.name===t))}getChildAt(t){return t>-1&&t<this.schema.fields.length?new ce([this.data.children[t]]):null}setChild(t,r){var n;return this.setChildAt((n=this.schema.fields)===null||n===void 0?void 0:n.findIndex(i=>i.name===t),r)}setChildAt(t,r){let n=this.schema,i=this.data;if(t>-1&&t<this.numCols){r||(r=new ce([zt({type:new Un,length:this.numRows})]));let o=n.fields.slice(),s=i.children.slice(),a=o[t].clone({type:r.type});[o[t],s[t]]=[a,r.data[0]],n=new ve(o,new Map(this.schema.metadata)),i=zt({type:new Pe(o),children:s})}return new e(n,i)}select(t){let r=this.schema.select(t),n=new Pe(r.fields),i=[];for(let o of t){let s=this.schema.fields.findIndex(a=>a.name===o);~s&&(i[s]=this.data.children[s])}return new e(r,zt({type:n,length:this.numRows,children:i}))}selectAt(t){let r=this.schema.selectAt(t),n=t.map(o=>this.data.children[o]).filter(Boolean),i=zt({type:new Pe(r.fields),length:this.numRows,children:n});return new e(r,i)}};U4=Symbol.toStringTag;cr[U4]=(e=>(e._nullCount=-1,e[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(cr.prototype);function C4(e,t,r=t.reduce((n,i)=>Math.max(n,i.length),0)){var n;let i=[...e.fields],o=[...t],s=(r+63&-64)>>3;for(let[a,c]of e.fields.entries()){let l=t[a];(!l||l.length!==r)&&(i[a]=c.clone({nullable:!0}),o[a]=(n=l?._changeLengthAndBackfillNullBitmap(r))!==null&&n!==void 0?n:zt({type:c.type,length:r,nullCount:r,nullBitmap:new Uint8Array(s)}))}return[e.assign(i),zt({type:new Pe(i),length:r,children:o})]}function P4(e,t,r=new Map){for(let n=-1,i=e.length;++n<i;){let s=e[n].type,a=t[n];if(mt.isDictionary(s)){if(!r.has(s.id))a.dictionary&&r.set(s.id,a.dictionary);else if(r.get(s.id)!==a.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}s.children&&s.children.length>0&&P4(s.children,a.children,r)}return r}var lf=class extends cr{constructor(t){let r=t.fields.map(i=>zt({type:i.type})),n=zt({type:new Pe(t.fields),nullCount:0,children:r});super(t,n)}};var yg;(function(e){e[e.BUFFER=0]="BUFFER"})(yg||(yg={}));var gg;(function(e){e[e.LZ4_FRAME=0]="LZ4_FRAME",e[e.ZSTD=1]="ZSTD"})(gg||(gg={}));var Ow=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsBodyCompression(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBodyCompression(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}codec(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt8(this.bb_pos+t):gg.LZ4_FRAME}method(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt8(this.bb_pos+t):yg.BUFFER}static startBodyCompression(t){t.startObject(2)}static addCodec(t,r){t.addFieldInt8(0,r,gg.LZ4_FRAME)}static addMethod(t,r){t.addFieldInt8(1,r,yg.BUFFER)}static endBodyCompression(t){return t.endObject()}static createBodyCompression(t,r,n){return e.startBodyCompression(t),e.addCodec(t,r),e.addMethod(t,n),e.endBodyCompression(t)}};var ih=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer(t,r,n){return t.prep(8,16),t.writeInt64(n),t.writeInt64(r),t.offset()}};var oh=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode(t,r,n){return t.prep(8,16),t.writeInt64(n),t.writeInt64(r),t.offset()}};var ji=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsRecordBatch(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsRecordBatch(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}length(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}nodes(t,r){let n=this.bb.__offset(this.bb_pos,6);return n?(r||new oh).__init(this.bb.__vector(this.bb_pos+n)+t*16,this.bb):null}nodesLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}buffers(t,r){let n=this.bb.__offset(this.bb_pos,8);return n?(r||new ih).__init(this.bb.__vector(this.bb_pos+n)+t*16,this.bb):null}buffersLength(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}compression(t){let r=this.bb.__offset(this.bb_pos,10);return r?(t||new Ow).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}static startRecordBatch(t){t.startObject(4)}static addLength(t,r){t.addFieldInt64(0,r,t.createLong(0,0))}static addNodes(t,r){t.addFieldOffset(1,r,0)}static startNodesVector(t,r){t.startVector(16,r,8)}static addBuffers(t,r){t.addFieldOffset(2,r,0)}static startBuffersVector(t,r){t.startVector(16,r,8)}static addCompression(t,r){t.addFieldOffset(3,r,0)}static endRecordBatch(t){return t.endObject()}};var vc=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsDictionaryBatch(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryBatch(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}id(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}data(t){let r=this.bb.__offset(this.bb_pos,6);return r?(t||new ji).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}isDelta(){let t=this.bb.__offset(this.bb_pos,8);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startDictionaryBatch(t){t.startObject(3)}static addId(t,r){t.addFieldInt64(0,r,t.createLong(0,0))}static addData(t,r){t.addFieldOffset(1,r,0)}static addIsDelta(t,r){t.addFieldInt8(2,+r,0)}static endDictionaryBatch(t){return t.endObject()}};var sh;(function(e){e[e.NONE=0]="NONE",e[e.Schema=1]="Schema",e[e.DictionaryBatch=2]="DictionaryBatch",e[e.RecordBatch=3]="RecordBatch",e[e.Tensor=4]="Tensor",e[e.SparseTensor=5]="SparseTensor"})(sh||(sh={}));var ms=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsMessage(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMessage(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}version(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Ml.V1}headerType(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):sh.NONE}header(t){let r=this.bb.__offset(this.bb_pos,8);return r?this.bb.__union(t,this.bb_pos+r):null}bodyLength(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}customMetadata(t,r){let n=this.bb.__offset(this.bb_pos,12);return n?(r||new Rr).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}customMetadataLength(){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startMessage(t){t.startObject(5)}static addVersion(t,r){t.addFieldInt16(0,r,Ml.V1)}static addHeaderType(t,r){t.addFieldInt8(1,r,sh.NONE)}static addHeader(t,r){t.addFieldOffset(2,r,0)}static addBodyLength(t,r){t.addFieldInt64(3,r,t.createLong(0,0))}static addCustomMetadata(t,r){t.addFieldOffset(4,r,0)}static createCustomMetadataVector(t,r){t.startVector(4,r.length,4);for(let n=r.length-1;n>=0;n--)t.addOffset(r[n]);return t.endVector()}static startCustomMetadataVector(t,r){t.startVector(4,r,4)}static endMessage(t){return t.endObject()}static finishMessageBuffer(t,r){t.finish(r)}static finishSizePrefixedMessageBuffer(t,r){t.finish(r,void 0,!0)}static createMessage(t,r,n,i,o,s){return e.startMessage(t),e.addVersion(t,r),e.addHeaderType(t,n),e.addHeader(t,i),e.addBodyLength(t,o),e.addCustomMetadata(t,s),e.endMessage(t)}};var HK=cn,aE=class extends wt{visit(t,r){return t==null||r==null?void 0:super.visit(t,r)}visitNull(t,r){return jy.startNull(r),jy.endNull(r)}visitInt(t,r){return hs.startInt(r),hs.addBitWidth(r,t.bitWidth),hs.addIsSigned(r,t.isSigned),hs.endInt(r)}visitFloat(t,r){return Dl.startFloatingPoint(r),Dl.addPrecision(r,t.precision),Dl.endFloatingPoint(r)}visitBinary(t,r){return Cy.startBinary(r),Cy.endBinary(r)}visitBool(t,r){return Uy.startBool(r),Uy.endBool(r)}visitUtf8(t,r){return Wy.startUtf8(r),Wy.endUtf8(r)}visitDecimal(t,r){return Ks.startDecimal(r),Ks.addScale(r,t.scale),Ks.addPrecision(r,t.precision),Ks.addBitWidth(r,t.bitWidth),Ks.endDecimal(r)}visitDate(t,r){return Bl.startDate(r),Bl.addUnit(r,t.unit),Bl.endDate(r)}visitTime(t,r){return hc.startTime(r),hc.addUnit(r,t.unit),hc.addBitWidth(r,t.bitWidth),hc.endTime(r)}visitTimestamp(t,r){let n=t.timezone&&r.createString(t.timezone)||void 0;return pc.startTimestamp(r),pc.addUnit(r,t.unit),n!==void 0&&pc.addTimezone(r,n),pc.endTimestamp(r)}visitInterval(t,r){return Ll.startInterval(r),Ll.addUnit(r,t.unit),Ll.endInterval(r)}visitList(t,r){return Vy.startList(r),Vy.endList(r)}visitStruct(t,r){return qy.startStruct_(r),qy.endStruct_(r)}visitUnion(t,r){ps.startTypeIdsVector(r,t.typeIds.length);let n=ps.createTypeIdsVector(r,t.typeIds);return ps.startUnion(r),ps.addMode(r,t.mode),ps.addTypeIds(r,n),ps.endUnion(r)}visitDictionary(t,r){let n=this.visit(t.indices,r);return Zs.startDictionaryEncoding(r),Zs.addId(r,new HK(t.id,0)),Zs.addIsOrdered(r,t.isOrdered),n!==void 0&&Zs.addIndexType(r,n),Zs.endDictionaryEncoding(r)}visitFixedSizeBinary(t,r){return Fl.startFixedSizeBinary(r),Fl.addByteWidth(r,t.byteWidth),Fl.endFixedSizeBinary(r)}visitFixedSizeList(t,r){return Nl.startFixedSizeList(r),Nl.addListSize(r,t.listSize),Nl.endFixedSizeList(r)}visitMap(t,r){return Rl.startMap(r),Rl.addKeysSorted(r,t.keysSorted),Rl.endMap(r)}},Fw=new aE;function j4(e,t=new Map){return new ve(ZK(e,t),Nw(e.customMetadata),t)}function cE(e){return new ln(e.count,Y4(e.columns),W4(e.columns))}function q4(e){return new vi(cE(e.data),e.id,e.isDelta)}function ZK(e,t){return(e.fields||[]).filter(Boolean).map(r=>ee.fromJSON(r,t))}function $4(e,t){return(e.children||[]).filter(Boolean).map(r=>ee.fromJSON(r,t))}function Y4(e){return(e||[]).reduce((t,r)=>[...t,new ys(r.count,KK(r.VALIDITY)),...Y4(r.children)],[])}function W4(e,t=[]){for(let r=-1,n=(e||[]).length;++r<n;){let i=e[r];i.VALIDITY&&t.push(new wi(t.length,i.VALIDITY.length)),i.TYPE&&t.push(new wi(t.length,i.TYPE.length)),i.OFFSET&&t.push(new wi(t.length,i.OFFSET.length)),i.DATA&&t.push(new wi(t.length,i.DATA.length)),t=W4(i.children,t)}return t}function KK(e){return(e||[]).reduce((t,r)=>t+ +(r===0),0)}function G4(e,t){let r,n,i,o,s,a;return!t||!(o=e.dictionary)?(s=V4(e,$4(e,t)),i=new ee(e.name,s,e.nullable,Nw(e.customMetadata))):t.has(r=o.id)?(n=(n=o.indexType)?z4(n):new Ys,a=new Ui(t.get(r),n,r,o.isOrdered),i=new ee(e.name,a,e.nullable,Nw(e.customMetadata))):(n=(n=o.indexType)?z4(n):new Ys,t.set(r,s=V4(e,$4(e,t))),a=new Ui(s,n,r,o.isOrdered),i=new ee(e.name,a,e.nullable,Nw(e.customMetadata))),i||null}function Nw(e){return new Map(Object.entries(e||{}))}function z4(e){return new gr(e.isSigned,e.bitWidth)}function V4(e,t){let r=e.type.name;switch(r){case"NONE":return new Un;case"null":return new Un;case"binary":return new nc;case"utf8":return new ic;case"bool":return new oc;case"list":return new as((t||[])[0]);case"struct":return new Pe(t||[]);case"struct_":return new Pe(t||[])}switch(r){case"int":{let n=e.type;return new gr(n.isSigned,n.bitWidth)}case"floatingpoint":{let n=e.type;return new bi(qe[n.precision])}case"decimal":{let n=e.type;return new sc(n.scale,n.precision,n.bitWidth)}case"date":{let n=e.type;return new ac(sn[n.unit])}case"time":{let n=e.type;return new ss(re[n.unit],n.bitWidth)}case"timestamp":{let n=e.type;return new cc(re[n.unit],n.timezone)}case"interval":{let n=e.type;return new lc(Cn[n.unit])}case"union":{let n=e.type;return new cs(er[n.mode],n.typeIds||[],t||[])}case"fixedsizebinary":{let n=e.type;return new uc(n.byteWidth)}case"fixedsizelist":{let n=e.type;return new ls(n.listSize,(t||[])[0])}case"map":{let n=e.type;return new us((t||[])[0],n.keysSorted)}}throw new Error(`Unrecognized type: "${r}"`)}var uf=cn,QK=ef,JK=zi,Si=class e{constructor(t,r,n,i){this._version=r,this._headerType=n,this.body=new Uint8Array(0),i&&(this._createHeader=()=>i),this._bodyLength=typeof t=="number"?t:t.low}static fromJSON(t,r){let n=new e(0,$r.V4,r);return n._createHeader=tQ(t,r),n}static decode(t){t=new JK(Ct(t));let r=ms.getRootAsMessage(t),n=r.bodyLength(),i=r.version(),o=r.headerType(),s=new e(n,i,o);return s._createHeader=eQ(r,o),s}static encode(t){let r=new QK,n=-1;return t.isSchema()?n=ve.encode(r,t.header()):t.isRecordBatch()?n=ln.encode(r,t.header()):t.isDictionaryBatch()&&(n=vi.encode(r,t.header())),ms.startMessage(r),ms.addVersion(r,$r.V4),ms.addHeader(r,n),ms.addHeaderType(r,t.headerType),ms.addBodyLength(r,new uf(t.bodyLength,0)),ms.finishMessageBuffer(r,ms.endMessage(r)),r.asUint8Array()}static from(t,r=0){if(t instanceof ve)return new e(0,$r.V4,me.Schema,t);if(t instanceof ln)return new e(r,$r.V4,me.RecordBatch,t);if(t instanceof vi)return new e(r,$r.V4,me.DictionaryBatch,t);throw new Error(`Unrecognized Message header: ${t}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===me.Schema}isRecordBatch(){return this.headerType===me.RecordBatch}isDictionaryBatch(){return this.headerType===me.DictionaryBatch}},ln=class{constructor(t,r,n){this._nodes=r,this._buffers=n,this._length=typeof t=="number"?t:t.low}get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}},vi=class{constructor(t,r,n=!1){this._data=t,this._isDelta=n,this._id=typeof r=="number"?r:r.low}get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}},wi=class{constructor(t,r){this.offset=typeof t=="number"?t:t.low,this.length=typeof r=="number"?r:r.low}},ys=class{constructor(t,r){this.length=typeof t=="number"?t:t.low,this.nullCount=typeof r=="number"?r:r.low}};function tQ(e,t){return()=>{switch(t){case me.Schema:return ve.fromJSON(e);case me.RecordBatch:return ln.fromJSON(e);case me.DictionaryBatch:return vi.fromJSON(e)}throw new Error(`Unrecognized Message type: { name: ${me[t]}, type: ${t} }`)}}function eQ(e,t){return()=>{switch(t){case me.Schema:return ve.decode(e.header(new xi));case me.RecordBatch:return ln.decode(e.header(new ji),e.version());case me.DictionaryBatch:return vi.decode(e.header(new vc),e.version())}throw new Error(`Unrecognized Message type: { name: ${me[t]}, type: ${t} }`)}}ee.encode=dQ;ee.decode=uQ;ee.fromJSON=G4;ve.encode=fQ;ve.decode=rQ;ve.fromJSON=j4;ln.encode=hQ;ln.decode=nQ;ln.fromJSON=cE;vi.encode=pQ;vi.decode=iQ;vi.fromJSON=q4;ys.encode=mQ;ys.decode=sQ;wi.encode=yQ;wi.decode=oQ;function rQ(e,t=new Map){let r=lQ(e,t);return new ve(r,Dw(e),t)}function nQ(e,t=$r.V4){if(e.compression()!==null)throw new Error("Record batch compression not implemented");return new ln(e.length(),aQ(e),cQ(e,t))}function iQ(e,t=$r.V4){return new vi(ln.decode(e.data(),t),e.id(),e.isDelta())}function oQ(e){return new wi(e.offset(),e.length())}function sQ(e){return new ys(e.length(),e.nullCount())}function aQ(e){let t=[];for(let r,n=-1,i=-1,o=e.nodesLength();++n<o;)(r=e.nodes(n))&&(t[++i]=ys.decode(r));return t}function cQ(e,t){let r=[];for(let n,i=-1,o=-1,s=e.buffersLength();++i<s;)(n=e.buffers(i))&&(t<$r.V4&&(n.bb_pos+=8*(i+1)),r[++o]=wi.decode(n));return r}function lQ(e,t){let r=[];for(let n,i=-1,o=-1,s=e.fieldsLength();++i<s;)(n=e.fields(i))&&(r[++o]=ee.decode(n,t));return r}function X4(e,t){let r=[];for(let n,i=-1,o=-1,s=e.childrenLength();++i<s;)(n=e.children(i))&&(r[++o]=ee.decode(n,t));return r}function uQ(e,t){let r,n,i,o,s,a;return!t||!(a=e.dictionary())?(i=Z4(e,X4(e,t)),n=new ee(e.name(),i,e.nullable(),Dw(e))):t.has(r=a.id().low)?(o=(o=a.indexType())?H4(o):new Ys,s=new Ui(t.get(r),o,r,a.isOrdered()),n=new ee(e.name(),s,e.nullable(),Dw(e))):(o=(o=a.indexType())?H4(o):new Ys,t.set(r,i=Z4(e,X4(e,t))),s=new Ui(i,o,r,a.isOrdered()),n=new ee(e.name(),s,e.nullable(),Dw(e))),n||null}function Dw(e){let t=new Map;if(e)for(let r,n,i=-1,o=Math.trunc(e.customMetadataLength());++i<o;)(r=e.customMetadata(i))&&(n=r.key())!=null&&t.set(n,r.value());return t}function H4(e){return new gr(e.isSigned(),e.bitWidth())}function Z4(e,t){let r=e.typeType();switch(r){case We.NONE:return new Un;case We.Null:return new Un;case We.Binary:return new nc;case We.Utf8:return new ic;case We.Bool:return new oc;case We.List:return new as((t||[])[0]);case We.Struct_:return new Pe(t||[])}switch(r){case We.Int:{let n=e.type(new hs);return new gr(n.isSigned(),n.bitWidth())}case We.FloatingPoint:{let n=e.type(new Dl);return new bi(n.precision())}case We.Decimal:{let n=e.type(new Ks);return new sc(n.scale(),n.precision(),n.bitWidth())}case We.Date:{let n=e.type(new Bl);return new ac(n.unit())}case We.Time:{let n=e.type(new hc);return new ss(n.unit(),n.bitWidth())}case We.Timestamp:{let n=e.type(new pc);return new cc(n.unit(),n.timezone())}case We.Interval:{let n=e.type(new Ll);return new lc(n.unit())}case We.Union:{let n=e.type(new ps);return new cs(n.mode(),n.typeIdsArray()||[],t||[])}case We.FixedSizeBinary:{let n=e.type(new Fl);return new uc(n.byteWidth())}case We.FixedSizeList:{let n=e.type(new Nl);return new ls(n.listSize(),(t||[])[0])}case We.Map:{let n=e.type(new Rl);return new us((t||[])[0],n.keysSorted())}}throw new Error(`Unrecognized type: "${We[r]}" (${r})`)}function fQ(e,t){let r=t.fields.map(o=>ee.encode(e,o));xi.startFieldsVector(e,r.length);let n=xi.createFieldsVector(e,r),i=t.metadata&&t.metadata.size>0?xi.createCustomMetadataVector(e,[...t.metadata].map(([o,s])=>{let a=e.createString(`${o}`),c=e.createString(`${s}`);return Rr.startKeyValue(e),Rr.addKey(e,a),Rr.addValue(e,c),Rr.endKeyValue(e)})):-1;return xi.startSchema(e),xi.addFields(e,n),xi.addEndianness(e,gQ?El.Little:El.Big),i!==-1&&xi.addCustomMetadata(e,i),xi.endSchema(e)}function dQ(e,t){let r=-1,n=-1,i=-1,o=t.type,s=t.typeId;mt.isDictionary(o)?(s=o.dictionary.typeId,i=Fw.visit(o,e),n=Fw.visit(o.dictionary,e)):n=Fw.visit(o,e);let a=(o.children||[]).map(u=>ee.encode(e,u)),c=vn.createChildrenVector(e,a),l=t.metadata&&t.metadata.size>0?vn.createCustomMetadataVector(e,[...t.metadata].map(([u,f])=>{let d=e.createString(`${u}`),h=e.createString(`${f}`);return Rr.startKeyValue(e),Rr.addKey(e,d),Rr.addValue(e,h),Rr.endKeyValue(e)})):-1;return t.name&&(r=e.createString(t.name)),vn.startField(e),vn.addType(e,n),vn.addTypeType(e,s),vn.addChildren(e,c),vn.addNullable(e,!!t.nullable),r!==-1&&vn.addName(e,r),i!==-1&&vn.addDictionary(e,i),l!==-1&&vn.addCustomMetadata(e,l),vn.endField(e)}function hQ(e,t){let r=t.nodes||[],n=t.buffers||[];ji.startNodesVector(e,r.length);for(let s of r.slice().reverse())ys.encode(e,s);let i=e.endVector();ji.startBuffersVector(e,n.length);for(let s of n.slice().reverse())wi.encode(e,s);let o=e.endVector();return ji.startRecordBatch(e),ji.addLength(e,new uf(t.length,0)),ji.addNodes(e,i),ji.addBuffers(e,o),ji.endRecordBatch(e)}function pQ(e,t){let r=ln.encode(e,t.data);return vc.startDictionaryBatch(e),vc.addId(e,new uf(t.id,0)),vc.addIsDelta(e,t.isDelta),vc.addData(e,r),vc.endDictionaryBatch(e)}function mQ(e,t){return oh.createFieldNode(e,new uf(t.length,0),new uf(t.nullCount,0))}function yQ(e,t){return ih.createBuffer(e,new uf(t.offset,0),new uf(t.length,0))}var gQ=(()=>{let e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),new Int16Array(e)[0]===256})();var uE=e=>`Expected ${me[e]} Message in stream, but was null or length 0.`,fE=e=>`Header pointer of flatbuffer-encoded ${me[e]} Message is null or length 0.`,K4=(e,t)=>`Expected to read ${e} metadata bytes, but only read ${t}.`,Q4=(e,t)=>`Expected to read ${e} bytes for message body, but only read ${t}.`,ah=class{constructor(t){this.source=t instanceof Js?t:new Js(t)}[Symbol.iterator](){return this}next(){let t;return(t=this.readMetadataLength()).done?$e:t.value===-1&&(t=this.readMetadataLength()).done?$e:(t=this.readMetadata(t.value)).done?$e:t}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}readMessage(t){let r;if((r=this.next()).done)return null;if(t!=null&&r.value.headerType!==t)throw new Error(uE(t));return r.value}readMessageBody(t){if(t<=0)return new Uint8Array(0);let r=Ct(this.source.read(t));if(r.byteLength<t)throw new Error(Q4(t,r.byteLength));return r.byteOffset%8===0&&r.byteOffset+r.byteLength<=r.buffer.byteLength?r:r.slice()}readSchema(t=!1){let r=me.Schema,n=this.readMessage(r),i=n?.header();if(t&&!i)throw new Error(fE(r));return i}readMetadataLength(){let t=this.source.read(Lw),r=t&&new zi(t),n=r?.readInt32(0)||0;return{done:n===0,value:n}}readMetadata(t){let r=this.source.read(t);if(!r)return $e;if(r.byteLength<t)throw new Error(K4(t,r.byteLength));return{done:!1,value:Si.decode(r)}}},bg=class{constructor(t,r){this.source=t instanceof So?t:b1(t)?new kl(t,r):new So(t)}[Symbol.asyncIterator](){return this}next(){return P(this,void 0,void 0,function*(){let t;return(t=yield this.readMetadataLength()).done?$e:t.value===-1&&(t=yield this.readMetadataLength()).done?$e:(t=yield this.readMetadata(t.value)).done?$e:t})}throw(t){return P(this,void 0,void 0,function*(){return yield this.source.throw(t)})}return(t){return P(this,void 0,void 0,function*(){return yield this.source.return(t)})}readMessage(t){return P(this,void 0,void 0,function*(){let r;if((r=yield this.next()).done)return null;if(t!=null&&r.value.headerType!==t)throw new Error(uE(t));return r.value})}readMessageBody(t){return P(this,void 0,void 0,function*(){if(t<=0)return new Uint8Array(0);let r=Ct(yield this.source.read(t));if(r.byteLength<t)throw new Error(Q4(t,r.byteLength));return r.byteOffset%8===0&&r.byteOffset+r.byteLength<=r.buffer.byteLength?r:r.slice()})}readSchema(t=!1){return P(this,void 0,void 0,function*(){let r=me.Schema,n=yield this.readMessage(r),i=n?.header();if(t&&!i)throw new Error(fE(r));return i})}readMetadataLength(){return P(this,void 0,void 0,function*(){let t=yield this.source.read(Lw),r=t&&new zi(t),n=r?.readInt32(0)||0;return{done:n===0,value:n}})}readMetadata(t){return P(this,void 0,void 0,function*(){let r=yield this.source.read(t);if(!r)return $e;if(r.byteLength<t)throw new Error(K4(t,r.byteLength));return{done:!1,value:Si.decode(r)}})}},xg=class extends ah{constructor(t){super(new Uint8Array(0)),this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=t instanceof Gy?t:new Gy(t)}next(){let{_json:t}=this;if(!this._schema)return this._schema=!0,{done:!1,value:Si.fromJSON(t.schema,me.Schema)};if(this._dictionaryIndex<t.dictionaries.length){let r=t.dictionaries[this._dictionaryIndex++];return this._body=r.data.columns,{done:!1,value:Si.fromJSON(r,me.DictionaryBatch)}}if(this._batchIndex<t.batches.length){let r=t.batches[this._batchIndex++];return this._body=r.columns,{done:!1,value:Si.fromJSON(r,me.RecordBatch)}}return this._body=[],$e}readMessageBody(t){return r(this._body);function r(n){return(n||[]).reduce((i,o)=>[...i,...o.VALIDITY&&[o.VALIDITY]||[],...o.TYPE&&[o.TYPE]||[],...o.OFFSET&&[o.OFFSET]||[],...o.DATA&&[o.DATA]||[],...r(o.children)],[])}}readMessage(t){let r;if((r=this.next()).done)return null;if(t!=null&&r.value.headerType!==t)throw new Error(uE(t));return r.value}readSchema(){let t=me.Schema,r=this.readMessage(t),n=r?.header();if(!r||!n)throw new Error(fE(t));return n}},Lw=4,lE="ARROW1",ch=new Uint8Array(lE.length);for(let e=0;e<lE.length;e+=1)ch[e]=lE.codePointAt(e);function Rw(e,t=0){for(let r=-1,n=ch.length;++r<n;)if(ch[r]!==e[t+r])return!1;return!0}var lh=ch.length,dE=lh+Lw,J4=lh*2+Lw;var un=class e extends rf{constructor(t){super(),this._impl=t}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(t){return this._impl.throw(t)}return(t){return this._impl.return(t)}cancel(){return this._impl.cancel()}reset(t){return this._impl.reset(t),this._DOMStream=void 0,this._nodeStream=void 0,this}open(t){let r=this._impl.open(t);return es(r)?r.then(()=>this):this}readRecordBatch(t){return this._impl.isFile()?this._impl.readRecordBatch(t):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return on.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return on.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,r){throw new Error('"throughDOM" not available in this environment')}static from(t){return t instanceof e?t:y1(t)?xQ(t):b1(t)?vQ(t):es(t)?(()=>P(this,void 0,void 0,function*(){return yield e.from(yield t)}))():x1(t)||Ay(t)||w1(t)||xo(t)?wQ(new So(t)):_Q(new Js(t))}static readAll(t){return t instanceof e?t.isSync()?tR(t):eR(t):y1(t)||ArrayBuffer.isView(t)||rs(t)||g1(t)?tR(t):eR(t)}},ea=class extends un{constructor(t){super(t),this._impl=t}readAll(){return[...this]}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return ke(this,arguments,function*(){yield G(yield*oo(or(this[Symbol.iterator]())))})}},Cl=class extends un{constructor(t){super(t),this._impl=t}readAll(){var t,r;return P(this,void 0,void 0,function*(){let n=new Array;try{for(var i=or(this),o;o=yield i.next(),!o.done;){let s=o.value;n.push(s)}}catch(s){t={error:s}}finally{try{o&&!o.done&&(r=i.return)&&(yield r.call(i))}finally{if(t)throw t.error}}return n})}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}},Ul=class extends ea{constructor(t){super(t),this._impl=t}},_g=class extends Cl{constructor(t){super(t),this._impl=t}},kw=class{constructor(t=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=t}get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(t){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=t,this.dictionaries=new Map,this}_loadRecordBatch(t,r){let n=this._loadVectors(t,r,this.schema.fields),i=zt({type:new Pe(this.schema.fields),length:t.length,children:n});return new cr(this.schema,i)}_loadDictionaryBatch(t,r){let{id:n,isDelta:i}=t,{dictionaries:o,schema:s}=this,a=o.get(n);if(i||!a){let c=s.dictionaries.get(n),l=this._loadVectors(t.data,r,[c]);return(a&&i?a.concat(new ce(l)):new ce(l)).memoize()}return a.memoize()}_loadVectors(t,r,n){return new Ky(r,t.nodes,t.buffers,this.dictionaries).visitMany(n)}},uh=class extends kw{constructor(t,r){super(r),this._reader=y1(t)?new xg(this._handle=t):new ah(this._handle=t)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(t){return this.closed||(this.autoDestroy=rR(this,t),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(t):$e}return(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(t):$e}next(){if(this.closed)return $e;let t,{_reader:r}=this;for(;t=this._readNextMessageAndValidate();)if(t.isSchema())this.reset(t.header());else if(t.isRecordBatch()){this._recordBatchIndex++;let n=t.header(),i=r.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(n,i)}}else if(t.isDictionaryBatch()){this._dictionaryIndex++;let n=t.header(),i=r.readMessageBody(t.bodyLength),o=this._loadDictionaryBatch(n,i);this.dictionaries.set(n.id,o)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new lf(this.schema)}):this.return()}_readNextMessageAndValidate(t){return this._reader.readMessage(t)}},fh=class extends kw{constructor(t,r){super(r),this._reader=new bg(this._handle=t)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){return P(this,void 0,void 0,function*(){!this.closed&&(this.closed=!0)&&(yield this.reset()._reader.return(),this._reader=null,this.dictionaries=null)})}open(t){return P(this,void 0,void 0,function*(){return this.closed||(this.autoDestroy=rR(this,t),this.schema||(this.schema=yield this._reader.readSchema())||(yield this.cancel())),this})}throw(t){return P(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.throw(t):$e})}return(t){return P(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.return(t):$e})}next(){return P(this,void 0,void 0,function*(){if(this.closed)return $e;let t,{_reader:r}=this;for(;t=yield this._readNextMessageAndValidate();)if(t.isSchema())yield this.reset(t.header());else if(t.isRecordBatch()){this._recordBatchIndex++;let n=t.header(),i=yield r.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(n,i)}}else if(t.isDictionaryBatch()){this._dictionaryIndex++;let n=t.header(),i=yield r.readMessageBody(t.bodyLength),o=this._loadDictionaryBatch(n,i);this.dictionaries.set(n.id,o)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new lf(this.schema)}):yield this.return()})}_readNextMessageAndValidate(t){return P(this,void 0,void 0,function*(){return yield this._reader.readMessage(t)})}},Cw=class extends uh{constructor(t,r){super(t instanceof Xy?t:new Xy(t),r)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isSync(){return!0}isFile(){return!0}open(t){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(let r of this._footer.dictionaryBatches())r&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(t)}readRecordBatch(t){var r;if(this.closed)return null;this._footer||this.open();let n=(r=this._footer)===null||r===void 0?void 0:r.getRecordBatch(t);if(n&&this._handle.seek(n.offset)){let i=this._reader.readMessage(me.RecordBatch);if(i?.isRecordBatch()){let o=i.header(),s=this._reader.readMessageBody(i.bodyLength);return this._loadRecordBatch(o,s)}}return null}_readDictionaryBatch(t){var r;let n=(r=this._footer)===null||r===void 0?void 0:r.getDictionaryBatch(t);if(n&&this._handle.seek(n.offset)){let i=this._reader.readMessage(me.DictionaryBatch);if(i?.isDictionaryBatch()){let o=i.header(),s=this._reader.readMessageBody(i.bodyLength),a=this._loadDictionaryBatch(o,s);this.dictionaries.set(o.id,a)}}}_readFooter(){let{_handle:t}=this,r=t.size-dE,n=t.readInt32(r),i=t.readAt(r-n,n);return mc.decode(i)}_readNextMessageAndValidate(t){var r;if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){let n=(r=this._footer)===null||r===void 0?void 0:r.getRecordBatch(this._recordBatchIndex);if(n&&this._handle.seek(n.offset))return this._reader.readMessage(t)}return null}},hE=class extends fh{constructor(t,...r){let n=typeof r[0]!="number"?r.shift():void 0,i=r[0]instanceof Map?r.shift():void 0;super(t instanceof kl?t:new kl(t,n),i)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isFile(){return!0}isAsync(){return!0}open(t){let r=Object.create(null,{open:{get:()=>super.open}});return P(this,void 0,void 0,function*(){if(!this.closed&&!this._footer){this.schema=(this._footer=yield this._readFooter()).schema;for(let n of this._footer.dictionaryBatches())n&&(yield this._readDictionaryBatch(this._dictionaryIndex++))}return yield r.open.call(this,t)})}readRecordBatch(t){var r;return P(this,void 0,void 0,function*(){if(this.closed)return null;this._footer||(yield this.open());let n=(r=this._footer)===null||r===void 0?void 0:r.getRecordBatch(t);if(n&&(yield this._handle.seek(n.offset))){let i=yield this._reader.readMessage(me.RecordBatch);if(i?.isRecordBatch()){let o=i.header(),s=yield this._reader.readMessageBody(i.bodyLength);return this._loadRecordBatch(o,s)}}return null})}_readDictionaryBatch(t){var r;return P(this,void 0,void 0,function*(){let n=(r=this._footer)===null||r===void 0?void 0:r.getDictionaryBatch(t);if(n&&(yield this._handle.seek(n.offset))){let i=yield this._reader.readMessage(me.DictionaryBatch);if(i?.isDictionaryBatch()){let o=i.header(),s=yield this._reader.readMessageBody(i.bodyLength),a=this._loadDictionaryBatch(o,s);this.dictionaries.set(o.id,a)}}})}_readFooter(){return P(this,void 0,void 0,function*(){let{_handle:t}=this;t._pending&&(yield t._pending);let r=t.size-dE,n=yield t.readInt32(r),i=yield t.readAt(r-n,n);return mc.decode(i)})}_readNextMessageAndValidate(t){return P(this,void 0,void 0,function*(){if(this._footer||(yield this.open()),this._footer&&this._recordBatchIndex<this.numRecordBatches){let r=this._footer.getRecordBatch(this._recordBatchIndex);if(r&&(yield this._handle.seek(r.offset)))return yield this._reader.readMessage(t)}return null})}},pE=class extends uh{constructor(t,r){super(t,r)}_loadVectors(t,r,n){return new aw(r,t.nodes,t.buffers,this.dictionaries).visitMany(n)}};function rR(e,t){return t&&typeof t.autoDestroy=="boolean"?t.autoDestroy:e.autoDestroy}function*tR(e){let t=un.from(e);try{if(!t.open({autoDestroy:!1}).closed)do yield t;while(!t.reset().open().closed)}finally{t.cancel()}}function eR(e){return ke(this,arguments,function*(){let r=yield G(un.from(e));try{if(!(yield G(r.open({autoDestroy:!1}))).closed)do yield yield G(r);while(!(yield G(r.reset().open())).closed)}finally{yield G(r.cancel())}})}function xQ(e){return new ea(new pE(e))}function _Q(e){let t=e.peek(lh+7&-8);return t&&t.byteLength>=4?Rw(t)?new Ul(new Cw(e.read())):new ea(new uh(e)):new ea(new uh(function*(){}()))}function wQ(e){return P(this,void 0,void 0,function*(){let t=yield e.peek(lh+7&-8);return t&&t.byteLength>=4?Rw(t)?new Ul(new Cw(yield e.read())):new Cl(new fh(e)):new Cl(new fh(function(){return ke(this,arguments,function*(){})}()))})}function vQ(e){return P(this,void 0,void 0,function*(){let{size:t}=yield e.stat(),r=new kl(e,t);return t>=J4&&Rw(yield r.readAt(0,lh+7&-8))?new _g(new hE(r)):new Cl(new fh(r))})}var br=class e extends wt{constructor(){super(),this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}static assemble(...t){let r=i=>i.flatMap(o=>Array.isArray(o)?r(o):o instanceof cr?o.data.children:o.data),n=new e;return n.visitMany(r(t)),n}visit(t){if(t instanceof ce)return this.visitMany(t.data),this;let{type:r}=t;if(!mt.isDictionary(r)){let{length:n,nullCount:i}=t;if(n>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");mt.isNull(r)||gs.call(this,i<=0?new Uint8Array(0):Hd(t.offset,n,t.nullBitmap)),this.nodes.push(new ys(n,i))}return super.visit(t)}visitNull(t){return this}visitDictionary(t){return this.visit(t.clone(t.type.indices))}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}};function gs(e){let t=e.byteLength+7&-8;return this.buffers.push(e),this.bufferRegions.push(new wi(this._byteLength,t)),this._byteLength+=t,this}function SQ(e){let{type:t,length:r,typeIds:n,valueOffsets:i}=e;if(gs.call(this,n),t.mode===er.Sparse)return mE.call(this,e);if(t.mode===er.Dense){if(e.offset<=0)return gs.call(this,i),mE.call(this,e);{let o=n.reduce((u,f)=>Math.max(u,f),n[0]),s=new Int32Array(o+1),a=new Int32Array(o+1).fill(-1),c=new Int32Array(r),l=My(-i[0],r,i);for(let u,f,d=-1;++d<r;)(f=a[u=n[d]])===-1&&(f=a[u]=l[u]),c[d]=l[d]-f,++s[u];gs.call(this,c);for(let u,f=-1,d=t.children.length;++f<d;)if(u=e.children[f]){let h=t.typeIds[f],p=Math.min(r,s[h]);this.visit(u.slice(a[h],p))}}}return this}function IQ(e){let t;return e.nullCount>=e.length?gs.call(this,new Uint8Array(0)):(t=e.values)instanceof Uint8Array?gs.call(this,Hd(e.offset,e.length,t)):gs.call(this,Qu(e.values))}function Pl(e){return gs.call(this,e.values.subarray(0,e.length*e.stride))}function nR(e){let{length:t,values:r,valueOffsets:n}=e,i=n[0],o=n[t],s=Math.min(o-i,r.byteLength-i);return gs.call(this,My(-n[0],t,n)),gs.call(this,r.subarray(i,i+s)),this}function yE(e){let{length:t,valueOffsets:r}=e;return r&&gs.call(this,My(r[0],t,r)),this.visit(e.children[0])}function mE(e){return this.visitMany(e.type.children.map((t,r)=>e.children[r]).filter(Boolean))[0]}br.prototype.visitBool=IQ;br.prototype.visitInt=Pl;br.prototype.visitFloat=Pl;br.prototype.visitUtf8=nR;br.prototype.visitBinary=nR;br.prototype.visitFixedSizeBinary=Pl;br.prototype.visitDate=Pl;br.prototype.visitTimestamp=Pl;br.prototype.visitTime=Pl;br.prototype.visitDecimal=Pl;br.prototype.visitList=yE;br.prototype.visitStruct=mE;br.prototype.visitUnion=SQ;br.prototype.visitInterval=Pl;br.prototype.visitFixedSizeList=yE;br.prototype.visitMap=yE;var ff=class extends rf{constructor(t){super(),this._position=0,this._started=!1,this._sink=new Qs,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,kn(t)||(t={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy=typeof t.autoDestroy=="boolean"?t.autoDestroy:!0,this._writeLegacyIpcFormat=typeof t.writeLegacyIpcFormat=="boolean"?t.writeLegacyIpcFormat:!1}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,r){throw new Error('"throughDOM" not available in this environment')}toString(t=!1){return this._sink.toString(t)}toUint8Array(t=!1){return this._sink.toUint8Array(t)}writeAll(t){return es(t)?t.then(r=>this.writeAll(r)):xo(t)?bE(this,t):gE(this,t)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream(t){return this._sink.toDOMStream(t)}toNodeStream(t){return this._sink.toNodeStream(t)}close(){return this.reset()._sink.close()}abort(t){return this.reset()._sink.abort(t)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset(t=this._sink,r=null){return t===this._sink||t instanceof Qs?this._sink=t:(this._sink=new Qs,t&&ML(t)?this.toDOMStream({type:"bytes"}).pipeTo(t):t&&EL(t)&&this.toNodeStream({objectMode:!1}).pipe(t)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,(!r||!cf(r,this._schema))&&(r==null?(this._position=0,this._schema=null):(this._started=!0,this._schema=r,this._writeSchema(r))),this}write(t){let r=null;if(this._sink){if(t==null)return this.finish()&&void 0;if(t instanceof Pn&&!(r=t.schema))return this.finish()&&void 0;if(t instanceof cr&&!(r=t.schema))return this.finish()&&void 0}else throw new Error("RecordBatchWriter is closed");if(r&&!cf(r,this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,r)}t instanceof cr?t instanceof lf||this._writeRecordBatch(t):t instanceof Pn?this.writeAll(t.batches):rs(t)&&this.writeAll(t)}_writeMessage(t,r=8){let n=r-1,i=Si.encode(t),o=i.byteLength,s=this._writeLegacyIpcFormat?4:8,a=o+s+n&~n,c=a-o-s;return t.headerType===me.RecordBatch?this._recordBatchBlocks.push(new yc(a,t.bodyLength,this._position)):t.headerType===me.DictionaryBatch&&this._dictionaryBlocks.push(new yc(a,t.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(a-s)),o>0&&this._write(i),this._writePadding(c)}_write(t){if(this._started){let r=Ct(t);r&&r.byteLength>0&&(this._sink.write(r),this._position+=r.byteLength)}return this}_writeSchema(t){return this._writeMessage(Si.from(t))}_writeFooter(t){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(ch)}_writePadding(t){return t>0?this._write(new Uint8Array(t)):this}_writeRecordBatch(t){let{byteLength:r,nodes:n,bufferRegions:i,buffers:o}=br.assemble(t),s=new ln(t.numRows,n,i),a=Si.from(s,r);return this._writeDictionaries(t)._writeMessage(a)._writeBodyBuffers(o)}_writeDictionaryBatch(t,r,n=!1){this._dictionaryDeltaOffsets.set(r,t.length+(this._dictionaryDeltaOffsets.get(r)||0));let{byteLength:i,nodes:o,bufferRegions:s,buffers:a}=br.assemble(new ce([t])),c=new ln(t.length,o,s),l=new vi(c,r,n),u=Si.from(l,i);return this._writeMessage(u)._writeBodyBuffers(a)}_writeBodyBuffers(t){let r,n,i;for(let o=-1,s=t.length;++o<s;)(r=t[o])&&(n=r.byteLength)>0&&(this._write(r),(i=(n+7&-8)-n)>0&&this._writePadding(i));return this}_writeDictionaries(t){for(let[r,n]of t.dictionaries){let i=this._dictionaryDeltaOffsets.get(r)||0;if(i===0||(n=n?.slice(i)).length>0)for(let o of n.data)this._writeDictionaryBatch(o,r,i>0),i+=o.length}return this}},df=class e extends ff{static writeAll(t,r){let n=new e(r);return es(t)?t.then(i=>n.writeAll(i)):xo(t)?bE(n,t):gE(n,t)}},hf=class e extends ff{static writeAll(t){let r=new e;return es(t)?t.then(n=>r.writeAll(n)):xo(t)?bE(r,t):gE(r,t)}constructor(){super(),this._autoDestroy=!0}_writeSchema(t){return this._writeMagic()._writePadding(2)}_writeFooter(t){let r=mc.encode(new mc(t,$r.V4,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter(t)._write(r)._write(Int32Array.of(r.byteLength))._writeMagic()}};function gE(e,t){let r=t;t instanceof Pn&&(r=t.batches,e.reset(void 0,t.schema));for(let n of r)e.write(n);return e.finish()}function bE(e,t){var r,n,i,o;return P(this,void 0,void 0,function*(){try{for(r=or(t);n=yield r.next(),!n.done;){let s=n.value;e.write(s)}}catch(s){i={error:s}}finally{try{n&&!n.done&&(o=r.return)&&(yield o.call(r))}finally{if(i)throw i.error}}return e.finish()})}function iR(e,t){if(xo(e))return AQ(e,t);if(rs(e))return TQ(e,t);throw new Error("toDOMStream() must be called with an Iterable or AsyncIterable")}function TQ(e,t){let r=null,n=t?.type==="bytes"||!1,i=t?.highWaterMark||Math.pow(2,24);return new ReadableStream(Object.assign(Object.assign({},t),{start(s){o(s,r||(r=e[Symbol.iterator]()))},pull(s){r?o(s,r):s.close()},cancel(){(r?.return&&r.return()||!0)&&(r=null)}}),Object.assign({highWaterMark:n?i:void 0},t));function o(s,a){let c,l=null,u=s.desiredSize||null;for(;!(l=a.next(n?u:null)).done;)if(ArrayBuffer.isView(l.value)&&(c=Ct(l.value))&&(u!=null&&n&&(u=u-c.byteLength+1),l.value=c),s.enqueue(l.value),u!=null&&--u<=0)return;s.close()}}function AQ(e,t){let r=null,n=t?.type==="bytes"||!1,i=t?.highWaterMark||Math.pow(2,24);return new ReadableStream(Object.assign(Object.assign({},t),{start(s){return P(this,void 0,void 0,function*(){yield o(s,r||(r=e[Symbol.asyncIterator]()))})},pull(s){return P(this,void 0,void 0,function*(){r?yield o(s,r):s.close()})},cancel(){return P(this,void 0,void 0,function*(){(r?.return&&(yield r.return())||!0)&&(r=null)})}}),Object.assign({highWaterMark:n?i:void 0},t));function o(s,a){return P(this,void 0,void 0,function*(){let c,l=null,u=s.desiredSize||null;for(;!(l=yield a.next(n?u:null)).done;)if(ArrayBuffer.isView(l.value)&&(c=Ct(l.value))&&(u!=null&&n&&(u=u-c.byteLength+1),l.value=c),s.enqueue(l.value),u!=null&&--u<=0)return;s.close()})}}function aR(e){return new xE(e)}var xE=class{constructor(t){this._numChunks=0,this._finished=!1,this._bufferedSize=0;let{["readableStrategy"]:r,["writableStrategy"]:n,["queueingStrategy"]:i="count"}=t,o=ux(t,["readableStrategy","writableStrategy","queueingStrategy"]);this._controller=null,this._builder=of(o),this._getSize=i!=="bytes"?oR:sR;let{["highWaterMark"]:s=i==="bytes"?Math.pow(2,14):1e3}=Object.assign({},r),{["highWaterMark"]:a=i==="bytes"?Math.pow(2,14):1e3}=Object.assign({},n);this.readable=new ReadableStream({cancel:()=>{this._builder.clear()},pull:c=>{this._maybeFlush(this._builder,this._controller=c)},start:c=>{this._maybeFlush(this._builder,this._controller=c)}},{highWaterMark:s,size:i!=="bytes"?oR:sR}),this.writable=new WritableStream({abort:()=>{this._builder.clear()},write:()=>{this._maybeFlush(this._builder,this._controller)},close:()=>{this._maybeFlush(this._builder.finish(),this._controller)}},{highWaterMark:a,size:c=>this._writeValueAndReturnChunkSize(c)})}_writeValueAndReturnChunkSize(t){let r=this._bufferedSize;return this._bufferedSize=this._getSize(this._builder.append(t)),this._bufferedSize-r}_maybeFlush(t,r){r!=null&&(this._bufferedSize>=r.desiredSize&&++this._numChunks&&this._enqueue(r,t.toVector()),t.finished&&((t.length>0||this._numChunks===0)&&++this._numChunks&&this._enqueue(r,t.toVector()),!this._finished&&(this._finished=!0)&&this._enqueue(r,null)))}_enqueue(t,r){this._bufferedSize=0,this._controller=null,r==null?t.close():t.enqueue(r)}},oR=e=>{var t;return(t=e?.length)!==null&&t!==void 0?t:0},sR=e=>{var t;return(t=e?.byteLength)!==null&&t!==void 0?t:0};function Uw(e,t){let r=new Qs,n=null,i=new ReadableStream({cancel(){return P(this,void 0,void 0,function*(){yield r.close()})},start(a){return P(this,void 0,void 0,function*(){yield s(a,n||(n=yield o()))})},pull(a){return P(this,void 0,void 0,function*(){n?yield s(a,n):a.close()})}});return{writable:new WritableStream(r,Object.assign({highWaterMark:Math.pow(2,14)},e)),readable:i};function o(){return P(this,void 0,void 0,function*(){return yield(yield un.from(r)).open(t)})}function s(a,c){return P(this,void 0,void 0,function*(){let l=a.desiredSize,u=null;for(;!(u=yield c.next()).done;)if(a.enqueue(u.value),l!=null&&--l<=0)return;a.close()})}}function Pw(e,t){let r=new this(e),n=new So(r),i=new ReadableStream({cancel(){return P(this,void 0,void 0,function*(){yield n.cancel()})},pull(s){return P(this,void 0,void 0,function*(){yield o(s)})},start(s){return P(this,void 0,void 0,function*(){yield o(s)})}},Object.assign({highWaterMark:Math.pow(2,14)},t));return{writable:new WritableStream(r,e),readable:i};function o(s){return P(this,void 0,void 0,function*(){let a=null,c=s.desiredSize;for(;a=yield n.read(c||null);)if(s.enqueue(a),c!=null&&(c-=a.byteLength)<=0)return;s.close()})}}function $w(e,t="stream"){return(t==="stream"?df:hf).writeAll(e).toUint8Array(!0)}var OQ=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},FM),rE),GM),NM),MM),WM),{compareSchemas:cf,compareFields:L4,compareTypes:R4});on.toDOMStream=iR;Ye.throughDOM=aR;un.throughDOM=Uw;Ul.throughDOM=Uw;ea.throughDOM=Uw;ff.throughDOM=Pw;hf.throughDOM=Pw;df.throughDOM=Pw;var FQ=Object.create,lR=Object.defineProperty,NQ=Object.getOwnPropertyDescriptor,DQ=Object.getOwnPropertyNames,LQ=Object.getPrototypeOf,RQ=Object.prototype.hasOwnProperty,kQ=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),CQ=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of DQ(t))!RQ.call(e,i)&&i!==r&&lR(e,i,{get:()=>t[i],enumerable:!(n=NQ(t,i))||n.enumerable});return e},UQ=(e,t,r)=>(r=e!=null?FQ(LQ(e)):{},CQ(t||!e||!e.__esModule?lR(r,"default",{value:e,enumerable:!0}):r,e)),PQ=kQ((e,t)=>{t.exports=Worker}),$Q=(e=>(e[e.UNDEFINED=0]="UNDEFINED",e[e.AUTOMATIC=1]="AUTOMATIC",e[e.READ_ONLY=2]="READ_ONLY",e[e.READ_WRITE=3]="READ_WRITE",e))($Q||{}),zQ=(e=>(e[e.NONE=0]="NONE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARNING=3]="WARNING",e[e.ERROR=4]="ERROR",e))(zQ||{}),VQ=(e=>(e[e.NONE=0]="NONE",e[e.CONNECT=1]="CONNECT",e[e.DISCONNECT=2]="DISCONNECT",e[e.OPEN=3]="OPEN",e[e.QUERY=4]="QUERY",e[e.INSTANTIATE=5]="INSTANTIATE",e))(VQ||{}),jQ=(e=>(e[e.NONE=0]="NONE",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR",e[e.START=3]="START",e[e.RUN=4]="RUN",e[e.CAPTURE=5]="CAPTURE",e))(jQ||{}),qQ=(e=>(e[e.NONE=0]="NONE",e[e.WEB_WORKER=1]="WEB_WORKER",e[e.NODE_WORKER=2]="NODE_WORKER",e[e.BINDINGS=3]="BINDINGS",e[e.ASYNC_DUCKDB=4]="ASYNC_DUCKDB",e))(qQ||{}),uR=class{log(e){}},fR=class{constructor(e=2){this.level=e}log(e){e.level>=this.level&&console.log(e)}};var YQ=(e=>(e[e.SUCCESS=0]="SUCCESS",e))(YQ||{}),WQ=class{constructor(e,t){this._bindings=e,this._conn=t}get bindings(){return this._bindings}async close(){return this._bindings.disconnect(this._conn)}useUnsafe(e){return e(this._bindings,this._conn)}async query(e){this._bindings.logger.log({timestamp:new Date,level:2,origin:4,topic:4,event:4,value:e});let t=await this._bindings.runQuery(this._conn,e),r=un.from(t);return console.assert(r.isSync(),"Reader is not sync"),console.assert(r.isFile(),"Reader is not file"),new Pn(r)}async send(e){this._bindings.logger.log({timestamp:new Date,level:2,origin:4,topic:4,event:4,value:e});let t=await this._bindings.startPendingQuery(this._conn,e);for(;t==null;)t=await this._bindings.pollPendingQuery(this._conn);let r=new dR(this._bindings,this._conn,t),n=await un.from(r);return console.assert(n.isAsync()),console.assert(n.isStream()),n}async cancelSent(){return await this._bindings.cancelPendingQuery(this._conn)}async getTableNames(e){return await this._bindings.getTableNames(this._conn,e)}async prepare(e){let t=await this._bindings.createPrepared(this._conn,e);return new GQ(this._bindings,this._conn,t)}async insertArrowTable(e,t){let r=$w(e,"stream");await this.insertArrowFromIPCStream(r,t)}async insertArrowFromIPCStream(e,t){await this._bindings.insertArrowFromIPCStream(this._conn,e,t)}async insertCSVFromPath(e,t){await this._bindings.insertCSVFromPath(this._conn,e,t)}async insertJSONFromPath(e,t){await this._bindings.insertJSONFromPath(this._conn,e,t)}},dR=class{constructor(e,t,r){this.db=e,this.conn=t,this.header=r,this._first=!0,this._depleted=!1,this._inFlight=null}async next(){if(this._first)return this._first=!1,{done:!1,value:this.header};if(this._depleted)return{done:!0,value:null};let e;return this._inFlight!=null?(e=await this._inFlight,this._inFlight=null):e=await this.db.fetchQueryResults(this.conn),this._depleted=e.length==0,this._depleted||(this._inFlight=this.db.fetchQueryResults(this.conn)),{done:this._depleted,value:e}}[Symbol.asyncIterator](){return this}},GQ=class{constructor(e,t,r){this.bindings=e,this.connectionId=t,this.statementId=r}async close(){await this.bindings.closePrepared(this.connectionId,this.statementId)}async query(...e){let t=await this.bindings.runPrepared(this.connectionId,this.statementId,e),r=un.from(t);return console.assert(r.isSync()),console.assert(r.isFile()),new Pn(r)}async send(...e){let t=await this.bindings.sendPrepared(this.connectionId,this.statementId,e),r=new dR(this.bindings,this.connectionId,t),n=await un.from(r);return console.assert(n.isAsync()),console.assert(n.isStream()),n}},XQ=(e=>(e.CANCEL_PENDING_QUERY="CANCEL_PENDING_QUERY",e.CLOSE_PREPARED="CLOSE_PREPARED",e.COLLECT_FILE_STATISTICS="COLLECT_FILE_STATISTICS",e.CONNECT="CONNECT",e.COPY_FILE_TO_BUFFER="COPY_FILE_TO_BUFFER",e.COPY_FILE_TO_PATH="COPY_FILE_TO_PATH",e.CREATE_PREPARED="CREATE_PREPARED",e.DISCONNECT="DISCONNECT",e.DROP_FILE="DROP_FILE",e.DROP_FILES="DROP_FILES",e.EXPORT_FILE_STATISTICS="EXPORT_FILE_STATISTICS",e.FETCH_QUERY_RESULTS="FETCH_QUERY_RESULTS",e.FLUSH_FILES="FLUSH_FILES",e.GET_FEATURE_FLAGS="GET_FEATURE_FLAGS",e.GET_TABLE_NAMES="GET_TABLE_NAMES",e.GET_VERSION="GET_VERSION",e.GLOB_FILE_INFOS="GLOB_FILE_INFOS",e.INSERT_ARROW_FROM_IPC_STREAM="INSERT_ARROW_FROM_IPC_STREAM",e.INSERT_CSV_FROM_PATH="IMPORT_CSV_FROM_PATH",e.INSERT_JSON_FROM_PATH="IMPORT_JSON_FROM_PATH",e.INSTANTIATE="INSTANTIATE",e.OPEN="OPEN",e.PING="PING",e.POLL_PENDING_QUERY="POLL_PENDING_QUERY",e.REGISTER_FILE_BUFFER="REGISTER_FILE_BUFFER",e.REGISTER_FILE_HANDLE="REGISTER_FILE_HANDLE",e.REGISTER_FILE_URL="REGISTER_FILE_URL",e.RESET="RESET",e.RUN_PREPARED="RUN_PREPARED",e.RUN_QUERY="RUN_QUERY",e.SEND_PREPARED="SEND_PREPARED",e.START_PENDING_QUERY="START_PENDING_QUERY",e.TOKENIZE="TOKENIZE",e))(XQ||{}),HQ=(e=>(e.CONNECTION_INFO="CONNECTION_INFO",e.ERROR="ERROR",e.FEATURE_FLAGS="FEATURE_FLAGS",e.FILE_BUFFER="FILE_BUFFER",e.FILE_INFOS="FILE_INFOS",e.FILE_SIZE="FILE_SIZE",e.FILE_STATISTICS="FILE_STATISTICS",e.INSTANTIATE_PROGRESS="INSTANTIATE_PROGRESS",e.LOG="LOG",e.OK="OK",e.PREPARED_STATEMENT_ID="PREPARED_STATEMENT_ID",e.QUERY_PLAN="QUERY_PLAN",e.QUERY_RESULT="QUERY_RESULT",e.QUERY_RESULT_CHUNK="QUERY_RESULT_CHUNK",e.QUERY_RESULT_HEADER="QUERY_RESULT_HEADER",e.QUERY_RESULT_HEADER_OR_NULL="QUERY_RESULT_HEADER_OR_NULL",e.REGISTERED_FILE="REGISTERED_FILE",e.SCRIPT_TOKENS="SCRIPT_TOKENS",e.SUCCESS="SUCCESS",e.TABLE_NAMES="TABLE_NAMES",e.VERSION_STRING="VERSION_STRING",e))(HQ||{}),ye=class{constructor(e,t){this.promiseResolver=()=>{},this.promiseRejecter=()=>{},this.type=e,this.data=t,this.promise=new Promise((r,n)=>{this.promiseResolver=r,this.promiseRejecter=n})}};function zw(e){switch(e.typeId){case N.Binary:return{sqlType:"binary"};case N.Bool:return{sqlType:"bool"};case N.Date:return{sqlType:"date"};case N.DateDay:return{sqlType:"date32[d]"};case N.DateMillisecond:return{sqlType:"date64[ms]"};case N.Decimal:{let t=e;return{sqlType:"decimal",precision:t.precision,scale:t.scale}}case N.Float:return{sqlType:"float"};case N.Float16:return{sqlType:"float16"};case N.Float32:return{sqlType:"float32"};case N.Float64:return{sqlType:"float64"};case N.Int:return{sqlType:"int32"};case N.Int16:return{sqlType:"int16"};case N.Int32:return{sqlType:"int32"};case N.Int64:return{sqlType:"int64"};case N.Uint16:return{sqlType:"uint16"};case N.Uint32:return{sqlType:"uint32"};case N.Uint64:return{sqlType:"uint64"};case N.Uint8:return{sqlType:"uint8"};case N.IntervalDayTime:return{sqlType:"interval[dt]"};case N.IntervalYearMonth:return{sqlType:"interval[m]"};case N.List:return{sqlType:"list",valueType:zw(e.valueType)};case N.FixedSizeBinary:return{sqlType:"fixedsizebinary",byteWidth:e.byteWidth};case N.Null:return{sqlType:"null"};case N.Utf8:return{sqlType:"utf8"};case N.Struct:return{sqlType:"struct",fields:e.children.map(t=>TE(t.name,t.type))};case N.Map:{let t=e;return{sqlType:"map",keyType:zw(t.keyType),valueType:zw(t.valueType)}}case N.Time:return{sqlType:"time[s]"};case N.TimeMicrosecond:return{sqlType:"time[us]"};case N.TimeMillisecond:return{sqlType:"time[ms]"};case N.TimeNanosecond:return{sqlType:"time[ns]"};case N.TimeSecond:return{sqlType:"time[s]"};case N.Timestamp:return{sqlType:"timestamp",timezone:e.timezone||void 0};case N.TimestampSecond:return{sqlType:"timestamp[s]",timezone:e.timezone||void 0};case N.TimestampMicrosecond:return{sqlType:"timestamp[us]",timezone:e.timezone||void 0};case N.TimestampNanosecond:return{sqlType:"timestamp[ns]",timezone:e.timezone||void 0};case N.TimestampMillisecond:return{sqlType:"timestamp[ms]",timezone:e.timezone||void 0}}throw new Error(`unsupported arrow type: ${e.toString()}`)}function TE(e,t){let r=zw(t);return r.name=e,r}var ZQ=new TextEncoder,hR=class{constructor(e,t=null){this._onInstantiationProgress=[],this._worker=null,this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{},this._nextMessageId=0,this._pendingRequests=new Map,this._logger=e,this._onMessageHandler=this.onMessage.bind(this),this._onErrorHandler=this.onError.bind(this),this._onCloseHandler=this.onClose.bind(this),t!=null&&this.attach(t)}get logger(){return this._logger}attach(e){this._worker=e,this._worker.addEventListener("message",this._onMessageHandler),this._worker.addEventListener("error",this._onErrorHandler),this._worker.addEventListener("close",this._onCloseHandler),this._workerShutdownPromise=new Promise((t,r)=>{this._workerShutdownResolver=t})}detach(){!this._worker||(this._worker.removeEventListener("message",this._onMessageHandler),this._worker.removeEventListener("error",this._onErrorHandler),this._worker.removeEventListener("close",this._onCloseHandler),this._worker=null,this._workerShutdownResolver(null),this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{})}async terminate(){!this._worker||(this._worker.terminate(),this._worker=null,this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{})}async postTask(e,t=[]){if(!this._worker){console.error("cannot send a message since the worker is not set!");return}let r=this._nextMessageId++;return this._pendingRequests.set(r,e),this._worker.postMessage({messageId:r,type:e.type,data:e.data},t),await e.promise}onMessage(e){let t=e.data;switch(t.type){case"LOG":{this._logger.log(t.data);return}case"INSTANTIATE_PROGRESS":{for(let n of this._onInstantiationProgress)n(t.data);return}}let r=this._pendingRequests.get(t.requestId);if(!r){console.warn(`unassociated response: [${t.requestId}, ${t.type.toString()}]`);return}if(this._pendingRequests.delete(t.requestId),t.type=="ERROR"){let n=new Error(t.data.message);n.name=t.data.name,n.stack=t.data.stack,r.promiseRejecter(n);return}switch(r.type){case"CLOSE_PREPARED":case"COLLECT_FILE_STATISTICS":case"COPY_FILE_TO_PATH":case"DISCONNECT":case"DROP_FILE":case"DROP_FILES":case"FLUSH_FILES":case"INSERT_ARROW_FROM_IPC_STREAM":case"IMPORT_CSV_FROM_PATH":case"IMPORT_JSON_FROM_PATH":case"OPEN":case"PING":case"REGISTER_FILE_BUFFER":case"REGISTER_FILE_HANDLE":case"REGISTER_FILE_URL":case"RESET":if(t.type=="OK"){r.promiseResolver(t.data);return}break;case"INSTANTIATE":if(this._onInstantiationProgress=[],t.type=="OK"){r.promiseResolver(t.data);return}break;case"GLOB_FILE_INFOS":if(t.type=="FILE_INFOS"){r.promiseResolver(t.data);return}break;case"GET_VERSION":if(t.type=="VERSION_STRING"){r.promiseResolver(t.data);return}break;case"GET_FEATURE_FLAGS":if(t.type=="FEATURE_FLAGS"){r.promiseResolver(t.data);return}break;case"GET_TABLE_NAMES":if(t.type=="TABLE_NAMES"){r.promiseResolver(t.data);return}break;case"TOKENIZE":if(t.type=="SCRIPT_TOKENS"){r.promiseResolver(t.data);return}break;case"COPY_FILE_TO_BUFFER":if(t.type=="FILE_BUFFER"){r.promiseResolver(t.data);return}break;case"EXPORT_FILE_STATISTICS":if(t.type=="FILE_STATISTICS"){r.promiseResolver(t.data);return}break;case"CONNECT":if(t.type=="CONNECTION_INFO"){r.promiseResolver(t.data);return}break;case"RUN_PREPARED":case"RUN_QUERY":if(t.type=="QUERY_RESULT"){r.promiseResolver(t.data);return}break;case"SEND_PREPARED":if(t.type=="QUERY_RESULT_HEADER"){r.promiseResolver(t.data);return}break;case"START_PENDING_QUERY":if(t.type=="QUERY_RESULT_HEADER_OR_NULL"){r.promiseResolver(t.data);return}break;case"POLL_PENDING_QUERY":if(t.type=="QUERY_RESULT_HEADER_OR_NULL"){r.promiseResolver(t.data);return}break;case"CANCEL_PENDING_QUERY":if(this._onInstantiationProgress=[],t.type=="SUCCESS"){r.promiseResolver(t.data);return}break;case"FETCH_QUERY_RESULTS":if(t.type=="QUERY_RESULT_CHUNK"){r.promiseResolver(t.data);return}break;case"CREATE_PREPARED":if(t.type=="PREPARED_STATEMENT_ID"){r.promiseResolver(t.data);return}break}r.promiseRejecter(new Error(`unexpected response type: ${t.type.toString()}`))}onError(e){console.error(e),console.error(`error in duckdb worker: ${e.message}`),this._pendingRequests.clear()}onClose(){if(this._workerShutdownResolver(null),this._pendingRequests.size!=0){console.warn(`worker terminated with ${this._pendingRequests.size} pending requests`);return}this._pendingRequests.clear()}async reset(){let e=new ye("RESET",null);return await this.postTask(e)}async ping(){let e=new ye("PING",null);await this.postTask(e)}async dropFile(e){let t=new ye("DROP_FILE",e);return await this.postTask(t)}async dropFiles(){let e=new ye("DROP_FILES",null);return await this.postTask(e)}async flushFiles(){let e=new ye("FLUSH_FILES",null);return await this.postTask(e)}async instantiate(e,t=null,r=n=>{}){this._onInstantiationProgress.push(r);let n=new ye("INSTANTIATE",[e,t]);return await this.postTask(n)}async getVersion(){let e=new ye("GET_VERSION",null);return await this.postTask(e)}async getFeatureFlags(){let e=new ye("GET_FEATURE_FLAGS",null);return await this.postTask(e)}async open(e){let t=new ye("OPEN",e);await this.postTask(t)}async tokenize(e){let t=new ye("TOKENIZE",e);return await this.postTask(t)}async connectInternal(){let e=new ye("CONNECT",null);return await this.postTask(e)}async connect(){let e=await this.connectInternal();return new WQ(this,e)}async disconnect(e){let t=new ye("DISCONNECT",e);await this.postTask(t)}async runQuery(e,t){let r=new ye("RUN_QUERY",[e,t]);return await this.postTask(r)}async startPendingQuery(e,t){let r=new ye("START_PENDING_QUERY",[e,t]);return await this.postTask(r)}async pollPendingQuery(e){let t=new ye("POLL_PENDING_QUERY",e);return await this.postTask(t)}async cancelPendingQuery(e){let t=new ye("CANCEL_PENDING_QUERY",e);return await this.postTask(t)}async fetchQueryResults(e){let t=new ye("FETCH_QUERY_RESULTS",e);return await this.postTask(t)}async getTableNames(e,t){let r=new ye("GET_TABLE_NAMES",[e,t]);return await this.postTask(r)}async createPrepared(e,t){let r=new ye("CREATE_PREPARED",[e,t]);return await this.postTask(r)}async closePrepared(e,t){let r=new ye("CLOSE_PREPARED",[e,t]);await this.postTask(r)}async runPrepared(e,t,r){let n=new ye("RUN_PREPARED",[e,t,r]);return await this.postTask(n)}async sendPrepared(e,t,r){let n=new ye("SEND_PREPARED",[e,t,r]);return await this.postTask(n)}async globFiles(e){let t=new ye("GLOB_FILE_INFOS",e);return await this.postTask(t)}async registerFileText(e,t){let r=ZQ.encode(t);await this.registerFileBuffer(e,r)}async registerFileURL(e,t,r,n){t===void 0&&(t=e);let i=new ye("REGISTER_FILE_URL",[e,t,r,n]);await this.postTask(i)}async registerEmptyFileBuffer(e){let t=new ye("REGISTER_FILE_BUFFER",[e,new Uint8Array]);await this.postTask(t)}async registerFileBuffer(e,t){let r=new ye("REGISTER_FILE_BUFFER",[e,t]);await this.postTask(r,[t.buffer])}async registerFileHandle(e,t,r,n){let i=new ye("REGISTER_FILE_HANDLE",[e,t,r,n]);await this.postTask(i,[])}async collectFileStatistics(e,t){let r=new ye("COLLECT_FILE_STATISTICS",[e,t]);await this.postTask(r,[])}async exportFileStatistics(e){let t=new ye("EXPORT_FILE_STATISTICS",e);return await this.postTask(t,[])}async copyFileToBuffer(e){let t=new ye("COPY_FILE_TO_BUFFER",e);return await this.postTask(t)}async copyFileToPath(e,t){let r=new ye("COPY_FILE_TO_PATH",[e,t]);await this.postTask(r)}async insertArrowFromIPCStream(e,t,r){if(t.length==0)return;let n=new ye("INSERT_ARROW_FROM_IPC_STREAM",[e,t,r]);await this.postTask(n,[t.buffer])}async insertCSVFromPath(e,t,r){if(r.columns!==void 0){let i=[];for(let o in r.columns){let s=r.columns[o];i.push(TE(o,s))}r.columnsFlat=i,delete r.columns}let n=new ye("IMPORT_CSV_FROM_PATH",[e,t,r]);await this.postTask(n)}async insertJSONFromPath(e,t,r){if(r.columns!==void 0){let i=[];for(let o in r.columns){let s=r.columns[o];i.push(TE(o,s))}r.columnsFlat=i,delete r.columns}let n=new ye("IMPORT_JSON_FROM_PATH",[e,t,r]);await this.postTask(n)}};var KQ=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,3,1,0,1,10,14,1,12,0,65,0,65,0,65,0,252,10,0,0,11])),QQ=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,8,1,6,0,6,64,25,11,11])),JQ=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])),tJ=()=>(async e=>{try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(e)}catch{return!1}})(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11])),AE={name:"@duckdb/duckdb-wasm",version:"1.27.0",description:"DuckDB powered by WebAssembly",license:"MIT",repository:{type:"git",url:"https://github.com/duckdb/duckdb-wasm.git"},keywords:["sql","duckdb","relational","database","data","query","wasm","analytics","olap","arrow","parquet","json","csv"],dependencies:{"apache-arrow":"^11.0.0"},devDependencies:{"@types/emscripten":"^1.39.6","@types/jasmine":"^4.3.1","@typescript-eslint/eslint-plugin":"^5.53.0","@typescript-eslint/parser":"^5.49.0",esbuild:"^0.15.12",eslint:"^8.35.0","eslint-plugin-jasmine":"^4.1.3","eslint-plugin-react":"^7.32.2","fast-glob":"^3.2.12",jasmine:"^4.5.0","jasmine-core":"^5.0.0","jasmine-spec-reporter":"^7.0.0","js-sha256":"^0.9.0",karma:"^6.4.2","karma-chrome-launcher":"^3.1.1","karma-coverage":"^2.2.0","karma-firefox-launcher":"^2.1.2","karma-jasmine":"^5.1.0","karma-jasmine-html-reporter":"^2.0.0","karma-sourcemap-loader":"^0.3.8","karma-spec-reporter":"^0.0.36","make-dir":"^3.1.0",nyc:"^15.1.0",prettier:"^2.8.4",puppeteer:"^19.10.0",rimraf:"^4.3.0",s3rver:"^3.7.1",typedoc:"^0.24.8",typescript:"^4.8.4","wasm-feature-detect":"^1.5.1","web-worker":"^1.2.0"},scripts:{"build:debug":"node bundle.mjs debug && tsc --emitDeclarationOnly","build:release":"node bundle.mjs release && tsc --emitDeclarationOnly",docs:"typedoc",report:"node ./coverage.mjs","test:node":"node --enable-source-maps --experimental-wasm-eh ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs","test:node:debug":"node --inspect-brk --enable-source-maps --experimental-wasm-eh ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs","test:node:coverage":"nyc -r json --report-dir ./coverage/node node --experimental-wasm-eh ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs","test:firefox":"karma start ./karma/tests-firefox.cjs","test:chrome":"karma start ./karma/tests-chrome.cjs","test:chrome:eh":"karma start ./karma/tests-chrome-eh.cjs","test:chrome:coverage":"karma start ./karma/tests-chrome-coverage.cjs","test:browser":"karma start ./karma/tests-all.cjs","test:browser:debug":"karma start ./karma/tests-debug.cjs",test:"npm run test:chrome && npm run test:node","test:coverage":"npm run test:chrome:coverage && npm run test:node:coverage && npm run report",lint:"eslint src test"},files:["dist","!dist/types/test"],main:"dist/duckdb-browser.cjs",module:"dist/duckdb-browser.mjs",types:"dist/duckdb-browser.d.ts",jsdelivr:"dist/duckdb-browser.cjs",unpkg:"dist/duckdb-browser.mjs",sideEffects:!1,browser:{fs:!1,path:!1,perf_hooks:!1,os:!1,worker_threads:!1},exports:{"./dist/duckdb-mvp.wasm":"./dist/duckdb-mvp.wasm","./dist/duckdb-eh.wasm":"./dist/duckdb-eh.wasm","./dist/duckdb-coi.wasm":"./dist/duckdb-coi.wasm","./dist/duckdb-browser":"./dist/duckdb-browser.mjs","./dist/duckdb-browser.cjs":"./dist/duckdb-browser.cjs","./dist/duckdb-browser.mjs":"./dist/duckdb-browser.mjs","./dist/duckdb-browser-blocking":"./dist/duckdb-browser-blocking.mjs","./dist/duckdb-browser-blocking.mjs":"./dist/duckdb-browser-blocking.mjs","./dist/duckdb-browser-blocking.cjs":"./dist/duckdb-browser-blocking.cjs","./dist/duckdb-browser-coi.pthread.worker.js":"./dist/duckdb-browser-coi.pthread.worker.js","./dist/duckdb-browser-coi.worker.js":"./dist/duckdb-browser-coi.worker.js","./dist/duckdb-browser-eh.worker.js":"./dist/duckdb-browser-eh.worker.js","./dist/duckdb-browser-mvp.worker.js":"./dist/duckdb-browser-mvp.worker.js","./dist/duckdb-node":"./dist/duckdb-node.cjs","./dist/duckdb-node.cjs":"./dist/duckdb-node.cjs","./dist/duckdb-node-blocking":"./dist/duckdb-node-blocking.cjs","./dist/duckdb-node-blocking.cjs":"./dist/duckdb-node-blocking.cjs","./dist/duckdb-node-eh.worker.cjs":"./dist/duckdb-node-eh.worker.cjs","./dist/duckdb-node-mvp.worker.cjs":"./dist/duckdb-node-mvp.worker.cjs","./blocking":{browser:{types:"./dist/duckdb-browser-blocking.d.ts",import:"./dist/duckdb-browser-blocking.mjs",require:"./dist/duckdb-browser-blocking.cjs"},node:{types:"./dist/duckdb-node-blocking.d.ts",require:"./dist/duckdb-node-blocking.cjs",import:"./dist/duckdb-node-blocking.cjs"},types:"./dist/duckdb-browser-blocking.d.ts",import:"./dist/duckdb-browser-blocking.mjs",require:"./dist/duckdb-browser-blocking.cjs"},".":{browser:{types:"./dist/duckdb-browser.d.ts",import:"./dist/duckdb-browser.mjs",require:"./dist/duckdb-browser.cjs"},node:{types:"./dist/duckdb-node.d.ts",import:"./dist/duckdb-node.cjs",require:"./dist/duckdb-node.cjs"},types:"./dist/duckdb-browser.d.ts",import:"./dist/duckdb-browser.mjs",require:"./dist/duckdb-browser.cjs"}}},eJ=AE.name,rJ=AE.version,ME=AE.version.split("."),WEt=ME[0],GEt=ME[1],XEt=ME[2],nJ=()=>typeof navigator>"u";function pR(){let e=`https://cdn.jsdelivr.net/npm/${eJ}@${rJ}/dist/`;return{mvp:{mainModule:`${e}duckdb-mvp.wasm`,mainWorker:`${e}duckdb-browser-mvp.worker.js`},eh:{mainModule:`${e}duckdb-eh.wasm`,mainWorker:`${e}duckdb-browser-eh.worker.js`}}}var _E=null,wE=null,vE=null,SE=null,IE=null;async function iJ(){return _E==null&&(_E=typeof BigInt64Array<"u"),wE==null&&(wE=await QQ()),vE==null&&(vE=await tJ()),SE==null&&(SE=await JQ()),IE==null&&(IE=await KQ()),{bigInt64Array:_E,crossOriginIsolated:nJ()||globalThis.crossOriginIsolated||!1,wasmExceptions:wE,wasmSIMD:SE,wasmThreads:vE,wasmBulkMemory:IE}}async function mR(e){let t=await iJ();if(t.wasmExceptions){if(t.wasmSIMD&&t.wasmThreads&&t.crossOriginIsolated&&e.coi)return{mainModule:e.coi.mainModule,mainWorker:e.coi.mainWorker,pthreadWorker:e.coi.pthreadWorker};if(e.eh)return{mainModule:e.eh.mainModule,mainWorker:e.eh.mainWorker,pthreadWorker:null}}return{mainModule:e.mvp.mainModule,mainWorker:e.mvp.mainWorker,pthreadWorker:null}}var HEt=UQ(PQ());function oJ(){let e=new TextDecoder;return t=>(typeof SharedArrayBuffer<"u"&&t.buffer instanceof SharedArrayBuffer&&(t=new Uint8Array(t)),e.decode(t))}var ZEt=oJ(),sJ=(e=>(e[e.BUFFER=0]="BUFFER",e[e.NODE_FS=1]="NODE_FS",e[e.BROWSER_FILEREADER=2]="BROWSER_FILEREADER",e[e.BROWSER_FSACCESS=3]="BROWSER_FSACCESS",e[e.HTTP=4]="HTTP",e[e.S3=5]="S3",e))(sJ||{});async function yR(e){let t=await cJ(e),r=await t.connect();return{db:t,con:r,query:async n=>{let{type:i,sql:o}=n,s=await r.query(o);return i==="exec"?void 0:i==="arrow"?s:Array.from(s)}}}async function cJ({log:e=!1}={}){let t=pR(),r=await mR(t),n=URL.createObjectURL(new Blob([`importScripts("${r.mainWorker}");`],{type:"text/javascript"})),i=new Worker(n),o=e?new fR:new uR,s=new hR(o,i);return await s.instantiate(r.mainModule,r.pthreadWorker),URL.revokeObjectURL(n),s}function EE(){let e=new Set,t,r=new Promise(n=>t=n);return{pending(n){e.add(n)},ready(n){return e.delete(n),e.size===0},resolve(){r=new Promise(n=>{t(),t=n})},get promise(){return r}}}function $l(e,t){let r=new e(t);return nn().connect(r),r.element}var lJ=e=>e&&typeof e=="object"&&!Array.isArray(e),jw=e=>$l(Vw,e),Vw=class extends mi{constructor({element:t,filterBy:r,from:n,column:i,label:o=i,format:s=u=>u,options:a,value:c,as:l}={}){super(r),this.from=n,this.column=i,this.selection=l,this.format=s,this.element=t??document.createElement("div"),this.element.setAttribute("class","input"),this.element.value=this;let u=document.createElement("label");u.innerText=o||i,this.element.appendChild(u),this.select=document.createElement("select"),a&&(this.data=a.map(f=>lJ(f)?f:{value:f}),this.update()),c=c??this.selection?.value??this.data?.[0]?.value,this.selection?.value===void 0&&this.publish(c),this.element.appendChild(this.select),this.selection&&(this.select.addEventListener("input",()=>{this.publish(this.selectedValue()??null)}),yo(this.selection)||this.selection.addEventListener("value",f=>{f!==this.select.value&&this.selectedValue(f)}))}selectedValue(t){if(arguments.length===0){let r=this.select.selectedIndex;return this.data[r].value}else{let r=this.data?.findIndex(n=>n.value===t);r>=0?this.select.selectedIndex=r:this.select.value=String(t)}}reset(){this.select.selectedIndex=this.from?0:-1}publish(t){let{selection:r,column:n}=this;yo(r)?r.update({source:this,schema:{type:"point"},value:t,predicate:t?Vs(n,po(t)):null}):yi(r)&&r.update(t)}query(t=[]){let{from:r,column:n}=this;return r?yt.from(r).select({value:n}).distinct().where(t).orderby(n):null}queryResult(t){return this.data=[{value:"",label:"All"},...t],this}update(){let{data:t,format:r,select:n}=this;n.replaceChildren();for(let{value:i,label:o}of t){let s=document.createElement("option");s.setAttribute("value",i),s.innerText=o??r(i),this.select.appendChild(s)}return this.selection&&this.selectedValue(this.selection?.value??""),this}};var uJ={contains:lM,prefix:uM,suffix:fM,regexp:cM},fJ=0,Yw=e=>$l(qw,e),qw=class extends mi{constructor({element:t,filterBy:r,from:n,column:i,label:o,type:s="contains",as:a}={}){if(super(r),this.id="search_"+ ++fJ,this.type=s,this.from=n,this.column=i,this.selection=a,this.element=t??document.createElement("div"),this.element.setAttribute("class","input"),this.element.value=this,o){let c=document.createElement("label");c.setAttribute("for",this.id),c.innerText=o,this.element.appendChild(c)}this.searchbox=document.createElement("input"),this.searchbox.setAttribute("id",this.id),this.searchbox.setAttribute("type","text"),this.searchbox.setAttribute("placeholder","Query"),this.element.appendChild(this.searchbox),this.selection&&(this.searchbox.addEventListener("input",()=>{this.publish(this.searchbox.value||null)}),yo(this.selection)||this.selection.addEventListener("value",c=>{c!==this.searchbox.value&&(this.searchbox.value=c)}))}reset(){this.searchbox.value=""}publish(t){let{selection:r,column:n,type:i}=this;yo(r)?r.update({source:this,schema:{type:i},value:t,predicate:t?uJ[i](n,po(t)):null}):yi(r)&&r.update(t)}query(t=[]){let{from:r,column:n}=this;return r?yt.from(r).select({list:n}).distinct().where(t):null}queryResult(t){return this.data=t,this}update(){let t=document.createElement("datalist"),r=`${this.id}_list`;t.setAttribute("id",r);for(let n of this.data){let i=document.createElement("option");i.setAttribute("value",n.list),t.append(i)}return this.datalist&&this.datalist.remove(),this.element.appendChild(this.datalist=t),this.searchbox.setAttribute("list",r),this}};var dJ=0,Gw=e=>$l(Ww,e),Ww=class extends mi{constructor({element:t,filterBy:r,as:n,min:i,max:o,step:s,from:a,column:c,label:l=c,value:u=n?.value,width:f}={}){if(super(r),this.id="slider_"+ ++dJ,this.from=a,this.column=c||"value",this.selection=n,this.min=i,this.max=o,this.step=s,this.element=t||document.createElement("div"),this.element.setAttribute("class","input"),this.element.value=this,l){let d=document.createElement("label");d.setAttribute("for",this.id),d.innerText=l,this.element.appendChild(d)}this.slider=document.createElement("input"),this.slider.setAttribute("id",this.id),this.slider.setAttribute("type","range"),f!=null&&(this.slider.style.width=`${+f}px`),i!=null&&this.slider.setAttribute("min",i),o!=null&&this.slider.setAttribute("max",o),s!=null&&this.slider.setAttribute("step",s),u!=null&&(this.slider.setAttribute("value",u),this.selection?.value===void 0&&this.publish(u)),this.element.appendChild(this.slider),this.selection&&(this.slider.addEventListener("input",()=>{this.publish(+this.slider.value)}),yo(this.selection)||this.selection.addEventListener("value",d=>{d!==+this.slider.value&&(this.slider.value=d)}))}query(t=[]){let{from:r,column:n}=this;return!r||this.min!=null&&this.max!=null?null:yt.select({min:ki(n),max:Ri(n)}).from(r).where(t)}queryResult(t){let{min:r,max:n}=Array.from(t)[0];return this.min==null&&this.slider.setAttribute("min",r),this.max==null&&this.slider.setAttribute("max",n),this.step==null&&this.slider.setAttribute("step",(n-r)/500),this}publish(t){let{selection:r,column:n}=this;yo(r)?r.update({source:this,schema:{type:"point"},value:t,predicate:Vs(n,po(t))}):yi(this.selection)&&r.update(t)}};function dh(e,t){if(e instanceof Date||(e=new Date(+e)),isNaN(e))return typeof t=="function"?t(e):t;let r=e.getUTCHours(),n=e.getUTCMinutes(),i=e.getUTCSeconds(),o=e.getUTCMilliseconds();return`${hJ(e.getUTCFullYear(),4)}-${Sc(e.getUTCMonth()+1,2)}-${Sc(e.getUTCDate(),2)}${r||n||i||o?`T${Sc(r,2)}:${Sc(n,2)}${i||o?`:${Sc(i,2)}${o?`.${Sc(o,3)}`:""}`:""}Z`:""}`}function hJ(e){return e<0?`-${Sc(-e,6)}`:e>9999?`+${Sc(e,6)}`:Sc(e,4)}function Sc(e,t){return`${e}`.padStart(t,"0")}var pJ=/^(?:[-+]\d{2})?\d{4}(?:-\d{2}(?:-\d{2})?)?(?:T\d{2}:\d{2}(?::\d{2}(?:\.\d{3})?)?(?:Z|[-+]\d{2}:?\d{2})?)?$/;function pf(e,t){return pJ.test(e+="")?new Date(e):typeof t=="function"?t(e):t}var BE=FE(e=>{let t=Xw(e);return r=>r==null?"":typeof r=="number"?t(r):r instanceof Date?OE(r):`${r}`}),Xw=FE(e=>t=>t===0?"0":t.toLocaleString(e)),UBt=BE(),PBt=Xw();function OE(e){return dh(e,"Invalid Date")}function FE(e){let t=FE,r;return(n="en")=>n===t?r:r=e(t=n)}var mJ=-1,Zw=e=>$l(Hw,e),Hw=class extends mi{constructor({element:t,filterBy:r,from:n,columns:i=["*"],align:o={},format:s,width:a,maxWidth:c,height:l=500,rowBatch:u=100}={}){super(r),this.id=`table-${++mJ}`,this.from=n,this.columns=i,this.format=s,this.align=o,this.widths=typeof a=="object"?a:{},this.offset=0,this.limit=+u,this.pending=!1,this.sortHeader=null,this.sortColumn=null,this.sortDesc=!1,this.element=t||document.createElement("div"),this.element.setAttribute("id",this.id),this.element.value=this,typeof a=="number"&&(this.element.style.width=`${a}px`),c&&(this.element.style.maxWidth=`${c}px`),this.element.style.maxHeight=`${l}px`,this.element.style.overflow="auto";let f=-1;this.element.addEventListener("scroll",d=>{let{pending:h,loaded:p}=this,{scrollHeight:m,scrollTop:g,clientHeight:y}=d.target,b=g<f;f=g,!(b||h||p)&&m-g<2*y&&(this.pending=!0,this.requestData(this.offset+this.limit))}),this.tbl=document.createElement("table"),this.element.appendChild(this.tbl),this.head=document.createElement("thead"),this.tbl.appendChild(this.head),this.body=document.createElement("tbody"),this.tbl.appendChild(this.body),this.style=document.createElement("style"),this.element.appendChild(this.style)}requestData(t=0){this.offset=t;let r=this.query(this.filterBy?.predicate(this));this.requestQuery(r),nn().prefetch(r.clone().offset(t+this.limit))}fields(){return this.columns.map(t=>Wu(this.from,t))}fieldInfo(t){this.schema=t;let r=this.head;r.innerHTML="";let n=document.createElement("tr");for(let{column:i}of t){let o=document.createElement("th");o.addEventListener("click",s=>this.sort(s,i)),o.appendChild(document.createElement("span")),o.appendChild(document.createTextNode(i)),n.appendChild(o)}return r.appendChild(n),this.formats=yJ(this.format,t),this.style.innerText=xJ(this.id,gJ(this.align,t),bJ(this.widths,t)),this}query(t=[]){let{from:r,limit:n,offset:i,schema:o,sortColumn:s,sortDesc:a}=this;return yt.from(r).select(o.map(c=>c.column)).where(t).orderby(s?a?aM(s):s:[]).limit(n).offset(i)}queryResult(t){return this.pending||(this.loaded=!1,this.body.replaceChildren()),this.data=t,this}update(){let{body:t,formats:r,data:n,schema:i,limit:o}=this,s=i.length,a=0;for(let c of n){++a;let l=document.createElement("tr");for(let u=0;u<s;++u){let f=c[i[u].column],d=document.createElement("td");d.innerText=f==null?"":r[u](f),l.appendChild(d)}t.appendChild(l)}return a<o&&(this.loaded=!0),this.pending=!1,this}sort(t,r){r===this.sortColumn?this.sortDesc=!this.sortDesc:(this.sortColumn=r,this.sortDesc=!1);let n=t.currentTarget,i=this.sortHeader;i===n&&t.metaKey?(i.firstChild.textContent="",this.sortHeader=null,this.sortColumn=null):(i&&(i.firstChild.textContent=""),this.sortHeader=n,n.firstChild.textContent=this.sortDesc?"\u25BE":"\u25B4"),this.requestData()}};function yJ(e={},t,r){return t.map(({column:n,type:i})=>{if(n in e)return e[n];switch(i){case"number":return Xw(r);case"date":return OE;default:return BE(r)}})}function gJ(e={},t){return t.map(({column:r,type:n})=>r in e?e[r]:n==="number"?"right":"left")}function bJ(e={},t){return t.map(({column:r})=>e[r])}function xJ(e,t,r){let n=[];return t.forEach((i,o)=>{let s=+r[o];if(i!=="left"||s){let a=i!=="left"?`text-align:${i};`:"",c=s?`width:${s}px;max-width:${s}px;`:"";n.push(`#${e} tr>:nth-child(${o+1}) {${a}${c}}`)}}),n.join(" ")}var mf=Symbol("Fixed"),bs=Symbol("Transient"),Kw=Symbol("Transform");var _J=["rectY-x","rectX-y","rect-x","rect-y"];function wJ(e,t){return _J.includes(`${t}-${e}`)}function wg(e,t={steps:25}){let r=(n,i)=>wJ(i,n.type)?{[`${i}1`]:NE(n,e,t),[`${i}2`]:NE(n,e,{...t,offset:1})}:{[i]:NE(n,e,t)};return r[Kw]=!0,r}function NE(e,t,r){return{column:t,label:t,get stats(){return["min","max"]},get columns(){return[t]},get basis(){return t},toString(){let{min:n,max:i}=e.stats[t],o=vJ(n,i,r),s=ae(t),a=o.min===0?s:`(${s} - ${o.min})`,c=`${(o.max-o.min)/o.steps}::DOUBLE`,l=r.offset?`${r.offset} + `:"";return`${n} + ${c} * (${l}FLOOR(${a} / ${c})::INTEGER)`}}}function vJ(e,t,r){let{steps:n=25,minstep:i=0,nice:o=!0}=r;if(o!==!1){let s=t-e,a=n,c=Math.LN10,l=Math.ceil(Math.log(a)/c),u=Math.max(i,Math.pow(10,Math.round(Math.log(s)/c)-l));for(;Math.ceil(s/u)>a;)u*=10;let f=[5,2],d;for(let m=0,g=f.length;m<g;++m)d=u/f[m],d>=i&&s/d<=a&&(u=d);d=Math.log(u);let h=d>=0?0:~~(-d/c)+1,p=Math.pow(10,-h-1);d=Math.floor(e/u+p)*u,e=e<d?d-u:d,t=Math.ceil(t/u)*u,n=Math.round((t-e)/u)}return{min:e,max:t,steps:n}}var IN={};Qr(IN,{align:()=>Z9,aspectRatio:()=>K9,attribute:()=>SN,attributes:()=>LT,axis:()=>Q9,colorClamp:()=>_j,colorDomain:()=>bj,colorInterpolate:()=>Sj,colorLabel:()=>Aj,colorNice:()=>wj,colorPivot:()=>Ij,colorRange:()=>xj,colorReverse:()=>Mj,colorScale:()=>gj,colorScheme:()=>vj,colorSymmetric:()=>Tj,colorTickFormat:()=>Bj,colorZero:()=>Ej,facetGrid:()=>mV,facetLabel:()=>yV,facetMargin:()=>uV,facetMarginBottom:()=>dV,facetMarginLeft:()=>hV,facetMarginRight:()=>pV,facetMarginTop:()=>fV,fxAlign:()=>IV,fxAriaDescription:()=>VV,fxAriaLabel:()=>zV,fxAxis:()=>EV,fxDomain:()=>gV,fxFontVariant:()=>$V,fxGrid:()=>RV,fxInset:()=>_V,fxInsetLeft:()=>wV,fxInsetRight:()=>vV,fxLabel:()=>CV,fxLabelAnchor:()=>UV,fxLabelOffset:()=>PV,fxLine:()=>kV,fxNice:()=>xV,fxPadding:()=>TV,fxPaddingInner:()=>AV,fxPaddingOuter:()=>MV,fxRange:()=>bV,fxReverse:()=>jV,fxRound:()=>SV,fxTickFormat:()=>DV,fxTickPadding:()=>NV,fxTickRotate:()=>LV,fxTickSize:()=>OV,fxTickSpacing:()=>FV,fxTicks:()=>BV,fyAlign:()=>KV,fyAriaDescription:()=>mj,fyAriaLabel:()=>pj,fyAxis:()=>ej,fyDomain:()=>qV,fyFontVariant:()=>hj,fyGrid:()=>cj,fyInset:()=>GV,fyInsetBottom:()=>HV,fyInsetTop:()=>XV,fyLabel:()=>uj,fyLabelAnchor:()=>fj,fyLabelOffset:()=>dj,fyLine:()=>lj,fyNice:()=>WV,fyPadding:()=>QV,fyPaddingInner:()=>JV,fyPaddingOuter:()=>tj,fyRange:()=>YV,fyReverse:()=>yj,fyRound:()=>ZV,fyTickFormat:()=>sj,fyTickPadding:()=>oj,fyTickRotate:()=>aj,fyTickSize:()=>nj,fyTickSpacing:()=>ij,fyTicks:()=>rj,grid:()=>tz,height:()=>q9,inset:()=>J9,label:()=>ez,lengthClamp:()=>Xj,lengthDomain:()=>Wj,lengthNice:()=>Hj,lengthRange:()=>Gj,lengthScale:()=>Yj,lengthZero:()=>Zj,margin:()=>Y9,marginBottom:()=>H9,marginLeft:()=>W9,marginRight:()=>G9,marginTop:()=>X9,margins:()=>$9,name:()=>U9,opacityClamp:()=>Dj,opacityDomain:()=>Fj,opacityLabel:()=>Rj,opacityNice:()=>Lj,opacityRange:()=>Nj,opacityReverse:()=>kj,opacityScale:()=>Oj,opacityTickFormat:()=>Uj,opacityZero:()=>Cj,padding:()=>rz,projectionClip:()=>aq,projectionDomain:()=>eq,projectionInset:()=>rq,projectionInsetBottom:()=>sq,projectionInsetLeft:()=>nq,projectionInsetRight:()=>iq,projectionInsetTop:()=>oq,projectionParallels:()=>Qj,projectionPrecision:()=>Jj,projectionRotate:()=>tq,projectionType:()=>Kj,rClamp:()=>Vj,rDomain:()=>$j,rNice:()=>jj,rRange:()=>zj,rScale:()=>Pj,rZero:()=>qj,round:()=>nz,style:()=>V9,width:()=>j9,xAlign:()=>hz,xAriaDescription:()=>Fz,xAriaLabel:()=>Oz,xAxis:()=>gz,xClamp:()=>fz,xDomain:()=>oz,xFontVariant:()=>Bz,xGrid:()=>Iz,xInset:()=>cz,xInsetLeft:()=>lz,xInsetRight:()=>uz,xLabel:()=>Az,xLabelAnchor:()=>Mz,xLabelOffset:()=>Ez,xLine:()=>Tz,xNice:()=>az,xPadding:()=>pz,xPaddingInner:()=>mz,xPaddingOuter:()=>yz,xRange:()=>sz,xReverse:()=>Nz,xRound:()=>dz,xScale:()=>iz,xTickFormat:()=>vz,xTickPadding:()=>wz,xTickRotate:()=>Sz,xTickSize:()=>xz,xTickSpacing:()=>_z,xTicks:()=>bz,xZero:()=>Dz,xyDomain:()=>z9,yAlign:()=>jz,yAriaDescription:()=>aV,yAriaLabel:()=>sV,yAxis:()=>Gz,yClamp:()=>zz,yDomain:()=>Rz,yFontVariant:()=>oV,yGrid:()=>tV,yInset:()=>Uz,yInsetBottom:()=>$z,yInsetTop:()=>Pz,yLabel:()=>rV,yLabelAnchor:()=>nV,yLabelOffset:()=>iV,yLine:()=>eV,yNice:()=>Cz,yPadding:()=>qz,yPaddingInner:()=>Yz,yPaddingOuter:()=>Wz,yRange:()=>kz,yReverse:()=>cV,yRound:()=>Vz,yScale:()=>Lz,yTickFormat:()=>Qz,yTickPadding:()=>Kz,yTickRotate:()=>Jz,yTickSize:()=>Hz,yTickSpacing:()=>Zz,yTicks:()=>Xz,yZero:()=>lV});var NT={};Qr(NT,{Area:()=>nd,Arrow:()=>Ob,BarX:()=>Fb,BarY:()=>Nb,Cell:()=>od,Contour:()=>Vb,Density:()=>Yb,Dot:()=>sd,Frame:()=>vb,Geo:()=>Wb,Hexgrid:()=>Gb,Image:()=>Xb,Line:()=>ad,Link:()=>Eb,Mark:()=>bt,Raster:()=>zb,Rect:()=>cd,RuleX:()=>bb,RuleY:()=>xb,Text:()=>td,TickX:()=>Ub,TickY:()=>Pb,Tip:()=>Sb,Vector:()=>rd,area:()=>J7,areaX:()=>Vp,areaY:()=>id,arrow:()=>e$,auto:()=>f$,autoSpec:()=>qF,axisFx:()=>KI,axisFy:()=>ZI,axisX:()=>wb,axisY:()=>_b,barX:()=>Hc,barY:()=>Zc,bin:()=>Xc,binX:()=>Ba,binY:()=>Oa,boxX:()=>d$,boxY:()=>h$,cell:()=>Db,cellX:()=>n$,cellY:()=>i$,centroid:()=>i9,circle:()=>a$,cluster:()=>n9,column:()=>Gr,contour:()=>v$,crosshair:()=>T$,crosshairX:()=>A$,crosshairY:()=>M$,delaunayLink:()=>O$,delaunayMesh:()=>F$,density:()=>k$,dodgeX:()=>b9,dodgeY:()=>x9,dot:()=>Lo,dotX:()=>o$,dotY:()=>s$,filter:()=>_5,formatIsoDate:()=>mb,formatMonth:()=>TP,formatWeekday:()=>AP,frame:()=>Dp,geo:()=>bT,geoCentroid:()=>o9,graticule:()=>U$,gridFx:()=>eT,gridFy:()=>JI,gridX:()=>tT,gridY:()=>QI,group:()=>lb,groupX:()=>mu,groupY:()=>yu,groupZ:()=>cb,hexagon:()=>c$,hexbin:()=>P$,hexgrid:()=>$$,hull:()=>N$,identity:()=>K,image:()=>V$,indexOf:()=>dr,initializer:()=>Qe,interpolateNearest:()=>KF,interpolateNone:()=>gT,interpolatorBarycentric:()=>ZF,interpolatorRandomWalk:()=>QF,legend:()=>YP,line:()=>Rb,lineX:()=>qp,lineY:()=>Yp,linearRegressionX:()=>Y$,linearRegressionY:()=>W$,link:()=>uT,map:()=>fd,mapX:()=>Xp,mapY:()=>Hp,marks:()=>ti,normalize:()=>MT,normalizeX:()=>S9,normalizeY:()=>I9,plot:()=>Tb,pointer:()=>Mp,pointerX:()=>Ep,pointerY:()=>Bp,raster:()=>b$,rect:()=>kb,rectX:()=>ld,rectY:()=>ud,reverse:()=>w5,ruleX:()=>eo,ruleY:()=>ro,scale:()=>Ma,select:()=>O9,selectFirst:()=>gN,selectLast:()=>bN,selectMaxX:()=>D9,selectMaxY:()=>L9,selectMinX:()=>F9,selectMinY:()=>N9,shuffle:()=>v5,sort:()=>mI,sphere:()=>C$,spike:()=>m7,stackX:()=>zF,stackX1:()=>Y7,stackX2:()=>W7,stackY:()=>VF,stackY1:()=>G7,stackY2:()=>X7,text:()=>Ea,textX:()=>jI,textY:()=>qI,tickX:()=>pT,tickY:()=>mT,tip:()=>nT,transform:()=>Xr,tree:()=>fN,treeLink:()=>ST,treeNode:()=>Hb,valueof:()=>gt,vector:()=>FF,vectorX:()=>GI,vectorY:()=>XI,voronoi:()=>D$,voronoiMesh:()=>L$,window:()=>FT,windowX:()=>T9,windowY:()=>A9});function be(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function To(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function yf(e){let t,r,n;e.length!==2?(t=be,r=(a,c)=>be(e(a),c),n=(a,c)=>e(a)-c):(t=e===be||e===To?e:SJ,r=e,n=e);function i(a,c,l=0,u=a.length){if(l<u){if(t(c,c)!==0)return u;do{let f=l+u>>>1;r(a[f],c)<0?l=f+1:u=f}while(l<u)}return l}function o(a,c,l=0,u=a.length){if(l<u){if(t(c,c)!==0)return u;do{let f=l+u>>>1;r(a[f],c)<=0?l=f+1:u=f}while(l<u)}return l}function s(a,c,l=0,u=a.length){let f=i(a,c,l,u-1);return f>l&&n(a[f-1],c)>-n(a[f],c)?f-1:f}return{left:i,center:s,right:o}}function SJ(){return 0}function vg(e){return e===null?NaN:+e}function*gR(e,t){if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(yield r);else{let r=-1;for(let n of e)(n=t(n,++r,e))!=null&&(n=+n)>=n&&(yield n)}}var bR=yf(be),xR=bR.right,IJ=bR.left,TJ=yf(vg).center,Ic=xR;var Sg=_R(wR),DE=_R(AJ);function _R(e){return function(t,r,n=r){if(!((r=+r)>=0))throw new RangeError("invalid rx");if(!((n=+n)>=0))throw new RangeError("invalid ry");let{data:i,width:o,height:s}=t;if(!((o=Math.floor(o))>=0))throw new RangeError("invalid width");if(!((s=Math.floor(s!==void 0?s:i.length/o))>=0))throw new RangeError("invalid height");if(!o||!s||!r&&!n)return t;let a=r&&e(r),c=n&&e(n),l=i.slice();return a&&c?(hh(a,l,i,o,s),hh(a,i,l,o,s),hh(a,l,i,o,s),ph(c,i,l,o,s),ph(c,l,i,o,s),ph(c,i,l,o,s)):a?(hh(a,i,l,o,s),hh(a,l,i,o,s),hh(a,i,l,o,s)):c&&(ph(c,i,l,o,s),ph(c,l,i,o,s),ph(c,i,l,o,s)),t}}function hh(e,t,r,n,i){for(let o=0,s=n*i;o<s;)e(t,r,o,o+=n,1)}function ph(e,t,r,n,i){for(let o=0,s=n*i;o<n;++o)e(t,r,o,o+s,n)}function AJ(e){let t=wR(e);return(r,n,i,o,s)=>{i<<=2,o<<=2,s<<=2,t(r,n,i+0,o+0,s),t(r,n,i+1,o+1,s),t(r,n,i+2,o+2,s),t(r,n,i+3,o+3,s)}}function wR(e){let t=Math.floor(e);if(t===e)return MJ(e);let r=e-t,n=2*e+1;return(i,o,s,a,c)=>{if(!((a-=c)>=s))return;let l=t*o[s],u=c*t,f=u+c;for(let d=s,h=s+u;d<h;d+=c)l+=o[Math.min(a,d)];for(let d=s,h=a;d<=h;d+=c)l+=o[Math.min(a,d+u)],i[d]=(l+r*(o[Math.max(s,d-f)]+o[Math.min(a,d+f)]))/n,l-=o[Math.max(s,d-u)]}}function MJ(e){let t=2*e+1;return(r,n,i,o,s)=>{if(!((o-=s)>=i))return;let a=e*n[i],c=s*e;for(let l=i,u=i+c;l<u;l+=s)a+=n[Math.min(o,l)];for(let l=i,u=o;l<=u;l+=s)a+=n[Math.min(o,l+c)],r[l]=a/t,a-=n[Math.max(i,l-c)]}}function ra(e,t){let r=0;if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&++r;else{let n=-1;for(let i of e)(i=t(i,++n,e))!=null&&(i=+i)>=i&&++r}return r}function EJ(e){return e.length|0}function BJ(e){return!(e>0)}function OJ(e){return typeof e!="object"||"length"in e?e:Array.from(e)}function FJ(e){return t=>e(...t)}function Qw(...e){let t=typeof e[e.length-1]=="function"&&FJ(e.pop());e=e.map(OJ);let r=e.map(EJ),n=e.length-1,i=new Array(n+1).fill(0),o=[];if(n<0||r.some(BJ))return o;for(;;){o.push(i.map((a,c)=>e[c][a]));let s=n;for(;++i[s]===r[s];){if(s===0)return t?o.map(t):o;i[s--]=0}}}function Jw(e,t){var r=0,n=0;return Float64Array.from(e,t===void 0?i=>r+=+i||0:i=>r+=+t(i,n++,e)||0)}function zl(e,t){let r=0,n,i=0,o=0;if(t===void 0)for(let s of e)s!=null&&(s=+s)>=s&&(n=s-i,i+=n/++r,o+=n*(s-i));else{let s=-1;for(let a of e)(a=t(a,++s,e))!=null&&(a=+a)>=a&&(n=a-i,i+=n/++r,o+=n*(a-i))}if(r>1)return o/(r-1)}function na(e,t){let r=zl(e,t);return r&&Math.sqrt(r)}function ze(e,t){let r,n;if(t===void 0)for(let i of e)i!=null&&(r===void 0?i>=i&&(r=n=i):(r>i&&(r=i),n<i&&(n=i)));else{let i=-1;for(let o of e)(o=t(o,++i,e))!=null&&(r===void 0?o>=o&&(r=n=o):(r>o&&(r=o),n<o&&(n=o)))}return[r,n]}var fn=class{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){let r=this._partials,n=0;for(let i=0;i<this._n&&i<32;i++){let o=r[i],s=t+o,a=Math.abs(t)<Math.abs(o)?t-(s-o):o-(s-t);a&&(r[n++]=a),t=s}return r[n]=t,this._n=n+1,this}valueOf(){let t=this._partials,r=this._n,n,i,o,s=0;if(r>0){for(s=t[--r];r>0&&(n=s,i=t[--r],s=n+i,o=i-(s-n),!o););r>0&&(o<0&&t[r-1]<0||o>0&&t[r-1]>0)&&(i=o*2,n=s+i,i==n-s&&(s=n))}return s}};var $n=class extends Map{constructor(t,r=IR){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(let[n,i]of t)this.set(n,i)}get(t){return super.get(LE(this,t))}has(t){return super.has(LE(this,t))}set(t,r){return super.set(vR(this,t),r)}delete(t){return super.delete(SR(this,t))}},xs=class extends Set{constructor(t,r=IR){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(let n of t)this.add(n)}has(t){return super.has(LE(this,t))}add(t){return super.add(vR(this,t))}delete(t){return super.delete(SR(this,t))}};function LE({_intern:e,_key:t},r){let n=t(r);return e.has(n)?e.get(n):r}function vR({_intern:e,_key:t},r){let n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function SR({_intern:e,_key:t},r){let n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function IR(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Ig(e){return e}function Vr(e,...t){return kE(e,Ig,Ig,t)}function _s(e,t,...r){return kE(e,Ig,t,r)}function RE(e,t,...r){return kE(e,Array.from,t,r)}function kE(e,t,r,n){return function i(o,s){if(s>=n.length)return r(o);let a=new $n,c=n[s++],l=-1;for(let u of o){let f=c(u,++l,o),d=a.get(f);d?d.push(u):a.set(f,[u])}for(let[u,f]of a)a.set(u,i(f,s));return t(a)}(e,0)}function CE(e,t){return Array.from(t,r=>e[r])}function ia(e,...t){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");e=Array.from(e);let[r]=t;if(r&&r.length!==2||t.length>1){let n=Uint32Array.from(e,(i,o)=>o);return t.length>1?(t=t.map(i=>e.map(i)),n.sort((i,o)=>{for(let s of t){let a=gf(s[i],s[o]);if(a)return a}})):(r=e.map(r),n.sort((i,o)=>gf(r[i],r[o]))),CE(e,n)}return e.sort(Tg(r))}function Tg(e=be){if(e===be)return gf;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{let n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function gf(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}function mh(e,t,r){return(t.length!==2?ia(_s(e,t,r),([n,i],[o,s])=>be(i,s)||be(n,o)):ia(Vr(e,r),([n,i],[o,s])=>t(i,s)||be(n,o))).map(([n])=>n)}var NJ=Math.sqrt(50),DJ=Math.sqrt(10),LJ=Math.sqrt(2);function tv(e,t,r){let n=(t-e)/Math.max(0,r),i=Math.floor(Math.log10(n)),o=n/Math.pow(10,i),s=o>=NJ?10:o>=DJ?5:o>=LJ?2:1,a,c,l;return i<0?(l=Math.pow(10,-i)/s,a=Math.round(e*l),c=Math.round(t*l),a/l<e&&++a,c/l>t&&--c,l=-l):(l=Math.pow(10,i)*s,a=Math.round(e/l),c=Math.round(t/l),a*l<e&&++a,c*l>t&&--c),c<a&&.5<=r&&r<2?tv(e,t,r*2):[a,c,l]}function dn(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];let n=t<e,[i,o,s]=n?tv(t,e,r):tv(e,t,r);if(!(o>=i))return[];let a=o-i+1,c=new Array(a);if(n)if(s<0)for(let l=0;l<a;++l)c[l]=(o-l)/-s;else for(let l=0;l<a;++l)c[l]=(o-l)*s;else if(s<0)for(let l=0;l<a;++l)c[l]=(i+l)/-s;else for(let l=0;l<a;++l)c[l]=(i+l)*s;return c}function Tc(e,t,r){return t=+t,e=+e,r=+r,tv(e,t,r)[2]}function yh(e,t,r){t=+t,e=+e,r=+r;let n=t<e,i=n?Tc(t,e,r):Tc(e,t,r);return(n?-1:1)*(i<0?1/-i:i)}function gh(e,t,r){let n;for(;;){let i=Tc(e,t,r);if(i===n||i===0||!isFinite(i))return[e,t];i>0?(e=Math.floor(e/i)*i,t=Math.ceil(t/i)*i):i<0&&(e=Math.ceil(e*i)/i,t=Math.floor(t*i)/i),n=i}}function Vl(e){return Math.max(1,Math.ceil(Math.log(ra(e))/Math.LN2)+1)}function ue(e,t){let r;if(t===void 0)for(let n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let i of e)(i=t(i,++n,e))!=null&&(r<i||r===void 0&&i>=i)&&(r=i)}return r}function ev(e,t){let r,n=-1,i=-1;if(t===void 0)for(let o of e)++i,o!=null&&(r<o||r===void 0&&o>=o)&&(r=o,n=i);else for(let o of e)(o=t(o,++i,e))!=null&&(r<o||r===void 0&&o>=o)&&(r=o,n=i);return n}function Te(e,t){let r;if(t===void 0)for(let n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let i of e)(i=t(i,++n,e))!=null&&(r>i||r===void 0&&i>=i)&&(r=i)}return r}function rv(e,t){let r,n=-1,i=-1;if(t===void 0)for(let o of e)++i,o!=null&&(r>o||r===void 0&&o>=o)&&(r=o,n=i);else for(let o of e)(o=t(o,++i,e))!=null&&(r>o||r===void 0&&o>=o)&&(r=o,n=i);return n}function nv(e,t,r=0,n=1/0,i){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(i=i===void 0?gf:Tg(i);n>r;){if(n-r>600){let c=n-r+1,l=t-r+1,u=Math.log(c),f=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*f*(c-f)/c)*(l-c/2<0?-1:1),h=Math.max(r,Math.floor(t-l*f/c+d)),p=Math.min(n,Math.floor(t+(c-l)*f/c+d));nv(e,t,h,p,i)}let o=e[t],s=r,a=n;for(Ag(e,r,t),i(e[n],o)>0&&Ag(e,r,n);s<a;){for(Ag(e,s,a),++s,--a;i(e[s],o)<0;)++s;for(;i(e[a],o)>0;)--a}i(e[r],o)===0?Ag(e,r,a):(++a,Ag(e,a,n)),a<=t&&(r=a+1),t<=a&&(n=a-1)}return e}function Ag(e,t,r){let n=e[t];e[t]=e[r],e[r]=n}function bf(e,t=be){let r,n=!1;if(t.length===1){let i;for(let o of e){let s=t(o);(n?be(s,i)>0:be(s,s)===0)&&(r=o,i=s,n=!0)}}else for(let i of e)(n?t(i,r)>0:t(i,i)===0)&&(r=i,n=!0);return r}function zn(e,t,r){if(e=Float64Array.from(gR(e,r)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return Te(e);if(t>=1)return ue(e);var n,i=(n-1)*t,o=Math.floor(i),s=ue(nv(e,o).subarray(0,o+1)),a=Te(e.subarray(o+1));return s+(a-s)*(i-o)}}function UE(e,t,r=vg){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,i=(n-1)*t,o=Math.floor(i),s=+r(e[o],o,e),a=+r(e[o+1],o+1,e);return s+(a-s)*(i-o)}}function iv(e,t,r){let n=ra(e),i=zn(e,.75)-zn(e,.25);return n&&i?Math.ceil((r-t)/(2*i*Math.pow(n,-1/3))):1}function Mg(e,t,r){let n=ra(e),i=na(e);return n&&i?Math.ceil((r-t)*Math.cbrt(n)/(3.49*i)):1}function xf(e,t){let r=0,n=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(++r,n+=i);else{let i=-1;for(let o of e)(o=t(o,++i,e))!=null&&(o=+o)>=o&&(++r,n+=o)}if(r)return n/r}function ws(e,t){return zn(e,.5,t)}function*kJ(e){for(let t of e)yield*t}function bh(e){return Array.from(kJ(e))}function xh(e,t){let r=new $n;if(t===void 0)for(let o of e)o!=null&&o>=o&&r.set(o,(r.get(o)||0)+1);else{let o=-1;for(let s of e)(s=t(s,++o,e))!=null&&s>=s&&r.set(s,(r.get(s)||0)+1)}let n,i=0;for(let[o,s]of r)s>i&&(i=s,n=o);return n}function xr(e,t,r){e=+e,t=+t,r=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((t-e)/r))|0,o=new Array(i);++n<i;)o[n]=e+n*r;return o}function Eg(e,t=be){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");let r=Array.from(e),n=new Float64Array(r.length);t.length!==2&&(r=r.map(t),t=be);let i=(a,c)=>t(r[a],r[c]),o,s;return e=Uint32Array.from(r,(a,c)=>c),e.sort(t===be?(a,c)=>gf(r[a],r[c]):Tg(i)),e.forEach((a,c)=>{let l=i(a,o===void 0?a:o);l>=0?((o===void 0||l>0)&&(o=a,s=c),n[a]=s):n[a]=NaN}),n}function ov(e,t=be){let r,n=!1;if(t.length===1){let i;for(let o of e){let s=t(o);(n?be(s,i)<0:be(s,s)===0)&&(r=o,i=s,n=!0)}}else for(let i of e)(n?t(i,r)<0:t(i,i)===0)&&(r=i,n=!0);return r}function hn(e,t){let r=0;if(t===void 0)for(let n of e)(n=+n)&&(r+=n);else{let n=-1;for(let i of e)(i=+t(i,++n,e))&&(r+=i)}return r}function jl(e){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");return Array.from(e).reverse()}function TR(e){return e}var PE=1,$E=2,zE=3,sv=4,AR=1e-6;function CJ(e){return"translate("+e+",0)"}function UJ(e){return"translate(0,"+e+")"}function PJ(e){return t=>+e(t)}function $J(e,t){return t=Math.max(0,e.bandwidth()-t*2)/2,e.round()&&(t=Math.round(t)),r=>+e(r)+t}function zJ(){return!this.__axis}function VJ(e,t){var r=[],n=null,i=null,o=6,s=6,a=3,c=typeof window<"u"&&window.devicePixelRatio>1?0:.5,l=e===PE||e===sv?-1:1,u=e===sv||e===$E?"x":"y",f=e===PE||e===zE?CJ:UJ;function d(h){var p=n??(t.ticks?t.ticks.apply(t,r):t.domain()),m=i??(t.tickFormat?t.tickFormat.apply(t,r):TR),g=Math.max(o,0)+a,y=t.range(),b=+y[0]+c,x=+y[y.length-1]+c,_=(t.bandwidth?$J:PJ)(t.copy(),c),w=h.selection?h.selection():h,v=w.selectAll(".domain").data([null]),A=w.selectAll(".tick").data(p,t).order(),B=A.exit(),D=A.enter().append("g").attr("class","tick"),T=A.select("line"),M=A.select("text");v=v.merge(v.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),A=A.merge(D),T=T.merge(D.append("line").attr("stroke","currentColor").attr(u+"2",l*o)),M=M.merge(D.append("text").attr("fill","currentColor").attr(u,l*g).attr("dy",e===PE?"0em":e===zE?"0.71em":"0.32em")),h!==w&&(v=v.transition(h),A=A.transition(h),T=T.transition(h),M=M.transition(h),B=B.transition(h).attr("opacity",AR).attr("transform",function(O){return isFinite(O=_(O))?f(O+c):this.getAttribute("transform")}),D.attr("opacity",AR).attr("transform",function(O){var L=this.parentNode.__axis;return f((L&&isFinite(L=L(O))?L:_(O))+c)})),B.remove(),v.attr("d",e===sv||e===$E?s?"M"+l*s+","+b+"H"+c+"V"+x+"H"+l*s:"M"+c+","+b+"V"+x:s?"M"+b+","+l*s+"V"+c+"H"+x+"V"+l*s:"M"+b+","+c+"H"+x),A.attr("opacity",1).attr("transform",function(O){return f(_(O)+c)}),T.attr(u+"2",l*o),M.attr(u,l*g).text(m),w.filter(zJ).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===$E?"start":e===sv?"end":"middle"),w.each(function(){this.__axis=_})}return d.scale=function(h){return arguments.length?(t=h,d):t},d.ticks=function(){return r=Array.from(arguments),d},d.tickArguments=function(h){return arguments.length?(r=h==null?[]:Array.from(h),d):r.slice()},d.tickValues=function(h){return arguments.length?(n=h==null?null:Array.from(h),d):n&&n.slice()},d.tickFormat=function(h){return arguments.length?(i=h,d):i},d.tickSize=function(h){return arguments.length?(o=s=+h,d):o},d.tickSizeInner=function(h){return arguments.length?(o=+h,d):o},d.tickSizeOuter=function(h){return arguments.length?(s=+h,d):s},d.tickPadding=function(h){return arguments.length?(a=+h,d):a},d.offset=function(h){return arguments.length?(c=+h,d):c},d}function VE(e){return VJ(zE,e)}var jJ={value:()=>{}};function ER(){for(var e=0,t=arguments.length,r={},n;e<t;++e){if(!(n=arguments[e]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new av(r)}function av(e){this._=e}function qJ(e,t){return e.trim().split(/^|\s+/).map(function(r){var n="",i=r.indexOf(".");if(i>=0&&(n=r.slice(i+1),r=r.slice(0,i)),r&&!t.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}av.prototype=ER.prototype={constructor:av,on:function(e,t){var r=this._,n=qJ(e+"",r),i,o=-1,s=n.length;if(arguments.length<2){for(;++o<s;)if((i=(e=n[o]).type)&&(i=YJ(r[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<s;)if(i=(e=n[o]).type)r[i]=MR(r[i],e.name,t);else if(t==null)for(i in r)r[i]=MR(r[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new av(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var r=new Array(i),n=0,i,o;n<i;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],n=0,i=o.length;n<i;++n)o[n].value.apply(t,r)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],i=0,o=n.length;i<o;++i)n[i].value.apply(t,r)}};function YJ(e,t){for(var r=0,n=e.length,i;r<n;++r)if((i=e[r]).name===t)return i.value}function MR(e,t,r){for(var n=0,i=e.length;n<i;++n)if(e[n].name===t){e[n]=jJ,e=e.slice(0,n).concat(e.slice(n+1));break}return r!=null&&e.push({name:t,value:r}),e}var _f=ER;var cv="http://www.w3.org/1999/xhtml",Ao={svg:"http://www.w3.org/2000/svg",xhtml:cv,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Ac(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),Ao.hasOwnProperty(t)?{space:Ao[t],local:e}:e}function WJ(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===cv&&t.documentElement.namespaceURI===cv?t.createElement(e):t.createElementNS(r,e)}}function GJ(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Mc(e){var t=Ac(e);return(t.local?GJ:WJ)(t)}function XJ(){}function wf(e){return e==null?XJ:function(){return this.querySelector(e)}}function BR(e){typeof e!="function"&&(e=wf(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var o=t[i],s=o.length,a=n[i]=new Array(s),c,l,u=0;u<s;++u)(c=o[u])&&(l=e.call(c,c.__data__,u,o))&&("__data__"in c&&(l.__data__=c.__data__),a[u]=l);return new lr(n,this._parents)}function jE(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function HJ(){return[]}function Bg(e){return e==null?HJ:function(){return this.querySelectorAll(e)}}function ZJ(e){return function(){return jE(e.apply(this,arguments))}}function OR(e){typeof e=="function"?e=ZJ(e):e=Bg(e);for(var t=this._groups,r=t.length,n=[],i=[],o=0;o<r;++o)for(var s=t[o],a=s.length,c,l=0;l<a;++l)(c=s[l])&&(n.push(e.call(c,c.__data__,l,s)),i.push(c));return new lr(n,i)}function Og(e){return function(){return this.matches(e)}}function lv(e){return function(t){return t.matches(e)}}var KJ=Array.prototype.find;function QJ(e){return function(){return KJ.call(this.children,e)}}function JJ(){return this.firstElementChild}function FR(e){return this.select(e==null?JJ:QJ(typeof e=="function"?e:lv(e)))}var ttt=Array.prototype.filter;function ett(){return Array.from(this.children)}function rtt(e){return function(){return ttt.call(this.children,e)}}function NR(e){return this.selectAll(e==null?ett:rtt(typeof e=="function"?e:lv(e)))}function DR(e){typeof e!="function"&&(e=Og(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var o=t[i],s=o.length,a=n[i]=[],c,l=0;l<s;++l)(c=o[l])&&e.call(c,c.__data__,l,o)&&a.push(c);return new lr(n,this._parents)}function uv(e){return new Array(e.length)}function LR(){return new lr(this._enter||this._groups.map(uv),this._parents)}function Fg(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Fg.prototype={constructor:Fg,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function RR(e){return function(){return e}}function ntt(e,t,r,n,i,o){for(var s=0,a,c=t.length,l=o.length;s<l;++s)(a=t[s])?(a.__data__=o[s],n[s]=a):r[s]=new Fg(e,o[s]);for(;s<c;++s)(a=t[s])&&(i[s]=a)}function itt(e,t,r,n,i,o,s){var a,c,l=new Map,u=t.length,f=o.length,d=new Array(u),h;for(a=0;a<u;++a)(c=t[a])&&(d[a]=h=s.call(c,c.__data__,a,t)+"",l.has(h)?i[a]=c:l.set(h,c));for(a=0;a<f;++a)h=s.call(e,o[a],a,o)+"",(c=l.get(h))?(n[a]=c,c.__data__=o[a],l.delete(h)):r[a]=new Fg(e,o[a]);for(a=0;a<u;++a)(c=t[a])&&l.get(d[a])===c&&(i[a]=c)}function ott(e){return e.__data__}function kR(e,t){if(!arguments.length)return Array.from(this,ott);var r=t?itt:ntt,n=this._parents,i=this._groups;typeof e!="function"&&(e=RR(e));for(var o=i.length,s=new Array(o),a=new Array(o),c=new Array(o),l=0;l<o;++l){var u=n[l],f=i[l],d=f.length,h=stt(e.call(u,u&&u.__data__,l,n)),p=h.length,m=a[l]=new Array(p),g=s[l]=new Array(p),y=c[l]=new Array(d);r(u,f,m,g,y,h,t);for(var b=0,x=0,_,w;b<p;++b)if(_=m[b]){for(b>=x&&(x=b+1);!(w=g[x])&&++x<p;);_._next=w||null}}return s=new lr(s,n),s._enter=a,s._exit=c,s}function stt(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function CR(){return new lr(this._exit||this._groups.map(uv),this._parents)}function UR(e,t,r){var n=this.enter(),i=this,o=this.exit();return typeof e=="function"?(n=e(n),n&&(n=n.selection())):n=n.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),r==null?o.remove():r(o),n&&i?n.merge(i).order():i}function PR(e){for(var t=e.selection?e.selection():e,r=this._groups,n=t._groups,i=r.length,o=n.length,s=Math.min(i,o),a=new Array(i),c=0;c<s;++c)for(var l=r[c],u=n[c],f=l.length,d=a[c]=new Array(f),h,p=0;p<f;++p)(h=l[p]||u[p])&&(d[p]=h);for(;c<i;++c)a[c]=r[c];return new lr(a,this._parents)}function $R(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var n=e[t],i=n.length-1,o=n[i],s;--i>=0;)(s=n[i])&&(o&&s.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(s,o),o=s);return this}function zR(e){e||(e=att);function t(f,d){return f&&d?e(f.__data__,d.__data__):!f-!d}for(var r=this._groups,n=r.length,i=new Array(n),o=0;o<n;++o){for(var s=r[o],a=s.length,c=i[o]=new Array(a),l,u=0;u<a;++u)(l=s[u])&&(c[u]=l);c.sort(t)}return new lr(i,this._parents).order()}function att(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function VR(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function jR(){return Array.from(this)}function qR(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],i=0,o=n.length;i<o;++i){var s=n[i];if(s)return s}return null}function YR(){let e=0;for(let t of this)++e;return e}function WR(){return!this.node()}function GR(e){for(var t=this._groups,r=0,n=t.length;r<n;++r)for(var i=t[r],o=0,s=i.length,a;o<s;++o)(a=i[o])&&e.call(a,a.__data__,o,i);return this}function ctt(e){return function(){this.removeAttribute(e)}}function ltt(e){return function(){this.removeAttributeNS(e.space,e.local)}}function utt(e,t){return function(){this.setAttribute(e,t)}}function ftt(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function dtt(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function htt(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function XR(e,t){var r=Ac(e);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((t==null?r.local?ltt:ctt:typeof t=="function"?r.local?htt:dtt:r.local?ftt:utt)(r,t))}function fv(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function ptt(e){return function(){this.style.removeProperty(e)}}function mtt(e,t,r){return function(){this.style.setProperty(e,t,r)}}function ytt(e,t,r){return function(){var n=t.apply(this,arguments);n==null?this.style.removeProperty(e):this.style.setProperty(e,n,r)}}function HR(e,t,r){return arguments.length>1?this.each((t==null?ptt:typeof t=="function"?ytt:mtt)(e,t,r??"")):ql(this.node(),e)}function ql(e,t){return e.style.getPropertyValue(t)||fv(e).getComputedStyle(e,null).getPropertyValue(t)}function gtt(e){return function(){delete this[e]}}function btt(e,t){return function(){this[e]=t}}function xtt(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function ZR(e,t){return arguments.length>1?this.each((t==null?gtt:typeof t=="function"?xtt:btt)(e,t)):this.node()[e]}function KR(e){return e.trim().split(/^|\s+/)}function qE(e){return e.classList||new QR(e)}function QR(e){this._node=e,this._names=KR(e.getAttribute("class")||"")}QR.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function JR(e,t){for(var r=qE(e),n=-1,i=t.length;++n<i;)r.add(t[n])}function t8(e,t){for(var r=qE(e),n=-1,i=t.length;++n<i;)r.remove(t[n])}function _tt(e){return function(){JR(this,e)}}function wtt(e){return function(){t8(this,e)}}function vtt(e,t){return function(){(t.apply(this,arguments)?JR:t8)(this,e)}}function e8(e,t){var r=KR(e+"");if(arguments.length<2){for(var n=qE(this.node()),i=-1,o=r.length;++i<o;)if(!n.contains(r[i]))return!1;return!0}return this.each((typeof t=="function"?vtt:t?_tt:wtt)(r,t))}function Stt(){this.textContent=""}function Itt(e){return function(){this.textContent=e}}function Ttt(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function r8(e){return arguments.length?this.each(e==null?Stt:(typeof e=="function"?Ttt:Itt)(e)):this.node().textContent}function Att(){this.innerHTML=""}function Mtt(e){return function(){this.innerHTML=e}}function Ett(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function n8(e){return arguments.length?this.each(e==null?Att:(typeof e=="function"?Ett:Mtt)(e)):this.node().innerHTML}function Btt(){this.nextSibling&&this.parentNode.appendChild(this)}function i8(){return this.each(Btt)}function Ott(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function o8(){return this.each(Ott)}function s8(e){var t=typeof e=="function"?e:Mc(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Ftt(){return null}function a8(e,t){var r=typeof e=="function"?e:Mc(e),n=t==null?Ftt:typeof t=="function"?t:wf(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function Ntt(){var e=this.parentNode;e&&e.removeChild(this)}function c8(){return this.each(Ntt)}function Dtt(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Ltt(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function l8(e){return this.select(e?Ltt:Dtt)}function u8(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Rtt(e){return function(t){e.call(this,t,this.__data__)}}function ktt(e){return e.trim().split(/^|\s+/).map(function(t){var r="",n=t.indexOf(".");return n>=0&&(r=t.slice(n+1),t=t.slice(0,n)),{type:t,name:r}})}function Ctt(e){return function(){var t=this.__on;if(t){for(var r=0,n=-1,i=t.length,o;r<i;++r)o=t[r],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++n]=o;++n?t.length=n:delete this.__on}}}function Utt(e,t,r){return function(){var n=this.__on,i,o=Rtt(t);if(n){for(var s=0,a=n.length;s<a;++s)if((i=n[s]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=r),i.value=t;return}}this.addEventListener(e.type,o,r),i={type:e.type,name:e.name,value:t,listener:o,options:r},n?n.push(i):this.__on=[i]}}function f8(e,t,r){var n=ktt(e+""),i,o=n.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,l=a.length,u;c<l;++c)for(i=0,u=a[c];i<o;++i)if((s=n[i]).type===u.type&&s.name===u.name)return u.value}return}for(a=t?Utt:Ctt,i=0;i<o;++i)this.each(a(n[i],t,r));return this}function d8(e,t,r){var n=fv(e),i=n.CustomEvent;typeof i=="function"?i=new i(t,r):(i=n.document.createEvent("Event"),r?(i.initEvent(t,r.bubbles,r.cancelable),i.detail=r.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function Ptt(e,t){return function(){return d8(this,e,t)}}function $tt(e,t){return function(){return d8(this,e,t.apply(this,arguments))}}function h8(e,t){return this.each((typeof t=="function"?$tt:Ptt)(e,t))}function*p8(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],i=0,o=n.length,s;i<o;++i)(s=n[i])&&(yield s)}var YE=[null];function lr(e,t){this._groups=e,this._parents=t}function m8(){return new lr([[document.documentElement]],YE)}function ztt(){return this}lr.prototype=m8.prototype={constructor:lr,select:BR,selectAll:OR,selectChild:FR,selectChildren:NR,filter:DR,data:kR,enter:LR,exit:CR,join:UR,merge:PR,selection:ztt,order:$R,sort:zR,call:VR,nodes:jR,node:qR,size:YR,empty:WR,each:GR,attr:XR,style:HR,property:ZR,classed:e8,text:r8,html:n8,raise:i8,lower:o8,append:s8,insert:a8,remove:c8,clone:l8,datum:u8,on:f8,dispatch:h8,[Symbol.iterator]:p8};var Ec=m8;function ne(e){return typeof e=="string"?new lr([[document.querySelector(e)]],[document.documentElement]):new lr([[e]],YE)}function y8(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Sn(e,t){if(e=y8(e),t===void 0&&(t=e.currentTarget),t){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var n=r.createSVGPoint();return n.x=e.clientX,n.y=e.clientY,n=n.matrixTransform(t.getScreenCTM().inverse()),[n.x,n.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}var dv={capture:!0,passive:!1};function hv(e){e.preventDefault(),e.stopImmediatePropagation()}function Ng(e){var t=e.document.documentElement,r=ne(e).on("dragstart.drag",hv,dv);"onselectstart"in t?r.on("selectstart.drag",hv,dv):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Dg(e,t){var r=e.document.documentElement,n=ne(e).on("dragstart.drag",null);t&&(n.on("click.drag",hv,dv),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in r?n.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}function Bc(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function Yl(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function sa(){}var Wl=.7,If=1/Wl,_h="\\s*([+-]?\\d+)\\s*",Lg="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",oa="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Vtt=/^#([0-9a-f]{3,8})$/,jtt=new RegExp(`^rgb\\(${_h},${_h},${_h}\\)$`),qtt=new RegExp(`^rgb\\(${oa},${oa},${oa}\\)$`),Ytt=new RegExp(`^rgba\\(${_h},${_h},${_h},${Lg}\\)$`),Wtt=new RegExp(`^rgba\\(${oa},${oa},${oa},${Lg}\\)$`),Gtt=new RegExp(`^hsl\\(${Lg},${oa},${oa}\\)$`),Xtt=new RegExp(`^hsla\\(${Lg},${oa},${oa},${Lg}\\)$`),g8={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Bc(sa,Vn,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:b8,formatHex:b8,formatHex8:Htt,formatHsl:Ztt,formatRgb:x8,toString:x8});function b8(){return this.rgb().formatHex()}function Htt(){return this.rgb().formatHex8()}function Ztt(){return T8(this).formatHsl()}function x8(){return this.rgb().formatRgb()}function Vn(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=Vtt.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?_8(t):r===3?new Tr(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?pv(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?pv(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=jtt.exec(e))?new Tr(t[1],t[2],t[3],1):(t=qtt.exec(e))?new Tr(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Ytt.exec(e))?pv(t[1],t[2],t[3],t[4]):(t=Wtt.exec(e))?pv(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Gtt.exec(e))?S8(t[1],t[2]/100,t[3]/100,1):(t=Xtt.exec(e))?S8(t[1],t[2]/100,t[3]/100,t[4]):g8.hasOwnProperty(e)?_8(g8[e]):e==="transparent"?new Tr(NaN,NaN,NaN,0):null}function _8(e){return new Tr(e>>16&255,e>>8&255,e&255,1)}function pv(e,t,r,n){return n<=0&&(e=t=r=NaN),new Tr(e,t,r,n)}function Rg(e){return e instanceof sa||(e=Vn(e)),e?(e=e.rgb(),new Tr(e.r,e.g,e.b,e.opacity)):new Tr}function jr(e,t,r,n){return arguments.length===1?Rg(e):new Tr(e,t,r,n??1)}function Tr(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}Bc(Tr,jr,Yl(sa,{brighter(e){return e=e==null?If:Math.pow(If,e),new Tr(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Wl:Math.pow(Wl,e),new Tr(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Tr(Sf(this.r),Sf(this.g),Sf(this.b),yv(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:w8,formatHex:w8,formatHex8:Ktt,formatRgb:v8,toString:v8}));function w8(){return`#${vf(this.r)}${vf(this.g)}${vf(this.b)}`}function Ktt(){return`#${vf(this.r)}${vf(this.g)}${vf(this.b)}${vf((isNaN(this.opacity)?1:this.opacity)*255)}`}function v8(){let e=yv(this.opacity);return`${e===1?"rgb(":"rgba("}${Sf(this.r)}, ${Sf(this.g)}, ${Sf(this.b)}${e===1?")":`, ${e})`}`}function yv(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Sf(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function vf(e){return e=Sf(e),(e<16?"0":"")+e.toString(16)}function S8(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new vs(e,t,r,n)}function T8(e){if(e instanceof vs)return new vs(e.h,e.s,e.l,e.opacity);if(e instanceof sa||(e=Vn(e)),!e)return new vs;if(e instanceof vs)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),o=Math.max(t,r,n),s=NaN,a=o-i,c=(o+i)/2;return a?(t===o?s=(r-n)/a+(r<n)*6:r===o?s=(n-t)/a+2:s=(t-r)/a+4,a/=c<.5?o+i:2-o-i,s*=60):a=c>0&&c<1?0:s,new vs(s,a,c,e.opacity)}function kg(e,t,r,n){return arguments.length===1?T8(e):new vs(e,t,r,n??1)}function vs(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}Bc(vs,kg,Yl(sa,{brighter(e){return e=e==null?If:Math.pow(If,e),new vs(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Wl:Math.pow(Wl,e),new vs(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new Tr(WE(e>=240?e-240:e+120,i,n),WE(e,i,n),WE(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new vs(I8(this.h),mv(this.s),mv(this.l),yv(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=yv(this.opacity);return`${e===1?"hsl(":"hsla("}${I8(this.h)}, ${mv(this.s)*100}%, ${mv(this.l)*100}%${e===1?")":`, ${e})`}`}}));function I8(e){return e=(e||0)%360,e<0?e+360:e}function mv(e){return Math.max(0,Math.min(1,e||0))}function WE(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}var gv=Math.PI/180,bv=180/Math.PI;var xv=18,A8=.96422,M8=1,E8=.82521,B8=4/29,wh=6/29,O8=3*wh*wh,Qtt=wh*wh*wh;function F8(e){if(e instanceof aa)return new aa(e.l,e.a,e.b,e.opacity);if(e instanceof Oc)return N8(e);e instanceof Tr||(e=Rg(e));var t=ZE(e.r),r=ZE(e.g),n=ZE(e.b),i=GE((.2225045*t+.7168786*r+.0606169*n)/M8),o,s;return t===r&&r===n?o=s=i:(o=GE((.4360747*t+.3850649*r+.1430804*n)/A8),s=GE((.0139322*t+.0971045*r+.7141733*n)/E8)),new aa(116*i-16,500*(o-i),200*(i-s),e.opacity)}function vh(e,t,r,n){return arguments.length===1?F8(e):new aa(e,t,r,n??1)}function aa(e,t,r,n){this.l=+e,this.a=+t,this.b=+r,this.opacity=+n}Bc(aa,vh,Yl(sa,{brighter(e){return new aa(this.l+xv*(e??1),this.a,this.b,this.opacity)},darker(e){return new aa(this.l-xv*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,r=isNaN(this.b)?e:e-this.b/200;return t=A8*XE(t),e=M8*XE(e),r=E8*XE(r),new Tr(HE(3.1338561*t-1.6168667*e-.4906146*r),HE(-.9787684*t+1.9161415*e+.033454*r),HE(.0719453*t-.2289914*e+1.4052427*r),this.opacity)}}));function GE(e){return e>Qtt?Math.pow(e,1/3):e/O8+B8}function XE(e){return e>wh?e*e*e:O8*(e-B8)}function HE(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function ZE(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Jtt(e){if(e instanceof Oc)return new Oc(e.h,e.c,e.l,e.opacity);if(e instanceof aa||(e=F8(e)),e.a===0&&e.b===0)return new Oc(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*bv;return new Oc(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function Cg(e,t,r,n){return arguments.length===1?Jtt(e):new Oc(e,t,r,n??1)}function Oc(e,t,r,n){this.h=+e,this.c=+t,this.l=+r,this.opacity=+n}function N8(e){if(isNaN(e.h))return new aa(e.l,0,0,e.opacity);var t=e.h*gv;return new aa(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Bc(Oc,Cg,Yl(sa,{brighter(e){return new Oc(this.h,this.c,this.l+xv*(e??1),this.opacity)},darker(e){return new Oc(this.h,this.c,this.l-xv*(e??1),this.opacity)},rgb(){return N8(this).rgb()}}));var k8=-.14861,KE=1.78277,QE=-.29227,_v=-.90649,Ug=1.97294,D8=Ug*_v,L8=Ug*KE,R8=KE*QE-_v*k8;function tet(e){if(e instanceof Tf)return new Tf(e.h,e.s,e.l,e.opacity);e instanceof Tr||(e=Rg(e));var t=e.r/255,r=e.g/255,n=e.b/255,i=(R8*n+D8*t-L8*r)/(R8+D8-L8),o=n-i,s=(Ug*(r-i)-QE*o)/_v,a=Math.sqrt(s*s+o*o)/(Ug*i*(1-i)),c=a?Math.atan2(s,o)*bv-120:NaN;return new Tf(c<0?c+360:c,a,i,e.opacity)}function jn(e,t,r,n){return arguments.length===1?tet(e):new Tf(e,t,r,n??1)}function Tf(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}Bc(Tf,jn,Yl(sa,{brighter(e){return e=e==null?If:Math.pow(If,e),new Tf(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Wl:Math.pow(Wl,e),new Tf(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*gv,t=+this.l,r=isNaN(this.s)?0:this.s*t*(1-t),n=Math.cos(e),i=Math.sin(e);return new Tr(255*(t+r*(k8*n+KE*i)),255*(t+r*(QE*n+_v*i)),255*(t+r*(Ug*n)),this.opacity)}}));function JE(e,t,r,n,i){var o=e*e,s=o*e;return((1-3*e+3*o-s)*t+(4-6*o+3*s)*r+(1+3*e+3*o-3*s)*n+s*i)/6}function C8(e){var t=e.length-1;return function(r){var n=r<=0?r=0:r>=1?(r=1,t-1):Math.floor(r*t),i=e[n],o=e[n+1],s=n>0?e[n-1]:2*i-o,a=n<t-1?e[n+2]:2*o-i;return JE((r-n/t)*t,s,i,o,a)}}function U8(e){var t=e.length;return function(r){var n=Math.floor(((r%=1)<0?++r:r)*t),i=e[(n+t-1)%t],o=e[n%t],s=e[(n+1)%t],a=e[(n+2)%t];return JE((r-n/t)*t,i,o,s,a)}}var Sh=e=>()=>e;function P8(e,t){return function(r){return e+r*t}}function eet(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function Ih(e,t){var r=t-e;return r?P8(e,r>180||r<-180?r-360*Math.round(r/360):r):Sh(isNaN(e)?t:e)}function $8(e){return(e=+e)==1?Ze:function(t,r){return r-t?eet(t,r,e):Sh(isNaN(t)?r:t)}}function Ze(e,t){var r=t-e;return r?P8(e,r):Sh(isNaN(e)?t:e)}var Mo=function e(t){var r=$8(t);function n(i,o){var s=r((i=jr(i)).r,(o=jr(o)).r),a=r(i.g,o.g),c=r(i.b,o.b),l=Ze(i.opacity,o.opacity);return function(u){return i.r=s(u),i.g=a(u),i.b=c(u),i.opacity=l(u),i+""}}return n.gamma=e,n}(1);function z8(e){return function(t){var r=t.length,n=new Array(r),i=new Array(r),o=new Array(r),s,a;for(s=0;s<r;++s)a=jr(t[s]),n[s]=a.r||0,i[s]=a.g||0,o[s]=a.b||0;return n=e(n),i=e(i),o=e(o),a.opacity=1,function(c){return a.r=n(c),a.g=i(c),a.b=o(c),a+""}}}var tB=z8(C8),ret=z8(U8);function V8(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),i;return function(o){for(i=0;i<r;++i)n[i]=e[i]*(1-o)+t[i]*o;return n}}function j8(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function q8(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,i=new Array(n),o=new Array(r),s;for(s=0;s<n;++s)i[s]=qi(e[s],t[s]);for(;s<r;++s)o[s]=t[s];return function(a){for(s=0;s<n;++s)o[s]=i[s](a);return o}}function Y8(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Ge(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function W8(e,t){var r={},n={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?r[i]=qi(e[i],t[i]):n[i]=t[i];return function(o){for(i in r)n[i]=r[i](o);return n}}var rB=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,eB=new RegExp(rB.source,"g");function net(e){return function(){return e}}function iet(e){return function(t){return e(t)+""}}function Pg(e,t){var r=rB.lastIndex=eB.lastIndex=0,n,i,o,s=-1,a=[],c=[];for(e=e+"",t=t+"";(n=rB.exec(e))&&(i=eB.exec(t));)(o=i.index)>r&&(o=t.slice(r,o),a[s]?a[s]+=o:a[++s]=o),(n=n[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,c.push({i:s,x:Ge(n,i)})),r=eB.lastIndex;return r<t.length&&(o=t.slice(r),a[s]?a[s]+=o:a[++s]=o),a.length<2?c[0]?iet(c[0].x):net(t):(t=c.length,function(l){for(var u=0,f;u<t;++u)a[(f=c[u]).i]=f.x(l);return a.join("")})}function qi(e,t){var r=typeof t,n;return t==null||r==="boolean"?Sh(t):(r==="number"?Ge:r==="string"?(n=Vn(t))?(t=n,Mo):Pg:t instanceof Vn?Mo:t instanceof Date?Y8:j8(t)?V8:Array.isArray(t)?q8:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?W8:Ge)(e,t)}function Af(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}var G8=180/Math.PI,wv={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function nB(e,t,r,n,i,o){var s,a,c;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(c=e*r+t*n)&&(r-=e*c,n-=t*c),(a=Math.sqrt(r*r+n*n))&&(r/=a,n/=a,c/=a),e*n<t*r&&(e=-e,t=-t,c=-c,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*G8,skewX:Math.atan(c)*G8,scaleX:s,scaleY:a}}var vv;function X8(e){let t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?wv:nB(t.a,t.b,t.c,t.d,t.e,t.f)}function H8(e){return e==null?wv:(vv||(vv=document.createElementNS("http://www.w3.org/2000/svg","g")),vv.setAttribute("transform",e),(e=vv.transform.baseVal.consolidate())?(e=e.matrix,nB(e.a,e.b,e.c,e.d,e.e,e.f)):wv)}function Z8(e,t,r,n){function i(l){return l.length?l.pop()+" ":""}function o(l,u,f,d,h,p){if(l!==f||u!==d){var m=h.push("translate(",null,t,null,r);p.push({i:m-4,x:Ge(l,f)},{i:m-2,x:Ge(u,d)})}else(f||d)&&h.push("translate("+f+t+d+r)}function s(l,u,f,d){l!==u?(l-u>180?u+=360:u-l>180&&(l+=360),d.push({i:f.push(i(f)+"rotate(",null,n)-2,x:Ge(l,u)})):u&&f.push(i(f)+"rotate("+u+n)}function a(l,u,f,d){l!==u?d.push({i:f.push(i(f)+"skewX(",null,n)-2,x:Ge(l,u)}):u&&f.push(i(f)+"skewX("+u+n)}function c(l,u,f,d,h,p){if(l!==f||u!==d){var m=h.push(i(h)+"scale(",null,",",null,")");p.push({i:m-4,x:Ge(l,f)},{i:m-2,x:Ge(u,d)})}else(f!==1||d!==1)&&h.push(i(h)+"scale("+f+","+d+")")}return function(l,u){var f=[],d=[];return l=e(l),u=e(u),o(l.translateX,l.translateY,u.translateX,u.translateY,f,d),s(l.rotate,u.rotate,f,d),a(l.skewX,u.skewX,f,d),c(l.scaleX,l.scaleY,u.scaleX,u.scaleY,f,d),l=u=null,function(h){for(var p=-1,m=d.length,g;++p<m;)f[(g=d[p]).i]=g.x(h);return f.join("")}}}var iB=Z8(X8,"px, ","px)","deg)"),oB=Z8(H8,", ",")",")");var oet=1e-12;function K8(e){return((e=Math.exp(e))+1/e)/2}function set(e){return((e=Math.exp(e))-1/e)/2}function aet(e){return((e=Math.exp(2*e))-1)/(e+1)}var sB=function e(t,r,n){function i(o,s){var a=o[0],c=o[1],l=o[2],u=s[0],f=s[1],d=s[2],h=u-a,p=f-c,m=h*h+p*p,g,y;if(m<oet)y=Math.log(d/l)/t,g=function(A){return[a+A*h,c+A*p,l*Math.exp(t*A*y)]};else{var b=Math.sqrt(m),x=(d*d-l*l+n*m)/(2*l*r*b),_=(d*d-l*l-n*m)/(2*d*r*b),w=Math.log(Math.sqrt(x*x+1)-x),v=Math.log(Math.sqrt(_*_+1)-_);y=(v-w)/t,g=function(A){var B=A*y,D=K8(w),T=l/(r*b)*(D*aet(t*B+w)-set(w));return[a+T*h,c+T*p,l*D/K8(t*B+w)]}}return g.duration=y*1e3*t/Math.SQRT2,g}return i.rho=function(o){var s=Math.max(.001,+o),a=s*s,c=a*a;return e(s,a,c)},i}(Math.SQRT2,2,4);function Q8(e){return function(t,r){var n=e((t=kg(t)).h,(r=kg(r)).h),i=Ze(t.s,r.s),o=Ze(t.l,r.l),s=Ze(t.opacity,r.opacity);return function(a){return t.h=n(a),t.s=i(a),t.l=o(a),t.opacity=s(a),t+""}}}var aB=Q8(Ih),cet=Q8(Ze);function Sv(e,t){var r=Ze((e=vh(e)).l,(t=vh(t)).l),n=Ze(e.a,t.a),i=Ze(e.b,t.b),o=Ze(e.opacity,t.opacity);return function(s){return e.l=r(s),e.a=n(s),e.b=i(s),e.opacity=o(s),e+""}}function J8(e){return function(t,r){var n=e((t=Cg(t)).h,(r=Cg(r)).h),i=Ze(t.c,r.c),o=Ze(t.l,r.l),s=Ze(t.opacity,r.opacity);return function(a){return t.h=n(a),t.c=i(a),t.l=o(a),t.opacity=s(a),t+""}}}var cB=J8(Ih),uet=J8(Ze);function tk(e){return function t(r){r=+r;function n(i,o){var s=e((i=jn(i)).h,(o=jn(o)).h),a=Ze(i.s,o.s),c=Ze(i.l,o.l),l=Ze(i.opacity,o.opacity);return function(u){return i.h=s(u),i.s=a(u),i.l=c(Math.pow(u,r)),i.opacity=l(u),i+""}}return n.gamma=t,n}(1)}var fet=tk(Ih),Th=tk(Ze);function Gl(e,t){t===void 0&&(t=e,e=qi);for(var r=0,n=t.length-1,i=t[0],o=new Array(n<0?0:n);r<n;)o[r]=e(i,i=t[++r]);return function(s){var a=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return o[a](s-a)}}function In(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e(n/(t-1));return r}var Ah=0,zg=0,$g=0,rk=1e3,Iv,Vg,Tv=0,Mf=0,Av=0,jg=typeof performance=="object"&&performance.now?performance:Date,nk=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Yg(){return Mf||(nk(det),Mf=jg.now()+Av)}function det(){Mf=0}function qg(){this._call=this._time=this._next=null}qg.prototype=Mv.prototype={constructor:qg,restart:function(e,t,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?Yg():+r)+(t==null?0:+t),!this._next&&Vg!==this&&(Vg?Vg._next=this:Iv=this,Vg=this),this._call=e,this._time=r,lB()},stop:function(){this._call&&(this._call=null,this._time=1/0,lB())}};function Mv(e,t,r){var n=new qg;return n.restart(e,t,r),n}function ik(){Yg(),++Ah;for(var e=Iv,t;e;)(t=Mf-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Ah}function ek(){Mf=(Tv=jg.now())+Av,Ah=zg=0;try{ik()}finally{Ah=0,pet(),Mf=0}}function het(){var e=jg.now(),t=e-Tv;t>rk&&(Av-=t,Tv=e)}function pet(){for(var e,t=Iv,r,n=1/0;t;)t._call?(n>t._time&&(n=t._time),e=t,t=t._next):(r=t._next,t._next=null,t=e?e._next=r:Iv=r);Vg=e,lB(n)}function lB(e){if(!Ah){zg&&(zg=clearTimeout(zg));var t=e-Mf;t>24?(e<1/0&&(zg=setTimeout(ek,e-jg.now()-Av)),$g&&($g=clearInterval($g))):($g||(Tv=jg.now(),$g=setInterval(het,rk)),Ah=1,nk(ek))}}function Ev(e,t,r){var n=new qg;return t=t==null?0:+t,n.restart(i=>{n.stop(),e(i+t)},t,r),n}var met=_f("start","end","cancel","interrupt"),yet=[],ak=0,ok=1,Ov=2,Bv=3,sk=4,Fv=5,Wg=6;function Xl(e,t,r,n,i,o){var s=e.__transition;if(!s)e.__transition={};else if(r in s)return;get(e,r,{name:t,index:n,group:i,on:met,tween:yet,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:ak})}function Gg(e,t){var r=kr(e,t);if(r.state>ak)throw new Error("too late; already scheduled");return r}function pn(e,t){var r=kr(e,t);if(r.state>Bv)throw new Error("too late; already running");return r}function kr(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function get(e,t,r){var n=e.__transition,i;n[t]=r,r.timer=Mv(o,0,r.time);function o(l){r.state=ok,r.timer.restart(s,r.delay,r.time),r.delay<=l&&s(l-r.delay)}function s(l){var u,f,d,h;if(r.state!==ok)return c();for(u in n)if(h=n[u],h.name===r.name){if(h.state===Bv)return Ev(s);h.state===sk?(h.state=Wg,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete n[u]):+u<t&&(h.state=Wg,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete n[u])}if(Ev(function(){r.state===Bv&&(r.state=sk,r.timer.restart(a,r.delay,r.time),a(l))}),r.state=Ov,r.on.call("start",e,e.__data__,r.index,r.group),r.state===Ov){for(r.state=Bv,i=new Array(d=r.tween.length),u=0,f=-1;u<d;++u)(h=r.tween[u].value.call(e,e.__data__,r.index,r.group))&&(i[++f]=h);i.length=f+1}}function a(l){for(var u=l<r.duration?r.ease.call(null,l/r.duration):(r.timer.restart(c),r.state=Fv,1),f=-1,d=i.length;++f<d;)i[f].call(e,u);r.state===Fv&&(r.on.call("end",e,e.__data__,r.index,r.group),c())}function c(){r.state=Wg,r.timer.stop(),delete n[t];for(var l in n)return;delete e.__transition}}function ca(e,t){var r=e.__transition,n,i,o=!0,s;if(r){t=t==null?null:t+"";for(s in r){if((n=r[s]).name!==t){o=!1;continue}i=n.state>Ov&&n.state<Fv,n.state=Wg,n.timer.stop(),n.on.call(i?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete r[s]}o&&delete e.__transition}}function ck(e){return this.each(function(){ca(this,e)})}function bet(e,t){var r,n;return function(){var i=pn(this,e),o=i.tween;if(o!==r){n=r=o;for(var s=0,a=n.length;s<a;++s)if(n[s].name===t){n=n.slice(),n.splice(s,1);break}}i.tween=n}}function xet(e,t,r){var n,i;if(typeof r!="function")throw new Error;return function(){var o=pn(this,e),s=o.tween;if(s!==n){i=(n=s).slice();for(var a={name:t,value:r},c=0,l=i.length;c<l;++c)if(i[c].name===t){i[c]=a;break}c===l&&i.push(a)}o.tween=i}}function lk(e,t){var r=this._id;if(e+="",arguments.length<2){for(var n=kr(this.node(),r).tween,i=0,o=n.length,s;i<o;++i)if((s=n[i]).name===e)return s.value;return null}return this.each((t==null?bet:xet)(r,e,t))}function Mh(e,t,r){var n=e._id;return e.each(function(){var i=pn(this,n);(i.value||(i.value={}))[t]=r.apply(this,arguments)}),function(i){return kr(i,n).value[t]}}function Nv(e,t){var r;return(typeof t=="number"?Ge:t instanceof Vn?Mo:(r=Vn(t))?(t=r,Mo):Pg)(e,t)}function _et(e){return function(){this.removeAttribute(e)}}function wet(e){return function(){this.removeAttributeNS(e.space,e.local)}}function vet(e,t,r){var n,i=r+"",o;return function(){var s=this.getAttribute(e);return s===i?null:s===n?o:o=t(n=s,r)}}function Iet(e,t,r){var n,i=r+"",o;return function(){var s=this.getAttributeNS(e.space,e.local);return s===i?null:s===n?o:o=t(n=s,r)}}function Tet(e,t,r){var n,i,o;return function(){var s,a=r(this),c;return a==null?void this.removeAttribute(e):(s=this.getAttribute(e),c=a+"",s===c?null:s===n&&c===i?o:(i=c,o=t(n=s,a)))}}function Aet(e,t,r){var n,i,o;return function(){var s,a=r(this),c;return a==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),c=a+"",s===c?null:s===n&&c===i?o:(i=c,o=t(n=s,a)))}}function uk(e,t){var r=Ac(e),n=r==="transform"?oB:Nv;return this.attrTween(e,typeof t=="function"?(r.local?Aet:Tet)(r,n,Mh(this,"attr."+e,t)):t==null?(r.local?wet:_et)(r):(r.local?Iet:vet)(r,n,t))}function Met(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}function Eet(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}function Bet(e,t){var r,n;function i(){var o=t.apply(this,arguments);return o!==n&&(r=(n=o)&&Eet(e,o)),r}return i._value=t,i}function Oet(e,t){var r,n;function i(){var o=t.apply(this,arguments);return o!==n&&(r=(n=o)&&Met(e,o)),r}return i._value=t,i}function fk(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;var n=Ac(e);return this.tween(r,(n.local?Bet:Oet)(n,t))}function Fet(e,t){return function(){Gg(this,e).delay=+t.apply(this,arguments)}}function Net(e,t){return t=+t,function(){Gg(this,e).delay=t}}function dk(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Fet:Net)(t,e)):kr(this.node(),t).delay}function Det(e,t){return function(){pn(this,e).duration=+t.apply(this,arguments)}}function Let(e,t){return t=+t,function(){pn(this,e).duration=t}}function hk(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Det:Let)(t,e)):kr(this.node(),t).duration}function Ret(e,t){if(typeof t!="function")throw new Error;return function(){pn(this,e).ease=t}}function pk(e){var t=this._id;return arguments.length?this.each(Ret(t,e)):kr(this.node(),t).ease}function ket(e,t){return function(){var r=t.apply(this,arguments);if(typeof r!="function")throw new Error;pn(this,e).ease=r}}function mk(e){if(typeof e!="function")throw new Error;return this.each(ket(this._id,e))}function yk(e){typeof e!="function"&&(e=Og(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var o=t[i],s=o.length,a=n[i]=[],c,l=0;l<s;++l)(c=o[l])&&e.call(c,c.__data__,l,o)&&a.push(c);return new qn(n,this._parents,this._name,this._id)}function gk(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,n=t.length,i=r.length,o=Math.min(n,i),s=new Array(n),a=0;a<o;++a)for(var c=t[a],l=r[a],u=c.length,f=s[a]=new Array(u),d,h=0;h<u;++h)(d=c[h]||l[h])&&(f[h]=d);for(;a<n;++a)s[a]=t[a];return new qn(s,this._parents,this._name,this._id)}function Cet(e){return(e+"").trim().split(/^|\s+/).every(function(t){var r=t.indexOf(".");return r>=0&&(t=t.slice(0,r)),!t||t==="start"})}function Uet(e,t,r){var n,i,o=Cet(t)?Gg:pn;return function(){var s=o(this,e),a=s.on;a!==n&&(i=(n=a).copy()).on(t,r),s.on=i}}function bk(e,t){var r=this._id;return arguments.length<2?kr(this.node(),r).on.on(e):this.each(Uet(r,e,t))}function Pet(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}function xk(){return this.on("end.remove",Pet(this._id))}function _k(e){var t=this._name,r=this._id;typeof e!="function"&&(e=wf(e));for(var n=this._groups,i=n.length,o=new Array(i),s=0;s<i;++s)for(var a=n[s],c=a.length,l=o[s]=new Array(c),u,f,d=0;d<c;++d)(u=a[d])&&(f=e.call(u,u.__data__,d,a))&&("__data__"in u&&(f.__data__=u.__data__),l[d]=f,Xl(l[d],t,r,d,l,kr(u,r)));return new qn(o,this._parents,t,r)}function wk(e){var t=this._name,r=this._id;typeof e!="function"&&(e=Bg(e));for(var n=this._groups,i=n.length,o=[],s=[],a=0;a<i;++a)for(var c=n[a],l=c.length,u,f=0;f<l;++f)if(u=c[f]){for(var d=e.call(u,u.__data__,f,c),h,p=kr(u,r),m=0,g=d.length;m<g;++m)(h=d[m])&&Xl(h,t,r,m,d,p);o.push(d),s.push(u)}return new qn(o,s,t,r)}var $et=Ec.prototype.constructor;function vk(){return new $et(this._groups,this._parents)}function zet(e,t){var r,n,i;return function(){var o=ql(this,e),s=(this.style.removeProperty(e),ql(this,e));return o===s?null:o===r&&s===n?i:i=t(r=o,n=s)}}function Sk(e){return function(){this.style.removeProperty(e)}}function Vet(e,t,r){var n,i=r+"",o;return function(){var s=ql(this,e);return s===i?null:s===n?o:o=t(n=s,r)}}function jet(e,t,r){var n,i,o;return function(){var s=ql(this,e),a=r(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(e),ql(this,e))),s===c?null:s===n&&c===i?o:(i=c,o=t(n=s,a))}}function qet(e,t){var r,n,i,o="style."+t,s="end."+o,a;return function(){var c=pn(this,e),l=c.on,u=c.value[o]==null?a||(a=Sk(t)):void 0;(l!==r||i!==u)&&(n=(r=l).copy()).on(s,i=u),c.on=n}}function Ik(e,t,r){var n=(e+="")=="transform"?iB:Nv;return t==null?this.styleTween(e,zet(e,n)).on("end.style."+e,Sk(e)):typeof t=="function"?this.styleTween(e,jet(e,n,Mh(this,"style."+e,t))).each(qet(this._id,e)):this.styleTween(e,Vet(e,n,t),r).on("end.style."+e,null)}function Yet(e,t,r){return function(n){this.style.setProperty(e,t.call(this,n),r)}}function Wet(e,t,r){var n,i;function o(){var s=t.apply(this,arguments);return s!==i&&(n=(i=s)&&Yet(e,s,r)),n}return o._value=t,o}function Tk(e,t,r){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,Wet(e,t,r??""))}function Get(e){return function(){this.textContent=e}}function Xet(e){return function(){var t=e(this);this.textContent=t??""}}function Ak(e){return this.tween("text",typeof e=="function"?Xet(Mh(this,"text",e)):Get(e==null?"":e+""))}function Het(e){return function(t){this.textContent=e.call(this,t)}}function Zet(e){var t,r;function n(){var i=e.apply(this,arguments);return i!==r&&(t=(r=i)&&Het(i)),t}return n._value=e,n}function Mk(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Zet(e))}function Ek(){for(var e=this._name,t=this._id,r=Dv(),n=this._groups,i=n.length,o=0;o<i;++o)for(var s=n[o],a=s.length,c,l=0;l<a;++l)if(c=s[l]){var u=kr(c,t);Xl(c,e,r,l,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new qn(n,this._parents,e,r)}function Bk(){var e,t,r=this,n=r._id,i=r.size();return new Promise(function(o,s){var a={value:s},c={value:function(){--i===0&&o()}};r.each(function(){var l=pn(this,n),u=l.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(c)),l.on=t}),i===0&&o()})}var Ket=0;function qn(e,t,r,n){this._groups=e,this._parents=t,this._name=r,this._id=n}function Ok(e){return Ec().transition(e)}function Dv(){return++Ket}var Fc=Ec.prototype;qn.prototype=Ok.prototype={constructor:qn,select:_k,selectAll:wk,selectChild:Fc.selectChild,selectChildren:Fc.selectChildren,filter:yk,merge:gk,selection:vk,transition:Ek,call:Fc.call,nodes:Fc.nodes,node:Fc.node,size:Fc.size,empty:Fc.empty,each:Fc.each,on:bk,attr:uk,attrTween:fk,style:Ik,styleTween:Tk,text:Ak,textTween:Mk,remove:xk,tween:lk,delay:dk,duration:hk,ease:pk,easeVarying:mk,end:Bk,[Symbol.iterator]:Fc[Symbol.iterator]};function Lv(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Qet={time:null,delay:0,duration:250,ease:Lv};function Jet(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}function Fk(e){var t,r;e instanceof qn?(t=e._id,e=e._name):(t=Dv(),(r=Qet).time=Yg(),e=e==null?null:e+"");for(var n=this._groups,i=n.length,o=0;o<i;++o)for(var s=n[o],a=s.length,c,l=0;l<a;++l)(c=s[l])&&Xl(c,e,t,l,s,r||Jet(c,t));return new qn(n,this._parents,e,t)}Ec.prototype.interrupt=ck;Ec.prototype.transition=Fk;var Rv=e=>()=>e;function uB(e,{sourceEvent:t,target:r,selection:n,mode:i,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},selection:{value:n,enumerable:!0,configurable:!0},mode:{value:i,enumerable:!0,configurable:!0},_:{value:o}})}function Nk(e){e.stopImmediatePropagation()}function kv(e){e.preventDefault(),e.stopImmediatePropagation()}var Dk={name:"drag"},fB={name:"space"},Eh={name:"handle"},Bh={name:"center"},{abs:Lk,max:Tn,min:An}=Math;function Rk(e){return[+e[0],+e[1]]}function hB(e){return[Rk(e[0]),Rk(e[1])]}var Cv={name:"x",handles:["w","e"].map(Xg),input:function(e,t){return e==null?null:[[+e[0],t[0][1]],[+e[1],t[1][1]]]},output:function(e){return e&&[e[0][0],e[1][0]]}},Uv={name:"y",handles:["n","s"].map(Xg),input:function(e,t){return e==null?null:[[t[0][0],+e[0]],[t[1][0],+e[1]]]},output:function(e){return e&&[e[0][1],e[1][1]]}},trt={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(Xg),input:function(e){return e==null?null:hB(e)},output:function(e){return e}},Nc={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},kk={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},Ck={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},ert={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},rrt={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function Xg(e){return{type:e}}function nrt(e){return!e.ctrlKey&&!e.button}function irt(){var e=this.ownerSVGElement||this;return e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]}function ort(){return navigator.maxTouchPoints||"ontouchstart"in this}function dB(e){for(;!e.__brush;)if(!(e=e.parentNode))return;return e.__brush}function srt(e){return e[0][0]===e[1][0]||e[0][1]===e[1][1]}function pB(){return gB(Cv)}function mB(){return gB(Uv)}function yB(){return gB(trt)}function gB(e){var t=irt,r=nrt,n=ort,i=!0,o=_f("start","brush","end"),s=6,a;function c(g){var y=g.property("__brush",m).selectAll(".overlay").data([Xg("overlay")]);y.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",Nc.overlay).merge(y).each(function(){var x=dB(this).extent;ne(this).attr("x",x[0][0]).attr("y",x[0][1]).attr("width",x[1][0]-x[0][0]).attr("height",x[1][1]-x[0][1])}),g.selectAll(".selection").data([Xg("selection")]).enter().append("rect").attr("class","selection").attr("cursor",Nc.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var b=g.selectAll(".handle").data(e.handles,function(x){return x.type});b.exit().remove(),b.enter().append("rect").attr("class",function(x){return"handle handle--"+x.type}).attr("cursor",function(x){return Nc[x.type]}),g.each(l).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",d).filter(n).on("touchstart.brush",d).on("touchmove.brush",h).on("touchend.brush touchcancel.brush",p).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}c.move=function(g,y,b){g.tween?g.on("start.brush",function(x){u(this,arguments).beforestart().start(x)}).on("interrupt.brush end.brush",function(x){u(this,arguments).end(x)}).tween("brush",function(){var x=this,_=x.__brush,w=u(x,arguments),v=_.selection,A=e.input(typeof y=="function"?y.apply(this,arguments):y,_.extent),B=qi(v,A);function D(T){_.selection=T===1&&A===null?null:B(T),l.call(x),w.brush()}return v!==null&&A!==null?D:D(1)}):g.each(function(){var x=this,_=arguments,w=x.__brush,v=e.input(typeof y=="function"?y.apply(x,_):y,w.extent),A=u(x,_).beforestart();ca(x),w.selection=v===null?null:v,l.call(x),A.start(b).brush(b).end(b)})},c.clear=function(g,y){c.move(g,null,y)};function l(){var g=ne(this),y=dB(this).selection;y?(g.selectAll(".selection").style("display",null).attr("x",y[0][0]).attr("y",y[0][1]).attr("width",y[1][0]-y[0][0]).attr("height",y[1][1]-y[0][1]),g.selectAll(".handle").style("display",null).attr("x",function(b){return b.type[b.type.length-1]==="e"?y[1][0]-s/2:y[0][0]-s/2}).attr("y",function(b){return b.type[0]==="s"?y[1][1]-s/2:y[0][1]-s/2}).attr("width",function(b){return b.type==="n"||b.type==="s"?y[1][0]-y[0][0]+s:s}).attr("height",function(b){return b.type==="e"||b.type==="w"?y[1][1]-y[0][1]+s:s})):g.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function u(g,y,b){var x=g.__brush.emitter;return x&&(!b||!x.clean)?x:new f(g,y,b)}function f(g,y,b){this.that=g,this.args=y,this.state=g.__brush,this.active=0,this.clean=b}f.prototype={beforestart:function(){return++this.active===1&&(this.state.emitter=this,this.starting=!0),this},start:function(g,y){return this.starting?(this.starting=!1,this.emit("start",g,y)):this.emit("brush",g),this},brush:function(g,y){return this.emit("brush",g,y),this},end:function(g,y){return--this.active===0&&(delete this.state.emitter,this.emit("end",g,y)),this},emit:function(g,y,b){var x=ne(this.that).datum();o.call(g,this.that,new uB(g,{sourceEvent:y,target:c,selection:e.output(this.state.selection),mode:b,dispatch:o}),x)}};function d(g){if(a&&!g.touches||!r.apply(this,arguments))return;var y=this,b=g.target.__data__.type,x=(i&&g.metaKey?b="overlay":b)==="selection"?Dk:i&&g.altKey?Bh:Eh,_=e===Uv?null:ert[b],w=e===Cv?null:rrt[b],v=dB(y),A=v.extent,B=v.selection,D=A[0][0],T,M,O=A[0][1],L,S,E=A[1][0],I,F,C=A[1][1],U,$,q=0,j=0,rt,ot=_&&w&&i&&g.shiftKey,Gt,at,Q=Array.from(g.touches||[g],st=>{let Le=st.identifier;return st=Sn(st,y),st.point0=st.slice(),st.identifier=Le,st});ca(y);var Z=u(y,arguments,!0).beforestart();if(b==="overlay"){B&&(rt=!0);let st=[Q[0],Q[1]||Q[0]];v.selection=B=[[T=e===Uv?D:An(st[0][0],st[1][0]),L=e===Cv?O:An(st[0][1],st[1][1])],[I=e===Uv?E:Tn(st[0][0],st[1][0]),U=e===Cv?C:Tn(st[0][1],st[1][1])]],Q.length>1&&ut(g)}else T=B[0][0],L=B[0][1],I=B[1][0],U=B[1][1];M=T,S=L,F=I,$=U;var V=ne(y).attr("pointer-events","none"),H=V.selectAll(".overlay").attr("cursor",Nc[b]);if(g.touches)Z.moved=z,Z.ended=Lt;else{var tt=ne(g.view).on("mousemove.brush",z,!0).on("mouseup.brush",Lt,!0);i&&tt.on("keydown.brush",Ie,!0).on("keyup.brush",le,!0),Ng(g.view)}l.call(y),Z.start(g,x.name);function z(st){for(let Le of st.changedTouches||[st])for(let Es of Q)Es.identifier===Le.identifier&&(Es.cur=Sn(Le,y));if(ot&&!Gt&&!at&&Q.length===1){let Le=Q[0];Lk(Le.cur[0]-Le[0])>Lk(Le.cur[1]-Le[1])?at=!0:Gt=!0}for(let Le of Q)Le.cur&&(Le[0]=Le.cur[0],Le[1]=Le.cur[1]);rt=!0,kv(st),ut(st)}function ut(st){let Le=Q[0],Es=Le.point0;var Ti;switch(q=Le[0]-Es[0],j=Le[1]-Es[1],x){case fB:case Dk:{_&&(q=Tn(D-T,An(E-I,q)),M=T+q,F=I+q),w&&(j=Tn(O-L,An(C-U,j)),S=L+j,$=U+j);break}case Eh:{Q[1]?(_&&(M=Tn(D,An(E,Q[0][0])),F=Tn(D,An(E,Q[1][0])),_=1),w&&(S=Tn(O,An(C,Q[0][1])),$=Tn(O,An(C,Q[1][1])),w=1)):(_<0?(q=Tn(D-T,An(E-T,q)),M=T+q,F=I):_>0&&(q=Tn(D-I,An(E-I,q)),M=T,F=I+q),w<0?(j=Tn(O-L,An(C-L,j)),S=L+j,$=U):w>0&&(j=Tn(O-U,An(C-U,j)),S=L,$=U+j));break}case Bh:{_&&(M=Tn(D,An(E,T-q*_)),F=Tn(D,An(E,I+q*_))),w&&(S=Tn(O,An(C,L-j*w)),$=Tn(O,An(C,U+j*w)));break}}F<M&&(_*=-1,Ti=T,T=I,I=Ti,Ti=M,M=F,F=Ti,b in kk&&H.attr("cursor",Nc[b=kk[b]])),$<S&&(w*=-1,Ti=L,L=U,U=Ti,Ti=S,S=$,$=Ti,b in Ck&&H.attr("cursor",Nc[b=Ck[b]])),v.selection&&(B=v.selection),Gt&&(M=B[0][0],F=B[1][0]),at&&(S=B[0][1],$=B[1][1]),(B[0][0]!==M||B[0][1]!==S||B[1][0]!==F||B[1][1]!==$)&&(v.selection=[[M,S],[F,$]],l.call(y),Z.brush(st,x.name))}function Lt(st){if(Nk(st),st.touches){if(st.touches.length)return;a&&clearTimeout(a),a=setTimeout(function(){a=null},500)}else Dg(st.view,rt),tt.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);V.attr("pointer-events","all"),H.attr("cursor",Nc.overlay),v.selection&&(B=v.selection),srt(B)&&(v.selection=null,l.call(y)),Z.end(st,x.name)}function Ie(st){switch(st.keyCode){case 16:{ot=_&&w;break}case 18:{x===Eh&&(_&&(I=F-q*_,T=M+q*_),w&&(U=$-j*w,L=S+j*w),x=Bh,ut(st));break}case 32:{(x===Eh||x===Bh)&&(_<0?I=F-q:_>0&&(T=M-q),w<0?U=$-j:w>0&&(L=S-j),x=fB,H.attr("cursor",Nc.selection),ut(st));break}default:return}kv(st)}function le(st){switch(st.keyCode){case 16:{ot&&(Gt=at=ot=!1,ut(st));break}case 18:{x===Bh&&(_<0?I=F:_>0&&(T=M),w<0?U=$:w>0&&(L=S),x=Eh,ut(st));break}case 32:{x===fB&&(st.altKey?(_&&(I=F-q*_,T=M+q*_),w&&(U=$-j*w,L=S+j*w),x=Bh):(_<0?I=F:_>0&&(T=M),w<0?U=$:w>0&&(L=S),x=Eh),H.attr("cursor",Nc[b]),ut(st));break}default:return}kv(st)}}function h(g){u(this,arguments).moved(g)}function p(g){u(this,arguments).ended(g)}function m(){var g=this.__brush||{selection:null};return g.extent=hB(t.apply(this,arguments)),g.dim=e,g}return c.extent=function(g){return arguments.length?(t=typeof g=="function"?g:Rv(hB(g)),c):t},c.filter=function(g){return arguments.length?(r=typeof g=="function"?g:Rv(!!g),c):r},c.touchable=function(g){return arguments.length?(n=typeof g=="function"?g:Rv(!!g),c):n},c.handleSize=function(g){return arguments.length?(s=+g,c):s},c.keyModifiers=function(g){return arguments.length?(i=!!g,c):i},c.on=function(){var g=o.on.apply(o,arguments);return g===o?c:g},c}var bB=Math.PI,xB=2*bB,Ef=1e-6,art=xB-Ef;function Uk(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function crt(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Uk;let r=10**t;return function(n){this._+=n[0];for(let i=1,o=n.length;i<o;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}var Hl=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Uk:crt(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,i){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(t,r,n,i,o,s){this._append`C${+t},${+r},${+n},${+i},${this._x1=+o},${this._y1=+s}`}arcTo(t,r,n,i,o){if(t=+t,r=+r,n=+n,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let s=this._x1,a=this._y1,c=n-t,l=i-r,u=s-t,f=a-r,d=u*u+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(d>Ef)if(!(Math.abs(f*c-l*u)>Ef)||!o)this._append`L${this._x1=t},${this._y1=r}`;else{let h=n-s,p=i-a,m=c*c+l*l,g=h*h+p*p,y=Math.sqrt(m),b=Math.sqrt(d),x=o*Math.tan((bB-Math.acos((m+d-g)/(2*y*b)))/2),_=x/b,w=x/y;Math.abs(_-1)>Ef&&this._append`L${t+_*u},${r+_*f}`,this._append`A${o},${o},0,0,${+(f*h>u*p)},${this._x1=t+w*c},${this._y1=r+w*l}`}}arc(t,r,n,i,o,s){if(t=+t,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let a=n*Math.cos(i),c=n*Math.sin(i),l=t+a,u=r+c,f=1^s,d=s?i-o:o-i;this._x1===null?this._append`M${l},${u}`:(Math.abs(this._x1-l)>Ef||Math.abs(this._y1-u)>Ef)&&this._append`L${l},${u}`,n&&(d<0&&(d=d%xB+xB),d>art?this._append`A${n},${n},0,1,${f},${t-a},${r-c}A${n},${n},0,1,${f},${this._x1=l},${this._y1=u}`:d>Ef&&this._append`A${n},${n},0,${+(d>=bB)},${f},${this._x1=t+n*Math.cos(o)},${this._y1=r+n*Math.sin(o)}`)}rect(t,r,n,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}};function Pk(){return new Hl}Pk.prototype=Hl.prototype;function Yn(e=3){return new Hl(+e)}var lrt=Array.prototype,Pv=lrt.slice;function $k(e,t){return e-t}function zk(e){for(var t=0,r=e.length,n=e[r-1][1]*e[0][0]-e[r-1][0]*e[0][1];++t<r;)n+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return n}var la=e=>()=>e;function Vk(e,t){for(var r=-1,n=t.length,i;++r<n;)if(i=urt(e,t[r]))return i;return 0}function urt(e,t){for(var r=t[0],n=t[1],i=-1,o=0,s=e.length,a=s-1;o<s;a=o++){var c=e[o],l=c[0],u=c[1],f=e[a],d=f[0],h=f[1];if(frt(c,f,t))return 0;u>n!=h>n&&r<(d-l)*(n-u)/(h-u)+l&&(i=-i)}return i}function frt(e,t,r){var n;return drt(e,t,r)&&hrt(e[n=+(e[0]===t[0])],r[n],t[n])}function drt(e,t,r){return(t[0]-e[0])*(r[1]-e[1])===(r[0]-e[0])*(t[1]-e[1])}function hrt(e,t,r){return e<=t&&t<=r||r<=t&&t<=e}function jk(){}var Dc=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function Zl(){var e=1,t=1,r=Vl,n=c;function i(l){var u=r(l);if(Array.isArray(u))u=u.slice().sort($k);else{let f=ze(l,prt);for(u=dn(...gh(f[0],f[1],u),u);u[u.length-1]>=f[1];)u.pop();for(;u[1]<f[0];)u.shift()}return u.map(f=>o(l,f))}function o(l,u){let f=u==null?NaN:+u;if(isNaN(f))throw new Error(`invalid value: ${u}`);var d=[],h=[];return s(l,f,function(p){n(p,l,f),zk(p)>0?d.push([p]):h.push(p)}),h.forEach(function(p){for(var m=0,g=d.length,y;m<g;++m)if(Vk((y=d[m])[0],p)!==-1){y.push(p);return}}),{type:"MultiPolygon",value:u,coordinates:d}}function s(l,u,f){var d=new Array,h=new Array,p,m,g,y,b,x;for(p=m=-1,y=Bf(l[0],u),Dc[y<<1].forEach(_);++p<e-1;)g=y,y=Bf(l[p+1],u),Dc[g|y<<1].forEach(_);for(Dc[y<<0].forEach(_);++m<t-1;){for(p=-1,y=Bf(l[m*e+e],u),b=Bf(l[m*e],u),Dc[y<<1|b<<2].forEach(_);++p<e-1;)g=y,y=Bf(l[m*e+e+p+1],u),x=b,b=Bf(l[m*e+p+1],u),Dc[g|y<<1|b<<2|x<<3].forEach(_);Dc[y|b<<3].forEach(_)}for(p=-1,b=l[m*e]>=u,Dc[b<<2].forEach(_);++p<e-1;)x=b,b=Bf(l[m*e+p+1],u),Dc[b<<2|x<<3].forEach(_);Dc[b<<3].forEach(_);function _(w){var v=[w[0][0]+p,w[0][1]+m],A=[w[1][0]+p,w[1][1]+m],B=a(v),D=a(A),T,M;(T=h[B])?(M=d[D])?(delete h[T.end],delete d[M.start],T===M?(T.ring.push(A),f(T.ring)):d[T.start]=h[M.end]={start:T.start,end:M.end,ring:T.ring.concat(M.ring)}):(delete h[T.end],T.ring.push(A),h[T.end=D]=T):(T=d[D])?(M=h[B])?(delete d[T.start],delete h[M.end],T===M?(T.ring.push(A),f(T.ring)):d[M.start]=h[T.end]={start:M.start,end:T.end,ring:M.ring.concat(T.ring)}):(delete d[T.start],T.ring.unshift(v),d[T.start=B]=T):d[B]=h[D]={start:B,end:D,ring:[v,A]}}}function a(l){return l[0]*2+l[1]*(e+1)*4}function c(l,u,f){l.forEach(function(d){var h=d[0],p=d[1],m=h|0,g=p|0,y=_B(u[g*e+m]);h>0&&h<e&&m===h&&(d[0]=qk(h,_B(u[g*e+m-1]),y,f)),p>0&&p<t&&g===p&&(d[1]=qk(p,_B(u[(g-1)*e+m]),y,f))})}return i.contour=o,i.size=function(l){if(!arguments.length)return[e,t];var u=Math.floor(l[0]),f=Math.floor(l[1]);if(!(u>=0&&f>=0))throw new Error("invalid size");return e=u,t=f,i},i.thresholds=function(l){return arguments.length?(r=typeof l=="function"?l:Array.isArray(l)?la(Pv.call(l)):la(l),i):r},i.smooth=function(l){return arguments.length?(n=l?c:jk,i):n===c},i}function prt(e){return isFinite(e)?e:NaN}function Bf(e,t){return e==null?!1:+e>=t}function _B(e){return e==null||isNaN(e=+e)?-1/0:e}function qk(e,t,r,n){let i=n-t,o=r-t,s=isFinite(i)||isFinite(o)?i/o:Math.sign(i)/Math.sign(o);return isNaN(s)?e:e+s-.5}function mrt(e){return e[0]}function yrt(e){return e[1]}function grt(){return 1}function wB(){var e=mrt,t=yrt,r=grt,n=960,i=500,o=20,s=2,a=o*3,c=n+a*2>>s,l=i+a*2>>s,u=la(20);function f(b){var x=new Float32Array(c*l),_=Math.pow(2,-s),w=-1;for(let L of b){var v=(e(L,++w,b)+a)*_,A=(t(L,w,b)+a)*_,B=+r(L,w,b);if(B&&v>=0&&v<c&&A>=0&&A<l){var D=Math.floor(v),T=Math.floor(A),M=v-D-.5,O=A-T-.5;x[D+T*c]+=(1-M)*(1-O)*B,x[D+1+T*c]+=M*(1-O)*B,x[D+1+(T+1)*c]+=M*O*B,x[D+(T+1)*c]+=(1-M)*O*B}}return Sg({data:x,width:c,height:l},o*_),x}function d(b){var x=f(b),_=u(x),w=Math.pow(2,2*s);return Array.isArray(_)||(_=dn(Number.MIN_VALUE,ue(x)/w,_)),Zl().size([c,l]).thresholds(_.map(v=>v*w))(x).map((v,A)=>(v.value=+_[A],h(v)))}d.contours=function(b){var x=f(b),_=Zl().size([c,l]),w=Math.pow(2,2*s),v=A=>{A=+A;var B=h(_.contour(x,A*w));return B.value=A,B};return Object.defineProperty(v,"max",{get:()=>ue(x)/w}),v};function h(b){return b.coordinates.forEach(p),b}function p(b){b.forEach(m)}function m(b){b.forEach(g)}function g(b){b[0]=b[0]*Math.pow(2,s)-a,b[1]=b[1]*Math.pow(2,s)-a}function y(){return a=o*3,c=n+a*2>>s,l=i+a*2>>s,d}return d.x=function(b){return arguments.length?(e=typeof b=="function"?b:la(+b),d):e},d.y=function(b){return arguments.length?(t=typeof b=="function"?b:la(+b),d):t},d.weight=function(b){return arguments.length?(r=typeof b=="function"?b:la(+b),d):r},d.size=function(b){if(!arguments.length)return[n,i];var x=+b[0],_=+b[1];if(!(x>=0&&_>=0))throw new Error("invalid size");return n=x,i=_,y()},d.cellSize=function(b){if(!arguments.length)return 1<<s;if(!((b=+b)>=1))throw new Error("invalid cell size");return s=Math.floor(Math.log(b)/Math.LN2),y()},d.thresholds=function(b){return arguments.length?(u=typeof b=="function"?b:Array.isArray(b)?la(Pv.call(b)):la(b),d):u},d.bandwidth=function(b){if(!arguments.length)return Math.sqrt(o*(o+1));if(!((b=+b)>=0))throw new Error("invalid bandwidth");return o=(Math.sqrt(4*b*b+1)-1)/2,y()},d}var ge=11102230246251565e-32,Ar=134217729,Hg=(3+8*ge)*ge;function Of(e,t,r,n,i){let o,s,a,c,l=t[0],u=n[0],f=0,d=0;u>l==u>-l?(o=l,l=t[++f]):(o=u,u=n[++d]);let h=0;if(f<e&&d<r)for(u>l==u>-l?(s=l+o,a=o-(s-l),l=t[++f]):(s=u+o,a=o-(s-u),u=n[++d]),o=s,a!==0&&(i[h++]=a);f<e&&d<r;)u>l==u>-l?(s=o+l,c=s-o,a=o-(s-c)+(l-c),l=t[++f]):(s=o+u,c=s-o,a=o-(s-c)+(u-c),u=n[++d]),o=s,a!==0&&(i[h++]=a);for(;f<e;)s=o+l,c=s-o,a=o-(s-c)+(l-c),l=t[++f],o=s,a!==0&&(i[h++]=a);for(;d<r;)s=o+u,c=s-o,a=o-(s-c)+(u-c),u=n[++d],o=s,a!==0&&(i[h++]=a);return(o!==0||h===0)&&(i[h++]=o),h}function Zg(e,t){let r=t[0];for(let n=1;n<e;n++)r+=t[n];return r}function W(e){return new Float64Array(e)}var brt=(3+16*ge)*ge,xrt=(2+12*ge)*ge,_rt=(9+64*ge)*ge*ge,Oh=W(4),Yk=W(8),Wk=W(12),Gk=W(16),Wn=W(4);function wrt(e,t,r,n,i,o,s){let a,c,l,u,f,d,h,p,m,g,y,b,x,_,w,v,A,B,D=e-i,T=r-i,M=t-o,O=n-o;_=D*O,d=Ar*D,h=d-(d-D),p=D-h,d=Ar*O,m=d-(d-O),g=O-m,w=p*g-(_-h*m-p*m-h*g),v=M*T,d=Ar*M,h=d-(d-M),p=M-h,d=Ar*T,m=d-(d-T),g=T-m,A=p*g-(v-h*m-p*m-h*g),y=w-A,f=w-y,Oh[0]=w-(y+f)+(f-A),b=_+y,f=b-_,x=_-(b-f)+(y-f),y=x-v,f=x-y,Oh[1]=x-(y+f)+(f-v),B=b+y,f=B-b,Oh[2]=b-(B-f)+(y-f),Oh[3]=B;let L=Zg(4,Oh),S=xrt*s;if(L>=S||-L>=S||(f=e-D,a=e-(D+f)+(f-i),f=r-T,l=r-(T+f)+(f-i),f=t-M,c=t-(M+f)+(f-o),f=n-O,u=n-(O+f)+(f-o),a===0&&c===0&&l===0&&u===0)||(S=_rt*s+Hg*Math.abs(L),L+=D*u+O*a-(M*l+T*c),L>=S||-L>=S))return L;_=a*O,d=Ar*a,h=d-(d-a),p=a-h,d=Ar*O,m=d-(d-O),g=O-m,w=p*g-(_-h*m-p*m-h*g),v=c*T,d=Ar*c,h=d-(d-c),p=c-h,d=Ar*T,m=d-(d-T),g=T-m,A=p*g-(v-h*m-p*m-h*g),y=w-A,f=w-y,Wn[0]=w-(y+f)+(f-A),b=_+y,f=b-_,x=_-(b-f)+(y-f),y=x-v,f=x-y,Wn[1]=x-(y+f)+(f-v),B=b+y,f=B-b,Wn[2]=b-(B-f)+(y-f),Wn[3]=B;let E=Of(4,Oh,4,Wn,Yk);_=D*u,d=Ar*D,h=d-(d-D),p=D-h,d=Ar*u,m=d-(d-u),g=u-m,w=p*g-(_-h*m-p*m-h*g),v=M*l,d=Ar*M,h=d-(d-M),p=M-h,d=Ar*l,m=d-(d-l),g=l-m,A=p*g-(v-h*m-p*m-h*g),y=w-A,f=w-y,Wn[0]=w-(y+f)+(f-A),b=_+y,f=b-_,x=_-(b-f)+(y-f),y=x-v,f=x-y,Wn[1]=x-(y+f)+(f-v),B=b+y,f=B-b,Wn[2]=b-(B-f)+(y-f),Wn[3]=B;let I=Of(E,Yk,4,Wn,Wk);_=a*u,d=Ar*a,h=d-(d-a),p=a-h,d=Ar*u,m=d-(d-u),g=u-m,w=p*g-(_-h*m-p*m-h*g),v=c*l,d=Ar*c,h=d-(d-c),p=c-h,d=Ar*l,m=d-(d-l),g=l-m,A=p*g-(v-h*m-p*m-h*g),y=w-A,f=w-y,Wn[0]=w-(y+f)+(f-A),b=_+y,f=b-_,x=_-(b-f)+(y-f),y=x-v,f=x-y,Wn[1]=x-(y+f)+(f-v),B=b+y,f=B-b,Wn[2]=b-(B-f)+(y-f),Wn[3]=B;let F=Of(I,Wk,4,Wn,Gk);return Gk[F-1]}function Fh(e,t,r,n,i,o){let s=(t-o)*(r-i),a=(e-i)*(n-o),c=s-a;if(s===0||a===0||s>0!=a>0)return c;let l=Math.abs(s+a);return Math.abs(c)>=brt*l?c:-wrt(e,t,r,n,i,o,l)}var o8t=(7+56*ge)*ge,s8t=(3+28*ge)*ge,a8t=(26+288*ge)*ge*ge,c8t=W(4),l8t=W(4),u8t=W(4),f8t=W(4),d8t=W(4),h8t=W(4),p8t=W(4),m8t=W(4),y8t=W(4),g8t=W(8),b8t=W(8),x8t=W(8),_8t=W(4),w8t=W(8),v8t=W(8),S8t=W(8),I8t=W(12),T8t=W(192),A8t=W(192);var B8t=(10+96*ge)*ge,O8t=(4+48*ge)*ge,F8t=(44+576*ge)*ge*ge,N8t=W(4),D8t=W(4),L8t=W(4),R8t=W(4),k8t=W(4),C8t=W(4),U8t=W(4),P8t=W(4),$8t=W(8),z8t=W(8),V8t=W(8),j8t=W(8),q8t=W(8),Y8t=W(8),W8t=W(8),G8t=W(8),X8t=W(8),H8t=W(4),Z8t=W(4),K8t=W(4),Q8t=W(8),J8t=W(16),tkt=W(16),ekt=W(16),rkt=W(32),nkt=W(32),ikt=W(48),okt=W(64),skt=W(1152),akt=W(1152);var fkt=(16+224*ge)*ge,dkt=(5+72*ge)*ge,hkt=(71+1408*ge)*ge*ge,pkt=W(4),mkt=W(4),ykt=W(4),gkt=W(4),bkt=W(4),xkt=W(4),_kt=W(4),wkt=W(4),vkt=W(4),Skt=W(4),Ikt=W(24),Tkt=W(24),Akt=W(24),Mkt=W(24),Ekt=W(24),Bkt=W(24),Okt=W(24),Fkt=W(24),Nkt=W(24),Dkt=W(24),Lkt=W(1152),Rkt=W(1152),kkt=W(1152),Ckt=W(1152),Ukt=W(1152),Pkt=W(2304),$kt=W(2304),zkt=W(3456),Vkt=W(5760),jkt=W(8),qkt=W(8),Ykt=W(8),Wkt=W(16),Gkt=W(24),Xkt=W(48),Hkt=W(48),Zkt=W(96),Kkt=W(192),Qkt=W(384),Jkt=W(384),tCt=W(384),eCt=W(768);var rCt=W(96),nCt=W(96),iCt=W(96),oCt=W(1152);var Hk=Math.pow(2,-52),$v=new Uint32Array(512),Dh=class e{static from(t,r=Mrt,n=Ert){let i=t.length,o=new Float64Array(i*2);for(let s=0;s<i;s++){let a=t[s];o[2*s]=r(a),o[2*s+1]=n(a)}return new e(o)}constructor(t){let r=t.length>>1;if(r>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;let n=Math.max(2*r-5,0);this._triangles=new Uint32Array(n*3),this._halfedges=new Int32Array(n*3),this._hashSize=Math.ceil(Math.sqrt(r)),this._hullPrev=new Uint32Array(r),this._hullNext=new Uint32Array(r),this._hullTri=new Uint32Array(r),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(r),this._dists=new Float64Array(r),this.update()}update(){let{coords:t,_hullPrev:r,_hullNext:n,_hullTri:i,_hullHash:o}=this,s=t.length>>1,a=1/0,c=1/0,l=-1/0,u=-1/0;for(let T=0;T<s;T++){let M=t[2*T],O=t[2*T+1];M<a&&(a=M),O<c&&(c=O),M>l&&(l=M),O>u&&(u=O),this._ids[T]=T}let f=(a+l)/2,d=(c+u)/2,h=1/0,p,m,g;for(let T=0;T<s;T++){let M=vB(f,d,t[2*T],t[2*T+1]);M<h&&(p=T,h=M)}let y=t[2*p],b=t[2*p+1];h=1/0;for(let T=0;T<s;T++){if(T===p)continue;let M=vB(y,b,t[2*T],t[2*T+1]);M<h&&M>0&&(m=T,h=M)}let x=t[2*m],_=t[2*m+1],w=1/0;for(let T=0;T<s;T++){if(T===p||T===m)continue;let M=Trt(y,b,x,_,t[2*T],t[2*T+1]);M<w&&(g=T,w=M)}let v=t[2*g],A=t[2*g+1];if(w===1/0){for(let O=0;O<s;O++)this._dists[O]=t[2*O]-t[0]||t[2*O+1]-t[1];Nh(this._ids,this._dists,0,s-1);let T=new Uint32Array(s),M=0;for(let O=0,L=-1/0;O<s;O++){let S=this._ids[O];this._dists[S]>L&&(T[M++]=S,L=this._dists[S])}this.hull=T.subarray(0,M),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(Fh(y,b,x,_,v,A)<0){let T=m,M=x,O=_;m=g,x=v,_=A,g=T,v=M,A=O}let B=Art(y,b,x,_,v,A);this._cx=B.x,this._cy=B.y;for(let T=0;T<s;T++)this._dists[T]=vB(t[2*T],t[2*T+1],B.x,B.y);Nh(this._ids,this._dists,0,s-1),this._hullStart=p;let D=3;n[p]=r[g]=m,n[m]=r[p]=g,n[g]=r[m]=p,i[p]=0,i[m]=1,i[g]=2,o.fill(-1),o[this._hashKey(y,b)]=p,o[this._hashKey(x,_)]=m,o[this._hashKey(v,A)]=g,this.trianglesLen=0,this._addTriangle(p,m,g,-1,-1,-1);for(let T=0,M,O;T<this._ids.length;T++){let L=this._ids[T],S=t[2*L],E=t[2*L+1];if(T>0&&Math.abs(S-M)<=Hk&&Math.abs(E-O)<=Hk||(M=S,O=E,L===p||L===m||L===g))continue;let I=0;for(let q=0,j=this._hashKey(S,E);q<this._hashSize&&(I=o[(j+q)%this._hashSize],!(I!==-1&&I!==n[I]));q++);I=r[I];let F=I,C;for(;C=n[F],Fh(S,E,t[2*F],t[2*F+1],t[2*C],t[2*C+1])>=0;)if(F=C,F===I){F=-1;break}if(F===-1)continue;let U=this._addTriangle(F,L,n[F],-1,-1,i[F]);i[L]=this._legalize(U+2),i[F]=U,D++;let $=n[F];for(;C=n[$],Fh(S,E,t[2*$],t[2*$+1],t[2*C],t[2*C+1])<0;)U=this._addTriangle($,L,C,i[L],-1,i[$]),i[L]=this._legalize(U+2),n[$]=$,D--,$=C;if(F===I)for(;C=r[F],Fh(S,E,t[2*C],t[2*C+1],t[2*F],t[2*F+1])<0;)U=this._addTriangle(C,L,F,-1,i[F],i[C]),this._legalize(U+2),i[C]=U,n[F]=F,D--,F=C;this._hullStart=r[L]=F,n[F]=r[$]=L,n[L]=$,o[this._hashKey(S,E)]=L,o[this._hashKey(t[2*F],t[2*F+1])]=F}this.hull=new Uint32Array(D);for(let T=0,M=this._hullStart;T<D;T++)this.hull[T]=M,M=n[M];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,r){return Math.floor(Srt(t-this._cx,r-this._cy)*this._hashSize)%this._hashSize}_legalize(t){let{_triangles:r,_halfedges:n,coords:i}=this,o=0,s=0;for(;;){let a=n[t],c=t-t%3;if(s=c+(t+2)%3,a===-1){if(o===0)break;t=$v[--o];continue}let l=a-a%3,u=c+(t+1)%3,f=l+(a+2)%3,d=r[s],h=r[t],p=r[u],m=r[f];if(Irt(i[2*d],i[2*d+1],i[2*h],i[2*h+1],i[2*p],i[2*p+1],i[2*m],i[2*m+1])){r[t]=m,r[a]=d;let y=n[f];if(y===-1){let x=this._hullStart;do{if(this._hullTri[x]===f){this._hullTri[x]=t;break}x=this._hullPrev[x]}while(x!==this._hullStart)}this._link(t,y),this._link(a,n[s]),this._link(s,f);let b=l+(a+1)%3;o<$v.length&&($v[o++]=b)}else{if(o===0)break;t=$v[--o]}}return s}_link(t,r){this._halfedges[t]=r,r!==-1&&(this._halfedges[r]=t)}_addTriangle(t,r,n,i,o,s){let a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=r,this._triangles[a+2]=n,this._link(a,i),this._link(a+1,o),this._link(a+2,s),this.trianglesLen+=3,a}};function Srt(e,t){let r=e/(Math.abs(e)+Math.abs(t));return(t>0?3-r:1+r)/4}function vB(e,t,r,n){let i=e-r,o=t-n;return i*i+o*o}function Irt(e,t,r,n,i,o,s,a){let c=e-s,l=t-a,u=r-s,f=n-a,d=i-s,h=o-a,p=c*c+l*l,m=u*u+f*f,g=d*d+h*h;return c*(f*g-m*h)-l*(u*g-m*d)+p*(u*h-f*d)<0}function Trt(e,t,r,n,i,o){let s=r-e,a=n-t,c=i-e,l=o-t,u=s*s+a*a,f=c*c+l*l,d=.5/(s*l-a*c),h=(l*u-a*f)*d,p=(s*f-c*u)*d;return h*h+p*p}function Art(e,t,r,n,i,o){let s=r-e,a=n-t,c=i-e,l=o-t,u=s*s+a*a,f=c*c+l*l,d=.5/(s*l-a*c),h=e+(l*u-a*f)*d,p=t+(s*f-c*u)*d;return{x:h,y:p}}function Nh(e,t,r,n){if(n-r<=20)for(let i=r+1;i<=n;i++){let o=e[i],s=t[o],a=i-1;for(;a>=r&&t[e[a]]>s;)e[a+1]=e[a--];e[a+1]=o}else{let i=r+n>>1,o=r+1,s=n;Kg(e,i,o),t[e[r]]>t[e[n]]&&Kg(e,r,n),t[e[o]]>t[e[n]]&&Kg(e,o,n),t[e[r]]>t[e[o]]&&Kg(e,r,o);let a=e[o],c=t[a];for(;;){do o++;while(t[e[o]]<c);do s--;while(t[e[s]]>c);if(s<o)break;Kg(e,o,s)}e[r+1]=e[s],e[s]=a,n-o+1>=s-r?(Nh(e,t,o,n),Nh(e,t,r,s-1)):(Nh(e,t,r,s-1),Nh(e,t,o,n))}}function Kg(e,t,r){let n=e[t];e[t]=e[r],e[r]=n}function Mrt(e){return e[0]}function Ert(e){return e[1]}var Eo=class{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,r){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,r){this._+=`L${this._x1=+t},${this._y1=+r}`}arc(t,r,n){t=+t,r=+r,n=+n;let i=t+n,o=r;if(n<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${o}`:(Math.abs(this._x1-i)>1e-6||Math.abs(this._y1-o)>1e-6)&&(this._+="L"+i+","+o),n&&(this._+=`A${n},${n},0,1,1,${t-n},${r}A${n},${n},0,1,1,${this._x1=i},${this._y1=o}`)}rect(t,r,n,i){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${+n}v${+i}h${-n}Z`}value(){return this._||null}};var Kl=class{constructor(){this._=[]}moveTo(t,r){this._.push([t,r])}closePath(){this._.push(this._[0].slice())}lineTo(t,r){this._.push([t,r])}value(){return this._.length?this._:null}};var Qg=class{constructor(t,[r,n,i,o]=[0,0,960,500]){if(!((i=+i)>=(r=+r))||!((o=+o)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=i,this.xmin=r,this.ymax=o,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){let{delaunay:{points:t,hull:r,triangles:n},vectors:i}=this,o,s,a=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let m=0,g=0,y=n.length,b,x;m<y;m+=3,g+=2){let _=n[m]*2,w=n[m+1]*2,v=n[m+2]*2,A=t[_],B=t[_+1],D=t[w],T=t[w+1],M=t[v],O=t[v+1],L=D-A,S=T-B,E=M-A,I=O-B,F=(L*I-S*E)*2;if(Math.abs(F)<1e-9){if(o===void 0){o=s=0;for(let U of r)o+=t[U*2],s+=t[U*2+1];o/=r.length,s/=r.length}let C=1e9*Math.sign((o-A)*I-(s-B)*E);b=(A+M)/2-C*I,x=(B+O)/2+C*E}else{let C=1/F,U=L*L+S*S,$=E*E+I*I;b=A+(I*U-S*$)*C,x=B+(L*$-E*U)*C}a[g]=b,a[g+1]=x}let c=r[r.length-1],l,u=c*4,f,d=t[2*c],h,p=t[2*c+1];i.fill(0);for(let m=0;m<r.length;++m)c=r[m],l=u,f=d,h=p,u=c*4,d=t[2*c],p=t[2*c+1],i[l+2]=i[u]=h-p,i[l+3]=i[u+1]=d-f}render(t){let r=t==null?t=new Eo:void 0,{delaunay:{halfedges:n,inedges:i,hull:o},circumcenters:s,vectors:a}=this;if(o.length<=1)return null;for(let u=0,f=n.length;u<f;++u){let d=n[u];if(d<u)continue;let h=Math.floor(u/3)*2,p=Math.floor(d/3)*2,m=s[h],g=s[h+1],y=s[p],b=s[p+1];this._renderSegment(m,g,y,b,t)}let c,l=o[o.length-1];for(let u=0;u<o.length;++u){c=l,l=o[u];let f=Math.floor(i[l]/3)*2,d=s[f],h=s[f+1],p=c*4,m=this._project(d,h,a[p+2],a[p+3]);m&&this._renderSegment(d,h,m[0],m[1],t)}return r&&r.value()}renderBounds(t){let r=t==null?t=new Eo:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),r&&r.value()}renderCell(t,r){let n=r==null?r=new Eo:void 0,i=this._clip(t);if(i===null||!i.length)return;r.moveTo(i[0],i[1]);let o=i.length;for(;i[0]===i[o-2]&&i[1]===i[o-1]&&o>1;)o-=2;for(let s=2;s<o;s+=2)(i[s]!==i[s-2]||i[s+1]!==i[s-1])&&r.lineTo(i[s],i[s+1]);return r.closePath(),n&&n.value()}*cellPolygons(){let{delaunay:{points:t}}=this;for(let r=0,n=t.length/2;r<n;++r){let i=this.cellPolygon(r);i&&(i.index=r,yield i)}}cellPolygon(t){let r=new Kl;return this.renderCell(t,r),r.value()}_renderSegment(t,r,n,i,o){let s,a=this._regioncode(t,r),c=this._regioncode(n,i);a===0&&c===0?(o.moveTo(t,r),o.lineTo(n,i)):(s=this._clipSegment(t,r,n,i,a,c))&&(o.moveTo(s[0],s[1]),o.lineTo(s[2],s[3]))}contains(t,r,n){return r=+r,r!==r||(n=+n,n!==n)?!1:this.delaunay._step(t,r,n)===t}*neighbors(t){let r=this._clip(t);if(r)for(let n of this.delaunay.neighbors(t)){let i=this._clip(n);if(i){t:for(let o=0,s=r.length;o<s;o+=2)for(let a=0,c=i.length;a<c;a+=2)if(r[o]===i[a]&&r[o+1]===i[a+1]&&r[(o+2)%s]===i[(a+c-2)%c]&&r[(o+3)%s]===i[(a+c-1)%c]){yield n;break t}}}}_cell(t){let{circumcenters:r,delaunay:{inedges:n,halfedges:i,triangles:o}}=this,s=n[t];if(s===-1)return null;let a=[],c=s;do{let l=Math.floor(c/3);if(a.push(r[l*2],r[l*2+1]),c=c%3===2?c-2:c+1,o[c]!==t)break;c=i[c]}while(c!==s&&c!==-1);return a}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];let r=this._cell(t);if(r===null)return null;let{vectors:n}=this,i=t*4;return this._simplify(n[i]||n[i+1]?this._clipInfinite(t,r,n[i],n[i+1],n[i+2],n[i+3]):this._clipFinite(t,r))}_clipFinite(t,r){let n=r.length,i=null,o,s,a=r[n-2],c=r[n-1],l,u=this._regioncode(a,c),f,d=0;for(let h=0;h<n;h+=2)if(o=a,s=c,a=r[h],c=r[h+1],l=u,u=this._regioncode(a,c),l===0&&u===0)f=d,d=0,i?i.push(a,c):i=[a,c];else{let p,m,g,y,b;if(l===0){if((p=this._clipSegment(o,s,a,c,l,u))===null)continue;[m,g,y,b]=p}else{if((p=this._clipSegment(a,c,o,s,u,l))===null)continue;[y,b,m,g]=p,f=d,d=this._edgecode(m,g),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(m,g):i=[m,g]}f=d,d=this._edgecode(y,b),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(y,b):i=[y,b]}if(i)f=d,d=this._edgecode(i[0],i[1]),f&&d&&this._edge(t,f,d,i,i.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(t,r,n,i,o,s){let a=o<s;for(a&&([t,r,n,i,o,s]=[n,i,t,r,s,o]);;){if(o===0&&s===0)return a?[n,i,t,r]:[t,r,n,i];if(o&s)return null;let c,l,u=o||s;u&8?(c=t+(n-t)*(this.ymax-r)/(i-r),l=this.ymax):u&4?(c=t+(n-t)*(this.ymin-r)/(i-r),l=this.ymin):u&2?(l=r+(i-r)*(this.xmax-t)/(n-t),c=this.xmax):(l=r+(i-r)*(this.xmin-t)/(n-t),c=this.xmin),o?(t=c,r=l,o=this._regioncode(t,r)):(n=c,i=l,s=this._regioncode(n,i))}}_clipInfinite(t,r,n,i,o,s){let a=Array.from(r),c;if((c=this._project(a[0],a[1],n,i))&&a.unshift(c[0],c[1]),(c=this._project(a[a.length-2],a[a.length-1],o,s))&&a.push(c[0],c[1]),a=this._clipFinite(t,a))for(let l=0,u=a.length,f,d=this._edgecode(a[u-2],a[u-1]);l<u;l+=2)f=d,d=this._edgecode(a[l],a[l+1]),f&&d&&(l=this._edge(t,f,d,a,l),u=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,r,n,i,o){for(;r!==n;){let s,a;switch(r){case 5:r=4;continue;case 4:r=6,s=this.xmax,a=this.ymin;break;case 6:r=2;continue;case 2:r=10,s=this.xmax,a=this.ymax;break;case 10:r=8;continue;case 8:r=9,s=this.xmin,a=this.ymax;break;case 9:r=1;continue;case 1:r=5,s=this.xmin,a=this.ymin;break}(i[o]!==s||i[o+1]!==a)&&this.contains(t,s,a)&&(i.splice(o,0,s,a),o+=2)}return o}_project(t,r,n,i){let o=1/0,s,a,c;if(i<0){if(r<=this.ymin)return null;(s=(this.ymin-r)/i)<o&&(c=this.ymin,a=t+(o=s)*n)}else if(i>0){if(r>=this.ymax)return null;(s=(this.ymax-r)/i)<o&&(c=this.ymax,a=t+(o=s)*n)}if(n>0){if(t>=this.xmax)return null;(s=(this.xmax-t)/n)<o&&(a=this.xmax,c=r+(o=s)*i)}else if(n<0){if(t<=this.xmin)return null;(s=(this.xmin-t)/n)<o&&(a=this.xmin,c=r+(o=s)*i)}return[a,c]}_edgecode(t,r){return(t===this.xmin?1:t===this.xmax?2:0)|(r===this.ymin?4:r===this.ymax?8:0)}_regioncode(t,r){return(t<this.xmin?1:t>this.xmax?2:0)|(r<this.ymin?4:r>this.ymax?8:0)}_simplify(t){if(t&&t.length>4){for(let r=0;r<t.length;r+=2){let n=(r+2)%t.length,i=(r+4)%t.length;(t[r]===t[n]&&t[n]===t[i]||t[r+1]===t[n+1]&&t[n+1]===t[i+1])&&(t.splice(n,2),r-=2)}t.length||(t=null)}return t}};var Brt=2*Math.PI,Lh=Math.pow;function Ort(e){return e[0]}function Frt(e){return e[1]}function Nrt(e){let{triangles:t,coords:r}=e;for(let n=0;n<t.length;n+=3){let i=2*t[n],o=2*t[n+1],s=2*t[n+2];if((r[s]-r[i])*(r[o+1]-r[i+1])-(r[o]-r[i])*(r[s+1]-r[i+1])>1e-10)return!1}return!0}function Drt(e,t,r){return[e+Math.sin(e+t)*r,t+Math.cos(e-t)*r]}var Yi=class e{static from(t,r=Ort,n=Frt,i){return new e("length"in t?Lrt(t,r,n,i):Float64Array.from(Rrt(t,r,n,i)))}constructor(t){this._delaunator=new Dh(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){let t=this._delaunator,r=this.points;if(t.hull&&t.hull.length>2&&Nrt(t)){this.collinear=Int32Array.from({length:r.length/2},(d,h)=>h).sort((d,h)=>r[2*d]-r[2*h]||r[2*d+1]-r[2*h+1]);let c=this.collinear[0],l=this.collinear[this.collinear.length-1],u=[r[2*c],r[2*c+1],r[2*l],r[2*l+1]],f=1e-8*Math.hypot(u[3]-u[1],u[2]-u[0]);for(let d=0,h=r.length/2;d<h;++d){let p=Drt(r[2*d],r[2*d+1],f);r[2*d]=p[0],r[2*d+1]=p[1]}this._delaunator=new Dh(r)}else delete this.collinear;let n=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,o=this.triangles=this._delaunator.triangles,s=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let c=0,l=n.length;c<l;++c){let u=o[c%3===2?c-2:c+1];(n[c]===-1||s[u]===-1)&&(s[u]=c)}for(let c=0,l=i.length;c<l;++c)a[i[c]]=c;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],s[i[0]]=1,i.length===2&&(s[i[1]]=0,this.triangles[1]=i[1],this.triangles[2]=i[1]))}voronoi(t){return new Qg(this,t)}*neighbors(t){let{inedges:r,hull:n,_hullIndex:i,halfedges:o,triangles:s,collinear:a}=this;if(a){let f=a.indexOf(t);f>0&&(yield a[f-1]),f<a.length-1&&(yield a[f+1]);return}let c=r[t];if(c===-1)return;let l=c,u=-1;do{if(yield u=s[l],l=l%3===2?l-2:l+1,s[l]!==t)return;if(l=o[l],l===-1){let f=n[(i[t]+1)%n.length];f!==u&&(yield f);return}}while(l!==c)}find(t,r,n=0){if(t=+t,t!==t||(r=+r,r!==r))return-1;let i=n,o;for(;(o=this._step(n,t,r))>=0&&o!==n&&o!==i;)n=o;return o}_step(t,r,n){let{inedges:i,hull:o,_hullIndex:s,halfedges:a,triangles:c,points:l}=this;if(i[t]===-1||!l.length)return(t+1)%(l.length>>1);let u=t,f=Lh(r-l[t*2],2)+Lh(n-l[t*2+1],2),d=i[t],h=d;do{let p=c[h],m=Lh(r-l[p*2],2)+Lh(n-l[p*2+1],2);if(m<f&&(f=m,u=p),h=h%3===2?h-2:h+1,c[h]!==t)break;if(h=a[h],h===-1){if(h=o[(s[t]+1)%o.length],h!==p&&Lh(r-l[h*2],2)+Lh(n-l[h*2+1],2)<f)return h;break}}while(h!==d);return u}render(t){let r=t==null?t=new Eo:void 0,{points:n,halfedges:i,triangles:o}=this;for(let s=0,a=i.length;s<a;++s){let c=i[s];if(c<s)continue;let l=o[s]*2,u=o[c]*2;t.moveTo(n[l],n[l+1]),t.lineTo(n[u],n[u+1])}return this.renderHull(t),r&&r.value()}renderPoints(t,r){r===void 0&&(!t||typeof t.moveTo!="function")&&(r=t,t=null),r=r==null?2:+r;let n=t==null?t=new Eo:void 0,{points:i}=this;for(let o=0,s=i.length;o<s;o+=2){let a=i[o],c=i[o+1];t.moveTo(a+r,c),t.arc(a,c,r,0,Brt)}return n&&n.value()}renderHull(t){let r=t==null?t=new Eo:void 0,{hull:n,points:i}=this,o=n[0]*2,s=n.length;t.moveTo(i[o],i[o+1]);for(let a=1;a<s;++a){let c=2*n[a];t.lineTo(i[c],i[c+1])}return t.closePath(),r&&r.value()}hullPolygon(){let t=new Kl;return this.renderHull(t),t.value()}renderTriangle(t,r){let n=r==null?r=new Eo:void 0,{points:i,triangles:o}=this,s=o[t*=3]*2,a=o[t+1]*2,c=o[t+2]*2;return r.moveTo(i[s],i[s+1]),r.lineTo(i[a],i[a+1]),r.lineTo(i[c],i[c+1]),r.closePath(),n&&n.value()}*trianglePolygons(){let{triangles:t}=this;for(let r=0,n=t.length/3;r<n;++r)yield this.trianglePolygon(r)}trianglePolygon(t){let r=new Kl;return this.renderTriangle(t,r),r.value()}};function Lrt(e,t,r,n){let i=e.length,o=new Float64Array(i*2);for(let s=0;s<i;++s){let a=e[s];o[s*2]=t.call(n,a,s,e),o[s*2+1]=r.call(n,a,s,e)}return o}function*Rrt(e,t,r,n){let i=0;for(let o of e)yield t.call(n,o,i,e),yield r.call(n,o,i,e),++i}function Zk(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Ff(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function ua(e){return e=Ff(Math.abs(e)),e?e[1]:NaN}function Kk(e,t){return function(r,n){for(var i=r.length,o=[],s=0,a=e[0],c=0;i>0&&a>0&&(c+a+1>n&&(a=Math.max(1,n-c)),o.push(r.substring(i-=a,i+a)),!((c+=a+1)>n));)a=e[s=(s+1)%e.length];return o.reverse().join(t)}}function Qk(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var krt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function fa(e){if(!(t=krt.exec(e)))throw new Error("invalid format: "+e);var t;return new zv({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}fa.prototype=zv.prototype;function zv(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}zv.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Jk(e){t:for(var t=e.length,r=1,n=-1,i;r<t;++r)switch(e[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+e[r])break t;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(i+1):e}var SB;function tC(e,t){var r=Ff(e,t);if(!r)return e+"";var n=r[0],i=r[1],o=i-(SB=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=n.length;return o===s?n:o>s?n+new Array(o-s+1).join("0"):o>0?n.slice(0,o)+"."+n.slice(o):"0."+new Array(1-o).join("0")+Ff(e,Math.max(0,t+o-1))[0]}function IB(e,t){var r=Ff(e,t);if(!r)return e+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}var TB={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Zk,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>IB(e*100,t),r:IB,s:tC,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function AB(e){return e}var eC=Array.prototype.map,rC=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function nC(e){var t=e.grouping===void 0||e.thousands===void 0?AB:Kk(eC.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?AB:Qk(eC.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"\u2212":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function l(f){f=fa(f);var d=f.fill,h=f.align,p=f.sign,m=f.symbol,g=f.zero,y=f.width,b=f.comma,x=f.precision,_=f.trim,w=f.type;w==="n"?(b=!0,w="g"):TB[w]||(x===void 0&&(x=12),_=!0,w="g"),(g||d==="0"&&h==="=")&&(g=!0,d="0",h="=");var v=m==="$"?r:m==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",A=m==="$"?n:/[%p]/.test(w)?s:"",B=TB[w],D=/[defgprs%]/.test(w);x=x===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,x)):Math.max(0,Math.min(20,x));function T(M){var O=v,L=A,S,E,I;if(w==="c")L=B(M)+L,M="";else{M=+M;var F=M<0||1/M<0;if(M=isNaN(M)?c:B(Math.abs(M),x),_&&(M=Jk(M)),F&&+M==0&&p!=="+"&&(F=!1),O=(F?p==="("?p:a:p==="-"||p==="("?"":p)+O,L=(w==="s"?rC[8+SB/3]:"")+L+(F&&p==="("?")":""),D){for(S=-1,E=M.length;++S<E;)if(I=M.charCodeAt(S),48>I||I>57){L=(I===46?i+M.slice(S+1):M.slice(S))+L,M=M.slice(0,S);break}}}b&&!g&&(M=t(M,1/0));var C=O.length+M.length+L.length,U=C<y?new Array(y-C+1).join(d):"";switch(b&&g&&(M=t(U+M,U.length?y-L.length:1/0),U=""),h){case"<":M=O+M+L+U;break;case"=":M=O+U+M+L;break;case"^":M=U.slice(0,C=U.length>>1)+O+M+L+U.slice(C);break;default:M=U+O+M+L;break}return o(M)}return T.toString=function(){return f+""},T}function u(f,d){var h=l((f=fa(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(ua(d)/3)))*3,m=Math.pow(10,-p),g=rC[8+p/3];return function(y){return h(m*y)+g}}return{format:l,formatPrefix:u}}var Vv,Bo,jv;MB({thousands:",",grouping:[3],currency:["$",""]});function MB(e){return Vv=nC(e),Bo=Vv.format,jv=Vv.formatPrefix,Vv}function EB(e){return Math.max(0,-ua(Math.abs(e)))}function BB(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ua(t)/3)))*3-ua(Math.abs(e)))}function OB(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,ua(t)-ua(e))+1}var nt=1e-6,Nf=1e-12,St=Math.PI,Ne=St/2,FB=St/4,qr=St*2,ur=180/St,ie=St/180,Vt=Math.abs,Oo=Math.atan,Mr=Math.atan2,et=Math.cos,Jg=Math.ceil,qv=Math.exp;var Yv=Math.hypot,Df=Math.log,Wv=Math.pow,J=Math.sin,Mn=Math.sign||function(e){return e>0?1:e<0?-1:0},De=Math.sqrt,Rh=Math.tan;function Gv(e){return e>1?0:e<-1?St:Math.acos(e)}function Xe(e){return e>1?Ne:e<-1?-Ne:Math.asin(e)}function Er(){}function Xv(e,t){e&&oC.hasOwnProperty(e.type)&&oC[e.type](e,t)}var iC={Feature:function(e,t){Xv(e.geometry,t)},FeatureCollection:function(e,t){for(var r=e.features,n=-1,i=r.length;++n<i;)Xv(r[n].geometry,t)}},oC={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var r=e.coordinates,n=-1,i=r.length;++n<i;)e=r[n],t.point(e[0],e[1],e[2])},LineString:function(e,t){NB(e.coordinates,t,0)},MultiLineString:function(e,t){for(var r=e.coordinates,n=-1,i=r.length;++n<i;)NB(r[n],t,0)},Polygon:function(e,t){sC(e.coordinates,t)},MultiPolygon:function(e,t){for(var r=e.coordinates,n=-1,i=r.length;++n<i;)sC(r[n],t)},GeometryCollection:function(e,t){for(var r=e.geometries,n=-1,i=r.length;++n<i;)Xv(r[n],t)}};function NB(e,t,r){var n=-1,i=e.length-r,o;for(t.lineStart();++n<i;)o=e[n],t.point(o[0],o[1],o[2]);t.lineEnd()}function sC(e,t){var r=-1,n=e.length;for(t.polygonStart();++r<n;)NB(e[r],t,1);t.polygonEnd()}function Wi(e,t){e&&iC.hasOwnProperty(e.type)?iC[e.type](e,t):Xv(e,t)}function t0(e){return[Mr(e[1],e[0]),Xe(e[2])]}function da(e){var t=e[0],r=e[1],n=et(r);return[n*et(t),n*J(t),J(r)]}function e0(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function kh(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Hv(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function r0(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function n0(e){var t=De(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var i0,Zv,Kv,Qv,Jv,t2,e2,r2,DB,LB,RB,lC,uC,Gn,Xn,Hn,Ss={sphere:Er,point:kB,lineStart:aC,lineEnd:cC,polygonStart:function(){Ss.lineStart=Prt,Ss.lineEnd=$rt},polygonEnd:function(){Ss.lineStart=aC,Ss.lineEnd=cC}};function kB(e,t){e*=ie,t*=ie;var r=et(t);o0(r*et(e),r*J(e),J(t))}function o0(e,t,r){++i0,Kv+=(e-Kv)/i0,Qv+=(t-Qv)/i0,Jv+=(r-Jv)/i0}function aC(){Ss.point=Crt}function Crt(e,t){e*=ie,t*=ie;var r=et(t);Gn=r*et(e),Xn=r*J(e),Hn=J(t),Ss.point=Urt,o0(Gn,Xn,Hn)}function Urt(e,t){e*=ie,t*=ie;var r=et(t),n=r*et(e),i=r*J(e),o=J(t),s=Mr(De((s=Xn*o-Hn*i)*s+(s=Hn*n-Gn*o)*s+(s=Gn*i-Xn*n)*s),Gn*n+Xn*i+Hn*o);Zv+=s,t2+=s*(Gn+(Gn=n)),e2+=s*(Xn+(Xn=i)),r2+=s*(Hn+(Hn=o)),o0(Gn,Xn,Hn)}function cC(){Ss.point=kB}function Prt(){Ss.point=zrt}function $rt(){fC(lC,uC),Ss.point=kB}function zrt(e,t){lC=e,uC=t,e*=ie,t*=ie,Ss.point=fC;var r=et(t);Gn=r*et(e),Xn=r*J(e),Hn=J(t),o0(Gn,Xn,Hn)}function fC(e,t){e*=ie,t*=ie;var r=et(t),n=r*et(e),i=r*J(e),o=J(t),s=Xn*o-Hn*i,a=Hn*n-Gn*o,c=Gn*i-Xn*n,l=Yv(s,a,c),u=Xe(l),f=l&&-u/l;DB.add(f*s),LB.add(f*a),RB.add(f*c),Zv+=u,t2+=u*(Gn+(Gn=n)),e2+=u*(Xn+(Xn=i)),r2+=u*(Hn+(Hn=o)),o0(Gn,Xn,Hn)}function CB(e){i0=Zv=Kv=Qv=Jv=t2=e2=r2=0,DB=new fn,LB=new fn,RB=new fn,Wi(e,Ss);var t=+DB,r=+LB,n=+RB,i=Yv(t,r,n);return i<Nf&&(t=t2,r=e2,n=r2,Zv<nt&&(t=Kv,r=Qv,n=Jv),i=Yv(t,r,n),i<Nf)?[NaN,NaN]:[Mr(r,t)*ur,Xe(n/i)*ur]}function s0(e,t){function r(n,i){return n=e(n,i),t(n[0],n[1])}return e.invert&&t.invert&&(r.invert=function(n,i){return n=t.invert(n,i),n&&e.invert(n[0],n[1])}),r}function UB(e,t){return Vt(e)>St&&(e-=Math.round(e/qr)*qr),[e,t]}UB.invert=UB;function PB(e,t,r){return(e%=qr)?t||r?s0(hC(e),pC(t,r)):hC(e):t||r?pC(t,r):UB}function dC(e){return function(t,r){return t+=e,Vt(t)>St&&(t-=Math.round(t/qr)*qr),[t,r]}}function hC(e){var t=dC(e);return t.invert=dC(-e),t}function pC(e,t){var r=et(e),n=J(e),i=et(t),o=J(t);function s(a,c){var l=et(c),u=et(a)*l,f=J(a)*l,d=J(c),h=d*r+u*n;return[Mr(f*i-h*o,u*r-d*n),Xe(h*i+f*o)]}return s.invert=function(a,c){var l=et(c),u=et(a)*l,f=J(a)*l,d=J(c),h=d*i-f*o;return[Mr(f*i+d*o,u*r+h*n),Xe(h*r-u*n)]},s}function mC(e){e=PB(e[0]*ie,e[1]*ie,e.length>2?e[2]*ie:0);function t(r){return r=e(r[0]*ie,r[1]*ie),r[0]*=ur,r[1]*=ur,r}return t.invert=function(r){return r=e.invert(r[0]*ie,r[1]*ie),r[0]*=ur,r[1]*=ur,r},t}function gC(e,t,r,n,i,o){if(r){var s=et(t),a=J(t),c=n*r;i==null?(i=t+n*qr,o=t-c/2):(i=yC(s,i),o=yC(s,o),(n>0?i<o:i>o)&&(i+=n*qr));for(var l,u=i;n>0?u>o:u<o;u-=c)l=t0([s,-a*et(u),-a*J(u)]),e.point(l[0],l[1])}}function yC(e,t){t=da(t),t[0]-=e,n0(t);var r=Gv(-t[1]);return((-t[2]<0?-r:r)+qr-nt)%qr}function n2(){var e=[],t;return{point:function(r,n,i){t.push([r,n,i])},lineStart:function(){e.push(t=[])},lineEnd:Er,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var r=e;return e=[],t=null,r}}}function Ch(e,t){return Vt(e[0]-t[0])<nt&&Vt(e[1]-t[1])<nt}function i2(e,t,r,n){this.x=e,this.z=t,this.o=r,this.e=n,this.v=!1,this.n=this.p=null}function o2(e,t,r,n,i){var o=[],s=[],a,c;if(e.forEach(function(p){if(!((m=p.length-1)<=0)){var m,g=p[0],y=p[m],b;if(Ch(g,y)){if(!g[2]&&!y[2]){for(i.lineStart(),a=0;a<m;++a)i.point((g=p[a])[0],g[1]);i.lineEnd();return}y[0]+=2*nt}o.push(b=new i2(g,p,null,!0)),s.push(b.o=new i2(g,null,b,!1)),o.push(b=new i2(y,p,null,!1)),s.push(b.o=new i2(y,null,b,!0))}}),!!o.length){for(s.sort(t),bC(o),bC(s),a=0,c=s.length;a<c;++a)s[a].e=r=!r;for(var l=o[0],u,f;;){for(var d=l,h=!0;d.v;)if((d=d.n)===l)return;u=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(a=0,c=u.length;a<c;++a)i.point((f=u[a])[0],f[1]);else n(d.x,d.n.x,1,i);d=d.n}else{if(h)for(u=d.p.z,a=u.length-1;a>=0;--a)i.point((f=u[a])[0],f[1]);else n(d.x,d.p.x,-1,i);d=d.p}d=d.o,u=d.z,h=!h}while(!d.v);i.lineEnd()}}}function bC(e){if(t=e.length){for(var t,r=0,n=e[0],i;++r<t;)n.n=i=e[r],i.p=n,n=i;n.n=i=e[0],i.p=n}}function $B(e){return Vt(e[0])<=St?e[0]:Mn(e[0])*((Vt(e[0])+St)%qr-St)}function xC(e,t){var r=$B(t),n=t[1],i=J(n),o=[J(r),-et(r),0],s=0,a=0,c=new fn;i===1?n=Ne+nt:i===-1&&(n=-Ne-nt);for(var l=0,u=e.length;l<u;++l)if(d=(f=e[l]).length)for(var f,d,h=f[d-1],p=$B(h),m=h[1]/2+FB,g=J(m),y=et(m),b=0;b<d;++b,p=_,g=v,y=A,h=x){var x=f[b],_=$B(x),w=x[1]/2+FB,v=J(w),A=et(w),B=_-p,D=B>=0?1:-1,T=D*B,M=T>St,O=g*v;if(c.add(Mr(O*D*J(T),y*A+O*et(T))),s+=M?B+D*qr:B,M^p>=r^_>=r){var L=kh(da(h),da(x));n0(L);var S=kh(o,L);n0(S);var E=(M^B>=0?-1:1)*Xe(S[2]);(n>E||n===E&&(L[0]||L[1]))&&(a+=M^B>=0?1:-1)}}return(s<-nt||s<nt&&c<-Nf)^a&1}function s2(e,t,r,n){return function(i){var o=t(i),s=n2(),a=t(s),c=!1,l,u,f,d={point:h,lineStart:m,lineEnd:g,polygonStart:function(){d.point=y,d.lineStart=b,d.lineEnd=x,u=[],l=[]},polygonEnd:function(){d.point=h,d.lineStart=m,d.lineEnd=g,u=bh(u);var _=xC(l,n);u.length?(c||(i.polygonStart(),c=!0),o2(u,jrt,_,r,i)):_&&(c||(i.polygonStart(),c=!0),i.lineStart(),r(null,null,1,i),i.lineEnd()),c&&(i.polygonEnd(),c=!1),u=l=null},sphere:function(){i.polygonStart(),i.lineStart(),r(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(_,w){e(_,w)&&i.point(_,w)}function p(_,w){o.point(_,w)}function m(){d.point=p,o.lineStart()}function g(){d.point=h,o.lineEnd()}function y(_,w){f.push([_,w]),a.point(_,w)}function b(){a.lineStart(),f=[]}function x(){y(f[0][0],f[0][1]),a.lineEnd();var _=a.clean(),w=s.result(),v,A=w.length,B,D,T;if(f.pop(),l.push(f),f=null,!!A){if(_&1){if(D=w[0],(B=D.length-1)>0){for(c||(i.polygonStart(),c=!0),i.lineStart(),v=0;v<B;++v)i.point((T=D[v])[0],T[1]);i.lineEnd()}return}A>1&&_&2&&w.push(w.pop().concat(w.shift())),u.push(w.filter(Vrt))}}return d}}function Vrt(e){return e.length>1}function jrt(e,t){return((e=e.x)[0]<0?e[1]-Ne-nt:Ne-e[1])-((t=t.x)[0]<0?t[1]-Ne-nt:Ne-t[1])}var zB=s2(function(){return!0},qrt,Wrt,[-St,-Ne]);function qrt(e){var t=NaN,r=NaN,n=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(o,s){var a=o>0?St:-St,c=Vt(o-t);Vt(c-St)<nt?(e.point(t,r=(r+s)/2>0?Ne:-Ne),e.point(n,r),e.lineEnd(),e.lineStart(),e.point(a,r),e.point(o,r),i=0):n!==a&&c>=St&&(Vt(t-n)<nt&&(t-=n*nt),Vt(o-a)<nt&&(o-=a*nt),r=Yrt(t,r,o,s),e.point(n,r),e.lineEnd(),e.lineStart(),e.point(a,r),i=0),e.point(t=o,r=s),n=a},lineEnd:function(){e.lineEnd(),t=r=NaN},clean:function(){return 2-i}}}function Yrt(e,t,r,n){var i,o,s=J(e-r);return Vt(s)>nt?Oo((J(t)*(o=et(n))*J(r)-J(n)*(i=et(t))*J(e))/(i*o*s)):(t+n)/2}function Wrt(e,t,r,n){var i;if(e==null)i=r*Ne,n.point(-St,i),n.point(0,i),n.point(St,i),n.point(St,0),n.point(St,-i),n.point(0,-i),n.point(-St,-i),n.point(-St,0),n.point(-St,i);else if(Vt(e[0]-t[0])>nt){var o=e[0]<t[0]?St:-St;i=r*o/2,n.point(-o,i),n.point(0,i),n.point(o,i)}else n.point(t[0],t[1])}function _C(e){var t=et(e),r=6*ie,n=t>0,i=Vt(t)>nt;function o(u,f,d,h){gC(h,e,r,d,u,f)}function s(u,f){return et(u)*et(f)>t}function a(u){var f,d,h,p,m;return{lineStart:function(){p=h=!1,m=1},point:function(g,y){var b=[g,y],x,_=s(g,y),w=n?_?0:l(g,y):_?l(g+(g<0?St:-St),y):0;if(!f&&(p=h=_)&&u.lineStart(),_!==h&&(x=c(f,b),(!x||Ch(f,x)||Ch(b,x))&&(b[2]=1)),_!==h)m=0,_?(u.lineStart(),x=c(b,f),u.point(x[0],x[1])):(x=c(f,b),u.point(x[0],x[1],2),u.lineEnd()),f=x;else if(i&&f&&n^_){var v;!(w&d)&&(v=c(b,f,!0))&&(m=0,n?(u.lineStart(),u.point(v[0][0],v[0][1]),u.point(v[1][0],v[1][1]),u.lineEnd()):(u.point(v[1][0],v[1][1]),u.lineEnd(),u.lineStart(),u.point(v[0][0],v[0][1],3)))}_&&(!f||!Ch(f,b))&&u.point(b[0],b[1]),f=b,h=_,d=w},lineEnd:function(){h&&u.lineEnd(),f=null},clean:function(){return m|(p&&h)<<1}}}function c(u,f,d){var h=da(u),p=da(f),m=[1,0,0],g=kh(h,p),y=e0(g,g),b=g[0],x=y-b*b;if(!x)return!d&&u;var _=t*y/x,w=-t*b/x,v=kh(m,g),A=r0(m,_),B=r0(g,w);Hv(A,B);var D=v,T=e0(A,D),M=e0(D,D),O=T*T-M*(e0(A,A)-1);if(!(O<0)){var L=De(O),S=r0(D,(-T-L)/M);if(Hv(S,A),S=t0(S),!d)return S;var E=u[0],I=f[0],F=u[1],C=f[1],U;I<E&&(U=E,E=I,I=U);var $=I-E,q=Vt($-St)<nt,j=q||$<nt;if(!q&&C<F&&(U=F,F=C,C=U),j?q?F+C>0^S[1]<(Vt(S[0]-E)<nt?F:C):F<=S[1]&&S[1]<=C:$>St^(E<=S[0]&&S[0]<=I)){var rt=r0(D,(-T+L)/M);return Hv(rt,A),[S,t0(rt)]}}}function l(u,f){var d=n?e:St-e,h=0;return u<-d?h|=1:u>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return s2(s,a,o,n?[0,-e]:[-St,e-St])}function wC(e,t,r,n,i,o){var s=e[0],a=e[1],c=t[0],l=t[1],u=0,f=1,d=c-s,h=l-a,p;if(p=r-s,!(!d&&p>0)){if(p/=d,d<0){if(p<u)return;p<f&&(f=p)}else if(d>0){if(p>f)return;p>u&&(u=p)}if(p=i-s,!(!d&&p<0)){if(p/=d,d<0){if(p>f)return;p>u&&(u=p)}else if(d>0){if(p<u)return;p<f&&(f=p)}if(p=n-a,!(!h&&p>0)){if(p/=h,h<0){if(p<u)return;p<f&&(f=p)}else if(h>0){if(p>f)return;p>u&&(u=p)}if(p=o-a,!(!h&&p<0)){if(p/=h,h<0){if(p>f)return;p>u&&(u=p)}else if(h>0){if(p<u)return;p<f&&(f=p)}return u>0&&(e[0]=s+u*d,e[1]=a+u*h),f<1&&(t[0]=s+f*d,t[1]=a+f*h),!0}}}}}var a0=1e9,a2=-a0;function Uh(e,t,r,n){function i(l,u){return e<=l&&l<=r&&t<=u&&u<=n}function o(l,u,f,d){var h=0,p=0;if(l==null||(h=s(l,f))!==(p=s(u,f))||c(l,u)<0^f>0)do d.point(h===0||h===3?e:r,h>1?n:t);while((h=(h+f+4)%4)!==p);else d.point(u[0],u[1])}function s(l,u){return Vt(l[0]-e)<nt?u>0?0:3:Vt(l[0]-r)<nt?u>0?2:1:Vt(l[1]-t)<nt?u>0?1:0:u>0?3:2}function a(l,u){return c(l.x,u.x)}function c(l,u){var f=s(l,1),d=s(u,1);return f!==d?f-d:f===0?u[1]-l[1]:f===1?l[0]-u[0]:f===2?l[1]-u[1]:u[0]-l[0]}return function(l){var u=l,f=n2(),d,h,p,m,g,y,b,x,_,w,v,A={point:B,lineStart:O,lineEnd:L,polygonStart:T,polygonEnd:M};function B(E,I){i(E,I)&&u.point(E,I)}function D(){for(var E=0,I=0,F=h.length;I<F;++I)for(var C=h[I],U=1,$=C.length,q=C[0],j,rt,ot=q[0],Gt=q[1];U<$;++U)j=ot,rt=Gt,q=C[U],ot=q[0],Gt=q[1],rt<=n?Gt>n&&(ot-j)*(n-rt)>(Gt-rt)*(e-j)&&++E:Gt<=n&&(ot-j)*(n-rt)<(Gt-rt)*(e-j)&&--E;return E}function T(){u=f,d=[],h=[],v=!0}function M(){var E=D(),I=v&&E,F=(d=bh(d)).length;(I||F)&&(l.polygonStart(),I&&(l.lineStart(),o(null,null,1,l),l.lineEnd()),F&&o2(d,a,E,o,l),l.polygonEnd()),u=l,d=h=p=null}function O(){A.point=S,h&&h.push(p=[]),w=!0,_=!1,b=x=NaN}function L(){d&&(S(m,g),y&&_&&f.rejoin(),d.push(f.result())),A.point=B,_&&u.lineEnd()}function S(E,I){var F=i(E,I);if(h&&p.push([E,I]),w)m=E,g=I,y=F,w=!1,F&&(u.lineStart(),u.point(E,I));else if(F&&_)u.point(E,I);else{var C=[b=Math.max(a2,Math.min(a0,b)),x=Math.max(a2,Math.min(a0,x))],U=[E=Math.max(a2,Math.min(a0,E)),I=Math.max(a2,Math.min(a0,I))];wC(C,U,e,t,r,n)?(_||(u.lineStart(),u.point(C[0],C[1])),u.point(U[0],U[1]),F||u.lineEnd(),v=!1):F&&(u.lineStart(),u.point(E,I),v=!1)}b=E,x=I,_=F}return A}}function vC(e,t,r){var n=xr(e,t-nt,r).concat(t);return function(i){return n.map(function(o){return[i,o]})}}function SC(e,t,r){var n=xr(e,t-nt,r).concat(t);return function(i){return n.map(function(o){return[o,i]})}}function VB(){var e,t,r,n,i,o,s,a,c=10,l=c,u=90,f=360,d,h,p,m,g=2.5;function y(){return{type:"MultiLineString",coordinates:b()}}function b(){return xr(Jg(n/u)*u,r,u).map(p).concat(xr(Jg(a/f)*f,s,f).map(m)).concat(xr(Jg(t/c)*c,e,c).filter(function(x){return Vt(x%u)>nt}).map(d)).concat(xr(Jg(o/l)*l,i,l).filter(function(x){return Vt(x%f)>nt}).map(h))}return y.lines=function(){return b().map(function(x){return{type:"LineString",coordinates:x}})},y.outline=function(){return{type:"Polygon",coordinates:[p(n).concat(m(s).slice(1),p(r).reverse().slice(1),m(a).reverse().slice(1))]}},y.extent=function(x){return arguments.length?y.extentMajor(x).extentMinor(x):y.extentMinor()},y.extentMajor=function(x){return arguments.length?(n=+x[0][0],r=+x[1][0],a=+x[0][1],s=+x[1][1],n>r&&(x=n,n=r,r=x),a>s&&(x=a,a=s,s=x),y.precision(g)):[[n,a],[r,s]]},y.extentMinor=function(x){return arguments.length?(t=+x[0][0],e=+x[1][0],o=+x[0][1],i=+x[1][1],t>e&&(x=t,t=e,e=x),o>i&&(x=o,o=i,i=x),y.precision(g)):[[t,o],[e,i]]},y.step=function(x){return arguments.length?y.stepMajor(x).stepMinor(x):y.stepMinor()},y.stepMajor=function(x){return arguments.length?(u=+x[0],f=+x[1],y):[u,f]},y.stepMinor=function(x){return arguments.length?(c=+x[0],l=+x[1],y):[c,l]},y.precision=function(x){return arguments.length?(g=+x,d=vC(o,i,90),h=SC(t,e,g),p=vC(a,s,90),m=SC(n,r,g),y):g},y.extentMajor([[-180,-90+nt],[180,90-nt]]).extentMinor([[-180,-80-nt],[180,80+nt]])}function jB(){return VB()()}var c0=e=>e;var qB=new fn,YB=new fn,IC,TC,WB,GB,Ql={point:Er,lineStart:Er,lineEnd:Er,polygonStart:function(){Ql.lineStart=Grt,Ql.lineEnd=Hrt},polygonEnd:function(){Ql.lineStart=Ql.lineEnd=Ql.point=Er,qB.add(Vt(YB)),YB=new fn},result:function(){var e=qB/2;return qB=new fn,e}};function Grt(){Ql.point=Xrt}function Xrt(e,t){Ql.point=AC,IC=WB=e,TC=GB=t}function AC(e,t){YB.add(GB*e-WB*t),WB=e,GB=t}function Hrt(){AC(IC,TC)}var XB=Ql;var Ph=1/0,c2=Ph,l0=-Ph,l2=l0,Zrt={point:Krt,lineStart:Er,lineEnd:Er,polygonStart:Er,polygonEnd:Er,result:function(){var e=[[Ph,c2],[l0,l2]];return l0=l2=-(c2=Ph=1/0),e}};function Krt(e,t){e<Ph&&(Ph=e),e>l0&&(l0=e),t<c2&&(c2=t),t>l2&&(l2=t)}var $h=Zrt;var HB=0,ZB=0,u0=0,u2=0,f2=0,zh=0,KB=0,QB=0,f0=0,BC,OC,ha,pa,Is={point:Lf,lineStart:MC,lineEnd:EC,polygonStart:function(){Is.lineStart=tnt,Is.lineEnd=ent},polygonEnd:function(){Is.point=Lf,Is.lineStart=MC,Is.lineEnd=EC},result:function(){var e=f0?[KB/f0,QB/f0]:zh?[u2/zh,f2/zh]:u0?[HB/u0,ZB/u0]:[NaN,NaN];return HB=ZB=u0=u2=f2=zh=KB=QB=f0=0,e}};function Lf(e,t){HB+=e,ZB+=t,++u0}function MC(){Is.point=Qrt}function Qrt(e,t){Is.point=Jrt,Lf(ha=e,pa=t)}function Jrt(e,t){var r=e-ha,n=t-pa,i=De(r*r+n*n);u2+=i*(ha+e)/2,f2+=i*(pa+t)/2,zh+=i,Lf(ha=e,pa=t)}function EC(){Is.point=Lf}function tnt(){Is.point=rnt}function ent(){FC(BC,OC)}function rnt(e,t){Is.point=FC,Lf(BC=ha=e,OC=pa=t)}function FC(e,t){var r=e-ha,n=t-pa,i=De(r*r+n*n);u2+=i*(ha+e)/2,f2+=i*(pa+t)/2,zh+=i,i=pa*e-ha*t,KB+=i*(ha+e),QB+=i*(pa+t),f0+=i*3,Lf(ha=e,pa=t)}var JB=Is;function d2(e){this._context=e}d2.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,qr);break}}},result:Er};var e3=new fn,t3,NC,DC,d0,h0,h2={point:Er,lineStart:function(){h2.point=nnt},lineEnd:function(){t3&&LC(NC,DC),h2.point=Er},polygonStart:function(){t3=!0},polygonEnd:function(){t3=null},result:function(){var e=+e3;return e3=new fn,e}};function nnt(e,t){h2.point=LC,NC=d0=e,DC=h0=t}function LC(e,t){d0-=e,h0-=t,e3.add(De(d0*d0+h0*h0)),d0=e,h0=t}var r3=h2;var RC,p2,kC,CC,Vh=class{constructor(t){this._append=t==null?UC:int(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,r){switch(this._point){case 0:{this._append`M${t},${r}`,this._point=1;break}case 1:{this._append`L${t},${r}`;break}default:{if(this._append`M${t},${r}`,this._radius!==kC||this._append!==p2){let n=this._radius,i=this._;this._="",this._append`m0,${n}a${n},${n} 0 1,1 0,${-2*n}a${n},${n} 0 1,1 0,${2*n}z`,kC=n,p2=this._append,CC=this._,this._=i}this._+=CC;break}}}result(){let t=this._;return this._="",t.length?t:null}};function UC(e){let t=1;this._+=e[0];for(let r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function int(e){let t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return UC;if(t!==RC){let r=10**t;RC=t,p2=function(i){let o=1;this._+=i[0];for(let s=i.length;o<s;++o)this._+=Math.round(arguments[o]*r)/r+i[o]}}return p2}function mn(e,t){let r=3,n=4.5,i,o;function s(a){return a&&(typeof n=="function"&&o.pointRadius(+n.apply(this,arguments)),Wi(a,i(o))),o.result()}return s.area=function(a){return Wi(a,i(XB)),XB.result()},s.measure=function(a){return Wi(a,i(r3)),r3.result()},s.bounds=function(a){return Wi(a,i($h)),$h.result()},s.centroid=function(a){return Wi(a,i(JB)),JB.result()},s.projection=function(a){return arguments.length?(i=a==null?(e=null,c0):(e=a).stream,s):e},s.context=function(a){return arguments.length?(o=a==null?(t=null,new Vh(r)):new d2(t=a),typeof n!="function"&&o.pointRadius(n),s):t},s.pointRadius=function(a){return arguments.length?(n=typeof a=="function"?a:(o.pointRadius(+a),+a),s):n},s.digits=function(a){if(!arguments.length)return r;if(a==null)r=null;else{let c=Math.floor(a);if(!(c>=0))throw new RangeError(`invalid digits: ${a}`);r=c}return t===null&&(o=new Vh(r)),s},s.projection(e).digits(r).context(t)}function Rf(e){return{stream:jh(e)}}function jh(e){return function(t){var r=new n3;for(var n in e)r[n]=e[n];return r.stream=t,r}}function n3(){}n3.prototype={constructor:n3,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function i3(e,t,r){var n=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),n!=null&&e.clipExtent(null),Wi(r,e.stream($h)),t($h.result()),n!=null&&e.clipExtent(n),e}function p0(e,t,r){return i3(e,function(n){var i=t[1][0]-t[0][0],o=t[1][1]-t[0][1],s=Math.min(i/(n[1][0]-n[0][0]),o/(n[1][1]-n[0][1])),a=+t[0][0]+(i-s*(n[1][0]+n[0][0]))/2,c=+t[0][1]+(o-s*(n[1][1]+n[0][1]))/2;e.scale(150*s).translate([a,c])},r)}function m2(e,t,r){return p0(e,[[0,0],t],r)}function y2(e,t,r){return i3(e,function(n){var i=+t,o=i/(n[1][0]-n[0][0]),s=(i-o*(n[1][0]+n[0][0]))/2,a=-o*n[0][1];e.scale(150*o).translate([s,a])},r)}function g2(e,t,r){return i3(e,function(n){var i=+t,o=i/(n[1][1]-n[0][1]),s=-o*n[0][0],a=(i-o*(n[1][1]+n[0][1]))/2;e.scale(150*o).translate([s,a])},r)}var PC=16,ont=et(30*ie);function o3(e,t){return+t?ant(e,t):snt(e)}function snt(e){return jh({point:function(t,r){t=e(t,r),this.stream.point(t[0],t[1])}})}function ant(e,t){function r(n,i,o,s,a,c,l,u,f,d,h,p,m,g){var y=l-n,b=u-i,x=y*y+b*b;if(x>4*t&&m--){var _=s+d,w=a+h,v=c+p,A=De(_*_+w*w+v*v),B=Xe(v/=A),D=Vt(Vt(v)-1)<nt||Vt(o-f)<nt?(o+f)/2:Mr(w,_),T=e(D,B),M=T[0],O=T[1],L=M-n,S=O-i,E=b*L-y*S;(E*E/x>t||Vt((y*L+b*S)/x-.5)>.3||s*d+a*h+c*p<ont)&&(r(n,i,o,s,a,c,M,O,D,_/=A,w/=A,v,m,g),g.point(M,O),r(M,O,D,_,w,v,l,u,f,d,h,p,m,g))}}return function(n){var i,o,s,a,c,l,u,f,d,h,p,m,g={point:y,lineStart:b,lineEnd:_,polygonStart:function(){n.polygonStart(),g.lineStart=w},polygonEnd:function(){n.polygonEnd(),g.lineStart=b}};function y(B,D){B=e(B,D),n.point(B[0],B[1])}function b(){f=NaN,g.point=x,n.lineStart()}function x(B,D){var T=da([B,D]),M=e(B,D);r(f,d,u,h,p,m,f=M[0],d=M[1],u=B,h=T[0],p=T[1],m=T[2],PC,n),n.point(f,d)}function _(){g.point=y,n.lineEnd()}function w(){b(),g.point=v,g.lineEnd=A}function v(B,D){x(i=B,D),o=f,s=d,a=h,c=p,l=m,g.point=x}function A(){r(f,d,u,h,p,m,o,s,i,a,c,l,PC,n),g.lineEnd=_,_()}return g}}var cnt=jh({point:function(e,t){this.stream.point(e*ie,t*ie)}});function lnt(e){return jh({point:function(t,r){var n=e(t,r);return this.stream.point(n[0],n[1])}})}function unt(e,t,r,n,i){function o(s,a){return s*=n,a*=i,[t+e*s,r-e*a]}return o.invert=function(s,a){return[(s-t)/e*n,(r-a)/e*i]},o}function $C(e,t,r,n,i,o){if(!o)return unt(e,t,r,n,i);var s=et(o),a=J(o),c=s*e,l=a*e,u=s/e,f=a/e,d=(a*r-s*t)/e,h=(a*t+s*r)/e;function p(m,g){return m*=n,g*=i,[c*m-l*g+t,r-l*m-c*g]}return p.invert=function(m,g){return[n*(u*m-f*g+d),i*(h-f*m-u*g)]},p}function yn(e){return s3(function(){return e})()}function s3(e){var t,r=150,n=480,i=250,o=0,s=0,a=0,c=0,l=0,u,f=0,d=1,h=1,p=null,m=zB,g=null,y,b,x,_=c0,w=.5,v,A,B,D,T;function M(E){return B(E[0]*ie,E[1]*ie)}function O(E){return E=B.invert(E[0],E[1]),E&&[E[0]*ur,E[1]*ur]}M.stream=function(E){return D&&T===E?D:D=cnt(lnt(u)(m(v(_(T=E)))))},M.preclip=function(E){return arguments.length?(m=E,p=void 0,S()):m},M.postclip=function(E){return arguments.length?(_=E,g=y=b=x=null,S()):_},M.clipAngle=function(E){return arguments.length?(m=+E?_C(p=E*ie):(p=null,zB),S()):p*ur},M.clipExtent=function(E){return arguments.length?(_=E==null?(g=y=b=x=null,c0):Uh(g=+E[0][0],y=+E[0][1],b=+E[1][0],x=+E[1][1]),S()):g==null?null:[[g,y],[b,x]]},M.scale=function(E){return arguments.length?(r=+E,L()):r},M.translate=function(E){return arguments.length?(n=+E[0],i=+E[1],L()):[n,i]},M.center=function(E){return arguments.length?(o=E[0]%360*ie,s=E[1]%360*ie,L()):[o*ur,s*ur]},M.rotate=function(E){return arguments.length?(a=E[0]%360*ie,c=E[1]%360*ie,l=E.length>2?E[2]%360*ie:0,L()):[a*ur,c*ur,l*ur]},M.angle=function(E){return arguments.length?(f=E%360*ie,L()):f*ur},M.reflectX=function(E){return arguments.length?(d=E?-1:1,L()):d<0},M.reflectY=function(E){return arguments.length?(h=E?-1:1,L()):h<0},M.precision=function(E){return arguments.length?(v=o3(A,w=E*E),S()):De(w)},M.fitExtent=function(E,I){return p0(M,E,I)},M.fitSize=function(E,I){return m2(M,E,I)},M.fitWidth=function(E,I){return y2(M,E,I)},M.fitHeight=function(E,I){return g2(M,E,I)};function L(){var E=$C(r,0,0,d,h,f).apply(null,t(o,s)),I=$C(r,n-E[0],i-E[1],d,h,f);return u=PB(a,c,l),A=s0(t,I),B=s0(u,A),v=o3(A,w),S()}function S(){return D=T=null,M}return function(){return t=e.apply(this,arguments),M.invert=t.invert&&O,L()}}function qh(e){var t=0,r=St/3,n=s3(e),i=n(t,r);return i.parallels=function(o){return arguments.length?n(t=o[0]*ie,r=o[1]*ie):[t*ur,r*ur]},i}function zC(e){var t=et(e);function r(n,i){return[n*t,J(i)/t]}return r.invert=function(n,i){return[n/t,Xe(i*t)]},r}function VC(e,t){var r=J(e),n=(r+J(t))/2;if(Vt(n)<nt)return zC(e);var i=1+r*(2*n-r),o=De(i)/n;function s(a,c){var l=De(i-2*n*J(c))/n;return[l*J(a*=n),o-l*et(a)]}return s.invert=function(a,c){var l=o-c,u=Mr(a,Vt(l))*Mn(l);return l*n<0&&(u-=St*Mn(a)*Mn(l)),[u/n,Xe((i-(a*a+l*l)*n*n)/(2*n))]},s}function Jl(){return qh(VC).scale(155.424).center([0,33.6442])}function m0(){return Jl().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function fnt(e){var t=e.length;return{point:function(r,n){for(var i=-1;++i<t;)e[i].point(r,n)},sphere:function(){for(var r=-1;++r<t;)e[r].sphere()},lineStart:function(){for(var r=-1;++r<t;)e[r].lineStart()},lineEnd:function(){for(var r=-1;++r<t;)e[r].lineEnd()},polygonStart:function(){for(var r=-1;++r<t;)e[r].polygonStart()},polygonEnd:function(){for(var r=-1;++r<t;)e[r].polygonEnd()}}}function a3(){var e,t,r=m0(),n,i=Jl().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o,s=Jl().rotate([157,0]).center([-3,19.9]).parallels([8,18]),a,c,l={point:function(d,h){c=[d,h]}};function u(d){var h=d[0],p=d[1];return c=null,n.point(h,p),c||(o.point(h,p),c)||(a.point(h,p),c)}u.invert=function(d){var h=r.scale(),p=r.translate(),m=(d[0]-p[0])/h,g=(d[1]-p[1])/h;return(g>=.12&&g<.234&&m>=-.425&&m<-.214?i:g>=.166&&g<.234&&m>=-.214&&m<-.115?s:r).invert(d)},u.stream=function(d){return e&&t===d?e:e=fnt([r.stream(t=d),i.stream(d),s.stream(d)])},u.precision=function(d){return arguments.length?(r.precision(d),i.precision(d),s.precision(d),f()):r.precision()},u.scale=function(d){return arguments.length?(r.scale(d),i.scale(d*.35),s.scale(d),u.translate(r.translate())):r.scale()},u.translate=function(d){if(!arguments.length)return r.translate();var h=r.scale(),p=+d[0],m=+d[1];return n=r.translate(d).clipExtent([[p-.455*h,m-.238*h],[p+.455*h,m+.238*h]]).stream(l),o=i.translate([p-.307*h,m+.201*h]).clipExtent([[p-.425*h+nt,m+.12*h+nt],[p-.214*h-nt,m+.234*h-nt]]).stream(l),a=s.translate([p-.205*h,m+.212*h]).clipExtent([[p-.214*h+nt,m+.166*h+nt],[p-.115*h-nt,m+.234*h-nt]]).stream(l),f()},u.fitExtent=function(d,h){return p0(u,d,h)},u.fitSize=function(d,h){return m2(u,d,h)},u.fitWidth=function(d,h){return y2(u,d,h)},u.fitHeight=function(d,h){return g2(u,d,h)};function f(){return e=t=null,u}return u.scale(1070)}function b2(e){return function(t,r){var n=et(t),i=et(r),o=e(n*i);return o===1/0?[2,0]:[o*i*J(t),o*J(r)]}}function ma(e){return function(t,r){var n=De(t*t+r*r),i=e(n),o=J(i),s=et(i);return[Mr(t*o,n*s),Xe(n&&r*o/n)]}}var c3=b2(function(e){return De(2/(1+e))});c3.invert=ma(function(e){return 2*Xe(e/2)});function l3(){return yn(c3).scale(124.75).clipAngle(180-.001)}var u3=b2(function(e){return(e=Gv(e))&&e/J(e)});u3.invert=ma(function(e){return e});function f3(){return yn(u3).scale(79.4188).clipAngle(180-.001)}function Yh(e,t){return[e,Df(Rh((Ne+t)/2))]}Yh.invert=function(e,t){return[e,2*Oo(qv(t))-Ne]};function d3(){return h3(Yh).scale(961/qr)}function h3(e){var t=yn(e),r=t.center,n=t.scale,i=t.translate,o=t.clipExtent,s=null,a,c,l;t.scale=function(f){return arguments.length?(n(f),u()):n()},t.translate=function(f){return arguments.length?(i(f),u()):i()},t.center=function(f){return arguments.length?(r(f),u()):r()},t.clipExtent=function(f){return arguments.length?(f==null?s=a=c=l=null:(s=+f[0][0],a=+f[0][1],c=+f[1][0],l=+f[1][1]),u()):s==null?null:[[s,a],[c,l]]};function u(){var f=St*n(),d=t(mC(t.rotate()).invert([0,0]));return o(s==null?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===Yh?[[Math.max(d[0]-f,s),a],[Math.min(d[0]+f,c),l]]:[[s,Math.max(d[1]-f,a)],[c,Math.min(d[1]+f,l)]])}return u()}function x2(e){return Rh((Ne+e)/2)}function jC(e,t){var r=et(e),n=e===t?J(e):Df(r/et(t))/Df(x2(t)/x2(e)),i=r*Wv(x2(e),n)/n;if(!n)return Yh;function o(s,a){i>0?a<-Ne+nt&&(a=-Ne+nt):a>Ne-nt&&(a=Ne-nt);var c=i/Wv(x2(a),n);return[c*J(n*s),i-c*et(n*s)]}return o.invert=function(s,a){var c=i-a,l=Mn(n)*De(s*s+c*c),u=Mr(s,Vt(c))*Mn(c);return c*n<0&&(u-=St*Mn(s)*Mn(c)),[u/n,2*Oo(Wv(i/l,1/n))-Ne]},o}function p3(){return qh(jC).scale(109.5).parallels([30,30])}function Wh(e,t){return[e,t]}Wh.invert=Wh;function m3(){return yn(Wh).scale(152.63)}function qC(e,t){var r=et(e),n=e===t?J(e):(r-et(t))/(t-e),i=r/n+e;if(Vt(n)<nt)return Wh;function o(s,a){var c=i-a,l=n*s;return[c*J(l),i-c*et(l)]}return o.invert=function(s,a){var c=i-a,l=Mr(s,Vt(c))*Mn(c);return c*n<0&&(l-=St*Mn(s)*Mn(c)),[l/n,i-Mn(n)*De(s*s+c*c)]},o}function y3(){return qh(qC).scale(131.154).center([0,13.9389])}var y0=1.340264,g0=-.081106,b0=893e-6,x0=.003796,_2=De(3)/2,dnt=12;function g3(e,t){var r=Xe(_2*J(t)),n=r*r,i=n*n*n;return[e*et(r)/(_2*(y0+3*g0*n+i*(7*b0+9*x0*n))),r*(y0+g0*n+i*(b0+x0*n))]}g3.invert=function(e,t){for(var r=t,n=r*r,i=n*n*n,o=0,s,a,c;o<dnt&&(a=r*(y0+g0*n+i*(b0+x0*n))-t,c=y0+3*g0*n+i*(7*b0+9*x0*n),r-=s=a/c,n=r*r,i=n*n*n,!(Vt(s)<Nf));++o);return[_2*e*(y0+3*g0*n+i*(7*b0+9*x0*n))/et(r),Xe(J(r)/_2)]};function b3(){return yn(g3).scale(177.158)}function x3(e,t){var r=et(t),n=et(e)*r;return[r*J(e)/n,J(t)/n]}x3.invert=ma(Oo);function _3(){return yn(x3).scale(144.049).clipAngle(60)}function w3(e,t){return[et(t)*J(e),J(t)]}w3.invert=ma(Xe);function v3(){return yn(w3).scale(249.5).clipAngle(90+nt)}function S3(e,t){var r=et(t),n=1+et(e)*r;return[r*J(e)/n,J(t)/n]}S3.invert=ma(function(e){return 2*Oo(e)});function I3(){return yn(S3).scale(250).clipAngle(142)}function T3(e,t){return[Df(Rh((Ne+t)/2)),-e]}T3.invert=function(e,t){return[-t,2*Oo(qv(e))-Ne]};function A3(){var e=h3(T3),t=e.center,r=e.rotate;return e.center=function(n){return arguments.length?t([-n[1],n[0]]):(n=t(),[n[1],-n[0]])},e.rotate=function(n){return arguments.length?r([n[0],n[1],n.length>2?n[2]+90:90]):(n=r(),[n[0],n[1],n[2]-90])},r([0,0,90]).scale(159.155)}function hnt(e,t){return e.parent===t.parent?1:2}function pnt(e){return e.reduce(mnt,0)/e.length}function mnt(e,t){return e+t.x}function ynt(e){return 1+e.reduce(gnt,0)}function gnt(e,t){return Math.max(e,t.y)}function bnt(e){for(var t;t=e.children;)e=t[0];return e}function xnt(e){for(var t;t=e.children;)e=t[t.length-1];return e}function M3(){var e=hnt,t=1,r=1,n=!1;function i(o){var s,a=0;o.eachAfter(function(d){var h=d.children;h?(d.x=pnt(h),d.y=ynt(h)):(d.x=s?a+=e(d,s):0,d.y=0,s=d)});var c=bnt(o),l=xnt(o),u=c.x-e(c,l)/2,f=l.x+e(l,c)/2;return o.eachAfter(n?function(d){d.x=(d.x-o.x)*t,d.y=(o.y-d.y)*r}:function(d){d.x=(d.x-u)/(f-u)*t,d.y=(1-(o.y?d.y/o.y:1))*r})}return i.separation=function(o){return arguments.length?(e=o,i):e},i.size=function(o){return arguments.length?(n=!1,t=+o[0],r=+o[1],i):n?null:[t,r]},i.nodeSize=function(o){return arguments.length?(n=!0,t=+o[0],r=+o[1],i):n?[t,r]:null},i}function _nt(e){var t=0,r=e.children,n=r&&r.length;if(!n)t=1;else for(;--n>=0;)t+=r[n].value;e.value=t}function YC(){return this.eachAfter(_nt)}function WC(e,t){let r=-1;for(let n of this)e.call(t,n,++r,this);return this}function GC(e,t){for(var r=this,n=[r],i,o,s=-1;r=n.pop();)if(e.call(t,r,++s,this),i=r.children)for(o=i.length-1;o>=0;--o)n.push(i[o]);return this}function XC(e,t){for(var r=this,n=[r],i=[],o,s,a,c=-1;r=n.pop();)if(i.push(r),o=r.children)for(s=0,a=o.length;s<a;++s)n.push(o[s]);for(;r=i.pop();)e.call(t,r,++c,this);return this}function HC(e,t){let r=-1;for(let n of this)if(e.call(t,n,++r,this))return n}function ZC(e){return this.eachAfter(function(t){for(var r=+e(t.data)||0,n=t.children,i=n&&n.length;--i>=0;)r+=n[i].value;t.value=r})}function KC(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function QC(e){for(var t=this,r=wnt(t,e),n=[t];t!==r;)t=t.parent,n.push(t);for(var i=n.length;e!==r;)n.splice(i,0,e),e=e.parent;return n}function wnt(e,t){if(e===t)return e;var r=e.ancestors(),n=t.ancestors(),i=null;for(e=r.pop(),t=n.pop();e===t;)i=e,e=r.pop(),t=n.pop();return i}function JC(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function tU(){return Array.from(this)}function eU(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function rU(){var e=this,t=[];return e.each(function(r){r!==e&&t.push({source:r.parent,target:r})}),t}function*nU(){var e=this,t,r=[e],n,i,o;do for(t=r.reverse(),r=[];e=t.pop();)if(yield e,n=e.children)for(i=0,o=n.length;i<o;++i)r.push(n[i]);while(r.length)}function E3(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=Int)):t===void 0&&(t=Snt);for(var r=new tu(e),n,i=[r],o,s,a,c;n=i.pop();)if((s=t(n.data))&&(c=(s=Array.from(s)).length))for(n.children=s,a=c-1;a>=0;--a)i.push(o=s[a]=new tu(s[a])),o.parent=n,o.depth=n.depth+1;return r.eachBefore(B3)}function vnt(){return E3(this).eachBefore(Tnt)}function Snt(e){return e.children}function Int(e){return Array.isArray(e)?e[1]:null}function Tnt(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function B3(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function tu(e){this.data=e,this.depth=this.height=0,this.parent=null}tu.prototype=E3.prototype={constructor:tu,count:YC,each:WC,eachAfter:XC,eachBefore:GC,find:HC,sum:ZC,sort:KC,path:QC,ancestors:JC,descendants:tU,leaves:eU,links:rU,copy:vnt,[Symbol.iterator]:nU};function w2(e){return e==null?null:Ant(e)}function Ant(e){if(typeof e!="function")throw new Error;return e}var Mnt={depth:-1},iU={},O3={};function Ent(e){return e.id}function Bnt(e){return e.parentId}function v2(){var e=Ent,t=Bnt,r;function n(i){var o=Array.from(i),s=e,a=t,c,l,u,f,d,h,p,m,g=new Map;if(r!=null){let y=o.map((_,w)=>Ont(r(_,w,i))),b=y.map(oU),x=new Set(y).add("");for(let _ of b)x.has(_)||(x.add(_),y.push(_),b.push(oU(_)),o.push(O3));s=(_,w)=>y[w],a=(_,w)=>b[w]}for(u=0,c=o.length;u<c;++u)l=o[u],h=o[u]=new tu(l),(p=s(l,u,i))!=null&&(p+="")&&(m=h.id=p,g.set(m,g.has(m)?iU:h)),(p=a(l,u,i))!=null&&(p+="")&&(h.parent=p);for(u=0;u<c;++u)if(h=o[u],p=h.parent){if(d=g.get(p),!d)throw new Error("missing: "+p);if(d===iU)throw new Error("ambiguous: "+p);d.children?d.children.push(h):d.children=[h],h.parent=d}else{if(f)throw new Error("multiple roots");f=h}if(!f)throw new Error("no root");if(r!=null){for(;f.data===O3&&f.children.length===1;)f=f.children[0],--c;for(let y=o.length-1;y>=0&&(h=o[y],h.data===O3);--y)h.data=null}if(f.parent=Mnt,f.eachBefore(function(y){y.depth=y.parent.depth+1,--c}).eachBefore(B3),f.parent=null,c>0)throw new Error("cycle");return f}return n.id=function(i){return arguments.length?(e=w2(i),n):e},n.parentId=function(i){return arguments.length?(t=w2(i),n):t},n.path=function(i){return arguments.length?(r=w2(i),n):r},n}function Ont(e){e=`${e}`;let t=e.length;return F3(e,t-1)&&!F3(e,t-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function oU(e){let t=e.length;if(t<2)return"";for(;--t>1&&!F3(e,t););return e.slice(0,t)}function F3(e,t){if(e[t]==="/"){let r=0;for(;t>0&&e[--t]==="\\";)++r;if(!(r&1))return!0}return!1}function Fnt(e,t){return e.parent===t.parent?1:2}function N3(e){var t=e.children;return t?t[0]:e.t}function D3(e){var t=e.children;return t?t[t.length-1]:e.t}function Nnt(e,t,r){var n=r/(t.i-e.i);t.c-=n,t.s+=r,e.c+=n,t.z+=r,t.m+=r}function Dnt(e){for(var t=0,r=0,n=e.children,i=n.length,o;--i>=0;)o=n[i],o.z+=t,o.m+=t,t+=o.s+(r+=o.c)}function Lnt(e,t,r){return e.a.parent===t.parent?e.a:r}function S2(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}S2.prototype=Object.create(tu.prototype);function Rnt(e){for(var t=new S2(e,0),r,n=[t],i,o,s,a;r=n.pop();)if(o=r._.children)for(r.children=new Array(a=o.length),s=a-1;s>=0;--s)n.push(i=r.children[s]=new S2(o[s],s)),i.parent=r;return(t.parent=new S2(null,0)).children=[t],t}function I2(){var e=Fnt,t=1,r=1,n=null;function i(l){var u=Rnt(l);if(u.eachAfter(o),u.parent.m=-u.z,u.eachBefore(s),n)l.eachBefore(c);else{var f=l,d=l,h=l;l.eachBefore(function(b){b.x<f.x&&(f=b),b.x>d.x&&(d=b),b.depth>h.depth&&(h=b)});var p=f===d?1:e(f,d)/2,m=p-f.x,g=t/(d.x+p+m),y=r/(h.depth||1);l.eachBefore(function(b){b.x=(b.x+m)*g,b.y=b.depth*y})}return l}function o(l){var u=l.children,f=l.parent.children,d=l.i?f[l.i-1]:null;if(u){Dnt(l);var h=(u[0].z+u[u.length-1].z)/2;d?(l.z=d.z+e(l._,d._),l.m=l.z-h):l.z=h}else d&&(l.z=d.z+e(l._,d._));l.parent.A=a(l,d,l.parent.A||f[0])}function s(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function a(l,u,f){if(u){for(var d=l,h=l,p=u,m=d.parent.children[0],g=d.m,y=h.m,b=p.m,x=m.m,_;p=D3(p),d=N3(d),p&&d;)m=N3(m),h=D3(h),h.a=l,_=p.z+b-d.z-g+e(p._,d._),_>0&&(Nnt(Lnt(p,l,f),l,_),g+=_,y+=_),b+=p.m,g+=d.m,x+=m.m,y+=h.m;p&&!D3(h)&&(h.t=p,h.m+=b-y),d&&!N3(m)&&(m.t=d,m.m+=g-x,f=l)}return f}function c(l){l.x*=t,l.y=l.depth*r}return i.separation=function(l){return arguments.length?(e=l,i):e},i.size=function(l){return arguments.length?(n=!1,t=+l[0],r=+l[1],i):n?null:[t,r]},i.nodeSize=function(l){return arguments.length?(n=!0,t=+l[0],r=+l[1],i):n?[t,r]:null},i}var sU=23283064365386963e-26;function kf(e=Math.random()){let t=(0<=e&&e<1?e/sU:Math.abs(e))|0;return()=>(t=1664525*t+1013904223|0,sU*(t>>>0))}function Br(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function _0(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}var w0=Symbol("implicit");function Cf(){var e=new $n,t=[],r=[],n=w0;function i(o){let s=e.get(o);if(s===void 0){if(n!==w0)return n;e.set(o,s=t.push(o)-1)}return r[s%r.length]}return i.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new $n;for(let s of o)e.has(s)||e.set(s,t.push(s)-1);return i},i.range=function(o){return arguments.length?(r=Array.from(o),i):r.slice()},i.unknown=function(o){return arguments.length?(n=o,i):n},i.copy=function(){return Cf(t,r).unknown(n)},Br.apply(i,arguments),i}function eu(){var e=Cf().unknown(void 0),t=e.domain,r=e.range,n=0,i=1,o,s,a=!1,c=0,l=0,u=.5;delete e.unknown;function f(){var d=t().length,h=i<n,p=h?i:n,m=h?n:i;o=(m-p)/Math.max(1,d-c+l*2),a&&(o=Math.floor(o)),p+=(m-p-o*(d-c))*u,s=o*(1-c),a&&(p=Math.round(p),s=Math.round(s));var g=xr(d).map(function(y){return p+o*y});return r(h?g.reverse():g)}return e.domain=function(d){return arguments.length?(t(d),f()):t()},e.range=function(d){return arguments.length?([n,i]=d,n=+n,i=+i,f()):[n,i]},e.rangeRound=function(d){return[n,i]=d,n=+n,i=+i,a=!0,f()},e.bandwidth=function(){return s},e.step=function(){return o},e.round=function(d){return arguments.length?(a=!!d,f()):a},e.padding=function(d){return arguments.length?(c=Math.min(1,l=+d),f()):c},e.paddingInner=function(d){return arguments.length?(c=Math.min(1,d),f()):c},e.paddingOuter=function(d){return arguments.length?(l=+d,f()):l},e.align=function(d){return arguments.length?(u=Math.max(0,Math.min(1,d)),f()):u},e.copy=function(){return eu(t(),[n,i]).round(a).paddingInner(c).paddingOuter(l).align(u)},Br.apply(f(),arguments)}function aU(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return aU(t())},e}function L3(){return aU(eu.apply(null,arguments).paddingInner(1))}function R3(e){return function(){return e}}function Gh(e){return+e}var cU=[0,1];function Ii(e){return e}function k3(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:R3(isNaN(t)?NaN:.5)}function knt(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function Cnt(e,t,r){var n=e[0],i=e[1],o=t[0],s=t[1];return i<n?(n=k3(i,n),o=r(s,o)):(n=k3(n,i),o=r(o,s)),function(a){return o(n(a))}}function Unt(e,t,r){var n=Math.min(e.length,t.length)-1,i=new Array(n),o=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)i[s]=k3(e[s],e[s+1]),o[s]=r(t[s],t[s+1]);return function(a){var c=Ic(e,a,1,n)-1;return o[c](i[c](a))}}function ya(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Uf(){var e=cU,t=cU,r=qi,n,i,o,s=Ii,a,c,l;function u(){var d=Math.min(e.length,t.length);return s!==Ii&&(s=knt(e[0],e[d-1])),a=d>2?Unt:Cnt,c=l=null,f}function f(d){return d==null||isNaN(d=+d)?o:(c||(c=a(e.map(n),t,r)))(n(s(d)))}return f.invert=function(d){return s(i((l||(l=a(t,e.map(n),Ge)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,Gh),u()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),u()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),r=Af,u()},f.clamp=function(d){return arguments.length?(s=d?!0:Ii,u()):s!==Ii},f.interpolate=function(d){return arguments.length?(r=d,u()):r},f.unknown=function(d){return arguments.length?(o=d,f):o},function(d,h){return n=d,i=h,u()}}function v0(){return Uf()(Ii,Ii)}function C3(e,t,r,n){var i=yh(e,t,r),o;switch(n=fa(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(o=BB(i,s))&&(n.precision=o),jv(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(o=OB(i,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=o-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(o=EB(i))&&(n.precision=o-(n.type==="%")*2);break}}return Bo(n)}function Lc(e){var t=e.domain;return e.ticks=function(r){var n=t();return dn(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var i=t();return C3(i[0],i[i.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),i=0,o=n.length-1,s=n[i],a=n[o],c,l,u=10;for(a<s&&(l=s,s=a,a=l,l=i,i=o,o=l);u-- >0;){if(l=Tc(s,a,r),l===c)return n[i]=s,n[o]=a,t(n);if(l>0)s=Math.floor(s/l)*l,a=Math.ceil(a/l)*l;else if(l<0)s=Math.ceil(s*l)/l,a=Math.floor(a*l)/l;else break;c=l}return e},e}function Rc(){var e=v0();return e.copy=function(){return ya(e,Rc())},Br.apply(e,arguments),Lc(e)}function S0(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Gh),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return S0(e).unknown(t)},e=arguments.length?Array.from(e,Gh):[0,1],Lc(r)}function I0(e,t){e=e.slice();var r=0,n=e.length-1,i=e[r],o=e[n],s;return o<i&&(s=r,r=n,n=s,s=i,i=o,o=s),e[r]=t.floor(i),e[n]=t.ceil(o),e}function lU(e){return Math.log(e)}function uU(e){return Math.exp(e)}function Pnt(e){return-Math.log(-e)}function $nt(e){return-Math.exp(-e)}function znt(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Vnt(e){return e===10?znt:e===Math.E?Math.exp:t=>Math.pow(e,t)}function jnt(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function fU(e){return(t,r)=>-e(-t,r)}function U3(e){let t=e(lU,uU),r=t.domain,n=10,i,o;function s(){return i=jnt(n),o=Vnt(n),r()[0]<0?(i=fU(i),o=fU(o),e(Pnt,$nt)):e(lU,uU),t}return t.base=function(a){return arguments.length?(n=+a,s()):n},t.domain=function(a){return arguments.length?(r(a),s()):r()},t.ticks=a=>{let c=r(),l=c[0],u=c[c.length-1],f=u<l;f&&([l,u]=[u,l]);let d=i(l),h=i(u),p,m,g=a==null?10:+a,y=[];if(!(n%1)&&h-d<g){if(d=Math.floor(d),h=Math.ceil(h),l>0){for(;d<=h;++d)for(p=1;p<n;++p)if(m=d<0?p/o(-d):p*o(d),!(m<l)){if(m>u)break;y.push(m)}}else for(;d<=h;++d)for(p=n-1;p>=1;--p)if(m=d>0?p/o(-d):p*o(d),!(m<l)){if(m>u)break;y.push(m)}y.length*2<g&&(y=dn(l,u,g))}else y=dn(d,h,Math.min(h-d,g)).map(o);return f?y.reverse():y},t.tickFormat=(a,c)=>{if(a==null&&(a=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=fa(c)).precision==null&&(c.trim=!0),c=Bo(c)),a===1/0)return c;let l=Math.max(1,n*a/t.ticks().length);return u=>{let f=u/o(Math.round(i(u)));return f*n<n-.5&&(f*=n),f<=l?c(u):""}},t.nice=()=>r(I0(r(),{floor:a=>o(Math.floor(i(a))),ceil:a=>o(Math.ceil(i(a)))})),t}function T0(){let e=U3(Uf()).domain([1,10]);return e.copy=()=>ya(e,T0()).base(e.base()),Br.apply(e,arguments),e}function dU(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function hU(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function P3(e){var t=1,r=e(dU(t),hU(t));return r.constant=function(n){return arguments.length?e(dU(t=+n),hU(t)):t},Lc(r)}function A0(){var e=P3(Uf());return e.copy=function(){return ya(e,A0()).constant(e.constant())},Br.apply(e,arguments)}function pU(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function qnt(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Ynt(e){return e<0?-e*e:e*e}function $3(e){var t=e(Ii,Ii),r=1;function n(){return r===1?e(Ii,Ii):r===.5?e(qnt,Ynt):e(pU(r),pU(1/r))}return t.exponent=function(i){return arguments.length?(r=+i,n()):r},Lc(t)}function M0(){var e=$3(Uf());return e.copy=function(){return ya(e,M0()).exponent(e.exponent())},Br.apply(e,arguments),e}function E0(){var e=[],t=[],r=[],n;function i(){var s=0,a=Math.max(1,t.length);for(r=new Array(a-1);++s<a;)r[s-1]=UE(e,s/a);return o}function o(s){return s==null||isNaN(s=+s)?n:t[Ic(r,s)]}return o.invertExtent=function(s){var a=t.indexOf(s);return a<0?[NaN,NaN]:[a>0?r[a-1]:e[0],a<r.length?r[a]:e[e.length-1]]},o.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let a of s)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(be),i()},o.range=function(s){return arguments.length?(t=Array.from(s),i()):t.slice()},o.unknown=function(s){return arguments.length?(n=s,o):n},o.quantiles=function(){return r.slice()},o.copy=function(){return E0().domain(e).range(t).unknown(n)},Br.apply(o,arguments)}function B0(){var e=[.5],t=[0,1],r,n=1;function i(o){return o!=null&&o<=o?t[Ic(e,o,0,n)]:r}return i.domain=function(o){return arguments.length?(e=Array.from(o),n=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(o){return arguments.length?(t=Array.from(o),n=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(o){var s=t.indexOf(o);return[e[s-1],e[s]]},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return B0().domain(e).range(t).unknown(r)},Br.apply(i,arguments)}var z3=new Date,V3=new Date;function Re(e,t,r,n){function i(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=o=>(e(o=new Date(+o)),o),i.ceil=o=>(e(o=new Date(o-1)),t(o,1),e(o),o),i.round=o=>{let s=i(o),a=i.ceil(o);return o-s<a-o?s:a},i.offset=(o,s)=>(t(o=new Date(+o),s==null?1:Math.floor(s)),o),i.range=(o,s,a)=>{let c=[];if(o=i.ceil(o),a=a==null?1:Math.floor(a),!(o<s)||!(a>0))return c;let l;do c.push(l=new Date(+o)),t(o,a),e(o);while(l<o&&o<s);return c},i.filter=o=>Re(s=>{if(s>=s)for(;e(s),!o(s);)s.setTime(s-1)},(s,a)=>{if(s>=s)if(a<0)for(;++a<=0;)for(;t(s,-1),!o(s););else for(;--a>=0;)for(;t(s,1),!o(s););}),r&&(i.count=(o,s)=>(z3.setTime(+o),V3.setTime(+s),e(z3),e(V3),Math.floor(r(z3,V3))),i.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(n?s=>n(s)%o===0:s=>i.count(0,s)%o===0):i)),i}var O0=Re(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);O0.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Re(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):O0);var m9t=O0.range;var En=Re(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*1e3)},(e,t)=>(t-e)/1e3,e=>e.getUTCSeconds()),mU=En.range;var ru=Re(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*1e3)},(e,t)=>{e.setTime(+e+t*6e4)},(e,t)=>(t-e)/6e4,e=>e.getMinutes()),Wnt=ru.range,nu=Re(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*6e4)},(e,t)=>(t-e)/6e4,e=>e.getUTCMinutes()),Gnt=nu.range;var iu=Re(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*1e3-e.getMinutes()*6e4)},(e,t)=>{e.setTime(+e+t*36e5)},(e,t)=>(t-e)/36e5,e=>e.getHours()),Xnt=iu.range,ou=Re(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*36e5)},(e,t)=>(t-e)/36e5,e=>e.getUTCHours()),Hnt=ou.range;var Ts=Re(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*6e4)/864e5,e=>e.getDate()-1),Znt=Ts.range,zf=Re(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>e.getUTCDate()-1),Knt=zf.range,Xh=Re(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>Math.floor(e/864e5)),Qnt=Xh.range;function Vf(e){return Re(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*6e4)/6048e5)}var Gi=Vf(0),su=Vf(1),T2=Vf(2),A2=Vf(3),ba=Vf(4),M2=Vf(5),E2=Vf(6),gU=Gi.range,Jnt=su.range,tit=T2.range,eit=A2.range,rit=ba.range,nit=M2.range,iit=E2.range;function jf(e){return Re(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/6048e5)}var Xi=jf(0),au=jf(1),B2=jf(2),O2=jf(3),xa=jf(4),F2=jf(5),N2=jf(6),bU=Xi.range,oit=au.range,sit=B2.range,ait=O2.range,cit=xa.range,lit=F2.range,uit=N2.range;var cu=Re(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth()),fit=cu.range,lu=Re(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth()),dit=lu.range;var Bn=Re(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Bn.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Re(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});var hit=Bn.range,On=Re(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());On.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Re(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});var pit=On.range;function _U(e,t,r,n,i,o){let s=[[En,1,1e3],[En,5,5*1e3],[En,15,15*1e3],[En,30,30*1e3],[o,1,6e4],[o,5,5*6e4],[o,15,15*6e4],[o,30,30*6e4],[i,1,36e5],[i,3,3*36e5],[i,6,6*36e5],[i,12,12*36e5],[n,1,864e5],[n,2,2*864e5],[r,1,6048e5],[t,1,2592e6],[t,3,3*2592e6],[e,1,31536e6]];function a(l,u,f){let d=u<l;d&&([l,u]=[u,l]);let h=f&&typeof f.range=="function"?f:c(l,u,f),p=h?h.range(l,+u+1):[];return d?p.reverse():p}function c(l,u,f){let d=Math.abs(u-l)/f,h=yf(([,,g])=>g).right(s,d);if(h===s.length)return e.every(yh(l/31536e6,u/31536e6,f));if(h===0)return O0.every(Math.max(yh(l,u,f),1));let[p,m]=s[d/s[h-1][2]<s[h][2]/d?h-1:h];return p.every(m)}return[a,c]}var[j3,N0]=_U(On,lu,Xi,Xh,ou,nu),[q3,Y3]=_U(Bn,cu,Gi,Ts,iu,ru);function W3(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function G3(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function D0(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function X3(e){var t=e.dateTime,r=e.date,n=e.time,i=e.periods,o=e.days,s=e.shortDays,a=e.months,c=e.shortMonths,l=L0(i),u=R0(i),f=L0(o),d=R0(o),h=L0(s),p=R0(s),m=L0(a),g=R0(a),y=L0(c),b=R0(c),x={a:F,A:C,b:U,B:$,c:null,d:AU,e:AU,f:Uit,g:Xit,G:Zit,H:Rit,I:kit,j:Cit,L:FU,m:Pit,M:$it,p:q,q:j,Q:BU,s:OU,S:zit,u:Vit,U:jit,V:qit,w:Yit,W:Wit,x:null,X:null,y:Git,Y:Hit,Z:Kit,"%":EU},_={a:rt,A:ot,b:Gt,B:at,c:null,d:MU,e:MU,f:eot,g:fot,G:hot,H:Qit,I:Jit,j:tot,L:DU,m:rot,M:not,p:Q,q:Z,Q:BU,s:OU,S:iot,u:oot,U:sot,V:aot,w:cot,W:lot,x:null,X:null,y:uot,Y:dot,Z:pot,"%":EU},w={a:T,A:M,b:O,B:L,c:S,d:IU,e:IU,f:Fit,g:SU,G:vU,H:TU,I:TU,j:Mit,L:Oit,m:Ait,M:Eit,p:D,q:Tit,Q:Dit,s:Lit,S:Bit,u:_it,U:wit,V:vit,w:xit,W:Sit,x:E,X:I,y:SU,Y:vU,Z:Iit,"%":Nit};x.x=v(r,x),x.X=v(n,x),x.c=v(t,x),_.x=v(r,_),_.X=v(n,_),_.c=v(t,_);function v(V,H){return function(tt){var z=[],ut=-1,Lt=0,Ie=V.length,le,st,Le;for(tt instanceof Date||(tt=new Date(+tt));++ut<Ie;)V.charCodeAt(ut)===37&&(z.push(V.slice(Lt,ut)),(st=wU[le=V.charAt(++ut)])!=null?le=V.charAt(++ut):st=le==="e"?" ":"0",(Le=H[le])&&(le=Le(tt,st)),z.push(le),Lt=ut+1);return z.push(V.slice(Lt,ut)),z.join("")}}function A(V,H){return function(tt){var z=D0(1900,void 0,1),ut=B(z,V,tt+="",0),Lt,Ie;if(ut!=tt.length)return null;if("Q"in z)return new Date(z.Q);if("s"in z)return new Date(z.s*1e3+("L"in z?z.L:0));if(H&&!("Z"in z)&&(z.Z=0),"p"in z&&(z.H=z.H%12+z.p*12),z.m===void 0&&(z.m="q"in z?z.q:0),"V"in z){if(z.V<1||z.V>53)return null;"w"in z||(z.w=1),"Z"in z?(Lt=G3(D0(z.y,0,1)),Ie=Lt.getUTCDay(),Lt=Ie>4||Ie===0?au.ceil(Lt):au(Lt),Lt=zf.offset(Lt,(z.V-1)*7),z.y=Lt.getUTCFullYear(),z.m=Lt.getUTCMonth(),z.d=Lt.getUTCDate()+(z.w+6)%7):(Lt=W3(D0(z.y,0,1)),Ie=Lt.getDay(),Lt=Ie>4||Ie===0?su.ceil(Lt):su(Lt),Lt=Ts.offset(Lt,(z.V-1)*7),z.y=Lt.getFullYear(),z.m=Lt.getMonth(),z.d=Lt.getDate()+(z.w+6)%7)}else("W"in z||"U"in z)&&("w"in z||(z.w="u"in z?z.u%7:"W"in z?1:0),Ie="Z"in z?G3(D0(z.y,0,1)).getUTCDay():W3(D0(z.y,0,1)).getDay(),z.m=0,z.d="W"in z?(z.w+6)%7+z.W*7-(Ie+5)%7:z.w+z.U*7-(Ie+6)%7);return"Z"in z?(z.H+=z.Z/100|0,z.M+=z.Z%100,G3(z)):W3(z)}}function B(V,H,tt,z){for(var ut=0,Lt=H.length,Ie=tt.length,le,st;ut<Lt;){if(z>=Ie)return-1;if(le=H.charCodeAt(ut++),le===37){if(le=H.charAt(ut++),st=w[le in wU?H.charAt(ut++):le],!st||(z=st(V,tt,z))<0)return-1}else if(le!=tt.charCodeAt(z++))return-1}return z}function D(V,H,tt){var z=l.exec(H.slice(tt));return z?(V.p=u.get(z[0].toLowerCase()),tt+z[0].length):-1}function T(V,H,tt){var z=h.exec(H.slice(tt));return z?(V.w=p.get(z[0].toLowerCase()),tt+z[0].length):-1}function M(V,H,tt){var z=f.exec(H.slice(tt));return z?(V.w=d.get(z[0].toLowerCase()),tt+z[0].length):-1}function O(V,H,tt){var z=y.exec(H.slice(tt));return z?(V.m=b.get(z[0].toLowerCase()),tt+z[0].length):-1}function L(V,H,tt){var z=m.exec(H.slice(tt));return z?(V.m=g.get(z[0].toLowerCase()),tt+z[0].length):-1}function S(V,H,tt){return B(V,t,H,tt)}function E(V,H,tt){return B(V,r,H,tt)}function I(V,H,tt){return B(V,n,H,tt)}function F(V){return s[V.getDay()]}function C(V){return o[V.getDay()]}function U(V){return c[V.getMonth()]}function $(V){return a[V.getMonth()]}function q(V){return i[+(V.getHours()>=12)]}function j(V){return 1+~~(V.getMonth()/3)}function rt(V){return s[V.getUTCDay()]}function ot(V){return o[V.getUTCDay()]}function Gt(V){return c[V.getUTCMonth()]}function at(V){return a[V.getUTCMonth()]}function Q(V){return i[+(V.getUTCHours()>=12)]}function Z(V){return 1+~~(V.getUTCMonth()/3)}return{format:function(V){var H=v(V+="",x);return H.toString=function(){return V},H},parse:function(V){var H=A(V+="",!1);return H.toString=function(){return V},H},utcFormat:function(V){var H=v(V+="",_);return H.toString=function(){return V},H},utcParse:function(V){var H=A(V+="",!0);return H.toString=function(){return V},H}}}var wU={"-":"",_:" ",0:"0"},Yr=/^\s*\d+/,yit=/^%/,git=/[\\^$*+?|[\]().{}]/g;function xe(e,t,r){var n=e<0?"-":"",i=(n?-e:e)+"",o=i.length;return n+(o<r?new Array(r-o+1).join(t)+i:i)}function bit(e){return e.replace(git,"\\$&")}function L0(e){return new RegExp("^(?:"+e.map(bit).join("|")+")","i")}function R0(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function xit(e,t,r){var n=Yr.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function _it(e,t,r){var n=Yr.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function wit(e,t,r){var n=Yr.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function vit(e,t,r){var n=Yr.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function Sit(e,t,r){var n=Yr.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function vU(e,t,r){var n=Yr.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function SU(e,t,r){var n=Yr.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function Iit(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function Tit(e,t,r){var n=Yr.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function Ait(e,t,r){var n=Yr.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function IU(e,t,r){var n=Yr.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function Mit(e,t,r){var n=Yr.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function TU(e,t,r){var n=Yr.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function Eit(e,t,r){var n=Yr.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function Bit(e,t,r){var n=Yr.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function Oit(e,t,r){var n=Yr.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function Fit(e,t,r){var n=Yr.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function Nit(e,t,r){var n=yit.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function Dit(e,t,r){var n=Yr.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function Lit(e,t,r){var n=Yr.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function AU(e,t){return xe(e.getDate(),t,2)}function Rit(e,t){return xe(e.getHours(),t,2)}function kit(e,t){return xe(e.getHours()%12||12,t,2)}function Cit(e,t){return xe(1+Ts.count(Bn(e),e),t,3)}function FU(e,t){return xe(e.getMilliseconds(),t,3)}function Uit(e,t){return FU(e,t)+"000"}function Pit(e,t){return xe(e.getMonth()+1,t,2)}function $it(e,t){return xe(e.getMinutes(),t,2)}function zit(e,t){return xe(e.getSeconds(),t,2)}function Vit(e){var t=e.getDay();return t===0?7:t}function jit(e,t){return xe(Gi.count(Bn(e)-1,e),t,2)}function NU(e){var t=e.getDay();return t>=4||t===0?ba(e):ba.ceil(e)}function qit(e,t){return e=NU(e),xe(ba.count(Bn(e),e)+(Bn(e).getDay()===4),t,2)}function Yit(e){return e.getDay()}function Wit(e,t){return xe(su.count(Bn(e)-1,e),t,2)}function Git(e,t){return xe(e.getFullYear()%100,t,2)}function Xit(e,t){return e=NU(e),xe(e.getFullYear()%100,t,2)}function Hit(e,t){return xe(e.getFullYear()%1e4,t,4)}function Zit(e,t){var r=e.getDay();return e=r>=4||r===0?ba(e):ba.ceil(e),xe(e.getFullYear()%1e4,t,4)}function Kit(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+xe(t/60|0,"0",2)+xe(t%60,"0",2)}function MU(e,t){return xe(e.getUTCDate(),t,2)}function Qit(e,t){return xe(e.getUTCHours(),t,2)}function Jit(e,t){return xe(e.getUTCHours()%12||12,t,2)}function tot(e,t){return xe(1+zf.count(On(e),e),t,3)}function DU(e,t){return xe(e.getUTCMilliseconds(),t,3)}function eot(e,t){return DU(e,t)+"000"}function rot(e,t){return xe(e.getUTCMonth()+1,t,2)}function not(e,t){return xe(e.getUTCMinutes(),t,2)}function iot(e,t){return xe(e.getUTCSeconds(),t,2)}function oot(e){var t=e.getUTCDay();return t===0?7:t}function sot(e,t){return xe(Xi.count(On(e)-1,e),t,2)}function LU(e){var t=e.getUTCDay();return t>=4||t===0?xa(e):xa.ceil(e)}function aot(e,t){return e=LU(e),xe(xa.count(On(e),e)+(On(e).getUTCDay()===4),t,2)}function cot(e){return e.getUTCDay()}function lot(e,t){return xe(au.count(On(e)-1,e),t,2)}function uot(e,t){return xe(e.getUTCFullYear()%100,t,2)}function fot(e,t){return e=LU(e),xe(e.getUTCFullYear()%100,t,2)}function dot(e,t){return xe(e.getUTCFullYear()%1e4,t,4)}function hot(e,t){var r=e.getUTCDay();return e=r>=4||r===0?xa(e):xa.ceil(e),xe(e.getUTCFullYear()%1e4,t,4)}function pot(){return"+0000"}function EU(){return"%"}function BU(e){return+e}function OU(e){return Math.floor(+e/1e3)}var Hh,Zh,RU,kc,kU;H3({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function H3(e){return Hh=X3(e),Zh=Hh.format,RU=Hh.parse,kc=Hh.utcFormat,kU=Hh.utcParse,Hh}function mot(e){return new Date(e)}function yot(e){return e instanceof Date?+e:+new Date(+e)}function D2(e,t,r,n,i,o,s,a,c,l){var u=v0(),f=u.invert,d=u.domain,h=l(".%L"),p=l(":%S"),m=l("%I:%M"),g=l("%I %p"),y=l("%a %d"),b=l("%b %d"),x=l("%B"),_=l("%Y");function w(v){return(c(v)<v?h:a(v)<v?p:s(v)<v?m:o(v)<v?g:n(v)<v?i(v)<v?y:b:r(v)<v?x:_)(v)}return u.invert=function(v){return new Date(f(v))},u.domain=function(v){return arguments.length?d(Array.from(v,yot)):d().map(mot)},u.ticks=function(v){var A=d();return e(A[0],A[A.length-1],v??10)},u.tickFormat=function(v,A){return A==null?w:l(A)},u.nice=function(v){var A=d();return(!v||typeof v.range!="function")&&(v=t(A[0],A[A.length-1],v??10)),v?d(I0(A,v)):u},u.copy=function(){return ya(u,D2(e,t,r,n,i,o,s,a,c,l))},u}function L2(){return Br.apply(D2(q3,Y3,Bn,cu,Gi,Ts,iu,ru,En,Zh).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function R2(){return Br.apply(D2(j3,N0,On,lu,Xi,zf,ou,nu,En,kc).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function k0(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function k2(){var e=0,t=.5,r=1,n=1,i,o,s,a,c,l=Ii,u,f=!1,d;function h(m){return isNaN(m=+m)?d:(m=.5+((m=+u(m))-o)*(n*m<n*o?a:c),l(f?Math.max(0,Math.min(1,m)):m))}h.domain=function(m){return arguments.length?([e,t,r]=m,i=u(e=+e),o=u(t=+t),s=u(r=+r),a=i===o?0:.5/(o-i),c=o===s?0:.5/(s-o),n=o<i?-1:1,h):[e,t,r]},h.clamp=function(m){return arguments.length?(f=!!m,h):f},h.interpolator=function(m){return arguments.length?(l=m,h):l};function p(m){return function(g){var y,b,x;return arguments.length?([y,b,x]=g,l=Gl(m,[y,b,x]),h):[l(0),l(.5),l(1)]}}return h.range=p(qi),h.rangeRound=p(Af),h.unknown=function(m){return arguments.length?(d=m,h):d},function(m){return u=m,i=m(e),o=m(t),s=m(r),a=i===o?0:.5/(o-i),c=o===s?0:.5/(s-o),n=o<i?-1:1,h}}function C0(){var e=Lc(k2()(Ii));return e.copy=function(){return k0(e,C0())},_0.apply(e,arguments)}function C2(){var e=U3(k2()).domain([.1,1,10]);return e.copy=function(){return k0(e,C2()).base(e.base())},_0.apply(e,arguments)}function U2(){var e=P3(k2());return e.copy=function(){return k0(e,U2()).constant(e.constant())},_0.apply(e,arguments)}function P2(){var e=$3(k2());return e.copy=function(){return k0(e,P2()).exponent(e.exponent())},_0.apply(e,arguments)}function X(e){for(var t=e.length/6|0,r=new Array(t),n=0;n<t;)r[n]="#"+e.slice(n*6,++n*6);return r}var Z3=X("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");var K3=X("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666");var Q3=X("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666");var J3=X("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928");var tO=X("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2");var eO=X("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc");var rO=X("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999");var nO=X("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3");var iO=X("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f");var oO=X("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab");var ht=e=>tB(e[e.length-1]);var $2=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(X),z2=ht($2);var V2=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(X),j2=ht(V2);var q2=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(X),Y2=ht(q2);var W2=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(X),G2=ht(W2);var U0=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(X),Kh=ht(U0);var X2=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(X),H2=ht(X2);var P0=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(X),Qh=ht(P0);var Z2=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(X),K2=ht(Z2);var Q2=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(X),J2=ht(Q2);var tS=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(X),eS=ht(tS);var rS=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(X),nS=ht(rS);var iS=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(X),oS=ht(iS);var sS=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(X),aS=ht(sS);var cS=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(X),lS=ht(cS);var uS=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(X),fS=ht(uS);var dS=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(X),hS=ht(dS);var pS=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(X),mS=ht(pS);var yS=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(X),gS=ht(yS);var bS=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(X),xS=ht(bS);var _S=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(X),wS=ht(_S);var vS=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(X),SS=ht(vS);var IS=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(X),TS=ht(IS);var AS=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(X),MS=ht(AS);var ES=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(X),BS=ht(ES);var OS=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(X),FS=ht(OS);var NS=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(X),DS=ht(NS);var LS=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(X),RS=ht(LS);function kS(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-e*(35.34-e*(2381.73-e*(6402.7-e*(7024.72-e*2710.57)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+e*(170.73+e*(52.82-e*(131.46-e*(176.58-e*67.37)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+e*(442.36-e*(2482.43-e*(6167.24-e*(6614.94-e*2475.67)))))))+")"}var CS=Th(jn(300,.5,0),jn(-240,.5,1));var PS=Th(jn(-100,.75,.35),jn(80,1.5,.8)),$S=Th(jn(260,.75,.35),jn(80,1.5,.8)),US=jn();function zS(e){(e<0||e>1)&&(e-=Math.floor(e));var t=Math.abs(e-.5);return US.h=360*e-100,US.s=1.5-1.5*t,US.l=.8-.9*t,US+""}var VS=jr(),got=Math.PI/3,bot=Math.PI*2/3;function jS(e){var t;return e=(.5-e)*Math.PI,VS.r=255*(t=Math.sin(e))*t,VS.g=255*(t=Math.sin(e+got))*t,VS.b=255*(t=Math.sin(e+bot))*t,VS+""}function qS(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+e*(1172.33-e*(10793.56-e*(33300.12-e*(38394.49-e*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+e*(557.33+e*(1225.33-e*(3574.96-e*(1073.77+e*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+e*(3211.1-e*(15327.97-e*(27814-e*(22569.18-e*6838.66)))))))+")"}function YS(e){var t=e.length;return function(r){return e[Math.max(0,Math.min(t-1,Math.floor(r*t)))]}}var WS=YS(X("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),GS=YS(X("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),XS=YS(X("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),HS=YS(X("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function Or(e){return function(){return e}}var sO=Math.cos;var Jh=Math.min,$0=Math.sin,_e=Math.sqrt,aO=1e-12,qf=Math.PI,Cqt=qf/2,tp=2*qf;function ZS(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{let n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new Hl(t)}var zqt=Array.prototype.slice;function KS(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function CU(e){this._context=e}CU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Cc(e){return new CU(e)}function QS(e){return e[0]}function JS(e){return e[1]}function z0(e,t){var r=Or(!0),n=null,i=Cc,o=null,s=ZS(a);e=typeof e=="function"?e:e===void 0?QS:Or(e),t=typeof t=="function"?t:t===void 0?JS:Or(t);function a(c){var l,u=(c=KS(c)).length,f,d=!1,h;for(n==null&&(o=i(h=s())),l=0;l<=u;++l)!(l<u&&r(f=c[l],l,c))===d&&((d=!d)?o.lineStart():o.lineEnd()),d&&o.point(+e(f,l,c),+t(f,l,c));if(h)return o=null,h+""||null}return a.x=function(c){return arguments.length?(e=typeof c=="function"?c:Or(+c),a):e},a.y=function(c){return arguments.length?(t=typeof c=="function"?c:Or(+c),a):t},a.defined=function(c){return arguments.length?(r=typeof c=="function"?c:Or(!!c),a):r},a.curve=function(c){return arguments.length?(i=c,n!=null&&(o=i(n)),a):i},a.context=function(c){return arguments.length?(c==null?n=o=null:o=i(n=c),a):n},a}function ep(e,t,r){var n=null,i=Or(!0),o=null,s=Cc,a=null,c=ZS(l);e=typeof e=="function"?e:e===void 0?QS:Or(+e),t=typeof t=="function"?t:t===void 0?Or(0):Or(+t),r=typeof r=="function"?r:r===void 0?JS:Or(+r);function l(f){var d,h,p,m=(f=KS(f)).length,g,y=!1,b,x=new Array(m),_=new Array(m);for(o==null&&(a=s(b=c())),d=0;d<=m;++d){if(!(d<m&&i(g=f[d],d,f))===y)if(y=!y)h=d,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),p=d-1;p>=h;--p)a.point(x[p],_[p]);a.lineEnd(),a.areaEnd()}y&&(x[d]=+e(g,d,f),_[d]=+t(g,d,f),a.point(n?+n(g,d,f):x[d],r?+r(g,d,f):_[d]))}if(b)return a=null,b+""||null}function u(){return z0().defined(i).curve(s).context(o)}return l.x=function(f){return arguments.length?(e=typeof f=="function"?f:Or(+f),n=null,l):e},l.x0=function(f){return arguments.length?(e=typeof f=="function"?f:Or(+f),l):e},l.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:Or(+f),l):n},l.y=function(f){return arguments.length?(t=typeof f=="function"?f:Or(+f),r=null,l):t},l.y0=function(f){return arguments.length?(t=typeof f=="function"?f:Or(+f),l):t},l.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:Or(+f),l):r},l.lineX0=l.lineY0=function(){return u().x(e).y(t)},l.lineY1=function(){return u().x(e).y(r)},l.lineX1=function(){return u().x(n).y(t)},l.defined=function(f){return arguments.length?(i=typeof f=="function"?f:Or(!!f),l):i},l.curve=function(f){return arguments.length?(s=f,o!=null&&(a=s(o)),l):s},l.context=function(f){return arguments.length?(f==null?o=a=null:a=s(o=f),l):o},l}var tI=class{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}};function cO(e){return new tI(e,!0)}function lO(e){return new tI(e,!1)}var xot=_e(3),V0={draw(e,t){let r=_e(t+Jh(t/28,.75))*.59436,n=r/2,i=n*xot;e.moveTo(0,r),e.lineTo(0,-r),e.moveTo(-i,-n),e.lineTo(i,n),e.moveTo(-i,n),e.lineTo(i,-n)}};var Uc={draw(e,t){let r=_e(t/qf);e.moveTo(r,0),e.arc(0,0,r,0,tp)}};var j0={draw(e,t){let r=_e(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}};var UU=_e(1/3),_ot=UU*2,q0={draw(e,t){let r=_e(t/_ot),n=r*UU;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}};var Y0={draw(e,t){let r=_e(t)*.62625;e.moveTo(0,-r),e.lineTo(r,0),e.lineTo(0,r),e.lineTo(-r,0),e.closePath()}};var W0={draw(e,t){let r=_e(t-Jh(t/7,2))*.87559;e.moveTo(-r,0),e.lineTo(r,0),e.moveTo(0,r),e.lineTo(0,-r)}};var G0={draw(e,t){let r=_e(t),n=-r/2;e.rect(n,n,r,r)}};var X0={draw(e,t){let r=_e(t)*.4431;e.moveTo(r,r),e.lineTo(r,-r),e.lineTo(-r,-r),e.lineTo(-r,r),e.closePath()}};var wot=.8908130915292852,PU=$0(qf/10)/$0(7*qf/10),vot=$0(tp/10)*PU,Sot=-sO(tp/10)*PU,H0={draw(e,t){let r=_e(t*wot),n=vot*r,i=Sot*r;e.moveTo(0,-r),e.lineTo(n,i);for(let o=1;o<5;++o){let s=tp*o/5,a=sO(s),c=$0(s);e.lineTo(c*r,-a*r),e.lineTo(a*n-c*i,c*n+a*i)}e.closePath()}};var uO=_e(3),Z0={draw(e,t){let r=-_e(t/(uO*3));e.moveTo(0,r*2),e.lineTo(-uO*r,-r),e.lineTo(uO*r,-r),e.closePath()}};var Iot=_e(3),K0={draw(e,t){let r=_e(t)*.6824,n=r/2,i=r*Iot/2;e.moveTo(0,-r),e.lineTo(i,n),e.lineTo(-i,n),e.closePath()}};var Fo=-.5,No=_e(3)/2,fO=1/_e(12),Tot=(fO/2+1)*3,Q0={draw(e,t){let r=_e(t/Tot),n=r/2,i=r*fO,o=n,s=r*fO+r,a=-o,c=s;e.moveTo(n,i),e.lineTo(o,s),e.lineTo(a,c),e.lineTo(Fo*n-No*i,No*n+Fo*i),e.lineTo(Fo*o-No*s,No*o+Fo*s),e.lineTo(Fo*a-No*c,No*a+Fo*c),e.lineTo(Fo*n+No*i,Fo*i-No*n),e.lineTo(Fo*o+No*s,Fo*s-No*o),e.lineTo(Fo*a+No*c,Fo*c-No*a),e.closePath()}};var rp={draw(e,t){let r=_e(t-Jh(t/6,1.7))*.6189;e.moveTo(-r,-r),e.lineTo(r,r),e.moveTo(-r,r),e.lineTo(r,-r)}};var eI=[Uc,j0,q0,G0,H0,Z0,Q0],dO=[Uc,W0,rp,K0,V0,X0,Y0];function Do(){}function np(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function J0(e){this._context=e}J0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:np(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:np(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function hO(e){return new J0(e)}function $U(e){this._context=e}$U.prototype={areaStart:Do,areaEnd:Do,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:np(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function pO(e){return new $U(e)}function zU(e){this._context=e}zU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:np(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function mO(e){return new zU(e)}function VU(e,t){this._basis=new J0(e),this._beta=t}VU.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,r=e.length-1;if(r>0)for(var n=e[0],i=t[0],o=e[r]-n,s=t[r]-i,a=-1,c;++a<=r;)c=a/r,this._basis.point(this._beta*e[a]+(1-this._beta)*(n+c*o),this._beta*t[a]+(1-this._beta)*(i+c*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var yO=function e(t){function r(n){return t===1?new J0(n):new VU(n,t)}return r.beta=function(n){return e(+n)},r}(.85);function ip(e,t,r){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-r),e._x2,e._y2)}function rI(e,t){this._context=e,this._k=(1-t)/6}rI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:ip(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:ip(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var gO=function e(t){function r(n){return new rI(n,t)}return r.tension=function(n){return e(+n)},r}(0);function nI(e,t){this._context=e,this._k=(1-t)/6}nI.prototype={areaStart:Do,areaEnd:Do,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:ip(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var bO=function e(t){function r(n){return new nI(n,t)}return r.tension=function(n){return e(+n)},r}(0);function iI(e,t){this._context=e,this._k=(1-t)/6}iI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:ip(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var xO=function e(t){function r(n){return new iI(n,t)}return r.tension=function(n){return e(+n)},r}(0);function tb(e,t,r){var n=e._x1,i=e._y1,o=e._x2,s=e._y2;if(e._l01_a>aO){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,c=3*e._l01_a*(e._l01_a+e._l12_a);n=(n*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/c,i=(i*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/c}if(e._l23_a>aO){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,u=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*l+e._x1*e._l23_2a-t*e._l12_2a)/u,s=(s*l+e._y1*e._l23_2a-r*e._l12_2a)/u}e._context.bezierCurveTo(n,i,o,s,e._x2,e._y2)}function jU(e,t){this._context=e,this._alpha=t}jU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var r=this._x2-e,n=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+n*n,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:tb(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var _O=function e(t){function r(n){return t?new jU(n,t):new rI(n,0)}return r.alpha=function(n){return e(+n)},r}(.5);function qU(e,t){this._context=e,this._alpha=t}qU.prototype={areaStart:Do,areaEnd:Do,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var r=this._x2-e,n=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+n*n,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:tb(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var wO=function e(t){function r(n){return t?new qU(n,t):new nI(n,0)}return r.alpha=function(n){return e(+n)},r}(.5);function YU(e,t){this._context=e,this._alpha=t}YU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var r=this._x2-e,n=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+n*n,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:tb(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var vO=function e(t){function r(n){return t?new YU(n,t):new iI(n,0)}return r.alpha=function(n){return e(+n)},r}(.5);function WU(e){this._context=e}WU.prototype={areaStart:Do,areaEnd:Do,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function SO(e){return new WU(e)}function GU(e){return e<0?-1:1}function XU(e,t,r){var n=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(n||i<0&&-0),s=(r-e._y1)/(i||n<0&&-0),a=(o*i+s*n)/(n+i);return(GU(o)+GU(s))*Math.min(Math.abs(o),Math.abs(s),.5*Math.abs(a))||0}function HU(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function IO(e,t,r){var n=e._x0,i=e._y0,o=e._x1,s=e._y1,a=(o-n)/3;e._context.bezierCurveTo(n+a,i+a*t,o-a,s-a*r,o,s)}function oI(e){this._context=e}oI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:IO(this,this._t0,HU(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,IO(this,HU(this,r=XU(this,e,t)),r);break;default:IO(this,this._t0,r=XU(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function ZU(e){this._context=new KU(e)}(ZU.prototype=Object.create(oI.prototype)).point=function(e,t){oI.prototype.point.call(this,t,e)};function KU(e){this._context=e}KU.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,i,o){this._context.bezierCurveTo(t,e,n,r,o,i)}};function TO(e){return new oI(e)}function AO(e){return new ZU(e)}function JU(e){this._context=e}JU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=QU(e),i=QU(t),o=0,s=1;s<r;++o,++s)this._context.bezierCurveTo(n[0][o],i[0][o],n[1][o],i[1][o],e[s],t[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function QU(e){var t,r=e.length-1,n,i=new Array(r),o=new Array(r),s=new Array(r);for(i[0]=0,o[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,o[t]=4,s[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,o[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/o[t-1],o[t]-=n,s[t]-=n*s[t-1];for(i[r-1]=s[r-1]/o[r-1],t=r-2;t>=0;--t)i[t]=(s[t]-i[t+1])/o[t];for(o[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}function MO(e){return new JU(e)}function sI(e,t){this._context=e,this._t=t}sI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function EO(e){return new sI(e,.5)}function BO(e){return new sI(e,0)}function OO(e){return new sI(e,1)}var eb=e=>()=>e;function FO(e,{sourceEvent:t,target:r,transform:n,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:i}})}function Hi(e,t,r){this.k=e,this.x=t,this.y=r}Hi.prototype={constructor:Hi,scale:function(e){return e===1?this:new Hi(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Hi(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var rb=new Hi(1,0,0);NO.prototype=Hi.prototype;function NO(e){for(;!e.__zoom;)if(!(e=e.parentNode))return rb;return e.__zoom}function aI(e){e.stopImmediatePropagation()}function op(e){e.preventDefault(),e.stopImmediatePropagation()}function Aot(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Mot(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function t5(){return this.__zoom||rb}function Eot(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Bot(){return navigator.maxTouchPoints||"ontouchstart"in this}function Oot(e,t,r){var n=e.invertX(t[0][0])-r[0][0],i=e.invertX(t[1][0])-r[1][0],o=e.invertY(t[0][1])-r[0][1],s=e.invertY(t[1][1])-r[1][1];return e.translate(i>n?(n+i)/2:Math.min(0,n)||Math.max(0,i),s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s))}function DO(){var e=Aot,t=Mot,r=Oot,n=Eot,i=Bot,o=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,c=sB,l=_f("start","zoom","end"),u,f,d,h=500,p=150,m=0,g=10;function y(S){S.property("__zoom",t5).on("wheel.zoom",B,{passive:!1}).on("mousedown.zoom",D).on("dblclick.zoom",T).filter(i).on("touchstart.zoom",M).on("touchmove.zoom",O).on("touchend.zoom touchcancel.zoom",L).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}y.transform=function(S,E,I,F){var C=S.selection?S.selection():S;C.property("__zoom",t5),S!==C?w(S,E,I,F):C.interrupt().each(function(){v(this,arguments).event(F).start().zoom(null,typeof E=="function"?E.apply(this,arguments):E).end()})},y.scaleBy=function(S,E,I,F){y.scaleTo(S,function(){var C=this.__zoom.k,U=typeof E=="function"?E.apply(this,arguments):E;return C*U},I,F)},y.scaleTo=function(S,E,I,F){y.transform(S,function(){var C=t.apply(this,arguments),U=this.__zoom,$=I==null?_(C):typeof I=="function"?I.apply(this,arguments):I,q=U.invert($),j=typeof E=="function"?E.apply(this,arguments):E;return r(x(b(U,j),$,q),C,s)},I,F)},y.translateBy=function(S,E,I,F){y.transform(S,function(){return r(this.__zoom.translate(typeof E=="function"?E.apply(this,arguments):E,typeof I=="function"?I.apply(this,arguments):I),t.apply(this,arguments),s)},null,F)},y.translateTo=function(S,E,I,F,C){y.transform(S,function(){var U=t.apply(this,arguments),$=this.__zoom,q=F==null?_(U):typeof F=="function"?F.apply(this,arguments):F;return r(rb.translate(q[0],q[1]).scale($.k).translate(typeof E=="function"?-E.apply(this,arguments):-E,typeof I=="function"?-I.apply(this,arguments):-I),U,s)},F,C)};function b(S,E){return E=Math.max(o[0],Math.min(o[1],E)),E===S.k?S:new Hi(E,S.x,S.y)}function x(S,E,I){var F=E[0]-I[0]*S.k,C=E[1]-I[1]*S.k;return F===S.x&&C===S.y?S:new Hi(S.k,F,C)}function _(S){return[(+S[0][0]+ +S[1][0])/2,(+S[0][1]+ +S[1][1])/2]}function w(S,E,I,F){S.on("start.zoom",function(){v(this,arguments).event(F).start()}).on("interrupt.zoom end.zoom",function(){v(this,arguments).event(F).end()}).tween("zoom",function(){var C=this,U=arguments,$=v(C,U).event(F),q=t.apply(C,U),j=I==null?_(q):typeof I=="function"?I.apply(C,U):I,rt=Math.max(q[1][0]-q[0][0],q[1][1]-q[0][1]),ot=C.__zoom,Gt=typeof E=="function"?E.apply(C,U):E,at=c(ot.invert(j).concat(rt/ot.k),Gt.invert(j).concat(rt/Gt.k));return function(Q){if(Q===1)Q=Gt;else{var Z=at(Q),V=rt/Z[2];Q=new Hi(V,j[0]-Z[0]*V,j[1]-Z[1]*V)}$.zoom(null,Q)}})}function v(S,E,I){return!I&&S.__zooming||new A(S,E)}function A(S,E){this.that=S,this.args=E,this.active=0,this.sourceEvent=null,this.extent=t.apply(S,E),this.taps=0}A.prototype={event:function(S){return S&&(this.sourceEvent=S),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(S,E){return this.mouse&&S!=="mouse"&&(this.mouse[1]=E.invert(this.mouse[0])),this.touch0&&S!=="touch"&&(this.touch0[1]=E.invert(this.touch0[0])),this.touch1&&S!=="touch"&&(this.touch1[1]=E.invert(this.touch1[0])),this.that.__zoom=E,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(S){var E=ne(this.that).datum();l.call(S,this.that,new FO(S,{sourceEvent:this.sourceEvent,target:y,type:S,transform:this.that.__zoom,dispatch:l}),E)}};function B(S,...E){if(!e.apply(this,arguments))return;var I=v(this,E).event(S),F=this.__zoom,C=Math.max(o[0],Math.min(o[1],F.k*Math.pow(2,n.apply(this,arguments)))),U=Sn(S);if(I.wheel)(I.mouse[0][0]!==U[0]||I.mouse[0][1]!==U[1])&&(I.mouse[1]=F.invert(I.mouse[0]=U)),clearTimeout(I.wheel);else{if(F.k===C)return;I.mouse=[U,F.invert(U)],ca(this),I.start()}op(S),I.wheel=setTimeout($,p),I.zoom("mouse",r(x(b(F,C),I.mouse[0],I.mouse[1]),I.extent,s));function $(){I.wheel=null,I.end()}}function D(S,...E){if(d||!e.apply(this,arguments))return;var I=S.currentTarget,F=v(this,E,!0).event(S),C=ne(S.view).on("mousemove.zoom",j,!0).on("mouseup.zoom",rt,!0),U=Sn(S,I),$=S.clientX,q=S.clientY;Ng(S.view),aI(S),F.mouse=[U,this.__zoom.invert(U)],ca(this),F.start();function j(ot){if(op(ot),!F.moved){var Gt=ot.clientX-$,at=ot.clientY-q;F.moved=Gt*Gt+at*at>m}F.event(ot).zoom("mouse",r(x(F.that.__zoom,F.mouse[0]=Sn(ot,I),F.mouse[1]),F.extent,s))}function rt(ot){C.on("mousemove.zoom mouseup.zoom",null),Dg(ot.view,F.moved),op(ot),F.event(ot).end()}}function T(S,...E){if(e.apply(this,arguments)){var I=this.__zoom,F=Sn(S.changedTouches?S.changedTouches[0]:S,this),C=I.invert(F),U=I.k*(S.shiftKey?.5:2),$=r(x(b(I,U),F,C),t.apply(this,E),s);op(S),a>0?ne(this).transition().duration(a).call(w,$,F,S):ne(this).call(y.transform,$,F,S)}}function M(S,...E){if(e.apply(this,arguments)){var I=S.touches,F=I.length,C=v(this,E,S.changedTouches.length===F).event(S),U,$,q,j;for(aI(S),$=0;$<F;++$)q=I[$],j=Sn(q,this),j=[j,this.__zoom.invert(j),q.identifier],C.touch0?!C.touch1&&C.touch0[2]!==j[2]&&(C.touch1=j,C.taps=0):(C.touch0=j,U=!0,C.taps=1+!!u);u&&(u=clearTimeout(u)),U&&(C.taps<2&&(f=j[0],u=setTimeout(function(){u=null},h)),ca(this),C.start())}}function O(S,...E){if(this.__zooming){var I=v(this,E).event(S),F=S.changedTouches,C=F.length,U,$,q,j;for(op(S),U=0;U<C;++U)$=F[U],q=Sn($,this),I.touch0&&I.touch0[2]===$.identifier?I.touch0[0]=q:I.touch1&&I.touch1[2]===$.identifier&&(I.touch1[0]=q);if($=I.that.__zoom,I.touch1){var rt=I.touch0[0],ot=I.touch0[1],Gt=I.touch1[0],at=I.touch1[1],Q=(Q=Gt[0]-rt[0])*Q+(Q=Gt[1]-rt[1])*Q,Z=(Z=at[0]-ot[0])*Z+(Z=at[1]-ot[1])*Z;$=b($,Math.sqrt(Q/Z)),q=[(rt[0]+Gt[0])/2,(rt[1]+Gt[1])/2],j=[(ot[0]+at[0])/2,(ot[1]+at[1])/2]}else if(I.touch0)q=I.touch0[0],j=I.touch0[1];else return;I.zoom("touch",r(x($,q,j),I.extent,s))}}function L(S,...E){if(this.__zooming){var I=v(this,E).event(S),F=S.changedTouches,C=F.length,U,$;for(aI(S),d&&clearTimeout(d),d=setTimeout(function(){d=null},h),U=0;U<C;++U)$=F[U],I.touch0&&I.touch0[2]===$.identifier?delete I.touch0:I.touch1&&I.touch1[2]===$.identifier&&delete I.touch1;if(I.touch1&&!I.touch0&&(I.touch0=I.touch1,delete I.touch1),I.touch0)I.touch0[1]=this.__zoom.invert(I.touch0[0]);else if(I.end(),I.taps===2&&($=Sn($,this),Math.hypot(f[0]-$[0],f[1]-$[1])<g)){var q=ne(this).on("dblclick.zoom");q&&q.apply(this,arguments)}}}return y.wheelDelta=function(S){return arguments.length?(n=typeof S=="function"?S:eb(+S),y):n},y.filter=function(S){return arguments.length?(e=typeof S=="function"?S:eb(!!S),y):e},y.touchable=function(S){return arguments.length?(i=typeof S=="function"?S:eb(!!S),y):i},y.extent=function(S){return arguments.length?(t=typeof S=="function"?S:eb([[+S[0][0],+S[0][1]],[+S[1][0],+S[1][1]]]),y):t},y.scaleExtent=function(S){return arguments.length?(o[0]=+S[0],o[1]=+S[1],y):[o[0],o[1]]},y.translateExtent=function(S){return arguments.length?(s[0][0]=+S[0][0],s[1][0]=+S[1][0],s[0][1]=+S[0][1],s[1][1]=+S[1][1],y):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},y.constrain=function(S){return arguments.length?(r=S,y):r},y.duration=function(S){return arguments.length?(a=+S,y):a},y.interpolate=function(S){return arguments.length?(c=S,y):c},y.on=function(){var S=l.on.apply(l,arguments);return S===l?y:S},y.clickDistance=function(S){return arguments.length?(m=(S=+S)*S,y):Math.sqrt(m)},y.tapDistance=function(S){return arguments.length?(g=+S,y):g},y}function _r(e){return e!=null&&!Number.isNaN(e)}function Wr(e,t){return+_r(t)-+_r(e)||be(e,t)}function Yf(e,t){return+_r(t)-+_r(e)||To(e,t)}function nb(e){return e!=null&&`${e}`!=""}function sp(e){return isFinite(e)?e:NaN}function Zn(e){return e>0&&isFinite(e)?e:NaN}function uu(e){return e<0&&isFinite(e)?e:NaN}var Fot=new Map([["second",En],["minute",ru],["hour",iu],["day",Ts],["week",Gi],["month",cu],["year",Bn],["monday",su],["tuesday",T2],["wednesday",A2],["thursday",ba],["friday",M2],["saturday",E2],["sunday",Gi]]),Not=new Map([["second",En],["minute",nu],["hour",ou],["day",Xh],["week",Xi],["month",lu],["year",On],["monday",au],["tuesday",B2],["wednesday",O2],["thursday",xa],["friday",F2],["saturday",N2],["sunday",Xi]]);function e5(e,t){let r=`${e}`.toLowerCase();r.endsWith("s")&&(r=r.slice(0,-1));let n=1,i=/^(?:(\d+)\s+)/.exec(r);switch(i&&(r=r.slice(i[0].length),n=+i[1]),r){case"quarter":r="month",n*=3;break;case"half":r="month",n*=6;break}let o=t.get(r);if(!o)throw new Error(`unknown interval: ${e}`);if(!(n>1))return o;if(!o.every)throw new Error(`non-periodic interval: ${r}`);return o.every(n)}function r5(e){return e5(e,Fot)}function cI(e){return e5(e,Not)}function n5(e){if(!e)return!1;let t=e.floor(new Date(Date.UTC(2e3,11,31)));return On(t)>=t}function i5(e){if(!e)return!1;let t=e.floor(new Date(2e3,11,31));return Bn(t)>=t}var Wf=Object.getPrototypeOf(Uint8Array),Dot=Object.prototype.toString;function gt(e,t,r){let n=typeof t;return n==="string"?o5(e,LO(t),r):n==="function"?o5(e,t,r):n==="number"||t instanceof Date||n==="boolean"?fe(e,Cr(t),r):typeof t?.transform=="function"?s5(t.transform(e),r):s5(t,r)}function o5(e,t,r){return fe(e,r?.prototype instanceof Wf?Lot(t):t,r)}function s5(e,t){return t===void 0?vr(e):e instanceof t?e:t.prototype instanceof Wf&&!(e instanceof Wf)?t.from(e,RO):t.from(e)}function Lot(e){return(t,r)=>RO(e(t,r))}var fu=[null],LO=e=>t=>t[e],dr={transform:Kn},K={transform:e=>e};var ib=()=>1,a5=()=>!0,nr=e=>e==null?e:`${e}`,Nt=e=>e==null?e:+e;var Pc=e=>e?e[0]:void 0,du=e=>e?e[1]:void 0,c5=e=>e?e[2]:void 0,Cr=e=>()=>e;function ap(e){let t=+`${e}`.slice(1)/100;return(r,n)=>zn(r,t,n)}function Fr(e){return e instanceof Wf?e:fe(e,RO,Float64Array)}function RO(e){return e==null?NaN:Number(e)}function l5(e){return fe(e,kO)}function kO(e){return e instanceof Date&&!isNaN(e)?e:typeof e=="string"?pf(e):e==null||isNaN(e=+e)?void 0:new Date(e)}function wr(e,t){return e===void 0&&(e=t),e===null?[void 0,"none"]:hu(e)?[void 0,e]:[e,void 0]}function Se(e,t){return e===void 0&&(e=t),e===null||typeof e=="number"?[void 0,e]:[e,void 0]}function Gf(e,t,r){if(e!=null)return Zi(e,t,r)}function Zi(e,t,r){let n=`${e}`.toLowerCase();if(!r.includes(n))throw new Error(`invalid ${t}: ${e}`);return n}function vr(e){return e==null||e instanceof Array||e instanceof Wf?e:Array.from(e)}function fe(e,t,r=Array){return e==null?e:e instanceof r?e.map(t):r.from(e,t)}function ob(e,t=Array){return e instanceof t?e.slice():t.from(e)}function CO({x:e,x1:t,x2:r}){return e!==void 0||t!==void 0||r!==void 0}function UO({y:e,y1:t,y2:r}){return e!==void 0||t!==void 0||r!==void 0}function cp(e){return CO(e)||UO(e)||e.interval!==void 0}function Fn(e){return e?.toString===Dot}function _a(e){return Fn(e)&&(e.type!==void 0||e.domain!==void 0)}function Ki(e){return Fn(e)&&typeof e.transform!="function"}function wa(e){return Ki(e)&&e.value===void 0&&e.channel===void 0}function PO(e,t,r,n=K){return t===void 0&&r===void 0?(t=0,r=e===void 0?n:e):t===void 0?t=e===void 0?0:e:r===void 0&&(r=e===void 0?0:e),[t,r]}function hr(e,t){return e===void 0&&t===void 0?[Pc,du]:[e,t]}function Nn({z:e,fill:t,stroke:r}={}){return e===void 0&&([e]=wr(t)),e===void 0&&([e]=wr(r)),e}function Kn(e){let t=e.length,r=new Uint32Array(t);for(let n=0;n<t;++n)r[n]=n;return r}function lp(e,t){return fe(t,r=>e[r])}function up(e){return e.length===1?(t,r)=>e(lp(r,t)):e}function $c(e){return e!==null&&typeof e=="object"?e.valueOf():e}function lI(e,t){if(t[e]!==void 0)return t[e];switch(e){case"x1":case"x2":e="x";break;case"y1":case"y2":e="y";break}return t[e]}function Gr(e){let t;return[{transform:()=>t,label:Qn(e)},r=>t=r]}function gn(e){return e==null?[e]:Gr(e)}function Qn(e,t){return typeof e=="string"?e:e&&e.label!==void 0?e.label:t}function fp(e,t){return{transform(r){let n=e.transform(r),i=t.transform(r);return fr(n)||fr(i)?fe(n,(o,s)=>new Date((+n[s]+ +i[s])/2)):fe(n,(o,s)=>(+n[s]+ +i[s])/2,Float64Array)},label:e.label}}function Xf(e,t){let r=$O(t?.interval,t?.type);return r?fe(e,r):e}function $O(e,t){let r=uI(e,t);return r&&(n=>_r(n)?r.floor(n):n)}function uI(e,t){if(e!=null){if(typeof e=="number"){0<e&&e<1&&Number.isInteger(1/e)&&(e=-1/e);let r=Math.abs(e);return e<0?{floor:n=>Math.floor(n*r)/r,offset:n=>(n*r+1)/r,range:(n,i)=>xr(Math.ceil(n*r),i*r).map(o=>o/r)}:{floor:n=>Math.floor(n/r)*r,offset:n=>n+r,range:(n,i)=>xr(Math.ceil(n/r),i/r).map(o=>o*r)}}if(typeof e=="string")return(t==="time"?r5:cI)(e);if(typeof e.floor!="function")throw new Error("invalid interval; missing floor method");if(typeof e.offset!="function")throw new Error("invalid interval; missing offset method");return e}}function va(e,t){if(e=uI(e,t),e&&typeof e.range!="function")throw new Error("invalid interval: missing range method");return e}function u5(e,t){if(e=va(e,t),e&&typeof e.ceil!="function")throw new Error("invalid interval: missing ceil method");return e}function Sa(e){return e===void 0||Ki(e)?e:{value:e}}function f5(e){return e==null?null:{transform:t=>gt(t,e,Float64Array),label:Qn(e)}}function d5(e){if(!Dn(e))return!1;for(let t of e)if(t!=null)return typeof t=="object"&&"0"in t&&"1"in t}function Dn(e){return e&&typeof e[Symbol.iterator]=="function"}function fI(e){for(let t of e)if(t!=null)return typeof t!="object"||t instanceof Date}function bn(e){for(let t of e){if(t==null)continue;let r=typeof t;return r==="string"||r==="boolean"}}function fr(e){for(let t of e)if(t!=null)return t instanceof Date}function h5(e){for(let t of e)if(t!=null)return typeof t=="string"&&isNaN(t)&&pf(t)}function p5(e){for(let t of e)if(t!=null){if(typeof t!="string")return!1;if(t.trim())return!isNaN(t)}}function dI(e){for(let t of e)if(t!=null)return typeof t=="number"}function hI(e,t){let r;for(let n of e)if(n!=null){if(!t(n))return!1;r=!0}return r}function hu(e){return typeof e!="string"?!1:(e=e.toLowerCase().trim(),e==="none"||e==="currentcolor"||e.startsWith("url(")&&e.endsWith(")")||e.startsWith("var(")&&e.endsWith(")")||Vn(e)!==null)}function m5(e){return typeof e=="number"&&(0<=e&&e<=1||isNaN(e))}function Ke(e){return e==null||zc(e)}function zc(e){return/^\s*none\s*$/i.test(e)}function y5(e){return/^\s*round\s*$/i.test(e)}function zO(e,t){return Gf(e,t,["middle","top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"])}function Ia(e="middle"){return zO(e,"frameAnchor")}function Hf(e){if(e==null)return;let t=e[0],r=e[e.length-1];return To(t,r)}function g5(e={},...t){let r=e;for(let n of t)for(let i in n)if(r[i]===void 0){let o=n[i];r===e?r={...r,[i]:o}:r[i]=o}return r}function Rot(e){console.warn("named iterables are deprecated; please use an object instead");let t=new Set;return Object.fromEntries(Array.from(e,r=>{let{name:n}=r;if(n==null)throw new Error("missing name");let i=`${n}`;if(i==="__proto__")throw new Error(`illegal name: ${i}`);if(t.has(i))throw new Error(`duplicate name: ${i}`);return t.add(i),[n,r]}))}function sb(e){return Dn(e)?Rot(e):e}var Qi=Symbol("position"),Ji=Symbol("color"),dp=Symbol("radius"),hp=Symbol("length"),pp=Symbol("opacity"),mp=Symbol("symbol"),kot=Symbol("projection"),Oe=new Map([["x",Qi],["y",Qi],["fx",Qi],["fy",Qi],["r",dp],["color",Ji],["opacity",pp],["symbol",mp],["length",hp],["projection",kot]]);var VO=Math.sqrt(3),jO=2/VO,Cot={draw(e,t){let r=Math.sqrt(t/Math.PI),n=r*jO,i=n/2;e.moveTo(0,n),e.lineTo(r,i),e.lineTo(r,-i),e.lineTo(0,-n),e.lineTo(-r,-i),e.lineTo(-r,i),e.closePath()}},qO=new Map([["asterisk",V0],["circle",Uc],["cross",j0],["diamond",q0],["diamond2",Y0],["hexagon",Cot],["plus",W0],["square",G0],["square2",X0],["star",H0],["times",rp],["triangle",Z0],["triangle2",K0],["wye",Q0]]);function YO(e){return e&&typeof e.draw=="function"}function b5(e){return YO(e)?!0:typeof e!="string"?!1:qO.has(e.toLowerCase())}function yp(e){if(e==null||YO(e))return e;let t=qO.get(`${e}`.toLowerCase());if(t)return t;throw new Error(`invalid symbol: ${e}`)}function x5(e){if(e==null||YO(e))return[void 0,e];if(typeof e=="string"){let t=qO.get(`${e}`.toLowerCase());if(t)return[void 0,t]}return[e,void 0]}function Xr({filter:e,sort:t,reverse:r,transform:n,initializer:i,...o}={},s){if(n===void 0&&(e!=null&&(n=XO(e)),t!=null&&!wa(t)&&(n=WO(n,ZO(t))),r&&(n=WO(n,HO))),s!=null&&i!=null)throw new Error("transforms cannot be applied after initializers");return{...o,...(t===null||wa(t))&&{sort:t},transform:WO(n,s)}}function Qe({filter:e,sort:t,reverse:r,initializer:n,...i}={},o){return n===void 0&&(e!=null&&(n=XO(e)),t!=null&&!wa(t)&&(n=GO(n,ZO(t))),r&&(n=GO(n,HO))),{...i,...(t===null||wa(t))&&{sort:t},initializer:GO(n,o)}}function WO(e,t){return e==null?t===null?void 0:t:t==null?e===null?void 0:e:function(r,n,i){return{data:r,facets:n}=e.call(this,r,n,i),t.call(this,vr(r),n,i)}}function GO(e,t){return e==null?t===null?void 0:t:t==null?e===null?void 0:e:function(r,n,i,...o){let s,a,c,l,u,f;return{data:a=r,facets:c=n,channels:s}=e.call(this,r,n,i,...o),{data:u=a,facets:f=c,channels:l}=t.call(this,a,c,{...i,...s},...o),{data:u,facets:f,channels:{...s,...l}}}}function pI(e,t){return(e.initializer!=null?Qe:Xr)(e,t)}function _5(e,t){return pI(t,XO(e))}function XO(e){return(t,r)=>{let n=gt(t,e);return{data:t,facets:r.map(i=>i.filter(o=>n[o]))}}}function w5({sort:e,...t}={}){return{...pI(t,HO),sort:wa(e)?e:null}}function HO(e,t){return{data:e,facets:t.map(r=>r.slice().reverse())}}function v5({seed:e,sort:t,...r}={}){return{...pI(r,S5(e==null?Math.random:kf(e))),sort:wa(t)?t:null}}function mI(e,{sort:t,...r}={}){return{...(Ki(e)&&e.channel!==void 0?Qe:pI)(r,ZO(e)),sort:wa(t)?t:null}}function ZO(e){return(typeof e=="function"&&e.length!==1?Uot:S5)(e)}function Uot(e){return(t,r)=>{let n=(i,o)=>e(t[i],t[o]);return{data:t,facets:r.map(i=>i.slice().sort(n))}}}function S5(e){let t,r;({channel:t,value:e,order:r}={...Sa(e)});let n=t?.startsWith("-");if(n&&(t=t.slice(1)),r===void 0&&(r=n?Yf:Wr),typeof r!="function")switch(`${r}`.toLowerCase()){case"ascending":r=Wr;break;case"descending":r=Yf;break;default:throw new Error(`invalid order: ${r}`)}return(i,o,s)=>{let a;if(t===void 0)a=gt(i,e);else{if(s===void 0)throw new Error("channel sort requires an initializer");if(a=s[t],!a)return{};a=a.value}let c=(l,u)=>r(a[l],a[u]);return{data:i,facets:o.map(l=>l.slice().sort(c))}}}function cb(e,t){return yI(null,null,e,t)}function mu(e={y:"count"},t={}){let{x:r=K}=t;if(r==null)throw new Error("missing channel: x");return yI(r,null,e,t)}function yu(e={x:"count"},t={}){let{y:r=K}=t;if(r==null)throw new Error("missing channel: y");return yI(null,r,e,t)}function lb(e={fill:"count"},t={}){let{x:r,y:n}=t;if([r,n]=hr(r,n),r==null)throw new Error("missing channel: x");if(n==null)throw new Error("missing channel: y");return yI(r,n,e,t)}function yI(e,t,{data:r=xI,filter:n,sort:i,reverse:o,...s}={},a={}){s=ub(s,a),r=gp(r,K),i=i==null?void 0:gI("sort",i,a),n=n==null?void 0:bI("filter",n,a);let[c,l]=gn(e),[u,f]=gn(t),{z:d,fill:h,stroke:p,x1:m,x2:g,y1:y,y2:b,...x}=a,[_,w]=gn(d),[v]=wr(h),[A]=wr(p),[B,D]=gn(v),[T,M]=gn(A);return{..."z"in a&&{z:_||d},..."fill"in a&&{fill:B||h},..."stroke"in a&&{stroke:T||p},...Xr(x,(O,L,S)=>{let E=Xf(gt(O,e),S?.x),I=Xf(gt(O,t),S?.y),F=gt(O,d),C=gt(O,v),U=gt(O,A),$=fb(s,{z:F,fill:C,stroke:U}),q=[],j=[],rt=E&&l([]),ot=I&&f([]),Gt=F&&w([]),at=C&&D([]),Q=U&&M([]),Z=0;for(let V of s)V.initialize(O);i&&i.initialize(O),n&&n.initialize(O);for(let V of L){let H=[];for(let tt of s)tt.scope("facet",V);i&&i.scope("facet",V),n&&n.scope("facet",V);for(let[tt,z]of pu(V,$))for(let[ut,Lt]of pu(z,I))for(let[Ie,le]of pu(Lt,E))if(!(n&&!n.reduce(le))){H.push(Z++),j.push(r.reduceIndex(le,O)),E&&rt.push(Ie),I&&ot.push(ut),F&&Gt.push($===F?tt:F[le[0]]),C&&at.push($===C?tt:C[le[0]]),U&&Q.push($===U?tt:U[le[0]]);for(let st of s)st.reduce(le);i&&i.reduce(le)}q.push(H)}return KO(q,i,o),{data:j,facets:q}}),...!Ta(s,"x")&&(c?{x:c}:{x1:m,x2:g}),...!Ta(s,"y")&&(u?{y:u}:{y1:y,y2:b}),...Object.fromEntries(s.map(({name:O,output:L})=>[O,L]))}}function Ta(e,...t){for(let{name:r}of e)if(t.includes(r))return!0;return!1}function ub(e,t,r=gI){let n=Object.entries(e);return t.title!=null&&e.title===void 0&&n.push(["title",jot]),t.href!=null&&e.href===void 0&&n.push(["href",_I]),n.filter(([,i])=>i!==void 0).map(([i,o])=>o===null?Pot(i):r(i,o,t))}function gI(e,t,r,n=bI){let i;Fn(t)&&"reduce"in t&&(i=t.scale,t=t.reduce);let o=n(e,t,r),[s,a]=Gr(o.label),c;return{name:e,output:i===void 0?s:{value:s,scale:i},initialize(l){o.initialize(l),c=a([])},scope(l,u){o.scope(l,u)},reduce(l,u){c.push(o.reduce(l,u))}}}function Pot(e){return{name:e,initialize(){},scope(){},reduce(){}}}function bI(e,t,r,n=gp){let i=lI(e,r),o=n(t,i),s,a;return{label:Qn(o===ab?null:i,o.label),initialize(c){s=i===void 0?c:gt(c,i),o.scope==="data"&&(a=o.reduceIndex(Kn(c),s))},scope(c,l){o.scope===c&&(a=o.reduceIndex(l,s))},reduce(c,l){return o.scope==null?o.reduceIndex(c,s,l):o.reduceIndex(c,s,a,l)}}}function pu(e,t){return t?ia(Vr(e,r=>t[r]),Pc):[[,e]]}function gp(e,t,r=$ot){if(e==null)return r(e);if(typeof e.reduceIndex=="function")return e;if(typeof e.reduce=="function"&&Fn(e))return zot(e);if(typeof e=="function")return Vot(e);if(/^p\d{2}$/i.test(e))return Vc(ap(e));switch(`${e}`.toLowerCase()){case"first":return _I;case"last":return qot;case"identity":return xI;case"count":return ab;case"distinct":return Yot;case"sum":return t==null?ab:Wot;case"proportion":return T5(t,"data");case"proportion-facet":return T5(t,"facet");case"deviation":return Vc(na);case"min":return Vc(Te);case"min-index":return Vc(rv);case"max":return Vc(ue);case"max-index":return Vc(ev);case"mean":return I5(xf);case"median":return I5(ws);case"variance":return Vc(zl);case"mode":return Vc(xh)}return r(e)}function $ot(e){throw new Error(`invalid reduce: ${e}`)}function fb(e,t){for(let r in t){let n=t[r];if(n!==void 0&&!e.some(i=>i.name===r))return n}}function KO(e,t,r){if(t){let n=t.output.transform(),i=(o,s)=>Wr(n[o],n[s]);e.forEach(o=>o.sort(i))}r&&e.forEach(n=>n.reverse())}function zot(e){return console.warn("deprecated reduce interface; implement reduceIndex instead."),{...e,reduceIndex:e.reduce.bind(e)}}function Vot(e){return{reduceIndex(t,r,n){return e(lp(r,t),n)}}}function Vc(e){return{reduceIndex(t,r){return e(t,n=>r[n])}}}function I5(e){return{reduceIndex(t,r){let n=e(t,i=>r[i]);return fr(r)?new Date(n):n}}}var xI={reduceIndex(e,t){return lp(t,e)}},_I={reduceIndex(e,t){return t[e[0]]}},jot={reduceIndex(e,t){let n=ia(_s(e,o=>o.length,o=>t[o]),du),i=n.slice(-5).reverse();if(i.length<n.length){let o=n.slice(0,-4);i[5-1]=[`\u2026 ${o.length.toLocaleString("en-US")} more`,hn(o,du)]}return i.map(([o,s])=>`${o} (${s.toLocaleString("en-US")})`).join(`
`)}},qot={reduceIndex(e,t){return t[e[e.length-1]]}},ab={label:"Frequency",reduceIndex(e){return e.length}},Yot={label:"Distinct",reduceIndex(e,t){let r=new xs;for(let n of e)r.add(t[n]);return r.size}},Wot=Vc(hn);function T5(e,t){return e==null?{scope:t,label:"Frequency",reduceIndex:(r,n,i=1)=>r.length/i}:{scope:t,reduceIndex:(r,n,i=1)=>hn(r,o=>n[o])/i}}function bp(e,{scale:t,type:r,value:n,filter:i,hint:o},s){return o===void 0&&typeof n?.transform=="function"&&(o=n.hint),JO(s,{scale:t,type:r,value:gt(e,n),label:Qn(n),filter:i,hint:o})}function wI(e,t){return Object.fromEntries(Object.entries(e).map(([r,n])=>[r,bp(t,n,r)]))}function xp(e,t){let r=Object.fromEntries(Object.entries(e).map(([n,{scale:i,value:o}])=>{let s=i==null?null:t[i];return[n,s==null?o:fe(o,s)]}));return r.channels=e,r}function JO(e,t){let{scale:r,value:n}=t;if(r===!0||r==="auto")switch(e){case"fill":case"stroke":case"color":t.scale=r!==!0&&hI(n,hu)?null:"color";break;case"fillOpacity":case"strokeOpacity":case"opacity":t.scale=r!==!0&&hI(n,m5)?null:"opacity";break;case"symbol":r!==!0&&hI(n,b5)?(t.scale=null,t.value=fe(n,yp)):t.scale="symbol";break;default:t.scale=Oe.has(e)?e:null;break}else if(r===!1)t.scale=null;else if(r!=null&&!Oe.has(r))throw new Error(`unknown scale: ${r}`);return t}function M5(e,t,r,n,i){let{order:o,reverse:s,reduce:a=!0,limit:c}=i;for(let l in i){if(!Oe.has(l))continue;let{value:u,order:f=o,reverse:d=s,reduce:h=a,limit:p=c}=Sa(i[l]),m=u?.startsWith("-");if(m&&(u=u.slice(1)),f=f===void 0?m!==(u==="width"||u==="height")?B5:E5:Hot(f),h==null||h===!1)continue;let g=l==="fx"||l==="fy"?Xot(t,n[l]):Got(r,l);if(!g)throw new Error(`missing channel for scale: ${l}`);let y=g.value,[b=0,x=1/0]=Dn(p)?p:p<0?[p]:[0,p];if(u==null)g.domain=()=>{let _=Array.from(new xs(y));return d&&(_=_.reverse()),(b!==0||x!==1/0)&&(_=_.slice(b,x)),_};else{let _=u==="data"?e:u==="height"?A5(r,"y1","y2"):u==="width"?A5(r,"x1","x2"):QO(r,u,u==="y"?"y2":u==="x"?"x2":void 0),w=gp(h===!0?"max":h,_);g.domain=()=>{let v=RE(Kn(y),A=>w.reduceIndex(A,_),A=>y[A]);return f&&v.sort(f),d&&v.reverse(),(b!==0||x!==1/0)&&(v=v.slice(b,x)),v.map(Pc)}}}}function Got(e,t){for(let r in e){let n=e[r];if(n.scale===t)return n}}function Xot(e,t){let r=e.original;if(r===e)return t;let n=t.value,i=t.value=[];for(let o=0;o<r.length;++o){let s=n[r[o][0]];for(let a of e[o])i[a]=s}return t}function A5(e,t,r){let n=QO(e,t),i=QO(e,r);return fe(i,(o,s)=>Math.abs(o-n[s]),Float64Array)}function QO(e,t,r){let n=e[t];if(!n&&r!==void 0&&(n=e[r]),n)return n.value;throw new Error(`missing channel: ${t}`)}function Hot(e){if(e==null||typeof e=="function")return e;switch(`${e}`.toLowerCase()){case"ascending":return E5;case"descending":return B5}throw new Error(`invalid order: ${e}`)}function E5([e,t],[r,n]){return Wr(t,n)||Wr(e,r)}function B5([e,t],[r,n]){return Yf(t,n)||Wr(e,r)}function vI(e,t){let r=e[t];if(r){for(;r.source;)r=r.source;return r.source===null?null:r}}function gu(e={}){let{document:t=typeof window<"u"?window.document:void 0}=e;return{document:t}}function ct(e,{document:t}){return ne(Mc(e).call(t.documentElement))}var tF=0;function O5(){let e=tF;return tF=0,e}function xn(e){console.warn(e),++tF}var N5=Math.PI,jc=2*N5,F5=.618;function D5({projection:e,inset:t=0,insetTop:r=t,insetRight:n=t,insetBottom:i=t,insetLeft:o=t}={},s){if(e==null)return;if(typeof e.stream=="function")return e;let a,c,l="frame";if(Fn(e)){let w;if({type:e,domain:c,inset:w,insetTop:r=w!==void 0?w:r,insetRight:n=w!==void 0?w:n,insetBottom:i=w!==void 0?w:i,insetLeft:o=w!==void 0?w:o,clip:l=l,...a}=e,e==null)return}typeof e!="function"&&({type:e}=L5(e));let{width:u,height:f,marginLeft:d,marginRight:h,marginTop:p,marginBottom:m}=s,g=u-d-h-o-n,y=f-p-m-r-i;if(e=e?.({width:g,height:y,clip:l,...a}),e==null)return;l=Zot(l,d,p,u-h,f-m);let b=d+o,x=p+r,_;if(c!=null){let[[w,v],[A,B]]=mn(e).bounds(c),D=Math.min(g/(A-w),y/(B-v));D>0?(b-=(D*(w+A)-g)/2,x-=(D*(v+B)-y)/2,_=Rf({point(T,M){this.stream.point(T*D+b,M*D+x)}})):xn("Warning: the projection could not be fit to the specified domain; using the default scale.")}return _??=b===0&&x===0?R5():Rf({point(w,v){this.stream.point(w+b,v+x)}}),{stream:w=>e.stream(_.stream(l(w)))}}function L5(e){switch(`${e}`.toLowerCase()){case"albers-usa":return As(a3,.7463,.4673);case"albers":return SI(m0,.7463,.4673);case"azimuthal-equal-area":return As(l3,4,4);case"azimuthal-equidistant":return As(f3,jc,jc);case"conic-conformal":return SI(p3,jc,jc);case"conic-equal-area":return SI(Jl,6.1702,2.9781);case"conic-equidistant":return SI(y3,7.312,3.6282);case"equal-earth":return As(b3,5.4133,2.6347);case"equirectangular":return As(m3,jc,N5);case"gnomonic":return As(_3,3.4641,3.4641);case"identity":return{type:R5};case"reflect-y":return{type:Kot};case"mercator":return As(d3,jc,jc);case"orthographic":return As(v3,2,2);case"stereographic":return As(I3,2,2);case"transverse-mercator":return As(A3,jc,jc);default:throw new Error(`unknown projection type: ${e}`)}}function Zot(e,t,r,n,i){if(e===!1||e==null||typeof e=="number")return o=>o;switch(e===!0&&(e="frame"),`${e}`.toLowerCase()){case"frame":return Uh(t,r,n,i);default:throw new Error(`unknown projection clip type: ${e}`)}}function As(e,t,r){return{type:({width:n,height:i,rotate:o,precision:s=.15,clip:a})=>{let c=e();return s!=null&&c.precision?.(s),o!=null&&c.rotate?.(o),typeof a=="number"&&c.clipAngle?.(a),c.scale(Math.min(n/t,i/r)),c.translate([n/2,i/2]),c},aspectRatio:r/t}}function SI(e,t,r){let{type:n,aspectRatio:i}=As(e,t,r);return{type:o=>{let{parallels:s,domain:a,width:c,height:l}=o,u=n(o);return s!=null&&(u.parallels(s),a===void 0&&u.fitSize([c,l],{type:"Sphere"})),u},aspectRatio:i}}var R5=Cr({stream:e=>e}),Kot=Cr(Rf({point(e,t){this.stream.point(e,-t)}}));function eF(e,t,r,n){let i=r[e],o=r[t],s=i.length,a=r[e]=new Float64Array(s).fill(NaN),c=r[t]=new Float64Array(s).fill(NaN),l,u=n.stream({point(f,d){a[l]=f,c[l]=d}});for(l=0;l<s;++l)u.point(i[l],o[l])}function k5({projection:e}={}){return e==null?!1:typeof e.stream=="function"?!0:(Fn(e)&&(e=e.type),e!=null)}function C5(e){if(typeof e?.stream=="function")return F5;if(Fn(e)&&(e=e.type),e!=null){if(typeof e!="function"){let{aspectRatio:t}=L5(e);if(t)return t}return F5}}function bu(e,t,{projection:r}){let{x:n,y:i}=e,o={};return n&&(o.x=n),i&&(o.y=i),o=xp(o,t),r&&n?.scale==="x"&&i?.scale==="y"&&eF("x","y",o,r),n&&(o.x=Fr(o.x)),i&&(o.y=Fr(o.y)),o}function U5(e){let t=[],r=[],n={scale:"x",value:t},i={scale:"y",value:r},o={point(s,a){t.push(s),r.push(a)},lineStart(){},lineEnd(){},polygonStart(){},polygonEnd(){},sphere(){}};for(let s of e.value)Wi(s,o);return[n,i]}var j5=new Map([["accent",K3],["category10",Z3],["dark2",Q3],["paired",J3],["pastel1",tO],["pastel2",eO],["set1",rO],["set2",nO],["set3",iO],["tableau10",oO]]);function q5(e){return e!=null&&j5.has(`${e}`.toLowerCase())}var P5=new Map([...j5,["brbg",qc($2,z2)],["prgn",qc(V2,j2)],["piyg",qc(q2,Y2)],["puor",qc(W2,G2)],["rdbu",qc(U0,Kh)],["rdgy",qc(X2,H2)],["rdylbu",qc(P0,Qh)],["rdylgn",qc(Z2,K2)],["spectral",qc(Q2,J2)],["burd",$5(U0,Kh)],["buylrd",$5(P0,Qh)],["blues",Hr(IS,TS)],["greens",Hr(AS,MS)],["greys",Hr(ES,BS)],["oranges",Hr(LS,RS)],["purples",Hr(OS,FS)],["reds",Hr(NS,DS)],["turbo",Yc(qS)],["viridis",Yc(WS)],["magma",Yc(GS)],["inferno",Yc(XS)],["plasma",Yc(HS)],["cividis",Yc(kS)],["cubehelix",Yc(CS)],["warm",Yc(PS)],["cool",Yc($S)],["bugn",Hr(tS,eS)],["bupu",Hr(rS,nS)],["gnbu",Hr(iS,oS)],["orrd",Hr(sS,aS)],["pubu",Hr(uS,fS)],["pubugn",Hr(cS,lS)],["purd",Hr(dS,hS)],["rdpu",Hr(pS,mS)],["ylgn",Hr(bS,xS)],["ylgnbu",Hr(yS,gS)],["ylorbr",Hr(_S,wS)],["ylorrd",Hr(vS,SS)],["rainbow",z5(zS)],["sinebow",z5(jS)]]);function Hr(e,t){return({length:r})=>r===1?[e[3][1]]:r===2?[e[3][1],e[3][2]]:(r=Math.max(3,Math.floor(r)),r>9?In(t,r):e[r])}function qc(e,t){return({length:r})=>r===2?[e[3][0],e[3][2]]:(r=Math.max(3,Math.floor(r)),r>11?In(t,r):e[r])}function $5(e,t){return({length:r})=>r===2?[e[3][2],e[3][0]]:(r=Math.max(3,Math.floor(r)),r>11?In(n=>t(1-n),r):e[r].slice().reverse())}function Yc(e){return({length:t})=>In(e,Math.max(2,Math.floor(t)))}function z5(e){return({length:t})=>In(e,Math.floor(t)+1).slice(0,-1)}function rF(e){let t=`${e}`.toLowerCase();if(!P5.has(t))throw new Error(`unknown ordinal scheme: ${t}`);return P5.get(t)}function db(e,t){let r=rF(e),n=typeof r=="function"?r({length:t}):r;return n.length!==t?n.slice(0,t):n}function Y5(e,t="greys"){let r=new Set,[n,i]=db(t,2);for(let o of e)if(o!=null)if(o===!0)r.add(i);else if(o===!1)r.add(n);else return;return[...r]}var V5=new Map([["brbg",z2],["prgn",j2],["piyg",Y2],["puor",G2],["rdbu",Kh],["rdgy",H2],["rdylbu",Qh],["rdylgn",K2],["spectral",J2],["burd",e=>Kh(1-e)],["buylrd",e=>Qh(1-e)],["blues",TS],["greens",MS],["greys",BS],["purples",FS],["reds",DS],["oranges",RS],["turbo",qS],["viridis",WS],["magma",GS],["inferno",XS],["plasma",HS],["cividis",kS],["cubehelix",CS],["warm",PS],["cool",$S],["bugn",eS],["bupu",nS],["gnbu",oS],["orrd",aS],["pubugn",lS],["pubu",fS],["purd",hS],["rdpu",mS],["ylgnbu",gS],["ylgn",xS],["ylorbr",wS],["ylorrd",SS],["rainbow",zS],["sinebow",jS]]);function _p(e){let t=`${e}`.toLowerCase();if(!V5.has(t))throw new Error(`unknown quantitative scheme: ${t}`);return V5.get(t)}var Qot=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);function W5(e){return e!=null&&Qot.has(`${e}`.toLowerCase())}var iF=e=>t=>e(1-t),nF=[0,1],G5=new Map([["number",Ge],["rgb",Mo],["hsl",aB],["hcl",cB],["lab",Sv]]);function oF(e){let t=`${e}`.toLowerCase();if(!G5.has(t))throw new Error(`unknown interpolator: ${t}`);return G5.get(t)}function vp(e,t,r,{type:n,nice:i,clamp:o,zero:s,domain:a=eP(e,r),unknown:c,round:l,scheme:u,interval:f,range:d=Oe.get(e)===dp?rst(r,a):Oe.get(e)===hp?nst(r,a):Oe.get(e)===pp?nF:void 0,interpolate:h=Oe.get(e)===Ji?u==null&&d!==void 0?Mo:_p(u!==void 0?u:n==="cyclical"?"rainbow":"turbo"):l?Af:Ge,reverse:p}){if(f=va(f,n),(n==="cyclical"||n==="sequential")&&(n="linear"),p=!!p,d!==void 0){let m=(a=vr(a)).length,g=(d=vr(d)).length;m>g?(a=a.slice(0,g),xn(`Warning: the ${e} scale domain contains extra elements.`)):g>m&&(d=d.slice(0,m),xn(`Warning: the ${e} scale range contains extra elements.`))}if(typeof h!="function"&&(h=oF(h)),h.length===1?(p&&(h=iF(h),p=!1),d===void 0&&(d=Float64Array.from(a,(m,g)=>g/(a.length-1)),d.length===2&&(d=nF)),t.interpolate((d===nF?Cr:hb)(h))):t.interpolate(h),s){let[m,g]=ze(a);(m>0||g<0)&&(a=ob(a),Hf(a)!==Math.sign(m)?a[a.length-1]=0:a[0]=0)}return p&&(a=jl(a)),t.domain(a).unknown(c),i&&(t.nice(Jot(i,n)),a=t.domain()),d!==void 0&&t.range(d),o&&t.clamp(o),{type:n,domain:a,range:d,scale:t,interpolate:h,interval:f}}function Jot(e,t){return e===!0?void 0:typeof e=="number"?e:u5(e,t)}function X5(e,t,r){return vp(e,Rc(),t,r)}function H5(e,t,r){return sF(e,t,{...r,exponent:.5})}function sF(e,t,{exponent:r=1,...n}){return vp(e,M0().exponent(r),t,{...n,type:"pow"})}function Z5(e,t,{base:r=10,domain:n=ist(t),...i}){return vp(e,T0().base(r),t,{...i,domain:n})}function K5(e,t,{constant:r=1,...n}){return vp(e,A0().constant(r),t,n)}function Q5(e,t,{range:r,quantiles:n=r===void 0?5:(r=[...r]).length,n:i=n,scheme:o="rdylbu",domain:s=ost(t),unknown:a,interpolate:c,reverse:l}){return r===void 0&&(r=c!==void 0?In(c,i):Oe.get(e)===Ji?db(o,i):void 0),s.length>0&&(s=E0(s,r===void 0?{length:i}:r).quantiles()),II(e,t,{domain:s,range:r,reverse:l,unknown:a})}function J5(e,t,{range:r,n=r===void 0?5:(r=[...r]).length,scheme:i="rdylbu",domain:o=eP(e,t),unknown:s,interpolate:a,reverse:c}){let[l,u]=ze(o),f;return r===void 0?(f=dn(l,u,n),f[0]<=l&&f.splice(0,1),f[f.length-1]>=u&&f.pop(),n=f.length+1,r=a!==void 0?In(a,n):Oe.get(e)===Ji?db(i,n):void 0):(f=In(Ge(l,u),n+1).slice(1,-1),l instanceof Date&&(f=f.map(d=>new Date(d)))),Hf(vr(o))<0&&f.reverse(),II(e,t,{domain:f,range:r,reverse:c,unknown:s})}function II(e,t,{domain:r=[0],unknown:n,scheme:i="rdylbu",interpolate:o,range:s=o!==void 0?In(o,r.length+1):Oe.get(e)===Ji?db(i,r.length+1):void 0,reverse:a}){r=vr(r);let c=Hf(r);if(!isNaN(c)&&!tst(r,c))throw new Error(`the ${e} scale has a non-monotonic domain`);return a&&(s=jl(s)),{type:"threshold",scale:B0(c<0?jl(r):r,s===void 0?[]:s).unknown(n),domain:r,range:s}}function tst(e,t){for(let r=1,n=e.length,i=e[0];r<n;++r){let o=To(i,i=e[r]);if(o!==0&&o!==t)return!1}return!0}function tP(){return{type:"identity",scale:S0()}}function wp(e,t=sp){return e.length?[Te(e,({value:r})=>r===void 0?r:Te(r,t)),ue(e,({value:r})=>r===void 0?r:ue(r,t))]:[0,1]}function eP(e,t){let r=Oe.get(e);return(r===dp||r===pp||r===hp?est:wp)(t)}function est(e){return[0,e.length?ue(e,({value:t})=>t===void 0?t:ue(t,sp)):1]}function rst(e,t){let r=e.find(({radius:s})=>s!==void 0);if(r!==void 0)return[0,r.radius];let n=zn(e,.5,({value:s})=>s===void 0?NaN:zn(s,.25,Zn)),i=t.map(s=>3*Math.sqrt(s/n)),o=30/ue(i);return o<1?i.map(s=>s*o):i}function nst(e,t){let r=ws(e,({value:o})=>o===void 0?NaN:ws(o,Math.abs)),n=t.map(o=>12*o/r),i=60/ue(n);return i<1?n.map(o=>o*i):n}function ist(e){for(let{value:t}of e)if(t!==void 0)for(let r of t){if(r>0)return wp(e,Zn);if(r<0)return wp(e,uu)}return[1,10]}function ost(e){let t=[];for(let{value:r}of e)if(r!==void 0)for(let n of r)t.push(n);return t}function hb(e){return(t,r)=>n=>e(t+n*(r-t))}function TI(e,t,r,n,{type:i,nice:o,clamp:s,domain:a=wp(n),unknown:c,pivot:l=0,scheme:u,range:f,symmetric:d=!0,interpolate:h=Oe.get(e)===Ji?u==null&&f!==void 0?Mo:_p(u!==void 0?u:"rdbu"):Ge,reverse:p}){l=+l,a=vr(a);let[m,g]=a;if(a.length>2&&xn(`Warning: the diverging ${e} scale domain contains extra elements.`),To(m,g)<0&&([m,g]=[g,m],p=!p),m=Math.min(m,l),g=Math.max(g,l),typeof h!="function"&&(h=oF(h)),f!==void 0&&(h=h.length===1?hb(h)(...f):Gl(h,f)),p&&(h=iF(h)),d){let y=r.apply(l),b=y-r.apply(m),x=r.apply(g)-y;b<x?m=r.invert(y-x):b>x&&(g=r.invert(y+b))}return t.domain([m,l,g]).unknown(c).interpolator(h),s&&t.clamp(s),o&&t.nice(o),{type:i,domain:[m,g],pivot:l,interpolate:h,scale:t}}function rP(e,t,r){return TI(e,C0(),sst,t,r)}function nP(e,t,r){return aF(e,t,{...r,exponent:.5})}function aF(e,t,{exponent:r=1,...n}){return TI(e,P2().exponent(r=+r),lst(r),t,{...n,type:"diverging-pow"})}function iP(e,t,{base:r=10,pivot:n=1,domain:i=wp(t,n<0?uu:Zn),...o}){return TI(e,C2().base(r=+r),ast,t,{domain:i,pivot:n,...o})}function oP(e,t,{constant:r=1,...n}){return TI(e,U2().constant(r=+r),ust(r),t,n)}var sst={apply(e){return e},invert(e){return e}},ast={apply:Math.log,invert:Math.exp},cst={apply(e){return Math.sign(e)*Math.sqrt(Math.abs(e))},invert(e){return Math.sign(e)*(e*e)}};function lst(e){return e===.5?cst:{apply(t){return Math.sign(t)*Math.pow(Math.abs(t),e)},invert(t){return Math.sign(t)*Math.pow(Math.abs(t),1/e)}}}function ust(e){return{apply(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))},invert(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}}function sP(e,t,r,n){return vp(e,t,r,n)}function aP(e,t,r){return sP(e,L2(),t,r)}function cP(e,t,r){return sP(e,R2(),t,r)}var Sp=Symbol("ordinal");function uP(e,t,r,{type:n,interval:i,domain:o,range:s,reverse:a,hint:c}){return i=va(i,n),o===void 0&&(o=mP(r,i,e)),(n==="categorical"||n===Sp)&&(n="ordinal"),a&&(o=jl(o)),t.domain(o),s!==void 0&&(typeof s=="function"&&(s=s(o)),t.range(s)),{type:n,domain:o,range:s,scale:t,hint:c,interval:i}}function fP(e,t,{type:r,interval:n,domain:i,range:o,scheme:s,unknown:a,...c}){n=va(n,r),i===void 0&&(i=mP(t,n,e));let l;if(Oe.get(e)===mp)l=fst(t),o=o===void 0?dst(l):fe(o,yp);else if(Oe.get(e)===Ji&&(o===void 0&&(r==="ordinal"||r===Sp)&&(o=Y5(i,s),o!==void 0&&(s=void 0)),s===void 0&&o===void 0&&(s=r==="ordinal"?"turbo":"tableau10"),s!==void 0))if(o!==void 0){let u=_p(s),f=o[0],d=o[1]-o[0];o=({length:h})=>In(p=>u(f+d*p),h)}else o=rF(s);if(a===w0)throw new Error(`implicit unknown on ${e} scale is not supported`);return uP(e,Cf().unknown(a),t,{...c,type:r,domain:i,range:o,hint:l})}function dP(e,t,{align:r=.5,padding:n=.5,...i}){return pP(L3().align(r).padding(n),t,i,e)}function hP(e,t,{align:r=.5,padding:n=.1,paddingInner:i=n,paddingOuter:o=e==="fx"||e==="fy"?0:n,...s}){return pP(eu().align(r).paddingInner(i).paddingOuter(o),t,s,e)}function pP(e,t,r,n){let{round:i}=r;return i!==void 0&&e.round(i=!!i),e=uP(n,e,t,r),e.round=i,e}function mP(e,t,r){let n=new xs;for(let{value:i,domain:o}of e){if(o!==void 0)return o();if(i!==void 0)for(let s of i)n.add(s)}if(t!==void 0){let[i,o]=ze(n).map(t.floor,t);return t.range(i,t.offset(o))}if(n.size>1e4&&Oe.get(r)===Qi)throw new Error(`implicit ordinal domain of ${r} scale has more than 10,000 values`);return ia(n,Wr)}function lP(e,t){let r;for(let{hint:n}of e){let i=n?.[t];if(i!==void 0){if(r===void 0)r=i;else if(r!==i)return}}return r}function fst(e){return{fill:lP(e,"fill"),stroke:lP(e,"stroke")}}function dst(e){return Ke(e.fill)?dO:eI}function pb(e,{label:t,inset:r=0,insetTop:n=r,insetRight:i=r,insetBottom:o=r,insetLeft:s=r,round:a,nice:c,clamp:l,zero:u,align:f,padding:d,projection:h,facet:{label:p=t}={},...m}={}){let g={};for(let[y,b]of e){let x=m[y],_=vP(y,b,{round:Oe.get(y)===Qi?a:void 0,nice:c,clamp:l,zero:u,align:f,padding:d,projection:h,...x});if(_){let{label:w=y==="fx"||y==="fy"?p:t,percent:v,transform:A,inset:B,insetTop:D=B!==void 0?B:y==="y"?n:0,insetRight:T=B!==void 0?B:y==="x"?i:0,insetBottom:M=B!==void 0?B:y==="y"?o:0,insetLeft:O=B!==void 0?B:y==="x"?s:0}=x||{};if(A==null)A=void 0;else if(typeof A!="function")throw new Error("invalid scale transform; not a function");_.percent=!!v,_.label=w===void 0?hst(b,_):w,_.transform=A,y==="x"||y==="fx"?(_.insetLeft=+O,_.insetRight=+T):(y==="y"||y==="fy")&&(_.insetTop=+D,_.insetBottom=+M),g[y]=_}}return g}function lF(e){return Object.fromEntries(Object.entries(e).filter(([,{scale:t}])=>t).map(([t,{scale:r,type:n,interval:i,label:o}])=>(r.type=n,i!=null&&(r.interval=i),o!=null&&(r.label=o),[t,r])))}function xP(e,t){let{x:r,y:n,fx:i,fy:o}=e,s=i||o?MI(t):t;i&&yP(i,s),o&&gP(o,s);let a=i||o?uF(e,t):t;r&&yP(r,a),n&&gP(n,a)}function hst(e=[],t){let r;for(let{label:n}of e)if(n!==void 0){if(r===void 0)r=n;else if(r!==n)return}if(r!==void 0)return!Aa(t)&&t.percent&&(r=`${r} (%)`),{inferred:!0,toString:()=>r}}function MI(e){let{marginTop:t,marginRight:r,marginBottom:n,marginLeft:i,width:o,height:s,facet:{marginTop:a,marginRight:c,marginBottom:l,marginLeft:u}}=e;return{marginTop:Math.max(t,a),marginRight:Math.max(r,c),marginBottom:Math.max(n,l),marginLeft:Math.max(i,u),width:o,height:s}}function uF({fx:e,fy:t},r){let{marginTop:n,marginRight:i,marginBottom:o,marginLeft:s,width:a,height:c}=MI(r);return{marginTop:n,marginRight:i,marginBottom:o,marginLeft:s,width:e?e.scale.bandwidth()+s+i:a,height:t?t.scale.bandwidth()+n+o:c,facet:{width:a,height:c}}}function yP(e,t){if(e.range===void 0){let{insetLeft:r,insetRight:n}=e,{width:i,marginLeft:o=0,marginRight:s=0}=t,a=o+r,c=i-s-n;e.range=[a,Math.max(a,c)],Aa(e)||(e.range=wP(e)),e.scale.range(e.range)}_P(e)}function gP(e,t){if(e.range===void 0){let{insetTop:r,insetBottom:n}=e,{height:i,marginTop:o=0,marginBottom:s=0}=t,a=o+r,c=i-s-n;e.range=[Math.max(a,c),a],Aa(e)?e.range.reverse():e.range=wP(e),e.scale.range(e.range)}_P(e)}function _P(e){e.round===void 0&&yst(e)&&pst(e)<=30&&e.scale.round(!0)}function pst({scale:e}){let t=e.domain().length,[r,n]=e.range(),i=e.paddingInner?e.paddingInner():1,o=e.paddingOuter?e.paddingOuter():e.padding(),s=t-i,a=Math.abs(n-r)/Math.max(1,s+o*2);return(a-Math.floor(a))*s}function wP(e){let t=e.scale.domain().length+dF(e);if(!(t>2))return e.range;let[r,n]=e.range;return Array.from({length:t},(i,o)=>r+o/(t-1)*(n-r))}function EI(e,t,r){return vP(e,r===void 0?void 0:[{hint:r}],{...t})}function vP(e,t=[],r={}){let n=mst(e,t,r);if(r.type===void 0&&r.domain===void 0&&r.range===void 0&&r.interval==null&&e!=="fx"&&e!=="fy"&&Aa({type:n})){let i=t.map(({value:o})=>o).filter(o=>o!==void 0);i.some(fr)?xn(`Warning: some data associated with the ${e} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${Ip(n)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${e} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${e} scale to "${Ip(n)}".`):i.some(h5)?xn(`Warning: some data associated with the ${e} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${Ip(n)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${e} scale to "${Ip(n)}".`):i.some(p5)&&xn(`Warning: some data associated with the ${e} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${Ip(n)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${e} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${e} scale to "${Ip(n)}".`)}switch(r.type=n,n){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":r=AI(t,r,Fr);break;case"identity":switch(Oe.get(e)){case Qi:r=AI(t,r,Fr);break;case mp:r=AI(t,r,gst);break}break;case"utc":case"time":r=AI(t,r,l5);break}switch(n){case"diverging":return rP(e,t,r);case"diverging-sqrt":return nP(e,t,r);case"diverging-pow":return aF(e,t,r);case"diverging-log":return iP(e,t,r);case"diverging-symlog":return oP(e,t,r);case"categorical":case"ordinal":case Sp:return fP(e,t,r);case"cyclical":case"sequential":case"linear":return X5(e,t,r);case"sqrt":return H5(e,t,r);case"threshold":return II(e,t,r);case"quantile":return Q5(e,t,r);case"quantize":return J5(e,t,r);case"pow":return sF(e,t,r);case"log":return Z5(e,t,r);case"symlog":return K5(e,t,r);case"utc":return cP(e,t,r);case"time":return aP(e,t,r);case"point":return dP(e,t,r);case"band":return hP(e,t,r);case"identity":return Oe.get(e)===Qi?tP():{type:"identity"};case void 0:return;default:throw new Error(`unknown scale type: ${n}`)}}function Ip(e){return typeof e=="symbol"?e.description:e}var bP={toString:()=>"projection"};function mst(e,t,{type:r,domain:n,range:i,scheme:o,pivot:s,projection:a}){if(e==="fx"||e==="fy")return"band";(e==="x"||e==="y")&&a!=null&&(r=bP);for(let{type:l}of t)if(l!==void 0){if(r===void 0)r=l;else if(r!==l)throw new Error(`scale incompatible with channel: ${r} !== ${l}`)}if(r===bP)return;if(r!==void 0)return r;if(n===void 0&&!t.some(({value:l})=>l!==void 0))return;let c=Oe.get(e);if(c===dp)return"sqrt";if(c===pp||c===hp)return"linear";if(c===mp)return"ordinal";if((n||i||[]).length>2)return cF(c);if(n!==void 0){if(bn(n))return cF(c);if(fr(n))return"utc"}else{let l=t.map(({value:u})=>u).filter(u=>u!==void 0);if(l.some(bn))return cF(c);if(l.some(fr))return"utc"}if(c===Ji){if(s!=null||W5(o))return"diverging";if(q5(o))return"categorical"}return"linear"}function cF(e){switch(e){case Qi:return"point";case Ji:return Sp;default:return"ordinal"}}function fF({type:e}){return e==="time"||e==="utc"}function Aa({type:e}){return e==="ordinal"||e==="point"||e==="band"||e===Sp}function dF({type:e}){return e==="threshold"}function yst({type:e}){return e==="point"||e==="band"}function Jn(e){if(e===void 0)return!0;let t=e.domain(),r=e(t[0]);for(let n=1,i=t.length;n<i;++n)if(e(t[n])-r)return!1;return!0}function AI(e,{domain:t,...r},n){for(let i of e)i.value!==void 0&&(i.value=n(i.value));return{domain:t===void 0?t:n(t),...r}}function gst(e){return fe(e,yp)}function Ma(e={}){let t;for(let r in e)if(Oe.has(r)&&_a(e[r])){if(t!==void 0)throw new Error("ambiguous scale definition; multiple scales found");t=IP(EI(r,e[r]))}if(t===void 0)throw new Error("invalid scale definition; no scale found");return t}function SP(e){return t=>{if(!Oe.has(t=`${t}`))throw new Error(`unknown scale: ${t}`);return t in e?IP(e[t]):void 0}}function IP({scale:e,type:t,domain:r,range:n,interpolate:i,interval:o,transform:s,percent:a,pivot:c}){if(t==="identity")return{type:"identity",apply:u=>u,invert:u=>u};let l=e.unknown?e.unknown():void 0;return{type:t,domain:ob(r),...n!==void 0&&{range:ob(n)},...s!==void 0&&{transform:s},...a&&{percent:a},...l!==void 0&&{unknown:l},...o!==void 0&&{interval:o},...i!==void 0&&{interpolate:i},...e.clamp&&{clamp:e.clamp()},...c!==void 0&&{pivot:c,symmetric:!1},...e.base&&{base:e.base()},...e.exponent&&{exponent:e.exponent()},...e.constant&&{constant:e.constant()},...e.align&&{align:e.align(),round:e.round()},...e.padding&&(e.paddingInner?{paddingInner:e.paddingInner(),paddingOuter:e.paddingOuter()}:{padding:e.padding()}),...e.bandwidth&&{bandwidth:e.bandwidth(),step:e.step()},apply:u=>e(u),...e.invert&&{invert:u=>e.invert(u)}}}function BI(e){let t,r;return(...n)=>((r?.length!==n.length||r.some((i,o)=>i!==n[o]))&&(r=n,t=e(...n)),t)}var bst=BI(e=>new Intl.NumberFormat(e)),xst=BI((e,t)=>new Intl.DateTimeFormat(e,{timeZone:"UTC",...t&&{month:t}})),_st=BI((e,t)=>new Intl.DateTimeFormat(e,{timeZone:"UTC",...t&&{weekday:t}}));function wst(e="en-US"){let t=bst(e);return r=>r!=null&&!isNaN(r)?t.format(r):void 0}function TP(e="en-US",t="short"){let r=xst(e,t);return n=>n!=null&&!isNaN(n=+new Date(Date.UTC(2e3,+n)))?r.format(n):void 0}function AP(e="en-US",t="short"){let r=_st(e,t);return n=>n!=null&&!isNaN(n=+new Date(Date.UTC(2001,0,+n)))?r.format(n):void 0}function mb(e){return dh(e,"Invalid Date")}function vst(e="en-US"){let t=wst(e);return r=>(r instanceof Date?mb:typeof r=="number"?t:nr)(r)}var to=vst();var ir=(typeof window<"u"?window.devicePixelRatio>1:typeof it>"u")?0:.5,Sst=0;function MP(){return`plot-clip-${++Sst}`}function OI(e,{title:t,href:r,ariaLabel:n,ariaDescription:i,ariaHidden:o,target:s,fill:a,fillOpacity:c,stroke:l,strokeWidth:u,strokeOpacity:f,strokeLinejoin:d,strokeLinecap:h,strokeMiterlimit:p,strokeDasharray:m,strokeDashoffset:g,opacity:y,mixBlendMode:b,imageFilter:x,paintOrder:_,pointerEvents:w,shapeRendering:v,channels:A},{ariaLabel:B,fill:D="currentColor",fillOpacity:T,stroke:M="none",strokeOpacity:O,strokeWidth:L,strokeLinecap:S,strokeLinejoin:E,strokeMiterlimit:I,paintOrder:F}){D===null&&(a=null,c=null),M===null&&(l=null,f=null),Ke(D)?!Ke(M)&&(!Ke(a)||A?.fill)&&(M="none"):Ke(M)&&(!Ke(l)||A?.stroke)&&(D="none");let[C,U]=wr(a,D),[$,q]=Se(c,T),[j,rt]=wr(l,M),[ot,Gt]=Se(f,O),[at,Q]=Se(y);zc(rt)||(u===void 0&&(u=L),h===void 0&&(h=S),d===void 0&&(d=E),p===void 0&&!y5(d)&&(p=I),!zc(U)&&_===void 0&&(_=F));let[Z,V]=Se(u);return D!==null&&(e.fill=Ae(U,"currentColor"),e.fillOpacity=yb(q,1)),M!==null&&(e.stroke=Ae(rt,"none"),e.strokeWidth=yb(V,1),e.strokeOpacity=yb(Gt,1),e.strokeLinejoin=Ae(d,"miter"),e.strokeLinecap=Ae(h,"butt"),e.strokeMiterlimit=yb(p,4),e.strokeDasharray=Ae(m,"none"),e.strokeDashoffset=Ae(g,"0")),e.target=nr(s),e.ariaLabel=nr(B),e.ariaDescription=nr(i),e.ariaHidden=nr(o),e.opacity=yb(Q,1),e.mixBlendMode=Ae(b,"normal"),e.imageFilter=Ae(x,"none"),e.paintOrder=Ae(_,"normal"),e.pointerEvents=Ae(w,"auto"),e.shapeRendering=Ae(v,"auto"),{title:{value:t,optional:!0},href:{value:r,optional:!0},ariaLabel:{value:n,optional:!0},fill:{value:C,scale:"auto",optional:!0},fillOpacity:{value:$,scale:"auto",optional:!0},stroke:{value:j,scale:"auto",optional:!0},strokeOpacity:{value:ot,scale:"auto",optional:!0},strokeWidth:{value:Z,optional:!0},opacity:{value:at,scale:"auto",optional:!0}}}function Ist(e,t){t&&e.filter(r=>nb(t[r])).append("title").call(Ast,t)}function Tst(e,t){t&&e.filter(([r])=>nb(t[r])).append("title").call(Mst,t)}function Ast(e,t){t&&e.text(r=>to(t[r]))}function Mst(e,t){t&&e.text(([r])=>to(t[r]))}function he(e,{target:t,tip:r},{ariaLabel:n,title:i,fill:o,fillOpacity:s,stroke:a,strokeOpacity:c,strokeWidth:l,opacity:u,href:f}){n&&lt(e,"aria-label",d=>n[d]),o&&lt(e,"fill",d=>o[d]),s&&lt(e,"fill-opacity",d=>s[d]),a&&lt(e,"stroke",d=>a[d]),c&&lt(e,"stroke-opacity",d=>c[d]),l&&lt(e,"stroke-width",d=>l[d]),u&&lt(e,"opacity",d=>u[d]),f&&BP(e,d=>f[d],t),r||Ist(e,i)}function Zf(e,{target:t,tip:r},{ariaLabel:n,title:i,fill:o,fillOpacity:s,stroke:a,strokeOpacity:c,strokeWidth:l,opacity:u,href:f}){n&&lt(e,"aria-label",([d])=>n[d]),o&&lt(e,"fill",([d])=>o[d]),s&&lt(e,"fill-opacity",([d])=>s[d]),a&&lt(e,"stroke",([d])=>a[d]),c&&lt(e,"stroke-opacity",([d])=>c[d]),l&&lt(e,"stroke-width",([d])=>l[d]),u&&lt(e,"opacity",([d])=>u[d]),f&&BP(e,([d])=>f[d],t),r||Tst(e,i)}function Est({ariaLabel:e,title:t,fill:r,fillOpacity:n,stroke:i,strokeOpacity:o,strokeWidth:s,opacity:a,href:c},{tip:l}){return[e,l?void 0:t,r,n,i,o,s,a,c].filter(u=>u!==void 0)}function gb(e,t,r){let n=Vr(e,i=>t[i]);return r===void 0&&n.size>1+e.length>>1&&xn("Warning: the implicit z channel has high cardinality. This may occur when the fill or stroke channel is associated with quantitative data rather than ordinal or categorical data. You can suppress this warning by setting the z option explicitly; if this data represents a single series, set z to null."),n.values()}function*FI(e,t,r,n){let{z:i}=r,{z:o}=n,s=Est(n,r),a=[...t,...s];for(let c of o?gb(e,o,i):[e]){let l,u;t:for(let f of c){for(let d of a)if(!_r(d[f])){u&&u.push(-1);continue t}if(l===void 0){u&&(yield u),l=s.map(d=>$c(d[f])),u=[f];continue}u.push(f);for(let d=0;d<s.length;++d)if($c(s[d][f])!==l[d]){yield u,l=s.map(p=>$c(p[f])),u=[f];continue t}}u&&(yield u)}}function EP(e){return e===!0?e="frame":e===!1&&(e=null),Gf(e,"clip",["frame","sphere"])}function Bst(e,t,r,n){let i;switch(t.clip){case"frame":{let{width:o,height:s,marginLeft:a,marginRight:c,marginTop:l,marginBottom:u}=r,f=MP();i=`url(#${f})`,e=ct("svg:g",n).call(d=>d.append("svg:clipPath").attr("id",f).append("rect").attr("x",a).attr("y",l).attr("width",o-c-a).attr("height",s-l-u)).each(function(){this.appendChild(e.node()),e.node=()=>this});break}case"sphere":{let{projection:o}=n;if(!o)throw new Error('the "sphere" clip option requires a projection');let s=MP();i=`url(#${s})`,e.append("clipPath").attr("id",s).append("path").attr("d",mn(o)({type:"Sphere"}));break}}lt(e,"aria-label",t.ariaLabel),lt(e,"aria-description",t.ariaDescription),lt(e,"aria-hidden",t.ariaHidden),lt(e,"clip-path",i)}function Pt(e,t,r,n){Bst(e,t,r,n),lt(e,"fill",t.fill),lt(e,"fill-opacity",t.fillOpacity),lt(e,"stroke",t.stroke),lt(e,"stroke-width",t.strokeWidth),lt(e,"stroke-opacity",t.strokeOpacity),lt(e,"stroke-linejoin",t.strokeLinejoin),lt(e,"stroke-linecap",t.strokeLinecap),lt(e,"stroke-miterlimit",t.strokeMiterlimit),lt(e,"stroke-dasharray",t.strokeDasharray),lt(e,"stroke-dashoffset",t.strokeDashoffset),lt(e,"shape-rendering",t.shapeRendering),lt(e,"filter",t.imageFilter),lt(e,"paint-order",t.paintOrder),lt(e,"pointer-events",t.pointerEvents)}function Dt(e,t){Ost(e,"mix-blend-mode",t.mixBlendMode),lt(e,"opacity",t.opacity)}function BP(e,t,r){e.each(function(n){let i=t(n);if(i!=null){let o=this.ownerDocument.createElementNS(Ao.svg,"a");o.setAttribute("fill","inherit"),o.setAttributeNS(Ao.xlink,"href",i),r!=null&&o.setAttribute("target",r),this.parentNode.insertBefore(o,this).appendChild(this)}})}function lt(e,t,r){r!=null&&e.attr(t,r)}function Ost(e,t,r){r!=null&&e.style(t,r)}function vt(e,t,{x:r,y:n},i=ir,o=ir){i+=t.dx,o+=t.dy,r?.bandwidth&&(i+=r.bandwidth()/2),n?.bandwidth&&(o+=n.bandwidth()/2),(i||o)&&e.attr("transform",`translate(${i},${o})`)}function Ae(e,t){if((e=nr(e))!==t)return e}function yb(e,t){if((e=Nt(e))!==t)return e}var Fst=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/i;function Tp(e){if(e===void 0)return"plot-d6a7b5";if(e=`${e}`,!Fst.test(e))throw new Error(`invalid class name: ${e}`);return e}function Ap(e,t){if(typeof t=="string")e.property("style",t);else if(t!=null)for(let r of e)Object.assign(r.style,t)}function Zr({frameAnchor:e},{width:t,height:r,marginTop:n,marginRight:i,marginBottom:o,marginLeft:s}){return[/left$/.test(e)?s:/right$/.test(e)?t-i:(s+t-i)/2,/^top/.test(e)?n:/^bottom/.test(e)?r-o:(n+r-o)/2]}function FP(e,t,r={}){let n=.5-ir,i=.5+ir,o=.5+ir,s=.5-ir;for(let{marginTop:m,marginRight:g,marginBottom:y,marginLeft:b}of t)m>n&&(n=m),g>i&&(i=g),y>o&&(o=y),b>s&&(s=b);let{margin:a,marginTop:c=a!==void 0?a:n,marginRight:l=a!==void 0?a:i,marginBottom:u=a!==void 0?a:o,marginLeft:f=a!==void 0?a:s}=r;c=+c,l=+l,u=+u,f=+f;let{width:d=640,height:h=Nst(e,r,{width:d,marginTopDefault:n,marginRightDefault:i,marginBottomDefault:o,marginLeftDefault:s})+Math.max(0,c-n+u-o)}=r;d=+d,h=+h;let p={width:d,height:h,marginTop:c,marginRight:l,marginBottom:u,marginLeft:f};if(e.fx||e.fy){let{margin:m,marginTop:g=m!==void 0?m:c,marginRight:y=m!==void 0?m:l,marginBottom:b=m!==void 0?m:u,marginLeft:x=m!==void 0?m:f}=r.facet??{};g=+g,y=+y,b=+b,x=+x,p.facet={marginTop:g,marginRight:y,marginBottom:b,marginLeft:x}}return p}function Nst({x:e,y:t,fy:r,fx:n},{projection:i,aspectRatio:o},{width:s,marginTopDefault:a,marginRightDefault:c,marginBottomDefault:l,marginLeftDefault:u}){let f=r?r.scale.domain().length:1,d=C5(i);if(d){let p=n?n.scale.domain().length:1,m=(1.1*f-.1)/(1.1*p-.1)*d,g=Math.max(.1,Math.min(10,m));return Math.round((s-u-c)*g+a+l)}let h=t?Aa(t)?t.scale.domain().length:Math.max(7,17/f):1;if(o!=null){if(o=+o,!(isFinite(o)&&o>0))throw new Error(`invalid aspectRatio: ${o}`);let p=OP("y",t)/(OP("x",e)*o),m=n?n.scale.bandwidth():1,g=r?r.scale.bandwidth():1,y=m*(s-u-c)-e.insetLeft-e.insetRight;return(p*y+t.insetTop+t.insetBottom)/g+a+l}return!!(t||r)*Math.max(1,Math.min(60,h*f))*20+!!n*30+60}function OP(e,t){if(!t)throw new Error(`aspectRatio requires ${e} scale`);let{type:r,domain:n}=t,i;switch(r){case"linear":case"utc":case"time":i=Number;break;case"pow":{let a=t.scale.exponent();i=c=>Math.pow(c,a);break}case"log":i=Math.log;break;case"point":case"band":return n.length;default:throw new Error(`unsupported ${e} scale for aspectRatio: ${r}`)}let[o,s]=ze(n);return Math.abs(i(s)-i(o))}function DP(e,t){let{fx:r,fy:n}=pb(e,t),i=r?.scale.domain(),o=n?.scale.domain();return i&&o?Qw(i,o).map(([s,a],c)=>({x:s,y:a,i:c})):i?i.map((s,a)=>({x:s,i:a})):o?o.map((s,a)=>({y:s,i:a})):void 0}function LP(e,{x:t,y:r}){return t&&=gF(t),r&&=gF(r),e.filter(t&&r?n=>t.has(n.x)&&r.has(n.y):t?n=>t.has(n.x):n=>r.has(n.y)).sort(t&&r?(n,i)=>t.get(n.x)-t.get(i.x)||r.get(n.y)-r.get(i.y):t?(n,i)=>t.get(n.x)-t.get(i.x):(n,i)=>r.get(n.y)-r.get(i.y))}function DI(e,{fx:t,fy:r}){let n=Kn(e),i=t?.value,o=r?.value;return t&&r?_s(n,s=>(s.fx=i[s[0]],s.fy=o[s[0]],s),s=>i[s],s=>o[s]):t?_s(n,s=>(s.fx=i[s[0]],s),s=>i[s]):_s(n,s=>(s.fy=o[s[0]],s),s=>o[s])}function RP(e,t,{marginTop:r,marginLeft:n}){return e&&t?({x:i,y:o})=>`translate(${e(i)-n},${t(o)-r})`:e?({x:i})=>`translate(${e(i)-n},0)`:({y:i})=>`translate(0,${t(i)-r})`}function kP(e){let t=[],r=new Uint32Array(hn(e,n=>n.length));for(let n of e){let i=0;for(let o of e)n!==o&&(r.set(o,i),i+=o.length);t.push(r.slice(0,i))}return t}var Dst=new Map([["top",hF],["right",yF],["bottom",pF],["left",mF],["top-left",NI(hF,mF)],["top-right",NI(hF,yF)],["bottom-left",NI(pF,mF)],["bottom-right",NI(pF,yF)],["top-empty",Rst],["right-empty",Ust],["bottom-empty",kst],["left-empty",Cst],["empty",Pst]]);function CP(e){if(e==null)return null;let t=Dst.get(`${e}`.toLowerCase());if(t)return t;throw new Error(`invalid facet anchor: ${e}`)}var NP=new WeakMap;function gF(e){let t=NP.get(e);return t||NP.set(e,t=new $n(fe(e,(r,n)=>[r,n]))),t}function xu(e,t){return gF(e).get(t)}function Lst(e,t,r){return t=$c(t),r=$c(r),e.find(n=>Object.is($c(n.x),t)&&Object.is($c(n.y),r))}function LI(e,t,r){return Lst(e,t,r)?.empty}function hF(e,{y:t},{y:r}){return t?xu(t,r)===0:!0}function pF(e,{y:t},{y:r}){return t?xu(t,r)===t.length-1:!0}function mF(e,{x:t},{x:r}){return t?xu(t,r)===0:!0}function yF(e,{x:t},{x:r}){return t?xu(t,r)===t.length-1:!0}function Rst(e,{y:t},{x:r,y:n,empty:i}){if(i)return!1;if(!t)return;let o=xu(t,n);if(o>0)return LI(e,r,t[o-1])}function kst(e,{y:t},{x:r,y:n,empty:i}){if(i)return!1;if(!t)return;let o=xu(t,n);if(o<t.length-1)return LI(e,r,t[o+1])}function Cst(e,{x:t},{x:r,y:n,empty:i}){if(i)return!1;if(!t)return;let o=xu(t,r);if(o>0)return LI(e,t[o-1],n)}function Ust(e,{x:t},{x:r,y:n,empty:i}){if(i)return!1;if(!t)return;let o=xu(t,r);if(o<t.length-1)return LI(e,t[o+1],n)}function Pst(e,t,{empty:r}){return r}function NI(e,t){return function(){return e.apply(null,arguments)&&t.apply(null,arguments)}}function RI(e,{channels:{fx:t,fy:r},groups:n}){return t&&r?e.map(({x:i,y:o})=>n.get(i)?.get(o)??[]):t?e.map(({x:i})=>n.get(i)??[]):e.map(({y:i})=>n.get(i)??[])}var bt=class{constructor(t,r={},n={},i){let{facet:o="auto",facetAnchor:s,fx:a,fy:c,sort:l,dx:u=0,dy:f=0,margin:d=0,marginTop:h=d,marginRight:p=d,marginBottom:m=d,marginLeft:g=d,clip:y,channels:b,tip:x,render:_}=n;if(this.data=t,this.sort=wa(l)?l:null,this.initializer=Qe(n).initializer,this.transform=this.initializer?n.transform:Xr(n).transform,o===null||o===!1?this.facet=null:(this.facet=Zi(o===!0?"include":o,"facet",["auto","include","exclude","super"]),this.fx=t===fu&&typeof a=="string"?[a]:a,this.fy=t===fu&&typeof c=="string"?[c]:c),this.facetAnchor=CP(s),r=sb(r),b!==void 0&&(r={...$st(b),...r}),i!==void 0&&(r={...OI(this,n,i),...r}),this.channels=Object.fromEntries(Object.entries(r).map(([w,v])=>{if(Ki(v.value)){let{value:A,scale:B=v.scale}=v.value;v={...v,scale:B,value:A}}if(t===fu&&typeof v.value=="string"){let{value:A}=v;v={...v,value:[A]}}return[w,v]}).filter(([w,{value:v,optional:A}])=>{if(v!=null)return!0;if(A)return!1;throw new Error(`missing channel value: ${w}`)})),this.dx=+u,this.dy=+f,this.marginTop=+h,this.marginRight=+p,this.marginBottom=+m,this.marginLeft=+g,this.clip=EP(y),this.tip=zst(x),this.facet==="super"){if(a||c)throw new Error("super-faceting cannot use fx or fy");for(let w in this.channels){let{scale:v}=r[w];if(!(v!=="x"&&v!=="y"))throw new Error("super-faceting cannot use x or y")}}_!=null&&(this.render=bF(_,this.render))}initialize(t,r,n){let i=vr(this.data);t===void 0&&i!=null&&(t=[Kn(i)]);let o=t;this.transform!=null&&({facets:t,data:i}=this.transform(i,t,n),i=vr(i)),t!==void 0&&(t.original=o);let s=wI(this.channels,i);return this.sort!=null&&M5(i,t,s,r,this.sort),{data:i,facets:t,channels:s}}filter(t,r,n){for(let i in r){let{filter:o=_r}=r[i];if(o!==null){let s=n[i];t=t.filter(a=>o(s[a]))}}return t}project(t,r,n){for(let i in t)if(t[i].scale==="x"&&/^x|x$/.test(i)){let o=i.replace(/^x|x$/,"y");o in t&&t[o].scale==="y"&&eF(i,o,r,n.projection)}}scale(t,r,n){let i=xp(t,r);return n.projection&&this.project(t,i,n),i}};function ti(...e){return e.plot=bt.prototype.plot,e}function bF(e,t){if(e==null)return t===null?void 0:t;if(t==null)return e===null?void 0:e;if(typeof e!="function")throw new TypeError(`invalid render transform: ${e}`);if(typeof t!="function")throw new TypeError(`invalid render transform: ${t}`);return function(r,n,i,o,s,a){return e.call(this,r,n,i,o,s,(c,l,u,f,d)=>t.call(this,c,l,u,f,d,a))}}function $st(e){return Object.fromEntries(Object.entries(sb(e)).map(([t,r])=>(r=Sa(r),r.filter===void 0&&r.scale==null&&(r={...r,filter:null}),[t,r])))}function zst(e){return e===!0?"xy":e===!1?null:Gf(e,"tip",["x","y","xy"])}function Wc(e,t){return e?.tip===!0?{...e,tip:t}:e}var UP=new WeakMap;function xF(e,t,{x:r,y:n,px:i,py:o,maxRadius:s=40,channels:a,render:c,...l}={}){return s=+s,i!=null&&(r??=null,a={...a,px:{value:i,scale:"x"}}),o!=null&&(n??=null,a={...a,py:{value:o,scale:"y"}}),{x:r,y:n,channels:a,...l,render:bF(function(u,f,d,h,p,m){let g=p.ownerSVGElement,{data:y}=p.getMarkState(this),b=UP.get(g);b||UP.set(g,b={sticky:!1,roots:[],renders:[]});let x=b.renders.push(j)-1,{x:_,y:w,fx:v,fy:A}=f,B=v?v(u.fx)-h.marginLeft:0,D=A?A(u.fy)-h.marginTop:0;_?.bandwidth&&(B+=_.bandwidth()/2),w?.bandwidth&&(D+=w.bandwidth()/2);let T=u.fi!=null,M;if(T){let at=b.facetStates;at||(b.facetStates=at=new Map),M=at.get(this),M||at.set(this,M=new Map)}let[O,L]=Zr(this,h),{px:S,py:E}=d,I=S?at=>S[at]:_F(d,O),F=E?at=>E[at]:wF(d,L),C,U,$;function q(at,Q){if(T)if($&&($=cancelAnimationFrame($)),at==null)M.delete(u.fi);else{M.set(u.fi,Q),$=requestAnimationFrame(()=>{$=null;for(let Z of M.values())if(Z<Q){at=null;break}j(at)});return}j(at)}function j(at){if(C===at)return;C=at;let Q=C==null?[]:[C];T&&(Q.fx=u.fx,Q.fy=u.fy,Q.fi=u.fi);let Z=m(Q,f,d,h,p);if(U){if(T){let V=U.parentNode,H=U.getAttribute("transform"),tt=Z.getAttribute("transform");H?Z.setAttribute("transform",H):Z.removeAttribute("transform"),tt?V.setAttribute("transform",tt):V.removeAttribute("transform"),Z.removeAttribute("aria-label"),Z.removeAttribute("aria-description"),Z.removeAttribute("aria-hidden")}U.replaceWith(Z)}return b.roots[x]=U=Z,p.dispatchValue(C==null?null:y[C]),Z}function rt(at){if(b.sticky||at.pointerType==="mouse"&&at.buttons===1)return;let[Q,Z]=Sn(at);Q-=B,Z-=D;let V=null,H=s*s;for(let tt of u){let z=e*(I(tt)-Q),ut=t*(F(tt)-Z),Lt=z*z+ut*ut;Lt<=H&&(V=tt,H=Lt)}q(V,H)}function ot(at){at.pointerType==="mouse"&&C!=null&&(b.sticky&&b.roots.some(Q=>Q?.contains(at.target))||(b.sticky?(b.sticky=!1,b.renders.forEach(Q=>Q(null))):b.sticky=!0,at.stopImmediatePropagation()))}function Gt(at){at.pointerType==="mouse"&&(b.sticky||q(null))}return g.addEventListener("pointerenter",rt),g.addEventListener("pointermove",rt),g.addEventListener("pointerdown",ot),g.addEventListener("pointerleave",Gt),j(null)},c)}}function Mp(e){return xF(1,1,e)}function Ep(e){return xF(1,.01,e)}function Bp(e){return xF(.01,1,e)}function _F({x1:e,x2:t,x:r=e},n){return e&&t?i=>(e[i]+t[i])/2:r?i=>r[i]:()=>n}function wF({y1:e,y2:t,y:r=e},n){return e&&t?i=>(e[i]+t[i])/2:r?i=>r[i]:()=>n}function kI(e){return Aa(e)&&e.interval===void 0?void 0:"tabular-nums"}function PP(e,t){return e===void 0?fr(t)?mb:nr:typeof e=="function"?e:(typeof e=="string"?fr(t)?kc:Bo:Cr)(e)}function $P(e,t){let{label:r=e.label,tickSize:n=6,width:i=240,height:o=44+n,marginTop:s=18,marginRight:a=0,marginBottom:c=16+n,marginLeft:l=0,style:u,ticks:f=(i-l-a)/64,tickFormat:d,fontVariant:h=kI(e),round:p=!0,opacity:m,className:g}=t,y=gu(t);g=Tp(g),m=Se(m)[1],d===null&&(d=()=>null);let b=ct("svg",y).attr("class",`${g}-ramp`).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",i).attr("height",o).attr("viewBox",`0 0 ${i} ${o}`).call(O=>O.append("style").text(`.${g}-ramp {
  display: block;
  background: white;
  height: auto;
  height: intrinsic;
  max-width: 100%;
  overflow: visible;
}
.${g}-ramp text {
  white-space: pre;
}`)).call(Ap,u),x=O=>O.selectAll(".tick line").attr("y1",s+c-o),_,w=p?(O,L)=>O.rangeRound(L):(O,L)=>O.range(L),{type:v,domain:A,range:B,interpolate:D,scale:T,pivot:M}=e;if(D){let O=B===void 0?D:Gl(D.length===1?hb(D):D,B);_=w(T.copy(),In(Ge(l,i-a),Math.min(A.length+(M!==void 0),B===void 0?1/0:B.length)));let L=256,S=y.document.createElement("canvas");S.width=L,S.height=1;let E=S.getContext("2d");for(let I=0,F=L-1;I<L;++I)E.fillStyle=O(I/F),E.fillRect(I,0,1,1);b.append("image").attr("opacity",m).attr("x",l).attr("y",s).attr("width",i-l-a).attr("height",o-s-c).attr("preserveAspectRatio","none").attr("xlink:href",S.toDataURL())}else if(v==="threshold"){let O=A,L=d===void 0?S=>S:typeof d=="string"?Bo(d):d;_=w(Rc().domain([-1,B.length-1]),[l,i-a]),b.append("g").attr("fill-opacity",m).selectAll().data(B).enter().append("rect").attr("x",(S,E)=>_(E-1)).attr("y",s).attr("width",(S,E)=>_(E)-_(E-1)).attr("height",o-s-c).attr("fill",S=>S),f=fe(O,(S,E)=>E),d=S=>L(O[S],S)}else _=w(eu().domain(A),[l,i-a]),b.append("g").attr("fill-opacity",m).selectAll().data(A).enter().append("rect").attr("x",_).attr("y",s).attr("width",Math.max(0,_.bandwidth()-1)).attr("height",o-s-c).attr("fill",T),x=()=>{};return b.append("g").attr("transform",`translate(0,${o-c})`).call(VE(_).ticks(Array.isArray(f)?null:f,typeof d=="string"?d:void 0).tickFormat(typeof d=="function"?d:void 0).tickSize(n).tickValues(Array.isArray(f)?f:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",Ae(h,"normal")).call(x).call(O=>O.select(".domain").remove()),r!==void 0&&b.append("text").attr("x",l).attr("y",s-6).attr("fill","currentColor").attr("font-weight","bold").text(r),b.node()}function zP(e,t){if(t==null)return t;let r=e(t);if(!r)throw new Error(`scale not found: ${t}`);return r}function VP(e,{opacity:t,...r}={}){if(!Aa(e)&&!dF(e))throw new Error(`swatches legend requires ordinal or threshold color scale (not ${e.type})`);return qP(e,r,(n,i,o,s)=>n.append("svg").attr("width",o).attr("height",s).attr("fill",i.scale).attr("fill-opacity",Se(t)[1]).append("rect").attr("width","100%").attr("height","100%"))}function jP(e,{fill:t=e.hint?.fill!==void 0?e.hint.fill:"none",fillOpacity:r=1,stroke:n=e.hint?.stroke!==void 0?e.hint.stroke:Ke(t)?"currentColor":"none",strokeOpacity:i=1,strokeWidth:o=1.5,r:s=4.5,...a}={},c){let[l,u]=wr(t),[f,d]=wr(n),h=zP(c,l),p=zP(c,f),m=s*s*Math.PI;return r=Se(r)[1],i=Se(i)[1],o=Se(o)[1],qP(e,a,(g,y,b,x)=>g.append("svg").attr("viewBox","-8 -8 16 16").attr("width",b).attr("height",x).attr("fill",l==="color"?_=>h.scale(_):u).attr("fill-opacity",r).attr("stroke",f==="color"?_=>p.scale(_):d).attr("stroke-opacity",i).attr("stroke-width",o).append("path").attr("d",_=>{let w=Yn();return e.scale(_).draw(w,m),w}))}function qP(e,t={},r){let{columns:n,tickFormat:i,fontVariant:o=kI(e),swatchSize:s=15,swatchWidth:a=s,swatchHeight:c=s,marginLeft:l=0,className:u,style:f,width:d}=t,h=gu(t);u=Tp(u),i=PP(i,e.domain);let p=ct("div",h).attr("class",`${u}-swatches ${u}-swatches-${n!=null?"columns":"wrap"}`),m;return n!=null?(m=`.${u}-swatches-columns .${u}-swatch {
  display: flex;
  align-items: center;
  break-inside: avoid;
  padding-bottom: 1px;
}
.${u}-swatches-columns .${u}-swatch::before {
  flex-shrink: 0;
}
.${u}-swatches-columns .${u}-swatch-label {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}`,p.style("columns",n).selectAll().data(e.domain).enter().append("div").attr("class",`${u}-swatch`).call(r,e,a,c).call(g=>g.append("div").attr("class",`${u}-swatch-label`).attr("title",i).text(i))):(m=`.${u}-swatches-wrap {
  display: flex;
  align-items: center;
  min-height: 33px;
  flex-wrap: wrap;
}
.${u}-swatches-wrap .${u}-swatch {
  display: inline-flex;
  align-items: center;
  margin-right: 1em;
}`,p.selectAll().data(e.domain).enter().append("span").attr("class",`${u}-swatch`).call(r,e,a,c).append(function(){return this.ownerDocument.createTextNode(i.apply(this,arguments))})),p.call(g=>g.insert("style","*").text(`.${u}-swatches {
  font-family: system-ui, sans-serif;
  font-size: 10px;
  margin-bottom: 0.5em;
}
.${u}-swatch > svg {
  margin-right: 0.5em;
  overflow: visible;
}
${m}`)).style("margin-left",l?`${+l}px`:null).style("width",d===void 0?null:`${+d}px`).style("font-variant",Ae(o,"normal")).call(Ap,f).node()}var CI=new Map([["symbol",jP],["color",GP],["opacity",Vst]]);function YP(e={}){for(let[t,r]of CI){let n=e[t];if(_a(n)){let i=gu(e),o;if(t==="symbol"){let{fill:s,stroke:a=s===void 0&&_a(e.color)?"color":void 0}=e;o={fill:s,stroke:a}}return r(EI(t,n,o),vF(i,n,e),s=>_a(e[s])?EI(s,e[s]):null)}}throw new Error("unknown legend type; no scale found")}function WP(e,t,r={}){return(n,i)=>{if(!CI.has(n))throw new Error(`unknown legend type: ${n}`);if(n in e)return CI.get(n)(e[n],vF(t,r[n],i),o=>e[o])}}function vF({className:e,...t},{label:r,ticks:n,tickFormat:i}={},o){return g5(o,{className:e,...t},{label:r,ticks:n,tickFormat:i})}function GP(e,{legend:t=!0,...r}){if(t===!0&&(t=e.type==="ordinal"?"swatches":"ramp"),e.domain!==void 0)switch(`${t}`.toLowerCase()){case"swatches":return VP(e,r);case"ramp":return $P(e,r);default:throw new Error(`unknown legend type: ${t}`)}}function Vst({type:e,interpolate:t,...r},{legend:n=!0,color:i=jr(0,0,0),...o}){if(!t)throw new Error(`${e} opacity scales are not supported`);if(n===!0&&(n="ramp"),`${n}`.toLowerCase()!=="ramp")throw new Error(`${n} opacity legends are not supported`);return GP({type:e,...r,interpolate:jst(i)},{legend:n,...o})}function jst(e){let{r:t,g:r,b:n}=jr(e)||jr(0,0,0);return i=>`rgba(${t},${r},${n},${i})`}function XP(e,t,r){let n=[];for(let[i,o]of CI){let s=r[i];if(s?.legend&&i in e){let a=o(e[i],vF(t,e[i],s),c=>e[c]);a!=null&&n.push(a)}}return n}var Op=Math.PI/180;function Ms(e,{marker:t,markerStart:r=t,markerMid:n=t,markerEnd:i=t}={}){e.markerStart=SF(r),e.markerMid=SF(n),e.markerEnd=SF(i)}function SF(e){if(e==null||e===!1)return null;if(e===!0)return ZP;if(typeof e=="function")return e;switch(`${e}`.toLowerCase()){case"none":return null;case"arrow":return HP("auto");case"arrow-reverse":return HP("auto-start-reverse");case"dot":return qst;case"circle":case"circle-fill":return ZP;case"circle-stroke":return Yst}throw new Error(`invalid marker: ${e}`)}function HP(e){return(t,r)=>ct("svg:marker",r).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("orient",e).attr("fill","none").attr("stroke",t).attr("stroke-width",1.5).attr("stroke-linecap","round").attr("stroke-linejoin","round").call(n=>n.append("path").attr("d","M-1.5,-3l3,3l-3,3")).node()}function qst(e,t){return ct("svg:marker",t).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",e).attr("stroke","none").call(r=>r.append("circle").attr("r",2.5)).node()}function ZP(e,t){return ct("svg:marker",t).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",e).attr("stroke","white").attr("stroke-width",1.5).call(r=>r.append("circle").attr("r",3)).node()}function Yst(e,t){return ct("svg:marker",t).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill","white").attr("stroke",e).attr("stroke-width",1.5).call(r=>r.append("circle").attr("r",3)).node()}var Wst=0;function Gc(e,t,{stroke:r},n){return QP(e,t,r&&(i=>r[i]),n)}function KP(e,t,{stroke:r},n){return QP(e,t,r&&(([i])=>r[i]),n)}function QP(e,{markerStart:t,markerMid:r,markerEnd:n,stroke:i},o=()=>i,s){let a=new Map;function c(l){return function(u){let f=o(u),d=a.get(l);d||a.set(l,d=new Map);let h=d.get(f);if(!h){let p=this.parentNode.insertBefore(l(f,s),this),m=`plot-marker-${++Wst}`;p.setAttribute("id",m),d.set(f,h=`url(#${m})`)}return h}}t&&e.attr("marker-start",c(t)),r&&e.attr("marker-mid",c(r)),n&&e.attr("marker-end",c(n))}function Kf({inset:e,insetLeft:t,insetRight:r,...n}={}){return[t,r]=JP(e,t,r),{inset:e,insetLeft:t,insetRight:r,...n}}function Qf({inset:e,insetTop:t,insetBottom:r,...n}={}){return[t,r]=JP(e,t,r),{inset:e,insetTop:t,insetBottom:r,...n}}function JP(e,t,r){return e===void 0&&t===void 0&&r===void 0?ir?[1,0]:[.5,.5]:[t,r]}function t7(e,{interval:t}){return e={...Sa(e)},e.interval=uI(e.interval===void 0?t:e.interval),e}function UI(e,t,r,n){let{[e]:i,[`${e}1`]:o,[`${e}2`]:s}=r,{value:a,interval:c}=t7(i,r);if(a==null||c==null&&!n)return r;let l=Qn(i);if(c==null){let h,p={transform:m=>h||(h=gt(m,a)),label:l};return{...r,[e]:void 0,[`${e}1`]:o===void 0?p:o,[`${e}2`]:s===void 0?p:s}}let u,f;function d(h){return f!==void 0&&h===u?f:f=fe(gt(u=h,a),p=>c.floor(p))}return t({...r,[e]:void 0,[`${e}1`]:o===void 0?{transform:d,label:l}:o,[`${e}2`]:s===void 0?{transform:h=>d(h).map(p=>c.offset(p)),label:l}:s})}function e7(e,t,r){let{[e]:n}=r,{value:i,interval:o}=t7(n,r);return i==null||o==null?r:t({...r,[e]:{label:Qn(n),transform:s=>{let a=fe(gt(s,i),l=>o.floor(l)),c=a.map(l=>o.offset(l));return a.map(fr(a)?(l,u)=>l==null||isNaN(l=+l)||(u=c[u],u==null)||isNaN(u=+u)?void 0:new Date((l+u)/2):(l,u)=>l==null||(u=c[u],u==null)?NaN:(+l+ +u)/2)}}})}function IF(e={}){return UI("x",Kf,e,!0)}function TF(e={}){return UI("y",Qf,e,!0)}function PI(e={}){return UI("x",Kf,e)}function $I(e={}){return UI("y",Qf,e)}function zI(e={}){return e7("x",Kf,e)}function VI(e={}){return e7("y",Qf,e)}var r7={ariaLabel:"rule",fill:null,stroke:"currentColor"},bb=class extends bt{constructor(t,r={}){let{x:n,y1:i,y2:o,inset:s=0,insetTop:a=s,insetBottom:c=s}=r;super(t,{x:{value:n,scale:"x",optional:!0},y1:{value:i,scale:"y",optional:!0},y2:{value:o,scale:"y",optional:!0}},Wc(r,"x"),r7),this.insetTop=Nt(a),this.insetBottom=Nt(c),Ms(this,r)}render(t,r,n,i,o){let{x:s,y:a}=r,{x:c,y1:l,y2:u}=n,{width:f,height:d,marginTop:h,marginRight:p,marginLeft:m,marginBottom:g}=i,{insetTop:y,insetBottom:b}=this;return ct("svg:g",o).call(Pt,this,i).call(vt,this,{x:c&&s},ir,0).call(x=>x.selectAll().data(t).enter().append("line").call(Dt,this).attr("x1",c?_=>c[_]:(m+f-p)/2).attr("x2",c?_=>c[_]:(m+f-p)/2).attr("y1",l&&!Jn(a)?_=>l[_]+y:h+y).attr("y2",u&&!Jn(a)?a.bandwidth?_=>u[_]+a.bandwidth()-b:_=>u[_]-b:d-g-b).call(he,this,n).call(Gc,this,n,o)).node()}},xb=class extends bt{constructor(t,r={}){let{x1:n,x2:i,y:o,inset:s=0,insetRight:a=s,insetLeft:c=s}=r;super(t,{y:{value:o,scale:"y",optional:!0},x1:{value:n,scale:"x",optional:!0},x2:{value:i,scale:"x",optional:!0}},Wc(r,"y"),r7),this.insetRight=Nt(a),this.insetLeft=Nt(c),Ms(this,r)}render(t,r,n,i,o){let{x:s,y:a}=r,{y:c,x1:l,x2:u}=n,{width:f,height:d,marginTop:h,marginRight:p,marginLeft:m,marginBottom:g}=i,{insetLeft:y,insetRight:b}=this;return ct("svg:g",o).call(Pt,this,i,o).call(vt,this,{y:c&&a},0,ir).call(x=>x.selectAll().data(t).enter().append("line").call(Dt,this).attr("x1",l&&!Jn(s)?_=>l[_]+y:m+y).attr("x2",u&&!Jn(s)?s.bandwidth?_=>u[_]+s.bandwidth()-b:_=>u[_]-b:f-p-b).attr("y1",c?_=>c[_]:(h+d-g)/2).attr("y2",c?_=>c[_]:(h+d-g)/2).call(he,this,n).call(Gc,this,n,o)).node()}};function eo(e,t){let{x:r=K,y:n,y1:i,y2:o,...s}=$I(t);return[i,o]=n7(n,i,o),new bb(e,{...s,x:r,y1:i,y2:o})}function ro(e,t){let{y:r=K,x:n,x1:i,x2:o,...s}=PI(t);return[i,o]=n7(n,i,o),new xb(e,{...s,y:r,x1:i,x2:o})}function n7(e,t,r){if(e==null){if(t===void 0){if(r!==void 0)return[0,r]}else if(r===void 0)return[0,t]}else{if(t===void 0)return r===void 0?[0,e]:[e,r];if(r===void 0)return[e,t]}return[t,r]}function _u(e,...t){let r=t.length;for(let n=0,i=!0;n<r;++n)typeof t[n]!="function"&&(i&&(e=e.slice(),i=!1),e.splice(n,2,e[n]+t[n]+e[n+1]),t.splice(n,1),--n,--r);return n=>{let i=e[0];for(let o=0;o<r;++o)i+=t[o](n)+e[o+1];return i}}var Gst={ariaLabel:"text",strokeLinejoin:"round",strokeWidth:3,paintOrder:"stroke"},c7="\xAD",td=class extends bt{constructor(t,r={}){let{x:n,y:i,text:o=Dn(t)&&fI(t)?K:dr,frameAnchor:s,textAnchor:a=/right$/i.test(s)?"end":/left$/i.test(s)?"start":"middle",lineAnchor:c=/^top/i.test(s)?"top":/^bottom/i.test(s)?"bottom":"middle",lineHeight:l=1,lineWidth:u=1/0,textOverflow:f,monospace:d,fontFamily:h=d?"ui-monospace, monospace":void 0,fontSize:p,fontStyle:m,fontVariant:g,fontWeight:y,rotate:b}=r,[x,_]=Se(b,0),[w,v]=Kst(p);if(super(t,{x:{value:n,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},fontSize:{value:w,optional:!0},rotate:{value:f5(x),optional:!0},text:{value:o,filter:nb,optional:!0}},r,Gst),this.rotate=_,this.textAnchor=Ae(a,"middle"),this.lineAnchor=Zi(c,"lineAnchor",["top","middle","bottom"]),this.lineHeight=+l,this.lineWidth=+u,this.textOverflow=MF(f),this.monospace=!!d,this.fontFamily=nr(h),this.fontSize=v,this.fontStyle=nr(m),this.fontVariant=nr(g),this.fontWeight=nr(y),this.frameAnchor=Ia(s),!(this.lineWidth>=0))throw new Error(`invalid lineWidth: ${u}`);this.splitLines=BF(this),this.clipLine=OF(this)}render(t,r,n,i,o){let{x:s,y:a}=r,{x:c,y:l,rotate:u,text:f,title:d,fontSize:h}=n,{rotate:p}=this,[m,g]=Zr(this,i);return ct("svg:g",o).call(Pt,this,i,o).call(EF,this,f,i).call(vt,this,{x:c&&s,y:l&&a}).call(y=>y.selectAll().data(t).enter().append("text").call(Dt,this).call(Xst,this,f,d).attr("transform",_u`translate(${c?b=>c[b]:m},${l?b=>l[b]:g})${u?b=>` rotate(${u[b]})`:p?` rotate(${p})`:""}`).call(lt,"font-size",h&&(b=>h[b])).call(he,this,n)).node()}};function MF(e){return e==null?null:Zi(e,"textOverflow",["clip","ellipsis","clip-start","clip-end","ellipsis-start","ellipsis-middle","ellipsis-end"]).replace(/^(clip|ellipsis)$/,"$1-end")}function Xst(e,t,r,n){if(!r)return;let{lineAnchor:i,lineHeight:o,textOverflow:s,splitLines:a,clipLine:c}=t;e.each(function(l){let u=a(to(r[l])??"").map(c),f=u.length,d=i==="top"?.71:i==="bottom"?1-f:(164-f*100)/200;if(f>1){let h=0;for(let p=0;p<f;++p){if(++h,!u[p])continue;let m=this.ownerDocument.createElementNS(Ao.svg,"tspan");m.setAttribute("x",0),p===h-1?m.setAttribute("y",`${(d+p)*o}em`):m.setAttribute("dy",`${h*o}em`),m.textContent=u[p],this.appendChild(m),h=0}}else d&&this.setAttribute("y",`${d*o}em`),this.textContent=u[0];if(s&&!n&&u[0]!==r[l]){let h=this.ownerDocument.createElementNS(Ao.svg,"title");h.textContent=r[l],this.appendChild(h)}})}function Ea(e,{x:t,y:r,...n}={}){return n.frameAnchor===void 0&&([t,r]=hr(t,r)),new td(e,{...n,x:t,y:r})}function jI(e,{x:t=K,...r}={}){return new td(e,VI({...r,x:t}))}function qI(e,{y:t=K,...r}={}){return new td(e,zI({...r,y:t}))}function EF(e,t,r){lt(e,"text-anchor",t.textAnchor),lt(e,"font-family",t.fontFamily),lt(e,"font-size",t.fontSize),lt(e,"font-style",t.fontStyle),lt(e,"font-variant",t.fontVariant===void 0?Hst(r):t.fontVariant),lt(e,"font-weight",t.fontWeight)}function Hst(e){return e&&(dI(e)||fr(e))?"tabular-nums":void 0}var Zst=new Set(["inherit","initial","revert","unset","xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large","larger","smaller"]);function Kst(e){return e==null||typeof e=="number"?[void 0,e]:typeof e!="string"?[e,void 0]:(e=e.trim().toLowerCase(),Zst.has(e)||/^[+-]?\d*\.?\d+(e[+-]?\d+)?(\w*|%)$/.test(e)?[void 0,e]:[e,void 0])}function Qst(e,t,r){let n=[],i,o=0;for(let[s,a,c]of Jst(e)){if(i===void 0&&(i=s),o>i&&r(e,i,a)>t&&(n.push(e.slice(i,o)+(e[o-1]===c7?"-":"")),i=s),c){n.push(e.slice(i,a)),i=void 0;continue}o=a}return n}function*Jst(e){let t=0,r=0,n=e.length;for(;r<n;){let i=1;switch(e[r]){case c7:case"-":++r,yield[t,r,!1],t=r;break;case" ":for(yield[t,r,!1];e[++r]===" ";);t=r;break;case"\r":e[r+1]===`
`&&++i;case`
`:yield[t,r,!0],r+=i,t=r;break;default:++r;break}}yield[t,r,!0]}var i7={a:56,b:63,c:57,d:63,e:58,f:37,g:62,h:60,i:26,j:26,k:55,l:26,m:88,n:60,o:60,p:62,q:62,r:39,s:54,t:38,u:60,v:55,w:79,x:54,y:55,z:55,A:69,B:67,C:73,D:74,E:61,F:58,G:76,H:75,I:28,J:55,K:67,L:58,M:89,N:75,O:78,P:65,Q:78,R:67,S:65,T:65,U:75,V:69,W:98,X:69,Y:67,Z:67,0:64,1:48,2:62,3:64,4:66,5:63,6:65,7:58,8:65,9:65," ":29,"!":32,'"':49,"'":31,"(":39,")":39,",":31,"-":48,".":31,"/":32,":":31,";":31,"?":52,"\u2018":31,"\u2019":31,"\u201C":47,"\u201D":47,"\u2026":82};function YI(e,t=0,r=e.length){let n=0;for(let i=t;i<r;i=Fp(e,i))n+=i7[e[i]]??(u7(e,i)?120:i7.e);return n}function WI(e,t=0,r=e.length){let n=0;for(let i=t;i<r;i=Fp(e,i))n+=u7(e,i)?200:100;return n}function BF({monospace:e,lineWidth:t,textOverflow:r}){if(r!=null||t==1/0)return o=>o.split(/\r\n?|\n/g);let n=e?WI:YI,i=t*100;return o=>Qst(o,i,n)}function OF({monospace:e,lineWidth:t,textOverflow:r}){if(r==null||t==1/0)return o=>o;let n=e?WI:YI,i=t*100;switch(r){case"clip-start":return o=>s7(o,i,n,"");case"clip-end":return o=>o7(o,i,n,"");case"ellipsis-start":return o=>s7(o,i,n,Jf);case"ellipsis-middle":return o=>tat(o,i,n,Jf);case"ellipsis-end":return o=>o7(o,i,n,Jf)}}var Jf="\u2026";function ed(e,t,r,n){let i=[],o=0;for(let s=0,a=0,c=e.length;s<c;s=a){a=Fp(e,s);let l=r(e,s,a);if(o+l>t){for(o+=n;o>t&&s>0;)a=s,s=i.pop(),o-=r(e,s,a);return[s,t-o]}o+=l,i.push(s)}return[-1,0]}function o7(e,t,r,n){e=e.trim();let i=r(n),[o]=ed(e,t,r,i);return o<0?e:e.slice(0,o).trimEnd()+n}function tat(e,t,r,n){e=e.trim();let i=r(e);if(i<=t)return e;let o=r(n)/2,[s,a]=ed(e,t/2,r,o),[c]=ed(e,i-t/2-a+o,r,-o);return c<0?n:e.slice(0,s).trimEnd()+n+e.slice(Fp(e,c)).trimStart()}function s7(e,t,r,n){e=e.trim();let i=r(e);if(i<=t)return e;let o=r(n),[s]=ed(e,i-t+o,r,-o);return s<0?n:n+e.slice(Fp(e,s)).trimStart()}var AF=/[\p{Combining_Mark}\p{Emoji_Modifier}]+/uy,a7=/\p{Extended_Pictographic}/uy;function Fp(e,t){return t+=eat(e,t)?2:1,nat(e,t)&&(t=AF.lastIndex),rat(e,t)?Fp(e,t+1):t}function l7(e,t){return e.charCodeAt(t)<128}function eat(e,t){let r=e.charCodeAt(t);if(r>=55296&&r<56320){let n=e.charCodeAt(t+1);return n>=56320&&n<57344}return!1}function rat(e,t){return e.charCodeAt(t)===8205}function nat(e,t){return l7(e,t)?!1:(AF.lastIndex=t,AF.test(e))}function u7(e,t){return l7(e,t)?!1:(a7.lastIndex=t,a7.test(e))}var f7={ariaLabel:"vector",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinejoin:"round",strokeLinecap:"round"},d7=3.5,iat=d7*5,h7={draw(e,t,r){let n=t*r/iat;e.moveTo(0,0),e.lineTo(0,-t),e.moveTo(-n,n-t),e.lineTo(0,-t),e.lineTo(n,n-t)}},p7={draw(e,t,r){e.moveTo(-r,0),e.lineTo(0,-t),e.lineTo(r,0)}},oat=new Map([["arrow",h7],["spike",p7]]);function sat(e){return e&&typeof e.draw=="function"}function aat(e){if(sat(e))return e;let t=oat.get(`${e}`.toLowerCase());if(t)return t;throw new Error(`invalid shape: ${e}`)}var rd=class extends bt{constructor(t,r={}){let{x:n,y:i,r:o=d7,length:s,rotate:a,shape:c=h7,anchor:l="middle",frameAnchor:u}=r,[f,d]=Se(s,12),[h,p]=Se(a,0);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},length:{value:f,scale:"length",optional:!0},rotate:{value:h,optional:!0}},r,f7),this.r=+o,this.length=d,this.rotate=p,this.shape=aat(c),this.anchor=Zi(l,"anchor",["start","middle","end"]),this.frameAnchor=Ia(u)}render(t,r,n,i,o){let{x:s,y:a}=r,{x:c,y:l,length:u,rotate:f}=n,{length:d,rotate:h,anchor:p,shape:m,r:g}=this,[y,b]=Zr(this,i);return ct("svg:g",o).call(Pt,this,i,o).call(vt,this,{x:c&&s,y:l&&a}).call(x=>x.selectAll().data(t).enter().append("path").call(Dt,this).attr("transform",_u`translate(${c?_=>c[_]:y},${l?_=>l[_]:b})${f?_=>` rotate(${f[_]})`:h?` rotate(${h})`:""}${p==="start"?"":p==="end"?u?_=>` translate(0,${u[_]})`:` translate(0,${d})`:u?_=>` translate(0,${u[_]/2})`:` translate(0,${d/2})`}`).attr("d",u?_=>{let w=Yn();return m.draw(w,u[_],g),w}:(()=>{let _=Yn();return m.draw(_,d,g),_})()).call(he,this,n)).node()}};function FF(e,t={}){let{x:r,y:n,...i}=t;return t.frameAnchor===void 0&&([r,n]=hr(r,n)),new rd(e,{...i,x:r,y:n})}function GI(e,t={}){let{x:r=K,...n}=t;return new rd(e,{...n,x:r})}function XI(e,t={}){let{y:r=K,...n}=t;return new rd(e,{...n,y:r})}function m7(e,t={}){let{shape:r=p7,stroke:n=f7.stroke,strokeWidth:i=1,fill:o=n,fillOpacity:s=.3,anchor:a="start",...c}=t;return FF(e,{...c,shape:r,stroke:n,strokeWidth:i,fill:o,fillOpacity:s,anchor:a})}function wu(e,t){return arguments.length<2&&!Dn(e)&&(t=e,e=null),t===void 0&&(t={}),[e,t]}function HI({anchor:e}={},t){return e===void 0?t[0]:Zi(e,"anchor",t)}function y7(e){return HI(e,["left","right"])}function g7(e){return HI(e,["right","left"])}function b7(e){return HI(e,["bottom","top"])}function x7(e){return HI(e,["top","bottom"])}function _b(){let[e,t]=wu(...arguments);return _7("y",y7(t),e,t)}function ZI(){let[e,t]=wu(...arguments);return _7("fy",g7(t),e,t)}function wb(){let[e,t]=wu(...arguments);return w7("x",b7(t),e,t)}function KI(){let[e,t]=wu(...arguments);return w7("fx",x7(t),e,t)}function _7(e,t,r,{color:n="currentColor",opacity:i=1,stroke:o=n,strokeOpacity:s=i,strokeWidth:a=1,fill:c=n,fillOpacity:l=i,textAnchor:u,textStroke:f,textStrokeOpacity:d,textStrokeWidth:h,tickSize:p=e==="y"?6:0,tickPadding:m,tickRotate:g,x:y,margin:b,marginTop:x=b===void 0?20:b,marginRight:_=b===void 0?t==="right"?40:0:b,marginBottom:w=b===void 0?20:b,marginLeft:v=b===void 0?t==="left"?40:0:b,label:A,labelAnchor:B,labelArrow:D,labelOffset:T,...M}){return p=Nt(p),m=Nt(m),g=Nt(g),B!==void 0&&(B=Zi(B,"labelAnchor",["center","top","bottom"])),D=B7(D),ti(p&&!Ke(o)?cat(e,t,r,{stroke:o,strokeOpacity:s,strokeWidth:a,tickSize:p,tickPadding:m,tickRotate:g,x:y,...M}):null,Ke(c)?null:uat(e,t,r,{fill:c,fillOpacity:l,stroke:f,strokeOpacity:d,strokeWidth:h,textAnchor:u,tickSize:p,tickPadding:m,tickRotate:g,x:y,marginTop:x,marginRight:_,marginBottom:w,marginLeft:v,...M}),!Ke(c)&&A!==null?Ea([],T7({fill:c,fillOpacity:l,...M},function(O,L,S,E,I){let F=E[e],{marginTop:C,marginRight:U,marginBottom:$,marginLeft:q}=e==="y"&&I.inset||I,j=B??(F.bandwidth?"center":"top"),rt=T??(t==="right"?U:q)-3;return j==="center"?(this.textAnchor=void 0,this.lineAnchor=t==="right"?"bottom":"top",this.frameAnchor=t,this.rotate=-90):(this.textAnchor=t==="right"?"end":"start",this.lineAnchor=j,this.frameAnchor=`${j}-${t}`,this.rotate=0),this.dy=j==="top"?3-C:j==="bottom"?$-3:0,this.dx=t==="right"?rt:-rt,this.ariaLabel=`${e}-axis label`,{facets:[[0]],channels:{text:{value:[E7(e,F,{anchor:t,label:A,labelAnchor:j,labelArrow:D})]}}}})):null)}function w7(e,t,r,{color:n="currentColor",opacity:i=1,stroke:o=n,strokeOpacity:s=i,strokeWidth:a=1,fill:c=n,fillOpacity:l=i,textAnchor:u,textStroke:f,textStrokeOpacity:d,textStrokeWidth:h,tickSize:p=e==="x"?6:0,tickPadding:m,tickRotate:g,y,margin:b,marginTop:x=b===void 0?t==="top"?30:0:b,marginRight:_=b===void 0?20:b,marginBottom:w=b===void 0?t==="bottom"?30:0:b,marginLeft:v=b===void 0?20:b,label:A,labelAnchor:B,labelArrow:D,labelOffset:T,...M}){return p=Nt(p),m=Nt(m),g=Nt(g),B!==void 0&&(B=Zi(B,"labelAnchor",["center","left","right"])),D=B7(D),ti(p&&!Ke(o)?lat(e,t,r,{stroke:o,strokeOpacity:s,strokeWidth:a,tickSize:p,tickPadding:m,tickRotate:g,y,...M}):null,Ke(c)?null:fat(e,t,r,{fill:c,fillOpacity:l,stroke:f,strokeOpacity:d,strokeWidth:h,textAnchor:u,tickSize:p,tickPadding:m,tickRotate:g,y,marginTop:x,marginRight:_,marginBottom:w,marginLeft:v,...M}),!Ke(c)&&A!==null?Ea([],T7({fill:c,fillOpacity:l,...M},function(O,L,S,E,I){let F=E[e],{marginTop:C,marginRight:U,marginBottom:$,marginLeft:q}=e==="x"&&I.inset||I,j=B??(F.bandwidth?"center":"right"),rt=T??(t==="top"?C:$)-3;return j==="center"?(this.frameAnchor=t,this.textAnchor=void 0):(this.frameAnchor=`${t}-${j}`,this.textAnchor=j==="right"?"end":"start"),this.lineAnchor=t,this.dy=t==="top"?-rt:rt,this.dx=j==="right"?U-3:j==="left"?3-q:0,this.ariaLabel=`${e}-axis label`,{facets:[[0]],channels:{text:{value:[E7(e,F,{anchor:t,label:A,labelAnchor:j,labelArrow:D})]}}}})):null)}function cat(e,t,r,{strokeWidth:n=1,strokeLinecap:i=null,strokeLinejoin:o=null,facetAnchor:s=t+(e==="y"?"-empty":""),frameAnchor:a=t,tickSize:c,inset:l=0,insetLeft:u=l,insetRight:f=l,dx:d=0,y:h=e==="y"?void 0:null,...p}){return Np(XI,e,`${e}-axis tick`,r,{strokeWidth:n,strokeLinecap:i,strokeLinejoin:o,facetAnchor:s,frameAnchor:a,y:h,...p,dx:t==="left"?+d-ir+ +u:+d+ir-f,anchor:"start",length:c,shape:t==="left"?pat:mat})}function lat(e,t,r,{strokeWidth:n=1,strokeLinecap:i=null,strokeLinejoin:o=null,facetAnchor:s=t+(e==="x"?"-empty":""),frameAnchor:a=t,tickSize:c,inset:l=0,insetTop:u=l,insetBottom:f=l,dy:d=0,x:h=e==="x"?void 0:null,...p}){return Np(GI,e,`${e}-axis tick`,r,{strokeWidth:n,strokeLinejoin:o,strokeLinecap:i,facetAnchor:s,frameAnchor:a,x:h,...p,dy:t==="bottom"?+d-ir-f:+d+ir+ +u,anchor:"start",length:c,shape:t==="bottom"?dat:hat})}function uat(e,t,r,{facetAnchor:n=t+(e==="y"?"-empty":""),frameAnchor:i=t,tickSize:o,tickRotate:s=0,tickPadding:a=Math.max(3,9-o)+(Math.abs(s)>60?4*Math.cos(s*Op):0),tickFormat:c,text:l=typeof c=="function"?c:void 0,textAnchor:u=Math.abs(s)>60?"middle":t==="left"?"end":"start",lineAnchor:f=s>60?"top":s<-60?"bottom":"middle",fontVariant:d,inset:h=0,insetLeft:p=h,insetRight:m=h,dx:g=0,y=e==="y"?void 0:null,...b}){return Np(qI,e,`${e}-axis tick label`,r,{facetAnchor:n,frameAnchor:i,text:l===void 0?null:l,textAnchor:u,lineAnchor:f,fontVariant:d,rotate:s,y,...b,dx:t==="left"?+g-o-a+ +p:+g+ +o+ +a-m},function(x,_,w){d===void 0&&(this.fontVariant=M7(x)),l===void 0&&(w.text=A7(x,_,c))})}function fat(e,t,r,{facetAnchor:n=t+(e==="x"?"-empty":""),frameAnchor:i=t,tickSize:o,tickRotate:s=0,tickPadding:a=Math.max(3,9-o)+(Math.abs(s)>=10?4*Math.cos(s*Op):0),tickFormat:c,text:l=typeof c=="function"?c:void 0,textAnchor:u=Math.abs(s)>=10?s<0^t==="bottom"?"start":"end":"middle",lineAnchor:f=Math.abs(s)>=10?"middle":t==="bottom"?"top":"bottom",fontVariant:d,inset:h=0,insetTop:p=h,insetBottom:m=h,dy:g=0,x:y=e==="x"?void 0:null,...b}){return Np(jI,e,`${e}-axis tick label`,r,{facetAnchor:n,frameAnchor:i,text:l===void 0?null:l,textAnchor:u,lineAnchor:f,fontVariant:d,rotate:s,x:y,...b,dy:t==="bottom"?+g+ +o+ +a-m:+g-o-a+ +p},function(x,_,w){d===void 0&&(this.fontVariant=M7(x)),l===void 0&&(w.text=A7(x,_,c))})}function QI(){let[e,t]=wu(...arguments);return v7("y",y7(t),e,t)}function JI(){let[e,t]=wu(...arguments);return v7("fy",g7(t),e,t)}function tT(){let[e,t]=wu(...arguments);return S7("x",b7(t),e,t)}function eT(){let[e,t]=wu(...arguments);return S7("fx",x7(t),e,t)}function v7(e,t,r,{y:n=e==="y"?void 0:null,x:i=null,x1:o=t==="left"?i:null,x2:s=t==="right"?i:null,...a}){return Np(ro,e,`${e}-grid`,r,{y:n,x1:o,x2:s,...I7(a)})}function S7(e,t,r,{x:n=e==="x"?void 0:null,y:i=null,y1:o=t==="top"?i:null,y2:s=t==="bottom"?i:null,...a}){return Np(eo,e,`${e}-grid`,r,{x:n,y1:o,y2:s,...I7(a)})}function I7({color:e="currentColor",opacity:t=.1,stroke:r=e,strokeOpacity:n=t,strokeWidth:i=1,...o}){return{stroke:r,strokeOpacity:n,strokeWidth:i,...o}}function T7({fill:e,fillOpacity:t,fontFamily:r,fontSize:n,fontStyle:i,fontWeight:o,monospace:s,pointerEvents:a,shapeRendering:c},l){return[,e]=wr(e),[,t]=Se(t),{facet:"super",x:null,y:null,fill:e,fillOpacity:t,fontFamily:r,fontSize:n,fontStyle:i,fontWeight:o,monospace:s,pointerEvents:a,shapeRendering:c,initializer:l}}function Np(e,t,r,n,i,o){let s,a=e(n,Qe(i,function(c,l,u,f,d,h){let p=c==null&&(t==="fx"||t==="fy"),{[t]:m}=f;if(!m)throw new Error(`missing scale: ${t}`);let{ticks:g,tickSpacing:y,interval:b}=i;if(fF(m)&&typeof g=="string"&&(b=g,g=void 0),c==null){if(Dn(g))c=vr(g);else if(m.ticks)if(g!==void 0)c=m.ticks(g);else if(b=va(b===void 0?m.interval:b,m.type),b!==void 0){let[_,w]=ze(m.domain());c=b.range(_,b.offset(b.floor(w)))}else{let[_,w]=ze(m.range());g=(w-_)/(y===void 0?t==="x"?80:35:y),c=m.ticks(g)}else c=m.domain();t==="y"||t==="x"?l=[Kn(c)]:s[t]={scale:t,value:K}}o?.call(this,m,g,s);let x=Object.fromEntries(Object.entries(s).map(([_,w])=>[_,{...w,value:gt(c,w.value)}]));return p&&(l=h.filterFacets(c,x)),{data:c,facets:l,channels:x}}));return n==null?(s=a.channels,a.channels={}):s={},a.ariaLabel=r,a}function A7(e,t,r){return{value:rT(e,t,r)}}function rT(e,t,r){return e.tickFormat?e.tickFormat(Dn(t)?null:t,r):r===void 0?n5(e.interval)?kc("%Y"):i5(e.interval)?Zh("%Y"):to:typeof r=="string"?(fr(e.domain())?kc:Bo)(r):Cr(r)}var dat={draw(e,t){e.moveTo(0,0),e.lineTo(0,t)}},hat={draw(e,t){e.moveTo(0,0),e.lineTo(0,-t)}},pat={draw(e,t){e.moveTo(0,0),e.lineTo(-t,0)}},mat={draw(e,t){e.moveTo(0,0),e.lineTo(t,0)}};function M7(e){return e.bandwidth&&!e.interval?void 0:"tabular-nums"}function yat(e){return Math.sign(Hf(e.domain()))*Math.sign(Hf(e.range()))}function E7(e,t,{anchor:r,label:n=t.label,labelAnchor:i,labelArrow:o}={}){if(!(n==null||n.inferred&&gat(t)&&/^(date|time|year)$/i.test(n))){if(n=String(n),o==="auto"&&(o=(!t.bandwidth||t.interval)&&!/[↑↓→←]/.test(n)),!o)return n;if(o===!0){let s=yat(t);s&&(o=/x$/.test(e)||i==="center"?/x$/.test(e)===s<0?"left":"right":s<0?"up":"down")}switch(o){case"left":return`\u2190 ${n}`;case"right":return`${n} \u2192`;case"up":return r==="right"?`${n} \u2191`:`\u2191 ${n}`;case"down":return r==="right"?`${n} \u2193`:`\u2193 ${n}`}return n}}function B7(e="auto"){return Ke(e)?!1:typeof e=="boolean"?e:Zi(e,"labelArrow",["auto","up","right","down","left"])}function gat(e){return fF(e)||e.interval!=null}var bat={ariaLabel:"frame",fill:"none",stroke:"currentColor"},xat={ariaLabel:"frame",fill:null,stroke:"currentColor",strokeLinecap:"square"},vb=class extends bt{constructor(t={}){let{anchor:r=null,inset:n=0,insetTop:i=n,insetRight:o=n,insetBottom:s=n,insetLeft:a=n,rx:c,ry:l}=t;super(fu,void 0,t,r==null?bat:xat),this.anchor=Gf(r,"anchor",["top","right","bottom","left"]),this.insetTop=Nt(i),this.insetRight=Nt(o),this.insetBottom=Nt(s),this.insetLeft=Nt(a),this.rx=Nt(c),this.ry=Nt(l)}render(t,r,n,i,o){let{marginTop:s,marginRight:a,marginBottom:c,marginLeft:l,width:u,height:f}=i,{anchor:d,insetTop:h,insetRight:p,insetBottom:m,insetLeft:g,rx:y,ry:b}=this,x=l+g,_=u-a-p,w=s+h,v=f-c-m;return ct(d?"svg:line":"svg:rect",o).datum(0).call(Pt,this,i,o).call(Dt,this).call(he,this,n).call(vt,this,{}).call(d==="left"?A=>A.attr("x1",x).attr("x2",x).attr("y1",w).attr("y2",v):d==="right"?A=>A.attr("x1",_).attr("x2",_).attr("y1",w).attr("y2",v):d==="top"?A=>A.attr("x1",x).attr("x2",_).attr("y1",w).attr("y2",w):d==="bottom"?A=>A.attr("x1",x).attr("x2",_).attr("y1",v).attr("y2",v):A=>A.attr("x",x).attr("y",w).attr("width",_-x).attr("height",v-w).attr("rx",y).attr("ry",b)).node()}};function Dp(e){return new vb(e)}var NF={ariaLabel:"tip",fill:"white",stroke:"currentColor"},_at=new Set(["geometry","href","src","ariaLabel"]),Sb=class extends bt{constructor(t,r={}){r.tip&&(r={...r,tip:!1}),r.title===void 0&&Dn(t)&&fI(t)&&(r={...r,title:K});let{x:n,y:i,x1:o,x2:s,y1:a,y2:c,anchor:l,monospace:u,fontFamily:f=u?"ui-monospace, monospace":void 0,fontSize:d,fontStyle:h,fontVariant:p,fontWeight:m,lineHeight:g=1,lineWidth:y=20,frameAnchor:b,textAnchor:x="start",textOverflow:_,textPadding:w=8,pointerSize:v=12,pathFilter:A="drop-shadow(0 3px 4px rgba(0,0,0,0.2))"}=r;super(t,{x:{value:o!=null&&s!=null?null:n,scale:"x",optional:!0},y:{value:a!=null&&c!=null?null:i,scale:"y",optional:!0},x1:{value:o,scale:"x",optional:s==null},y1:{value:a,scale:"y",optional:c==null},x2:{value:s,scale:"x",optional:o==null},y2:{value:c,scale:"y",optional:a==null}},r,NF),this.anchor=zO(l,"anchor"),this.previousAnchor=this.anchor??"top-left",this.frameAnchor=Ia(b),this.textAnchor=Ae(x,"middle"),this.textPadding=+w,this.pointerSize=+v,this.pathFilter=nr(A),this.lineHeight=+g,this.lineWidth=+y,this.textOverflow=MF(_),this.monospace=!!u,this.fontFamily=nr(f),this.fontSize=Nt(d),this.fontStyle=nr(h),this.fontVariant=nr(p),this.fontWeight=nr(m);for(let B in NF)B in this.channels&&(this[B]=NF[B]);this.splitLines=BF(this),this.clipLine=OF(this)}render(t,r,n,i,o){let s=this,{x:a,y:c,fx:l,fy:u}=r,{ownerSVGElement:f,document:d}=o,{anchor:h,monospace:p,lineHeight:m,lineWidth:g}=this,{textPadding:y,pointerSize:b,pathFilter:x}=this,{marginTop:_,marginLeft:w}=i,v=Iat(n),{x1:A,y1:B,x2:D,y2:T,x:M=A??D,y:O=B??T}=n,L=l?l(t.fx)-w:0,S=u?u(t.fy)-_:0,[E,I]=Zr(this,i),F=_F(n,E),C=wF(n,I),U=p?WI:YI,$=U(Jf),q=l&&rT(l),j=u&&rT(u);function*rt(Q,Z){if("title"in Q){let V=Q.title.value[Z];for(let H of s.splitLines(to(V)))yield{name:"",value:s.clipLine(H)};return}for(let V in Q){if(V==="x1"&&"x2"in Q||V==="y1"&&"y2"in Q)continue;let H=Q[V],tt=H.value[Z];if(!(!_r(tt)&&H.scale==null))if(V==="x2"&&"x1"in Q)yield{name:DF(r,H,"x"),value:O7(Q.x1,H,Z)};else if(V==="y2"&&"y1"in Q)yield{name:DF(r,H,"y"),value:O7(Q.y1,H,Z)};else{let z=H.scale,ut={name:DF(r,H,V),value:to(tt)};(z==="color"||z==="opacity")&&(ut[z]=n[V][Z]),yield ut}}t.fi!=null&&l&&(yield{name:String(l.label??"fx"),value:q(t.fx)}),t.fi!=null&&u&&(yield{name:String(u.label??"fy"),value:j(t.fy)})}let ot=ct("svg:g",o).call(Pt,this,i,o).call(EF,this).call(vt,this,{x:M&&a,y:O&&c}).call(Q=>Q.selectAll().data(t).enter().append("g").attr("transform",Z=>`translate(${Math.round(F(Z))},${Math.round(C(Z))})`).call(Dt,this).call(Z=>Z.append("path").attr("filter",x)).call(Z=>Z.append("text").each(function(V){let H=ne(this);this.setAttribute("fill","currentColor"),this.setAttribute("fill-opacity",1),this.setAttribute("stroke","none");let tt=new Set;for(let z of rt(v,V)){let ut=z.name;ut&&tt.has(ut)||(tt.add(ut),Gt(H,z))}})));function Gt(Q,{name:Z,value:V,color:H,opacity:tt}){let z=H!=null||tt!=null,ut,Lt=g*100,[Ie]=ed(Z,Lt,U,$);if(Ie>=0)Z=Z.slice(0,Ie).trimEnd()+Jf,ut=V.trim(),V="";else{(Z||!V&&!z)&&(V=" "+V);let[st]=ed(V,Lt-U(Z),U,$);st>=0&&(V=V.slice(0,st).trimEnd()+Jf,ut=V.trim())}let le=Q.append("tspan").attr("x",0).attr("dy",`${m}em`).text("\u200B");Z&&le.append("tspan").attr("font-weight","bold").text(Z),V&&le.append(()=>d.createTextNode(V)),z&&le.append("tspan").text(" \u25A0").attr("fill",H).attr("fill-opacity",tt).style("user-select","none"),ut&&le.append("title").text(ut)}function at(){let{width:Q,height:Z}=i.facet??i;ot.selectChildren().each(function(V){let{x:H,width:tt,height:z}=this.getBBox();tt=Math.round(tt),z=Math.round(z);let ut=h;if(ut===void 0){ut=s.previousAnchor;let le=F(V)+L,st=C(V)+S,Le=le+tt+y*2<Q,Es=le-tt-y*2>0,Ti=st+z+b+y*2+7<Z,cx=st-z-b-y*2>0,lx=(/-left$/.test(ut)?Le||!Es:Le&&!Es)?"left":"right",aA=(/^top-/.test(ut)?Ti||!cx:Ti&&!cx)?"top":"bottom";ut=s.previousAnchor=`${aA}-${lx}`}let Lt=this.firstChild,Ie=this.lastChild;if(Lt.setAttribute("d",Sat(ut,b,y,tt,z)),H)for(let le of Ie.childNodes)le.setAttribute("x",-H);Ie.setAttribute("y",`${+wat(ut,Ie.childNodes.length,m).toFixed(6)}em`),Ie.setAttribute("transform",`translate(${vat(ut,b,y,tt,z)})`)})}return f.isConnected?Promise.resolve().then(at):typeof requestAnimationFrame<"u"&&requestAnimationFrame(at),ot.node()}};function nT(e,{x:t,y:r,...n}={}){return n.frameAnchor===void 0&&([t,r]=hr(t,r)),new Sb(e,{...n,x:t,y:r})}function wat(e,t,r){return/^top(?:-|$)/.test(e)?.94-r:-.29-t*r}function vat(e,t,r,n,i){switch(e){case"middle":return[-n/2,i/2];case"top-left":return[r,t+r];case"top":return[-n/2,t/2+r];case"top-right":return[-n-r,t+r];case"right":return[-t/2-n-r,i/2];case"bottom-left":return[r,-t-r];case"bottom":return[-n/2,-t/2-r];case"bottom-right":return[-n-r,-t-r];case"left":return[r+t/2,i/2]}}function Sat(e,t,r,n,i){let o=n+r*2,s=i+r*2;switch(e){case"middle":return`M${-o/2},${-s/2}h${o}v${s}h${-o}z`;case"top-left":return`M0,0l${t},${t}h${o-t}v${s}h${-o}z`;case"top":return`M0,0l${t/2},${t/2}h${(o-t)/2}v${s}h${-o}v${-s}h${(o-t)/2}z`;case"top-right":return`M0,0l${-t},${t}h${t-o}v${s}h${o}z`;case"right":return`M0,0l${-t/2},${-t/2}v${t/2-s/2}h${-o}v${s}h${o}v${t/2-s/2}z`;case"bottom-left":return`M0,0l${t},${-t}h${o-t}v${-s}h${-o}z`;case"bottom":return`M0,0l${t/2},${-t/2}h${(o-t)/2}v${-s}h${-o}v${s}h${(o-t)/2}z`;case"bottom-right":return`M0,0l${-t},${-t}h${t-o}v${-s}h${o}z`;case"left":return`M0,0l${t/2},${-t/2}v${t/2-s/2}h${o}v${s}h${-o}v${t/2-s/2}z`}}function Iat({channels:e}){let t={};for(let r in e){if(_at.has(r))continue;let n=vI(e,r);n&&(t[r]=n)}return t}function O7(e,t,r){return t.hint?.length?`${to(t.value[r]-e.value[r])}`:`${to(e.value[r])}\u2013${to(t.value[r])}`}function DF(e,t,r){return String(e[t.scale]?.label??t?.label??r)}function Tb(e={}){let{facet:t,style:r,caption:n,ariaLabel:i,ariaDescription:o}=e,s=Tp(e.className),a=e.marks===void 0?[]:F7(e.marks);a.push(...Oat(a));let c=Eat(t,e),l=new Map;for(let I of a){let F=N7(I,c,e);F&&l.set(I,F)}let u=new Map;c&&Ib(u,[c],e),Ib(u,l,e);let f=F7(Fat(a,u,e));for(let I of f){let F=N7(I,c,e);F&&l.set(I,F)}a.unshift(...f);let d=DP(u,e);if(d!==void 0){let I=c?RI(d,c):void 0;for(let C of a){if(C.facet===null||C.facet==="super")continue;let U=l.get(C);U!==void 0&&(U.facetsIndex=C.fx!=null||C.fy!=null?RI(d,U):I)}let F=new Set;for(let{facetsIndex:C}of l.values())C?.forEach((U,$)=>{U?.length>0&&F.add($)});d.forEach(0<F.size&&F.size<d.length?(C,U)=>C.empty=!F.has(U):C=>C.empty=!1);for(let C of a)if(C.facet==="exclude"){let U=l.get(C);U!==void 0&&(U.facetsIndex=kP(U.facetsIndex))}}for(let I of Oe.keys())_a(e[I])&&I!=="fx"&&I!=="fy"&&u.set(I,[]);let h=new Map;for(let I of a){if(h.has(I))throw new Error("duplicate mark; each mark must be unique");let{facetsIndex:F,channels:C}=l.get(I)??{},{data:U,facets:$,channels:q}=I.initialize(F,C,e);kF(q,e),h.set(I,{data:U,facets:$,channels:q})}let p=pb(Ib(u,h,e),e),m=lF(p),g=FP(p,a,e);xP(p,g);let{fx:y,fy:b}=m,x=y||b?uF(p,g):g,_=y||b?Uat(m,g):g,w=gu(e),v=w.document,A=Mc("svg").call(v.documentElement),B=A;w.ownerSVGElement=A,w.className=s,w.projection=D5(e,x),w.filterFacets=(I,F)=>RI(d,{channels:F,groups:DI(I,F)}),w.getMarkState=I=>{let F=h.get(I),C=l.get(I);return{...F,channels:{...F.channels,...C?.channels}}},w.dispatchValue=I=>{B.value!==I&&(B.value=I,B.dispatchEvent(new Event("input",{bubbles:!0})))};let D=new Set;for(let[I,F]of h)if(I.initializer!=null){let C=I.facet==="super"?_:x,U=I.initializer(F.data,F.facets,F.channels,m,C,w);if(U.data!==void 0&&(F.data=U.data),U.facets!==void 0&&(F.facets=U.facets),U.channels!==void 0){let{fx:$,fy:q,...j}=U.channels;Mat(j),Object.assign(F.channels,j);for(let rt of Object.values(j)){let{scale:ot}=rt;ot!=null&&Oe.get(ot)!==Qi&&(R7(rt,e),D.add(ot))}($!=null||q!=null)&&l.set(I,!0)}}if(D.size){let I=new Map;Ib(I,h,e,U=>D.has(U)),Ib(u,h,e,U=>D.has(U));let F=Cat(pb(I,e),p),C=lF(F);Object.assign(p,F),Object.assign(m,C)}let T,M;d!==void 0&&(T={x:y?.domain(),y:b?.domain()},d=LP(d,T),M=RP(y,b,g));for(let[I,F]of h)F.values=I.scale(F.channels,m,w);let{width:O,height:L}=g;ne(A).attr("class",s).attr("fill","currentColor").attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("text-anchor","middle").attr("width",O).attr("height",L).attr("viewBox",`0 0 ${O} ${L}`).attr("aria-label",i).attr("aria-description",o).call(I=>I.append("style").text(`.${s} {
  display: block;
  background: white;
  height: auto;
  height: intrinsic;
  max-width: 100%;
}
.${s} text,
.${s} tspan {
  white-space: pre;
}`)).call(Ap,r);for(let I of a){let{channels:F,values:C,facets:U}=h.get(I);if(d===void 0||I.facet==="super"){let $=null;if(U&&($=U[0],$=I.filter($,F,C),$.length===0))continue;let q=I.render($,m,C,_,w);if(q==null)continue;A.appendChild(q)}else{let $;for(let q of d){if(!(I.facetAnchor?.(d,T,q)??!q.empty))continue;let j=null;if(U){let ot=l.has(I);if(j=U[ot?q.i:0],j=I.filter(j,F,C),j.length===0)continue;ot&&(j.fx=q.x,j.fy=q.y,j.fi=q.i)}let rt=I.render(j,m,C,x,w);if(rt!=null){($??=ne(A).append("g")).append(()=>rt).datum(q);for(let ot of["aria-label","aria-description","aria-hidden","transform"])rt.hasAttribute(ot)&&($.attr(ot,rt.getAttribute(ot)),rt.removeAttribute(ot))}}$?.selectChildren().attr("transform",M)}}let S=XP(p,w,e);if(n!=null||S.length>0){B=v.createElement("figure"),B.style.maxWidth="initial";for(let I of S)B.appendChild(I);if(B.appendChild(A),n!=null){let I=v.createElement("figcaption");I.appendChild(n?.ownerDocument?n:v.createTextNode(n)),B.appendChild(I)}}B.scale=SP(p),B.legend=WP(p,w,e);let E=O5();return E>0&&ne(A).append("text").attr("x",O).attr("y",20).attr("dy","-1em").attr("text-anchor","end").attr("font-family","initial").text("\u26A0\uFE0F").append("title").text(`${E.toLocaleString("en-US")} warning${E===1?"":"s"}. Please check the console.`),B}function Tat({marks:e=[],...t}={}){return Tb({...t,marks:[...e,this]})}bt.prototype.plot=Tat;function F7(e){return e.flat(1/0).filter(t=>t!=null).map(Aat)}function Aat(e){return typeof e.render=="function"?e:new RF(e)}var RF=class extends bt{constructor(t){if(typeof t!="function")throw new TypeError("invalid mark; missing render function");super(),this.render=t}render(){}};function kF(e,t){for(let r in e)R7(e[r],t);return e}function R7(e,t){let{scale:r,transform:n=!0}=e;if(r==null||!n)return;let{type:i,percent:o,interval:s,transform:a=o?c=>c*100:$O(s,i)}=t[r]??{};a!=null&&(e.value=fe(e.value,a),e.transform=!1)}function Mat(e){for(let t in e)JO(t,e[t])}function Ib(e,t,r,n=a5){for(let{channels:i}of t.values())for(let o in i){let s=i[o],{scale:a}=s;if(a!=null&&n(a))if(a==="projection"){if(!k5(r)){let c=r.x?.domain===void 0,l=r.y?.domain===void 0;if(c||l){let[u,f]=U5(s);c&&LF(e,"x",u),l&&LF(e,"y",f)}}}else LF(e,a,s)}return e}function LF(e,t,r){let n=e.get(t);n!==void 0?n.push(r):e.set(t,[r])}function Eat(e,t){if(e==null)return;let{x:r,y:n}=e;if(r==null&&n==null)return;let i=vr(e.data);if(i==null)throw new Error("missing facet data");let o={};r!=null&&(o.fx=bp(i,{value:r,scale:"fx"})),n!=null&&(o.fy=bp(i,{value:n,scale:"fy"})),kF(o,t);let s=DI(i,o);return{channels:o,groups:s,data:e.data}}function N7(e,t,r){if(e.facet===null||e.facet==="super")return;let{fx:n,fy:i}=e;if(n!=null||i!=null){let c=vr(e.data??n??i);if(c===void 0)throw new Error(`missing facet data in ${e.ariaLabel}`);if(c===null)return;let l={};return n!=null&&(l.fx=bp(c,{value:n,scale:"fx"})),i!=null&&(l.fy=bp(c,{value:i,scale:"fy"})),kF(l,r),{channels:l,groups:DI(c,l)}}if(t===void 0)return;let{channels:o,groups:s,data:a}=t;if(e.facet!=="auto"||e.data===a)return{channels:o,groups:s};a.length>0&&(s.size>1||s.size===1&&o.fx&&o.fy&&[...s][0][1].size>1)&&vr(e.data)?.length===a.length&&xn(`Warning: the ${e.ariaLabel} mark appears to use faceted data, but isn\u2019t faceted. The mark data has the same length as the facet data and the mark facet option is "auto", but the mark data and facet data are distinct. If this mark should be faceted, set the mark facet option to true; otherwise, suppress this warning by setting the mark facet option to false.`)}function Bat(e,t={}){return Qe({...t,x:null,y:null},(r,n,i,o,s,a)=>a.getMarkState(e))}function Oat(e){let t=[];for(let r of e){let n=r.tip;if(n){let o=(n==="x"?Ep:n==="y"?Bp:Mp)(Bat(r));o.title=null,t.push(nT(r.data,o))}}return t}function Fat(e,t,r){let{projection:n,x:i={},y:o={},fx:s={},fy:a={},axis:c,grid:l,facet:u={},facet:{axis:f=c,grid:d}=u,x:{axis:h=c,grid:p=h===null?null:l}=i,y:{axis:m=c,grid:g=m===null?null:l}=o,fx:{axis:y=f,grid:b=y===null?null:d}=s,fy:{axis:x=f,grid:_=x===null?null:d}=a}=r;(n||!_a(i)&&!D7("x",e))&&(h=p=null),(n||!_a(o)&&!D7("y",e))&&(m=g=null),t.has("fx")||(y=b=null),t.has("fy")||(x=_=null),h===void 0&&(h=!sT(e,"x")),m===void 0&&(m=!sT(e,"y")),y===void 0&&(y=!sT(e,"fx")),x===void 0&&(x=!sT(e,"fy")),h===!0&&(h="bottom"),m===!0&&(m="left"),y===!0&&(y=h==="top"||h===null?"bottom":"top"),x===!0&&(x=m==="right"||m===null?"left":"right");let w=[];return oT(w,_,JI,a),iT(w,x,ZI,"right","left",u,a),oT(w,b,eT,s),iT(w,y,KI,"top","bottom",u,s),oT(w,g,QI,o),iT(w,m,_b,"left","right",r,o),oT(w,p,tT,i),iT(w,h,wb,"bottom","top",r,i),w}function iT(e,t,r,n,i,o,s){if(!t)return;let a=Nat(t);s=Dat(a?n:t,o,s);let{line:c}=s;(r===_b||r===wb)&&c&&!zc(c)&&e.push(Dp(Lat(s))),e.push(r(s)),a&&e.push(r({...s,anchor:i,label:null}))}function oT(e,t,r,n){!t||zc(t)||e.push(r(Rat(t,n)))}function Nat(e){return/^\s*both\s*$/i.test(e)}function Dat(e,t,{line:r=t.line,ticks:n,tickSize:i,tickSpacing:o,tickPadding:s,tickFormat:a,tickRotate:c,fontVariant:l,ariaLabel:u,ariaDescription:f,label:d=t.label,labelAnchor:h,labelArrow:p=t.labelArrow,labelOffset:m}){return{anchor:e,line:r,ticks:n,tickSize:i,tickSpacing:o,tickPadding:s,tickFormat:a,tickRotate:c,fontVariant:l,ariaLabel:u,ariaDescription:f,label:d,labelAnchor:h,labelArrow:p,labelOffset:m}}function Lat(e){let{anchor:t,line:r}=e;return{anchor:t,facetAnchor:t+"-empty",stroke:r===!0?void 0:r}}function Rat(e,{stroke:t=hu(e)?e:void 0,ticks:r=kat(e)?e:void 0,tickSpacing:n,ariaLabel:i,ariaDescription:o}){return{stroke:t,ticks:r,tickSpacing:n,ariaLabel:i,ariaDescription:o}}function kat(e){switch(typeof e){case"number":return!0;case"string":return!hu(e)}return Dn(e)||typeof e?.range=="function"}function sT(e,t){let r=`${t}-axis `;return e.some(n=>n.ariaLabel?.startsWith(r))}function D7(e,t){for(let r of t)for(let n in r.channels){let{scale:i}=r.channels[n];if(i===e||i==="projection")return!0}return!1}function Cat(e,t){for(let r in e){let n=e[r],i=t[r];n.label===void 0&&i&&(n.label=i.label)}return e}function Uat({fx:e,fy:t},r){let{marginTop:n,marginRight:i,marginBottom:o,marginLeft:s,width:a,height:c}=MI(r),l=e&&L7(e),u=t&&L7(t);return{marginTop:t?u[0]:n,marginRight:e?a-l[1]:i,marginBottom:t?c-u[1]:o,marginLeft:e?l[0]:s,inset:{marginTop:r.marginTop,marginRight:r.marginRight,marginBottom:r.marginBottom,marginLeft:r.marginLeft},width:a,height:c}}function L7(e){let t=e.domain(),r=e(t[0]),n=e(t[t.length-1]);return n<r&&([r,n]=[n,r]),[r,n+e.bandwidth()]}var Pat=new Map([["basis",hO],["basis-closed",pO],["basis-open",mO],["bundle",yO],["bump-x",cO],["bump-y",lO],["cardinal",gO],["cardinal-closed",bO],["cardinal-open",xO],["catmull-rom",_O],["catmull-rom-closed",wO],["catmull-rom-open",vO],["linear",Cc],["linear-closed",SO],["monotone-x",TO],["monotone-y",AO],["natural",MO],["step",EO],["step-after",OO],["step-before",BO]]);function Ab(e=Cc,t){if(typeof e=="function")return e;let r=Pat.get(`${e}`.toLowerCase());if(!r)throw new Error(`unknown curve: ${e}`);if(t!==void 0){if("beta"in r)return r.beta(t);if("tension"in r)return r.tension(t);if("alpha"in r)return r.alpha(t)}return r}function aT(e=vu,t){return typeof e!="function"&&`${e}`.toLowerCase()==="auto"?vu:Ab(e,t)}function vu(e){return Cc(e)}function Ba(e={y:"count"},t={}){[e,t]=UF(e,t);let{x:r,y:n}=t;return CF(cT(r,t,K),null,null,n,e,Kf(t))}function Oa(e={x:"count"},t={}){[e,t]=UF(e,t);let{x:r,y:n}=t;return CF(null,cT(n,t,K),r,null,e,Qf(t))}function Xc(e={fill:"count"},t={}){[e,t]=UF(e,t);let{x:r,y:n}=$at(t);return CF(r,n,null,null,e,Kf(Qf(t)))}function U7(e,t,r={}){return r?.interval==null?r:e({[t]:r?.reduce===void 0?_I:r.reduce,filter:null},r)}function Lp(e={}){return U7(Ba,"y",Wc(e,"x"))}function Rp(e={}){return U7(Oa,"x",Wc(e,"y"))}function CF(e,t,r,n,{data:i=xI,filter:o=ab,sort:s,reverse:a,...c}={},l={}){e=k7(e),t=k7(t),c=zat(c,l),i=z7(i,K),s=s==null?void 0:P7("sort",s,l),o=o==null?void 0:$7("filter",o,l),r!=null&&Ta(c,"x","x1","x2")&&(r=null),n!=null&&Ta(c,"y","y1","y2")&&(n=null);let[u,f]=gn(e),[d,h]=gn(e),[p,m]=gn(t),[g,y]=gn(t),[b,x]=r!=null?[r,"x"]:n!=null?[n,"y"]:[],[_,w]=gn(b),{x:v,y:A,z:B,fill:D,stroke:T,x1:M,x2:O,y1:L,y2:S,domain:E,cumulative:I,thresholds:F,interval:C,...U}=l,[$,q]=gn(B),[j]=wr(D),[rt]=wr(T),[ot,Gt]=gn(j),[at,Q]=gn(rt);return{..."z"in l&&{z:$||B},..."fill"in l&&{fill:ot||D},..."stroke"in l&&{stroke:at||T},...Xr(U,(Z,V,H)=>{let tt=Xf(gt(Z,b),H?.[x]),z=gt(Z,B),ut=gt(Z,j),Lt=gt(Z,rt),Ie=fb(c,{z,fill:ut,stroke:Lt}),le=[],st=[],Le=tt&&w([]),Es=z&&q([]),Ti=ut&&Gt([]),cx=Lt&&Q([]),lx=e&&f([]),aA=e&&h([]),XN=t&&m([]),mW=t&&y([]),yW=Yat(e?.(Z),t?.(Z)),gW=0;for(let pd of c)pd.initialize(Z);s&&s.initialize(Z),o&&o.initialize(Z);for(let pd of V){let HN=[];for(let ym of c)ym.scope("facet",pd);s&&s.scope("facet",pd),o&&o.scope("facet",pd);for(let[ym,bW]of pu(pd,Ie))for(let[xW,_W]of pu(bW,tt))for(let[Mu,Eu]of yW(_W))if(!(o&&!o.reduce(Mu,Eu))){HN.push(gW++),st.push(i.reduceIndex(Mu,Z,Eu)),tt&&Le.push(xW),z&&Es.push(Ie===z?ym:z[Mu[0]]),ut&&Ti.push(Ie===ut?ym:ut[Mu[0]]),Lt&&cx.push(Ie===Lt?ym:Lt[Mu[0]]),lx&&(lx.push(Eu.x1),aA.push(Eu.x2)),XN&&(XN.push(Eu.y1),mW.push(Eu.y2));for(let wW of c)wW.reduce(Mu,Eu);s&&s.reduce(Mu)}le.push(HN)}return KO(le,s,a),{data:st,facets:le}}),...!Ta(c,"x")&&(u?{x1:u,x2:d,x:fp(u,d)}:{x:v,x1:M,x2:O}),...!Ta(c,"y")&&(p?{y1:p,y2:g,y:fp(p,g)}:{y:A,y1:L,y2:S}),..._&&{[x]:_},...Object.fromEntries(c.map(({name:Z,output:V})=>[Z,V]))}}function UF({cumulative:e,domain:t,thresholds:r,interval:n,...i},o){return[i,{cumulative:e,domain:t,thresholds:r,interval:n,...o}]}function cT(e,{cumulative:t,domain:r,thresholds:n,interval:i},o){return e={...Sa(e)},e.domain===void 0&&(e.domain=r),e.cumulative===void 0&&(e.cumulative=t),e.thresholds===void 0&&(e.thresholds=n),e.interval===void 0&&(e.interval=i),e.value===void 0&&(e.value=o),e.thresholds=PF(e.thresholds,e.interval),e}function $at(e){let{x:t,y:r}=e;return t=cT(t,e),r=cT(r,e),[t.value,r.value]=hr(t.value,r.value),{x:t,y:r}}function k7(e){if(e==null)return;let{value:t,cumulative:r,domain:n=ze,thresholds:i}=e,o=s=>{let a=gt(s,t),c;if(fr(a)||jat(i)){a=fe(a,kO,Float64Array);let[u,f]=typeof n=="function"?n(a):n,d=typeof i=="function"&&!Mb(i)?i(a,u,f):i;typeof d=="number"&&(d=N0(u,f,d)),Mb(d)&&(n===ze&&(u=d.floor(u),f=d.offset(d.floor(f))),d=d.range(u,d.offset(f))),c=d}else{a=Fr(a);let[u,f]=typeof n=="function"?n(a):n,d=typeof i=="function"&&!Mb(i)?i(a,u,f):i;if(typeof d=="number")if(n===ze){let h=Tc(u,f,d);if(isFinite(h))if(h>0){let p=Math.round(u/h),m=Math.round(f/h);p*h<=u||--p,m*h>f||++m;let g=m-p+1;d=new Float64Array(g);for(let y=0;y<g;++y)d[y]=(p+y)*h}else if(h<0){h=-h;let p=Math.round(u*h),m=Math.round(f*h);p/h<=u||--p,m/h>f||++m;let g=m-p+1;d=new Float64Array(g);for(let y=0;y<g;++y)d[y]=(p+y)/h}else d=[u];else d=[u]}else d=dn(u,f,d);else Mb(d)&&(n===ze&&(u=d.floor(u),f=d.offset(d.floor(f))),d=d.range(u,d.offset(f)));c=d}let l=[];if(c.length===1)l.push([c[0],c[0]]);else for(let u=1;u<c.length;++u)l.push([c[u-1],c[u]]);return l.bin=(r<0?Gat:r>0?Wat:$F)(l,c,a),l};return o.label=Qn(t),o}function PF(e,t,r=C7){if(e===void 0)return t===void 0?r:va(t);if(typeof e=="string"){switch(e.toLowerCase()){case"freedman-diaconis":return iv;case"scott":return Mg;case"sturges":return Vl;case"auto":return C7}return cI(e)}return e}function zat(e,t){return ub(e,t,P7)}function P7(e,t,r){return gI(e,t,r,$7)}function $7(e,t,r){return bI(e,t,r,z7)}function z7(e,t){return gp(e,t,Vat)}function Vat(e){switch(`${e}`.toLowerCase()){case"x":return Xat;case"x1":return Zat;case"x2":return Kat;case"y":return Hat;case"y1":return Qat;case"y2":return Jat}throw new Error(`invalid bin reduce: ${e}`)}function C7(e,t,r){return Math.min(200,Mg(e,t,r))}function jat(e){return qat(e)||Dn(e)&&fr(e)}function qat(e){return Mb(e)&&typeof e=="function"&&e()instanceof Date}function Mb(e){return typeof e?.range=="function"}function Yat(e,t){return e&&t?function*(r){let n=e.bin(r);for(let[i,[o,s]]of e.entries()){let a=t.bin(n[i]);for(let[c,[l,u]]of t.entries())yield[a[c],{x1:o,y1:l,x2:s,y2:u}]}}:e?function*(r){let n=e.bin(r);for(let[i,[o,s]]of e.entries())yield[n[i],{x1:o,x2:s}]}:function*(r){let n=t.bin(r);for(let[i,[o,s]]of t.entries())yield[n[i],{y1:o,y2:s}]}}function $F(e,t,r){return t=Fr(t),n=>{let i=e.map(()=>[]);for(let o of n)i[Ic(t,r[o])-1]?.push(o);return i}}function Wat(e,t,r){let n=$F(e,t,r);return i=>{let o=n(i);for(let s=1,a=o.length;s<a;++s){let c=o[s-1],l=o[s];for(let u of c)l.push(u)}return o}}function Gat(e,t,r){let n=$F(e,t,r);return i=>{let o=n(i);for(let s=o.length-2;s>=0;--s){let a=o[s+1],c=o[s];for(let l of a)c.push(l)}return o}}function V7(e,t){let r=(+e+ +t)/2;return e instanceof Date?new Date(r):r}var Xat={reduceIndex(e,t,{x1:r,x2:n}){return V7(r,n)}},Hat={reduceIndex(e,t,{y1:r,y2:n}){return V7(r,n)}},Zat={reduceIndex(e,t,{x1:r}){return r}},Kat={reduceIndex(e,t,{x2:r}){return r}},Qat={reduceIndex(e,t,{y1:r}){return r}},Jat={reduceIndex(e,t,{y2:r}){return r}};function kp(e={}){return CO(e)?e:{...e,x:K}}function Cp(e={}){return UO(e)?e:{...e,y:K}}function zF(e={},t={}){arguments.length===1&&([e,t]=$p(e));let{y1:r,y:n=r,x:i,...o}=t,[s,a,c,l]=zp(n,i,"y","x",e,o);return{...s,y1:r,y:a,x1:c,x2:l,x:fp(c,l)}}function Y7(e={},t={}){arguments.length===1&&([e,t]=$p(e));let{y1:r,y:n=r,x:i}=t,[o,s,a]=zp(n,i,"y","x",e,t);return{...o,y1:r,y:s,x:a}}function W7(e={},t={}){arguments.length===1&&([e,t]=$p(e));let{y1:r,y:n=r,x:i}=t,[o,s,,a]=zp(n,i,"y","x",e,t);return{...o,y1:r,y:s,x:a}}function VF(e={},t={}){arguments.length===1&&([e,t]=$p(e));let{x1:r,x:n=r,y:i,...o}=t,[s,a,c,l]=zp(n,i,"x","y",e,o);return{...s,x1:r,x:a,y1:c,y2:l,y:fp(c,l)}}function G7(e={},t={}){arguments.length===1&&([e,t]=$p(e));let{x1:r,x:n=r,y:i}=t,[o,s,a]=zp(n,i,"x","y",e,t);return{...o,x1:r,x:s,y:a}}function X7(e={},t={}){arguments.length===1&&([e,t]=$p(e));let{x1:r,x:n=r,y:i}=t,[o,s,,a]=zp(n,i,"x","y",e,t);return{...o,x1:r,x:s,y:a}}function Up({x:e,x1:t,x2:r,...n}={}){return n=Wc(n,"y"),t===void 0&&r===void 0?zF({x:e,...n}):([t,r]=PO(e,t,r),{...n,x1:t,x2:r})}function Pp({y:e,y1:t,y2:r,...n}={}){return n=Wc(n,"x"),t===void 0&&r===void 0?VF({y:e,...n}):([t,r]=PO(e,t,r),{...n,y1:t,y2:r})}function $p(e){let{offset:t,order:r,reverse:n,...i}=e;return[{offset:t,order:r,reverse:n},i]}var tct={length:!0};function zp(e,t=ib,r,n,{offset:i,order:o,reverse:s},a){let c=Nn(a),[l,u]=gn(e),[f,d]=Gr(t),[h,p]=Gr(t);return f.hint=h.hint=tct,i=ect(i),o=ict(o,i,n),[Xr(a,(m,g,y)=>{let b=e==null?void 0:u(Xf(gt(m,e),y?.[r])),x=gt(m,t,Float64Array),_=gt(m,c),w=o&&o(m,b,x,_),v=m.length,A=d(new Float64Array(v)),B=p(new Float64Array(v)),D=[];for(let T of g){let M=b?Array.from(Vr(T,O=>b[O]).values()):[T];if(w)for(let O of M)O.sort(w);for(let O of M){let L=0,S=0;s&&O.reverse();for(let E of O){let I=x[E];I<0?L=B[E]=(A[E]=L)+I:I>0?S=B[E]=(A[E]=S)+I:B[E]=A[E]=S}}D.push(M)}return i&&i(D,A,B,_),{data:m,facets:g}}),l,f,h]}function ect(e){if(e!=null){if(typeof e=="function")return e;switch(`${e}`.toLowerCase()){case"expand":case"normalize":return rct;case"center":case"silhouette":return nct;case"wiggle":return Z7}throw new Error(`unknown offset: ${e}`)}}function H7(e,t){let r=0,n=0;for(let i of e){let o=t[i];o<r&&(r=o),o>n&&(n=o)}return[r,n]}function rct(e,t,r){for(let n of e)for(let i of n){let[o,s]=H7(i,r);for(let a of i){let c=1/(s-o||1);t[a]=c*(t[a]-o),r[a]=c*(r[a]-o)}}}function nct(e,t,r){for(let n of e){for(let i of n){let[o,s]=H7(i,r);for(let a of i){let c=(s+o)/2;t[a]-=c,r[a]-=c}}K7(n,t,r)}Q7(e,t,r)}function Z7(e,t,r,n){for(let i of e){let o=new $n,s=0;for(let a of i){let c=-1,l=a.map(h=>Math.abs(r[h]-t[h])),u=a.map(h=>{c=n?n[h]:++c;let p=r[h]-t[h],m=o.has(c)?p-o.get(c):0;return o.set(c,p),m}),f=[0,...Jw(u)];for(let h of a)t[h]+=s,r[h]+=s;let d=hn(l);d&&(s-=hn(l,(h,p)=>(u[p]/2+f[p])*h)/d)}K7(i,t,r)}Q7(e,t,r)}function K7(e,t,r){let n=Te(e,i=>Te(i,o=>t[o]));for(let i of e)for(let o of i)t[o]-=n,r[o]-=n}function Q7(e,t,r){let n=e.length;if(n===1)return;let i=e.map(a=>a.flat()),o=i.map(a=>(Te(a,c=>t[c])+ue(a,c=>r[c]))/2),s=Te(o);for(let a=0;a<n;a++){let c=s-o[a];for(let l of i[a])t[l]+=c,r[l]+=c}}function ict(e,t,r){if(e===void 0&&t===Z7)return j7(Wr);if(e!=null){if(typeof e=="string"){let n=e.startsWith("-"),i=n?Yf:Wr;switch((n?e.slice(1):e).toLowerCase()){case"value":case r:return oct(i);case"z":return sct(i);case"sum":return act(i);case"appearance":return cct(i);case"inside-out":return j7(i)}return q7(LO(e))}if(typeof e=="function")return(e.length===1?q7:lct)(e);if(Array.isArray(e))return uct(e);throw new Error(`invalid order: ${e}`)}}function oct(e){return(t,r,n)=>(i,o)=>e(n[i],n[o])}function sct(e){return(t,r,n,i)=>(o,s)=>e(i[o],i[s])}function act(e){return lT(e,(t,r,n,i)=>mh(Kn(t),o=>hn(o,s=>n[s]),o=>i[o]))}function cct(e){return lT(e,(t,r,n,i)=>mh(Kn(t),o=>r[bf(o,s=>n[s])],o=>i[o]))}function j7(e){return lT(e,(t,r,n,i)=>{let o=Kn(t),s=mh(o,f=>r[bf(f,d=>n[d])],f=>i[f]),a=_s(o,f=>hn(f,d=>n[d]),f=>i[f]),c=[],l=[],u=0;for(let f of s)u<0?(u+=a.get(f),c.push(f)):(u-=a.get(f),l.push(f));return l.reverse().concat(c)})}function q7(e){return t=>{let r=gt(t,e);return(n,i)=>Wr(r[n],r[i])}}function lct(e){return t=>(r,n)=>e(t[r],t[n])}function uct(e){return lT(Wr,()=>e)}function lT(e,t){return(r,n,i,o)=>{if(!o)throw new Error("missing channel: z");let s=new $n(t(r,n,i,o).map((a,c)=>[a,c]));return(a,c)=>e(s.get(o[a]),s.get(o[c]))}}var fct={ariaLabel:"area",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1},nd=class extends bt{constructor(t,r={}){let{x1:n,y1:i,x2:o,y2:s,z:a,curve:c,tension:l}=r;super(t,{x1:{value:n,scale:"x"},y1:{value:i,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:s,scale:"y",optional:!0},z:{value:Nn(r),optional:!0}},r,fct),this.z=a,this.curve=Ab(c,l)}filter(t){return t}render(t,r,n,i,o){let{x1:s,y1:a,x2:c=s,y2:l=a}=n;return ct("svg:g",o).call(Pt,this,i,o).call(vt,this,r,0,0).call(u=>u.selectAll().data(FI(t,[s,a,c,l],this,n)).enter().append("path").call(Dt,this).call(Zf,this,n).attr("d",ep().curve(this.curve).defined(f=>f>=0).x0(f=>s[f]).y0(f=>a[f]).x1(f=>c[f]).y1(f=>l[f]))).node()}};function J7(e,t){return t===void 0?id(e,{x:Pc,y:du}):new nd(e,t)}function Vp(e,t){let{y:r=dr,...n}=Rp(t);return new nd(e,Up(kp({...n,y1:r,y2:void 0})))}function id(e,t){let{x:r=dr,...n}=Lp(t);return new nd(e,Pp(Cp({...n,x1:r,x2:void 0})))}var dct={ariaLabel:"link",fill:"none",stroke:"currentColor",strokeMiterlimit:1},Eb=class extends bt{constructor(t,r={}){let{x1:n,y1:i,x2:o,y2:s,curve:a,tension:c}=r;super(t,{x1:{value:n,scale:"x"},y1:{value:i,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:s,scale:"y",optional:!0}},r,dct),this.curve=aT(a,c),Ms(this,r)}project(t,r,n){this.curve!==vu&&super.project(t,r,n)}render(t,r,n,i,o){let{x1:s,y1:a,x2:c=s,y2:l=a}=n,{curve:u}=this;return ct("svg:g",o).call(Pt,this,i,o).call(vt,this,r).call(f=>f.selectAll().data(t).enter().append("path").call(Dt,this).attr("d",u===vu&&o.projection?hct(o.projection,s,a,c,l):d=>{let h=Yn(),p=u(h);return p.lineStart(),p.point(s[d],a[d]),p.point(c[d],l[d]),p.lineEnd(),h}).call(he,this,n).call(Gc,this,n,o)).node()}};function hct(e,t,r,n,i){let o=mn(e);return t=Fr(t),r=Fr(r),n=Fr(n),i=Fr(i),s=>o({type:"LineString",coordinates:[[t[s],r[s]],[n[s],i[s]]]})}function uT(e,{x:t,x1:r,x2:n,y:i,y1:o,y2:s,...a}={}){return[r,n]=Bb(t,r,n),[o,s]=Bb(i,o,s),new Eb(e,{...a,x1:r,x2:n,y1:o,y2:s})}function Bb(e,t,r){if(e===void 0){if(t===void 0){if(r!==void 0)return[r]}else if(r===void 0)return[t]}else{if(t===void 0)return r===void 0?[e]:[e,r];if(r===void 0)return[e,t]}return[t,r]}var pct={ariaLabel:"arrow",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:1,strokeWidth:1.5},Ob=class extends bt{constructor(t,r={}){let{x1:n,y1:i,x2:o,y2:s,bend:a=0,headAngle:c=60,headLength:l=8,inset:u=0,insetStart:f=u,insetEnd:d=u}=r;super(t,{x1:{value:n,scale:"x"},y1:{value:i,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:s,scale:"y",optional:!0}},r,pct),this.bend=a===!0?22.5:Math.max(-90,Math.min(90,a)),this.headAngle=+c,this.headLength=+l,this.insetStart=+f,this.insetEnd=+d}render(t,r,n,i,o){let{x1:s,y1:a,x2:c=s,y2:l=a,SW:u}=n,{strokeWidth:f,bend:d,headAngle:h,headLength:p,insetStart:m,insetEnd:g}=this,y=u?w=>u[w]:Cr(f===void 0?1:f),b=d*Op,x=h*Op/2,_=p/1.5;return ct("svg:g",o).call(Pt,this,i,o).call(vt,this,r).call(w=>w.selectAll().data(t).enter().append("path").call(Dt,this).attr("d",v=>{let A=s[v],B=a[v],D=c[v],T=l[v],M=Math.hypot(D-A,T-B);if(M<=m+g)return null;let O=Math.atan2(T-B,D-A),L=Math.min(_*y(v),M/3),S=Math.hypot(M/Math.tan(b),M)/2;if(m||g)if(S<1e5){let j=Math.sign(b),[rt,ot]=mct([A,B],[D,T],S,j);if(m&&([A,B]=t$([rt,ot,S],[A,B,m],-j*Math.sign(m))),g){let[Gt,at]=t$([rt,ot,S],[D,T,g],j*Math.sign(g));O+=Math.atan2(at-ot,Gt-rt)-Math.atan2(T-ot,D-rt),D=Gt,T=at}}else{let j=D-A,rt=T-B,ot=Math.hypot(j,rt);m&&(A+=j/ot*m,B+=rt/ot*m),g&&(D-=j/ot*g,T-=rt/ot*g)}let E=O+b,I=E+x,F=E-x,C=D-L*Math.cos(I),U=T-L*Math.sin(I),$=D-L*Math.cos(F),q=T-L*Math.sin(F);return`M${A},${B}${S<1e5?`A${S},${S} 0,0,${b>0?1:0} `:"L"}${D},${T}M${C},${U}L${D},${T}L${$},${q}`}).call(he,this,n)).node()}};function mct([e,t],[r,n],i,o){let s=r-e,a=n-t,c=Math.hypot(s,a),l=o*Math.sqrt(i*i-c*c/4)/c;return[(e+r)/2-a*l,(t+n)/2+s*l]}function t$([e,t,r],[n,i,o],s){let a=n-e,c=i-t,l=Math.hypot(a,c),u=(a*a+c*c-o*o+r*r)/(2*l),f=s*Math.sqrt(r*r-u*u);return[e+(a*u+c*f)/l,t+(c*u-a*f)/l]}function e$(e,{x:t,x1:r,x2:n,y:i,y1:o,y2:s,...a}={}){return[r,n]=Bb(t,r,n),[o,s]=Bb(i,o,s),new Ob(e,{...a,x1:r,x2:n,y1:o,y2:s})}var jp=class extends bt{constructor(t,r,n={},i){super(t,r,n,i);let{inset:o=0,insetTop:s=o,insetRight:a=o,insetBottom:c=o,insetLeft:l=o,rx:u,ry:f}=n;this.insetTop=Nt(s),this.insetRight=Nt(a),this.insetBottom=Nt(c),this.insetLeft=Nt(l),this.rx=Ae(u,"auto"),this.ry=Ae(f,"auto")}render(t,r,n,i,o){let{rx:s,ry:a}=this;return ct("svg:g",o).call(Pt,this,i,o).call(this._transform,this,r).call(c=>c.selectAll().data(t).enter().append("rect").call(Dt,this).attr("x",this._x(r,n,i)).attr("width",this._width(r,n,i)).attr("y",this._y(r,n,i)).attr("height",this._height(r,n,i)).call(lt,"rx",s).call(lt,"ry",a).call(he,this,n)).node()}_x(t,{x:r},{marginLeft:n}){let{insetLeft:i}=this;return r?o=>r[o]+i:n+i}_y(t,{y:r},{marginTop:n}){let{insetTop:i}=this;return r?o=>r[o]+i:n+i}_width({x:t},{x:r},{marginRight:n,marginLeft:i,width:o}){let{insetLeft:s,insetRight:a}=this,c=r&&t?t.bandwidth():o-n-i;return Math.max(0,c-s-a)}_height({y:t},{y:r},{marginTop:n,marginBottom:i,height:o}){let{insetTop:s,insetBottom:a}=this,c=r&&t?t.bandwidth():o-n-i;return Math.max(0,c-s-a)}},r$={ariaLabel:"bar"},Fb=class extends jp{constructor(t,r={}){let{x1:n,x2:i,y:o}=r;super(t,{x1:{value:n,scale:"x"},x2:{value:i,scale:"x"},y:{value:o,scale:"y",type:"band",optional:!0}},r,r$)}_transform(t,r,{x:n}){t.call(vt,r,{x:n},0,0)}_x({x:t},{x1:r,x2:n},{marginLeft:i}){let{insetLeft:o}=this;return Jn(t)?i+o:s=>Math.min(r[s],n[s])+o}_width({x:t},{x1:r,x2:n},{marginRight:i,marginLeft:o,width:s}){let{insetLeft:a,insetRight:c}=this;return Jn(t)?s-i-o-a-c:l=>Math.max(0,Math.abs(n[l]-r[l])-a-c)}},Nb=class extends jp{constructor(t,r={}){let{x:n,y1:i,y2:o}=r;super(t,{y1:{value:i,scale:"y"},y2:{value:o,scale:"y"},x:{value:n,scale:"x",type:"band",optional:!0}},r,r$)}_transform(t,r,{y:n}){t.call(vt,r,{y:n},0,0)}_y({y:t},{y1:r,y2:n},{marginTop:i}){let{insetTop:o}=this;return Jn(t)?i+o:s=>Math.min(r[s],n[s])+o}_height({y:t},{y1:r,y2:n},{marginTop:i,marginBottom:o,height:s}){let{insetTop:a,insetBottom:c}=this;return Jn(t)?s-i-o-a-c:l=>Math.max(0,Math.abs(n[l]-r[l])-a-c)}};function Hc(e,t={}){return cp(t)||(t={...t,y:dr,x2:K}),new Fb(e,Up(PI(kp(t))))}function Zc(e,t={}){return cp(t)||(t={...t,x:dr,y2:K}),new Nb(e,Pp($I(Cp(t))))}var yct={ariaLabel:"cell"},od=class extends jp{constructor(t,{x:r,y:n,...i}={}){super(t,{x:{value:r,scale:"x",type:"band",optional:!0},y:{value:n,scale:"y",type:"band",optional:!0}},i,yct)}_transform(t,r){t.call(vt,r,{},0,0)}};function Db(e,{x:t,y:r,...n}={}){return[t,r]=hr(t,r),new od(e,{...n,x:t,y:r})}function n$(e,{x:t=dr,fill:r,stroke:n,...i}={}){return r===void 0&&wr(n)[0]===void 0&&(r=K),new od(e,{...i,x:t,fill:r,stroke:n})}function i$(e,{y:t=dr,fill:r,stroke:n,...i}={}){return r===void 0&&wr(n)[0]===void 0&&(r=K),new od(e,{...i,y:t,fill:r,stroke:n})}var gct={ariaLabel:"dot",fill:"none",stroke:"currentColor",strokeWidth:1.5};function Lb(e){return e.sort===void 0&&e.reverse===void 0?mI({channel:"-r"},e):e}var sd=class extends bt{constructor(t,r={}){let{x:n,y:i,r:o,rotate:s,symbol:a=Uc,frameAnchor:c}=r,[l,u]=Se(s,0),[f,d]=x5(a),[h,p]=Se(o,f==null?3:4.5);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},r:{value:h,scale:"r",filter:Zn,optional:!0},rotate:{value:l,optional:!0},symbol:{value:f,scale:"auto",optional:!0}},Lb(r),gct),this.r=p,this.rotate=u,this.symbol=d,this.frameAnchor=Ia(c);let{channels:m}=this,{symbol:g}=m;if(g){let{fill:y,stroke:b}=m;g.hint={fill:y?y.value===g.value?"color":"currentColor":this.fill,stroke:b?b.value===g.value?"color":"currentColor":this.stroke}}}render(t,r,n,i,o){let{x:s,y:a}=r,{x:c,y:l,r:u,rotate:f,symbol:d}=n,{r:h,rotate:p,symbol:m}=this,[g,y]=Zr(this,i),b=m===Uc,x=u?void 0:h*h*Math.PI;return uu(h)&&(t=[]),ct("svg:g",o).call(Pt,this,i,o).call(vt,this,{x:c&&s,y:l&&a}).call(_=>_.selectAll().data(t).enter().append(b?"circle":"path").call(Dt,this).call(b?w=>{w.attr("cx",c?v=>c[v]:g).attr("cy",l?v=>l[v]:y).attr("r",u?v=>u[v]:h)}:w=>{w.attr("transform",_u`translate(${c?v=>c[v]:g},${l?v=>l[v]:y})${f?v=>` rotate(${f[v]})`:p?` rotate(${p})`:""}`).attr("d",u&&d?v=>{let A=Yn();return d[v].draw(A,u[v]*u[v]*Math.PI),A}:u?v=>{let A=Yn();return m.draw(A,u[v]*u[v]*Math.PI),A}:d?v=>{let A=Yn();return d[v].draw(A,x),A}:(()=>{let v=Yn();return m.draw(v,x),v})())}).call(he,this,n)).node()}};function Lo(e,{x:t,y:r,...n}={}){return n.frameAnchor===void 0&&([t,r]=hr(t,r)),new sd(e,{...n,x:t,y:r})}function o$(e,{x:t=K,...r}={}){return new sd(e,VI({...r,x:t}))}function s$(e,{y:t=K,...r}={}){return new sd(e,zI({...r,y:t}))}function a$(e,t){return Lo(e,{...t,symbol:"circle"})}function c$(e,t){return Lo(e,{...t,symbol:"hexagon"})}var bct={ariaLabel:"line",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1},ad=class extends bt{constructor(t,r={}){let{x:n,y:i,z:o,curve:s,tension:a}=r;super(t,{x:{value:n,scale:"x"},y:{value:i,scale:"y"},z:{value:Nn(r),optional:!0}},r,bct),this.z=o,this.curve=aT(s,a),Ms(this,r)}filter(t){return t}project(t,r,n){this.curve!==vu&&super.project(t,r,n)}render(t,r,n,i,o){let{x:s,y:a}=n,{curve:c}=this;return ct("svg:g",o).call(Pt,this,i,o).call(vt,this,r).call(l=>l.selectAll().data(FI(t,[s,a],this,n)).enter().append("path").call(Dt,this).call(Zf,this,n).call(KP,this,n,o).attr("d",c===vu&&o.projection?xct(o.projection,s,a):z0().curve(c).defined(u=>u>=0).x(u=>s[u]).y(u=>a[u]))).node()}};function xct(e,t,r){let n=mn(e);return t=Fr(t),r=Fr(r),i=>{let o=[],s=[o];for(let a of i)a===-1?(o=[],s.push(o)):o.push([t[a],r[a]]);return n({type:"MultiLineString",coordinates:s})}}function Rb(e,{x:t,y:r,...n}={}){return[t,r]=hr(t,r),new ad(e,{...n,x:t,y:r})}function qp(e,{x:t=K,y:r=dr,...n}={}){return new ad(e,Rp({...n,x:t,y:r}))}function Yp(e,{x:t=dr,y:r=K,...n}={}){return new ad(e,Lp({...n,x:t,y:r}))}var _ct={ariaLabel:"rect"},cd=class extends bt{constructor(t,r={}){let{x1:n,y1:i,x2:o,y2:s,inset:a=0,insetTop:c=a,insetRight:l=a,insetBottom:u=a,insetLeft:f=a,rx:d,ry:h}=r;super(t,{x1:{value:n,scale:"x",optional:!0},y1:{value:i,scale:"y",optional:!0},x2:{value:o,scale:"x",optional:!0},y2:{value:s,scale:"y",optional:!0}},r,_ct),this.insetTop=Nt(c),this.insetRight=Nt(l),this.insetBottom=Nt(u),this.insetLeft=Nt(f),this.rx=Ae(d,"auto"),this.ry=Ae(h,"auto")}render(t,r,n,i,o){let{x:s,y:a}=r,{x1:c,y1:l,x2:u,y2:f}=n,{marginTop:d,marginRight:h,marginBottom:p,marginLeft:m,width:g,height:y}=i,{projection:b}=o,{insetTop:x,insetRight:_,insetBottom:w,insetLeft:v,rx:A,ry:B}=this;return ct("svg:g",o).call(Pt,this,i,o).call(vt,this,{x:c&&u&&s,y:l&&f&&a},0,0).call(D=>D.selectAll().data(t).enter().append("rect").call(Dt,this).attr("x",c&&u&&(b||!Jn(s))?T=>Math.min(c[T],u[T])+v:m+v).attr("y",l&&f&&(b||!Jn(a))?T=>Math.min(l[T],f[T])+x:d+x).attr("width",c&&u&&(b||!Jn(s))?T=>Math.max(0,Math.abs(u[T]-c[T])-v-_):g-h-m-_-v).attr("height",l&&f&&(b||!Jn(a))?T=>Math.max(0,Math.abs(l[T]-f[T])-x-w):y-d-p-x-w).call(lt,"rx",A).call(lt,"ry",B).call(he,this,n)).node()}};function kb(e,t){return new cd(e,IF(TF(t)))}function ld(e,t={}){return cp(t)||(t={...t,y:dr,x2:K,interval:1}),new cd(e,Up(TF(kp(t))))}function ud(e,t={}){return cp(t)||(t={...t,x:dr,y2:K,interval:1}),new cd(e,Pp(IF(Cp(t))))}function qF(e,t){t=wct(t);let{x:r,y:n,color:i,size:o}=t,s=fT(e,r),a=fT(e,n),c=fT(e,i),l=fT(e,o),{fx:u,fy:f,x:{value:d,reduce:h,zero:p,...m},y:{value:g,reduce:y,zero:b,...x},color:{value:_,color:w,reduce:v},size:{value:A,reduce:B},mark:D}=t;if(h===void 0&&(h=y==null&&d==null&&A==null&&g!=null?"count":null),y===void 0&&(y=h==null&&g==null&&A==null&&d!=null?"count":null),B===void 0&&A==null&&v==null&&h==null&&y==null&&(d==null||bn(s))&&(g==null||bn(a))&&(B="count"),p===void 0&&(p=dT(h)?!0:void 0),b===void 0&&(b=dT(y)?!0:void 0),d==null&&g==null)throw new Error("must specify x or y");if(h!=null&&g==null)throw new Error("reducing x requires y");if(y!=null&&d==null)throw new Error("reducing y requires x");D===void 0&&(D=A!=null||B!=null?"dot":dT(h)||dT(y)||v!=null?"bar":d!=null&&g!=null?bn(s)||bn(a)||h==null&&y==null&&!Cb(s)&&!Cb(a)?"dot":"line":d!=null||g!=null?"rule":null);let T,M,O;switch(D){case"dot":O=Lo,M="stroke";break;case"line":O=s&&a||h!=null||y!=null?b||y!=null||s&&Cb(s)?Yp:p||h!=null||a&&Cb(a)?qp:Rb:s?qp:Yp,M="stroke",l$(c)&&(T=null);break;case"area":O=!(b||y!=null)&&(p||h!=null||a&&Cb(a))?Vp:id,M="fill",l$(c)&&(T=null);break;case"rule":O=s?eo:ro,M="stroke";break;case"bar":O=b?Gp(h,s)?Zc:ud:p?Gp(y,a)?Hc:ld:Gp(h,s)&&Gp(y,a)?Db:Gp(h,s)?Zc:Gp(y,a)?Hc:h!=null?ld:y!=null?ud:kb,M="fill";break;default:throw new Error(`invalid mark: ${D}`)}let L={fx:u,fy:f,x:s??void 0,y:a??void 0,[M]:c??w,z:T,r:l??void 0,tip:!0},S,E={[M]:v??void 0,r:B??void 0};if(h!=null&&y!=null)throw new Error("cannot reduce both x and y");return y!=null?(E.y=y,S=bn(s)?mu:Ba):h!=null?(E.x=h,S=bn(a)?yu:Oa):(v!=null||B!=null)&&(s&&a?S=bn(s)&&bn(a)?lb:bn(s)?Oa:bn(a)?Ba:Xc:s?S=bn(s)?mu:Ba:a&&(S=bn(a)?yu:Oa)),(S===Xc||S===Ba)&&(L.x={value:s,...m}),(S===Xc||S===Oa)&&(L.y={value:a,...x}),p===void 0&&(p=s&&!(S===Xc||S===Ba)&&(O===Hc||O===Vp||O===ld||O===ro)),b===void 0&&(b=a&&!(S===Xc||S===Oa)&&(O===Zc||O===id||O===ud||O===eo)),{fx:u??null,fy:f??null,x:{value:d??null,reduce:h??null,zero:!!p,...m},y:{value:g??null,reduce:y??null,zero:!!b,...x},color:{value:_??null,reduce:v??null,...w!==void 0&&{color:w}},size:{value:A??null,reduce:B??null},mark:D,markImpl:u$[O],markOptions:L,transformImpl:u$[S],transformOptions:E,colorMode:M}}function f$(e,t){let r=qF(e,t),{fx:n,fy:i,x:{zero:o},y:{zero:s},markOptions:a,transformOptions:c,colorMode:l}=r,u=jF[r.markImpl],f=jF[r.transformImpl],d=n!=null||i!=null?Dp({strokeOpacity:.1}):null,h=[o?eo([0]):null,s?ro([0]):null],p=u(e,f?f(c,a):a);return l==="stroke"?ti(d,h,p):ti(d,p,h)}function Cb(e){let t,r;for(let n of e){if(n==null)continue;if(t===void 0){t=n;continue}let i=Math.sign(be(t,n));if(i){if(r!==void 0&&i!==r)return!1;t=n,r=i}}return!0}function wct({x:e,y:t,color:r,size:n,fx:i,fy:o,mark:s}={}){return Ki(e)||(e=Wp(e)),Ki(t)||(t=Wp(t)),Ki(r)||(r=hu(r)?{color:r}:Wp(r)),Ki(n)||(n=Wp(n)),Ki(i)&&({value:i}=Wp(i)),Ki(o)&&({value:o}=Wp(o)),s!=null&&(s=`${s}`.toLowerCase()),{x:e,y:t,color:r,size:n,fx:i,fy:o,mark:s}}function fT(e,t){let r=gt(e,t.value);return r&&(r.label=Qn(t.value)),r}function Wp(e){return Sct(e)?{reduce:e}:{value:e}}function dT(e){return/^(?:distinct|count|sum|proportion)$/i.test(e)}function vct(e){return/^(?:first|last|mode)$/i.test(e)}function Gp(e,t){return e!=null&&!vct(e)||!t?!1:bn(t)}function Sct(e){if(e==null)return!1;if(typeof e.reduceIndex=="function"||typeof e.reduce=="function"&&Fn(e)||/^p\d{2}$/i.test(e))return!0;switch(`${e}`.toLowerCase()){case"first":case"last":case"count":case"distinct":case"sum":case"proportion":case"proportion-facet":case"deviation":case"min":case"min-index":case"max":case"max-index":case"mean":case"median":case"variance":case"mode":return!0}return!1}function l$(e){return e?new xs(e).size>e.length>>1:!1}var jF={dot:Lo,line:Rb,lineX:qp,lineY:Yp,areaX:Vp,areaY:id,ruleX:eo,ruleY:ro,barX:Hc,barY:Zc,rect:kb,rectX:ld,rectY:ud,cell:Db,bin:Xc,binX:Ba,binY:Oa,group:lb,groupX:mu,groupY:yu},u$=Object.fromEntries(Object.entries(jF).map(([e,t])=>[t,e]));function Xp(e,t={}){let{x:r,x1:n,x2:i}=t;r===void 0&&n===void 0&&i===void 0&&(t={...t,x:r=K});let o={};return r!=null&&(o.x=e),n!=null&&(o.x1=e),i!=null&&(o.x2=e),fd(o,t)}function Hp(e,t={}){let{y:r,y1:n,y2:i}=t;r===void 0&&n===void 0&&i===void 0&&(t={...t,y:r=K});let o={};return r!=null&&(o.y=e),n!=null&&(o.y1=e),i!=null&&(o.y2=e),fd(o,t)}function fd(e={},t={}){let r=Nn(t),n=Object.entries(e).map(([i,o])=>{let s=lI(i,t);if(s==null)throw new Error(`missing channel: ${i}`);let[a,c]=Gr(s);return{key:i,input:s,output:a,setOutput:c,map:Ict(o)}});return{...Xr(t,(i,o)=>{let s=gt(i,r),a=n.map(({input:l})=>gt(i,l)),c=n.map(({setOutput:l})=>l(new Array(i.length)));for(let l of o)for(let u of s?Vr(l,f=>s[f]).values():[l])n.forEach(({map:f},d)=>f.mapIndex(u,a[d],c[d]));return{data:i,facets:o}}),...Object.fromEntries(n.map(({key:i,output:o})=>[i,o]))}}function Ict(e){if(e==null)throw new Error("missing map");if(typeof e.mapIndex=="function")return e;if(typeof e.map=="function"&&Fn(e))return Tct(e);if(typeof e=="function")return YF(up(e));switch(`${e}`.toLowerCase()){case"cumsum":return Mct;case"rank":return YF((t,r)=>Eg(t,n=>r[n]));case"quantile":return YF((t,r)=>Act(t,n=>r[n]))}throw new Error(`invalid map: ${e}`)}function Tct(e){return console.warn("deprecated map interface; implement mapIndex instead."),{mapIndex:e.map.bind(e)}}function Act(e,t){let r=ra(e,t)-1;return Eg(e,t).map(n=>n/r)}function YF(e){return{mapIndex(t,r,n){let i=e(t,r);if(i.length!==t.length)throw new Error("map function returned a mismatched length");for(let o=0,s=t.length;o<s;++o)n[t[o]]=i[o]}}}var Mct={mapIndex(e,t,r){let n=0;for(let i of e)r[i]=n+=t[i]}};var Ect={ariaLabel:"tick",fill:null,stroke:"currentColor"},hT=class extends bt{constructor(t,r,n){super(t,r,n,Ect),Ms(this,n)}render(t,r,n,i,o){return ct("svg:g",o).call(Pt,this,i,o).call(this._transform,this,r).call(s=>s.selectAll().data(t).enter().append("line").call(Dt,this).attr("x1",this._x1(r,n,i)).attr("x2",this._x2(r,n,i)).attr("y1",this._y1(r,n,i)).attr("y2",this._y2(r,n,i)).call(he,this,n).call(Gc,this,n,o)).node()}},Ub=class extends hT{constructor(t,r={}){let{x:n,y:i,inset:o=0,insetTop:s=o,insetBottom:a=o}=r;super(t,{x:{value:n,scale:"x"},y:{value:i,scale:"y",type:"band",optional:!0}},r),this.insetTop=Nt(s),this.insetBottom=Nt(a)}_transform(t,r,{x:n}){t.call(vt,r,{x:n},ir,0)}_x1(t,{x:r}){return n=>r[n]}_x2(t,{x:r}){return n=>r[n]}_y1({y:t},{y:r},{marginTop:n}){let{insetTop:i}=this;return r&&t?o=>r[o]+i:n+i}_y2({y:t},{y:r},{height:n,marginBottom:i}){let{insetBottom:o}=this;return r&&t?s=>r[s]+t.bandwidth()-o:n-i-o}},Pb=class extends hT{constructor(t,r={}){let{x:n,y:i,inset:o=0,insetRight:s=o,insetLeft:a=o}=r;super(t,{y:{value:i,scale:"y"},x:{value:n,scale:"x",type:"band",optional:!0}},r),this.insetRight=Nt(s),this.insetLeft=Nt(a)}_transform(t,r,{y:n}){t.call(vt,r,{y:n},0,ir)}_x1({x:t},{x:r},{marginLeft:n}){let{insetLeft:i}=this;return r&&t?o=>r[o]+i:n+i}_x2({x:t},{x:r},{width:n,marginRight:i}){let{insetRight:o}=this;return r&&t?s=>r[s]+t.bandwidth()-o:n-i-o}_y1(t,{y:r}){return n=>r[n]}_y2(t,{y:r}){return n=>r[n]}};function pT(e,{x:t=K,...r}={}){return new Ub(e,{...r,x:t})}function mT(e,{y:t=K,...r}={}){return new Pb(e,{...r,y:t})}function d$(e,{x:t=K,y:r=null,fill:n="#ccc",fillOpacity:i,stroke:o="currentColor",strokeOpacity:s,strokeWidth:a=2,sort:c,...l}={}){let u=r!=null?yu:cb;return ti(ro(e,u({x1:WF,x2:GF},{x:t,y:r,stroke:o,strokeOpacity:s,...l})),Hc(e,u({x1:"p25",x2:"p75"},{x:t,y:r,fill:n,fillOpacity:i,...l})),pT(e,u({x:"p50"},{x:t,y:r,stroke:o,strokeOpacity:s,strokeWidth:a,sort:c,...l})),Lo(e,fd({x:p$},{x:t,y:r,z:r,stroke:o,strokeOpacity:s,...l})))}function h$(e,{y:t=K,x:r=null,fill:n="#ccc",fillOpacity:i,stroke:o="currentColor",strokeOpacity:s,strokeWidth:a=2,sort:c,...l}={}){let u=r!=null?mu:cb;return ti(eo(e,u({y1:WF,y2:GF},{x:r,y:t,stroke:o,strokeOpacity:s,...l})),Zc(e,u({y1:"p25",y2:"p75"},{x:r,y:t,fill:n,fillOpacity:i,...l})),mT(e,u({y:"p50"},{x:r,y:t,stroke:o,strokeOpacity:s,strokeWidth:a,sort:c,...l})),Lo(e,fd({y:p$},{x:r,y:t,z:r,stroke:o,strokeOpacity:s,...l})))}function p$(e){let t=WF(e),r=GF(e);return e.map(n=>n<t||n>r?n:NaN)}function WF(e){let t=m$(e)*2.5-y$(e)*1.5;return Te(e,r=>r>=t?r:NaN)}function GF(e){let t=y$(e)*2.5-m$(e)*1.5;return ue(e,r=>r<=t?r:NaN)}function m$(e){return zn(e,.25)}function y$(e){return zn(e,.75)}var Bct={ariaLabel:"raster",stroke:null,pixelSize:1};function Zp(e,t){let r=+e;if(isNaN(r))throw new Error(`invalid ${t}: ${e}`);return r}function g$(e,t){let r=Math.floor(e);if(isNaN(r))throw new Error(`invalid ${t}: ${e}`);return r}var $b=class extends bt{constructor(t,r,n={},i){let{width:o,height:s,x:a,y:c,x1:l=a==null?0:void 0,y1:u=c==null?0:void 0,x2:f=a==null?o:void 0,y2:d=c==null?s:void 0,pixelSize:h=i.pixelSize,blur:p=0,interpolate:m}=n;if(o!=null&&(o=g$(o,"width")),s!=null&&(s=g$(s,"height")),l!=null&&(l=Zp(l,"x1")),u!=null&&(u=Zp(u,"y1")),f!=null&&(f=Zp(f,"x2")),d!=null&&(d=Zp(d,"y2")),a==null&&(l==null||f==null))throw new Error("missing x");if(c==null&&(u==null||d==null))throw new Error("missing y");t!=null&&o!=null&&s!=null&&(a===void 0&&l!=null&&f!=null&&(a=Lct(l,f,o,s)),c===void 0&&u!=null&&d!=null&&(c=Rct(u,d,o,s))),super(t,{x:{value:a,scale:"x",optional:!0},y:{value:c,scale:"y",optional:!0},x1:{value:l==null?null:[l],scale:"x",optional:!0,filter:null},y1:{value:u==null?null:[u],scale:"y",optional:!0,filter:null},x2:{value:f==null?null:[f],scale:"x",optional:!0,filter:null},y2:{value:d==null?null:[d],scale:"y",optional:!0,filter:null},...r},n,i),this.width=o,this.height=s,this.pixelSize=Zp(h,"pixelSize"),this.blur=Zp(p,"blur"),this.interpolate=a==null||c==null?null:Oct(m)}},zb=class extends $b{constructor(t,r={}){let{imageRendering:n}=r;if(t==null){let{fill:i,fillOpacity:o}=r;Se(o)[0]!==void 0&&(r=yT("fillOpacity",r)),wr(i)[0]!==void 0&&(r=yT("fill",r))}super(t,void 0,r,Bct),this.imageRendering=Ae(n,"auto")}scale(t,{color:r,...n},i){return super.scale(t,n,i)}render(t,r,n,i,o){let s=r[n.channels.fill?.scale]??(E=>E),{x:a,y:c}=n,{document:l}=o,[u,f,d,h]=x$(n,i,o),p=d-u,m=h-f,{pixelSize:g,width:y=Math.round(Math.abs(p)/g),height:b=Math.round(Math.abs(m)/g)}=this,x=y*b,{fill:_,fillOpacity:w}=n,v=0;if(this.interpolate){let E=y/p,I=b/m,F=fe(a,U=>(U-u)*E,Float64Array),C=fe(c,U=>(U-f)*I,Float64Array);_&&(_=this.interpolate(t,y,b,F,C,_)),w&&(w=this.interpolate(t,y,b,F,C,w))}else this.data==null&&t&&(v=t.fi*x);let A=l.createElement("canvas");A.width=y,A.height=b;let B=A.getContext("2d"),D=B.createImageData(y,b),T=D.data,{r:M,g:O,b:L}=jr(this.fill)??{r:0,g:0,b:0},S=(this.fillOpacity??1)*255;for(let E=0;E<x;++E){let I=E<<2;if(_){let F=s(_[E+v]);if(F==null){T[I+3]=0;continue}({r:M,g:O,b:L}=jr(F))}w&&(S=w[E+v]*255),T[I+0]=M,T[I+1]=O,T[I+2]=L,T[I+3]=S}return this.blur>0&&DE(D,this.blur),B.putImageData(D,0,0),ct("svg:g",o).call(Pt,this,i,o).call(vt,this,r).call(E=>E.append("image").attr("transform",`translate(${u},${f}) scale(${Math.sign(d-u)},${Math.sign(h-f)})`).attr("width",Math.abs(p)).attr("height",Math.abs(m)).attr("preserveAspectRatio","none").call(lt,"image-rendering",this.imageRendering).call(Dt,this).attr("xlink:href",A.toDataURL())).node()}};function XF(e,t,r){arguments.length<3&&(r=t,t=null);let{x:n,y:i,[e]:o,...s}=r;return n===void 0&&i===void 0&&d5(t)&&(n=Pc,i=du,o===void 0&&(o=c5)),[t,{...s,x:n,y:i,[e]:o}]}function b$(){let[e,t]=XF("fill",...arguments);return new zb(e,e==null||t.fill!==void 0||t.fillOpacity!==void 0?t:{...t,fill:K})}function x$({x1:e,y1:t,x2:r,y2:n},i,{projection:o}){let{width:s,height:a,marginTop:c,marginRight:l,marginBottom:u,marginLeft:f}=i;return[e&&o==null?e[0]:f,t&&o==null?t[0]:c,r&&o==null?r[0]:s-l,n&&o==null?n[0]:a-u]}function HF({x1:e,y1:t,x2:r,y2:n},i,o,s){let a={};return e&&(a.x1=e),t&&(a.y1=t),r&&(a.x2=r),n&&(a.y2=n),x$(xp(a,i),o,s)}function yT(e,t={}){let{[e]:r}=t;if(typeof r!="function")throw new Error(`invalid ${e}: not a function`);return Qe({...t,[e]:void 0},function(n,i,o,s,a,c){let{x:l,y:u}=s;if(!l)throw new Error("missing scale: x");if(!u)throw new Error("missing scale: y");let[f,d,h,p]=HF(o,s,a,c),m=h-f,g=p-d,{pixelSize:y}=this,{width:b=Math.round(Math.abs(m)/y),height:x=Math.round(Math.abs(g)/y)}=t,_=new Array(b*x*(i?i.length:1)),w=m/b,v=g/x,A=0;for(let B of i??[void 0])for(let D=.5;D<x;++D)for(let T=.5;T<b;++T,++A)_[A]=r(l.invert(f+T*w),u.invert(d+D*v),B);return{data:_,facets:i,channels:{[e]:{value:_,scale:"auto"}}}})}function Oct(e){if(typeof e=="function")return e;if(e==null)return gT;switch(`${e}`.toLowerCase()){case"none":return gT;case"nearest":return KF;case"barycentric":return ZF();case"random-walk":return QF()}throw new Error(`invalid interpolate: ${e}`)}function gT(e,t,r,n,i,o){let s=new Array(t*r);for(let a of e)n[a]<0||n[a]>=t||i[a]<0||i[a]>=r||(s[Math.floor(i[a])*t+Math.floor(n[a])]=o[a]);return s}function ZF({random:e=kf(42)}={}){return(t,r,n,i,o,s)=>{let a=t.length,c=r>>2,l=(n>>2)-1,u=a+c*2+l*2,f=new Float64Array(u*2);for(let x=0;x<a;++x)f[x*2]=i[t[x]],f[x*2+1]=o[t[x]];let d=a,h=(x,_)=>(f[d*2]=x,f[d*2+1]=_,d++);for(let x=0;x<=c;++x)h(x/c*r,0),h(x/c*r,n);for(let x=0;x<l;++x)h(r,x/l*n),h(0,x/l*n);s=lp(s,t);let p=new Yi(f.subarray(0,a*2));for(let x=a,_;x<u;++x)s[x]=s[_=p.find(f[x*2],f[x*2+1],_)];let{points:m,triangles:g}=new Yi(f),y=new s.constructor(r*n),b=Dct(s,e);for(let x=0;x<g.length;x+=3){let _=g[x],w=g[x+1],v=g[x+2],A=m[2*_],B=m[2*w],D=m[2*v],T=m[2*_+1],M=m[2*w+1],O=m[2*v+1],L=Math.min(A,B,D),S=Math.max(A,B,D),E=Math.min(T,M,O),I=Math.max(T,M,O),F=(M-O)*(A-D)+(T-O)*(D-B);if(!F)continue;let C=s[_],U=s[w],$=s[v];for(let q=Math.floor(L);q<S;++q)for(let j=Math.floor(E);j<I;++j){if(q<0||q>=r||j<0||j>=n)continue;let rt=q+.5,ot=j+.5,Gt=((M-O)*(rt-D)+(ot-O)*(D-B))/F;if(Gt<0)continue;let at=((O-T)*(rt-D)+(ot-O)*(A-D))/F;if(at<0)continue;let Q=1-Gt-at;Q<0||(y[q+r*j]=b(C,Gt,U,at,$,Q,q,j))}}return y}}function KF(e,t,r,n,i,o){let s=new o.constructor(t*r),a=Yi.from(e,u=>n[u],u=>i[u]),c,l;for(let u=.5,f=0;u<r;++u){l=c;for(let d=.5;d<t;++d,++f)l=a.find(d,u,l),d===.5&&(c=l),s[f]=o[e[l]]}return s}function QF({random:e=kf(42),minDistance:t=.5,maxSteps:r=2}={}){return(n,i,o,s,a,c)=>{let l=new c.constructor(i*o),u=Yi.from(n,p=>s[p],p=>a[p]),f,d,h;for(let p=.5,m=0;p<o;++p){d=f;for(let g=.5;g<i;++g,++m){let y=g,b=p;h=d=u.find(y,b,d),g===.5&&(f=d);let x,_=0;for(;(x=Math.hypot(s[n[h]]-y,a[n[h]]-b))>t&&_<r;){let w=e(g,p,_)*2*Math.PI;y+=Math.cos(w)*x,b+=Math.sin(w)*x,h=u.find(y,b,h),++_}l[m]=c[n[h]]}}return l}}function Fct(e,t,r,n,i,o){return t*e+n*r+o*i}function Nct(e){return(t,r,n,i,o,s,a,c)=>{let l=e(a,c);return l<r?t:l<r+i?n:o}}function Dct(e,t){return dI(e)||fr(e)?Fct:Nct(t)}function Lct(e,t,r){return{transform(n){let i=n.length,o=new Float64Array(i),s=(t-e)/r,a=e+s/2;for(let c=0;c<i;++c)o[c]=c%r*s+a;return o}}}function Rct(e,t,r,n){return{transform(i){let o=i.length,s=new Float64Array(o),a=(t-e)/n,c=e+a/2;for(let l=0;l<o;++l)s[l]=Math.floor(l/r)%n*a+c;return s}}}var _$={ariaLabel:"contour",fill:"none",stroke:"currentColor",strokeMiterlimit:1,pixelSize:2},Vb=class extends $b{constructor(t,{smooth:r=!0,value:n,...i}={}){let o=OI({},i,_$);if(n===void 0){for(let a in o)if(o[a].value!=null){if(n!==void 0)throw new Error("ambiguous contour value");n=i[a],i[a]="value"}}if(n!=null){let a={transform:c=>c.map(l=>l.value),label:Qn(n)};for(let c in o)i[c]==="value"&&(i[c]=a)}if(t==null){if(n==null)throw new Error("missing contour value");i=yT("value",{value:n,...i}),n=null}else{let{interpolate:a}=i;n===void 0&&(n=K),a===void 0&&(i.interpolate="nearest")}super(t,{value:{value:n,optional:!0}},kct(i),_$);let s={geometry:{value:K}};for(let a in this.channels){let c=this.channels[a],{scale:l}=c;l==="x"||l==="y"||a==="value"||(s[a]=c,delete this.channels[a])}this.contourChannels=s,this.smooth=!!r}filter(t,{x:r,y:n,value:i,...o},s){return super.filter(t,o,s)}render(t,r,n,i,o){let{geometry:s}=n,a=mn();return ct("svg:g",o).call(Pt,this,i,o).call(vt,this,r).call(c=>{c.selectAll().data(t).enter().append("path").call(Dt,this).attr("d",l=>a(s[l])).call(he,this,n)}).node()}};function kct({thresholds:e,interval:t,...r}){return e=PF(e,t,Vl),Qe(r,function(n,i,o,s,a,c){let[l,u,f,d]=HF(o,s,a,c),h=f-l,p=d-u,{pixelSize:m,width:g=Math.round(Math.abs(h)/m),height:y=Math.round(Math.abs(p)/m)}=this,b=g/h,x=y/p,_=o.value.value,w=[];if(this.interpolate){let{x:T,y:M}=bu(o,s,c),O=fe(T,I=>(I-l)*b,Float64Array),L=fe(M,I=>(I-u)*x,Float64Array),S=[o.x,o.y,o.value],E=[O,L,_];for(let I of i){let F=this.filter(I,S,E);w.push(this.interpolate(F,g,y,O,L,_))}}else if(i){let T=g*y,M=i.length;for(let O=0;O<M;++O)w.push(_.slice(O*T,O*T+T))}else w.push(_);if(this.blur>0)for(let T of w)Sg({data:T,width:g,height:y},this.blur);let v=Cct(e,_,...Uct(w));if(v===null)throw new Error(`unsupported thresholds: ${e}`);let{contour:A}=Zl().size([g,y]).smooth(this.smooth),B=[],D=[];for(let T of w)D.push(xr(B.length,B.push(...fe(v,M=>A(T,M)))));for(let{coordinates:T}of B)for(let M of T)for(let O of M)for(let L of O)L[0]=L[0]/b+l,L[1]=L[1]/x+u;return{data:B,facets:D,channels:wI(this.contourChannels,B)}})}function Cct(e,t,r,n){if(typeof e?.range=="function")return e.range(e.floor(r),n);if(typeof e=="function"&&(e=e(t,r,n)),typeof e!="number")return vr(e);let i=dn(...gh(r,n,e),e);for(;i[i.length-1]>=n;)i.pop();for(;i[1]<r;)i.shift();return i}function v$(){return new Vb(...XF("value",...arguments))}function Uct(e){return[Te(e,t=>Te(t,w$)),ue(e,t=>ue(t,w$))]}function w$(e){return isFinite(e)?e:NaN}function T$(e,t){return JF(Mp,e,t)}function A$(e,t={}){return JF(Ep,e,t)}function M$(e,t={}){return JF(Bp,e,t)}function JF(e,t,r={}){let{x:n,y:i,maxRadius:o}=r,s=e({px:n,py:i,maxRadius:o}),a=[];n!=null&&a.push(eo(t,S$("x",{...s,inset:-6},r))),i!=null&&a.push(ro(t,S$("y",{...s,inset:-6},r))),n!=null&&a.push(Ea(t,I$("x",{...s,dy:9,frameAnchor:"bottom",lineAnchor:"top"},r))),i!=null&&a.push(Ea(t,I$("y",{...s,dx:-9,frameAnchor:"left",textAnchor:"end"},r)));for(let c of a)c.ariaLabel=`crosshair ${c.ariaLabel}`;return ti(...a)}function E$(e,{channels:t,...r},{facet:n,facetAnchor:i,fx:o,fy:s,[e]:a,channels:c,transform:l,initializer:u}){return{...r,facet:n,facetAnchor:i,fx:o,fy:s,[e]:a,channels:{...t,...c},transform:l,initializer:Pct(e,u)}}function Pct(e,t){return t==null?t:function(r,n,{x:i,y:o,px:s,py:a,...c},...l){let{channels:{x:u,y:f,...d}={},...h}=t.call(this,r,n,{...c,x:s,y:a},...l);return{channels:{...d,...u&&{px:u,...e==="x"&&{x:u}},...f&&{py:f,...e==="y"&&{y:f}}},...h}}}function S$(e,t,r){let{color:n="currentColor",opacity:i=.2,ruleStroke:o=n,ruleStrokeOpacity:s=i,ruleStrokeWidth:a}=r;return{...E$(e,t,r),stroke:o,strokeOpacity:s,strokeWidth:a}}function I$(e,t,r){let{color:n="currentColor",textFill:i=n,textFillOpacity:o,textStroke:s="white",textStrokeOpacity:a,textStrokeWidth:c=5}=r;return{...E$(e,t,$ct(e,r)),fill:i,fillOpacity:o,stroke:s,strokeOpacity:a,strokeWidth:c}}function $ct(e,t){return Qe(t,(r,n,i)=>({channels:{text:{value:vI(i,e)?.value}}}))}var zct={ariaLabel:"delaunay link",fill:"none",stroke:"currentColor",strokeMiterlimit:1},Vct={ariaLabel:"delaunay mesh",fill:null,stroke:"currentColor",strokeOpacity:.2},jct={ariaLabel:"hull",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeMiterlimit:1},qct={ariaLabel:"voronoi",fill:"none",stroke:"currentColor",strokeMiterlimit:1},Yct={ariaLabel:"voronoi mesh",fill:null,stroke:"currentColor",strokeOpacity:.2},tN=class extends bt{constructor(t,r={}){let{x:n,y:i,z:o,curve:s,tension:a}=r;super(t,{x:{value:n,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},z:{value:o,optional:!0}},r,zct),this.curve=Ab(s,a),Ms(this,r)}render(t,r,n,i,o){let{x:s,y:a}=r,{x:c,y:l,z:u}=n,{curve:f}=this,[d,h]=Zr(this,i),p=c?b=>c[b]:Cr(d),m=l?b=>l[b]:Cr(h),g=this;function y(b){let x=-1,_=[],w={};for(let S in n)w[S]=[];let v=[],A=[],B=[],D=[];function T(S,E){S=b[S],E=b[E],_.push(++x),v[x]=p(S),B[x]=m(S),A[x]=p(E),D[x]=m(E);for(let I in n)w[I].push(n[I][E])}let{halfedges:M,hull:O,triangles:L}=Yi.from(b,p,m);for(let S=0;S<M.length;++S){let E=M[S];E>S&&T(L[S],L[E])}for(let S=0;S<O.length;++S)T(O[S],O[(S+1)%O.length]);ne(this).selectAll().data(_).enter().append("path").call(Dt,g).attr("d",S=>{let E=Yn(),I=f(E);return I.lineStart(),I.point(v[S],B[S]),I.point(A[S],D[S]),I.lineEnd(),E}).call(he,g,w).call(Gc,g,w,o)}return ct("svg:g",o).call(Pt,this,i,o).call(vt,this,{x:c&&s,y:l&&a}).call(u?b=>b.selectAll().data(Vr(t,x=>u[x]).values()).enter().append("g").each(y):b=>b.datum(t).each(y)).node()}},jb=class extends bt{constructor(t,r={},n,i=({z:o})=>o){let{x:o,y:s}=r;super(t,{x:{value:o,scale:"x",optional:!0},y:{value:s,scale:"y",optional:!0},z:{value:i(r),optional:!0}},r,n)}render(t,r,n,i,o){let{x:s,y:a}=r,{x:c,y:l,z:u}=n,[f,d]=Zr(this,i),h=c?y=>c[y]:Cr(f),p=l?y=>l[y]:Cr(d),m=this;function g(y){let b=Yi.from(y,h,p);ne(this).append("path").datum(y[0]).call(Dt,m).attr("d",m._render(b,i)).call(he,m,n)}return ct("svg:g",o).call(Pt,this,i,o).call(vt,this,{x:c&&s,y:l&&a}).call(u?y=>y.selectAll().data(Vr(t,b=>u[b]).values()).enter().append("g").each(g):y=>y.datum(t).each(g)).node()}},eN=class extends jb{constructor(t,r={}){super(t,r,Vct),this.fill="none"}_render(t){return t.render()}},rN=class extends jb{constructor(t,r={}){super(t,r,jct,Nn)}_render(t){return t.renderHull()}},nN=class extends bt{constructor(t,r={}){let{x:n,y:i,z:o}=r;super(t,{x:{value:n,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},z:{value:o,optional:!0}},r,qct)}render(t,r,n,i,o){let{x:s,y:a}=r,{x:c,y:l,z:u}=n,[f,d]=Zr(this,i),h=c?y=>c[y]:Cr(f),p=l?y=>l[y]:Cr(d),m=this;function g(y){let b=Yi.from(y,h,p),x=B$(b,i);ne(this).selectAll().data(y).enter().append("path").call(Dt,m).attr("d",(_,w)=>x.renderCell(w)).call(he,m,n)}return ct("svg:g",o).call(Pt,this,i,o).call(vt,this,{x:c&&s,y:l&&a}).call(u?y=>y.selectAll().data(Vr(t,b=>u[b]).values()).enter().append("g").each(g):y=>y.datum(t).each(g)).node()}},iN=class extends jb{constructor(t,r){super(t,r,Yct),this.fill="none"}_render(t,r){return B$(t,r).render()}};function B$(e,t){let{width:r,height:n,marginTop:i,marginRight:o,marginBottom:s,marginLeft:a}=t;return e.voronoi([a,i,r-o,n-s])}function qb(e,t,{x:r,y:n,...i}={}){return[r,n]=hr(r,n),new e(t,{...i,x:r,y:n})}function O$(e,t){return qb(tN,e,t)}function F$(e,t){return qb(eN,e,t)}function N$(e,t){return qb(rN,e,t)}function D$(e,t){return qb(nN,e,t)}function L$(e,t){return qb(iN,e,t)}var Wct={ariaLabel:"density",fill:"none",stroke:"currentColor",strokeMiterlimit:1},Yb=class extends bt{constructor(t,{x:r,y:n,z:i,weight:o,fill:s,stroke:a,...c}={}){let l=R$(s)&&(s="currentColor",!0),u=R$(a)&&(a="currentColor",!0);super(t,{x:{value:r,scale:"x",optional:!0},y:{value:n,scale:"y",optional:!0},z:{value:Nn({z:i,fill:s,stroke:a}),optional:!0},weight:{value:o,optional:!0}},Xct({...c,fill:s,stroke:a},l,u),Wct),l&&(this.fill=void 0),u&&(this.stroke=void 0),this.z=i}filter(t){return t}render(t,r,n,i,o){let{contours:s}=n,a=mn();return ct("svg:g",o).call(Pt,this,i,o).call(vt,this,{}).call(c=>c.selectAll().data(t).enter().append("path").call(Dt,this).call(he,this,n).attr("d",l=>a(s[l]))).node()}};function k$(e,{x:t,y:r,...n}={}){return[t,r]=hr(t,r),new Yb(e,{...n,x:t,y:r})}var Gct=new Set(["x","y","z","weight"]);function Xct(e,t,r){let{bandwidth:i,thresholds:o}=e;return i=i===void 0?20:+i,o=o===void 0?20:typeof o?.[Symbol.iterator]=="function"?Fr(o):+o,Qe(e,function(s,a,c,l,u,f){let d=c.weight?Fr(c.weight.value):null,h=c.z?.value,{z:p}=this,[m,g]=Zr(this,u),{width:y,height:b}=u,{x,y:_}=bu(c,l,f),w=Object.fromEntries(Object.entries(c).filter(([L])=>!Gct.has(L)).map(([L,S])=>[L,{...S,value:[]}])),v=t&&[],A=r&&[],B=wB().x(x?L=>x[L]:m).y(_?L=>_[L]:g).weight(d?L=>d[L]:1).size([y,b]).bandwidth(i),D=[];for(let L of a){let S=[];D.push(S);for(let E of h?gb(L,h,p):[L]){let I=B.contours(E);S.push([E,I])}}let T=o;if(!(T instanceof Wf)){let L=0;for(let S of D)for(let[,E]of S){let I=E.max;I>L&&(L=I)}T=Float64Array.from({length:o-1},(S,E)=>L*100*(E+1)/o)}let M=[],O=[];for(let L of D){let S=[];M.push(S);for(let[E,I]of L)for(let F of T){S.push(O.length),O.push(I(F/100)),v&&v.push(F),A&&A.push(F);for(let C in w)w[C].value.push(c[C].value[E[0]])}}return v&&v.push(0),A&&A.push(0),{data:s,facets:M,channels:{...w,...v&&{fill:{value:v,scale:"color"}},...A&&{stroke:{value:A,scale:"color"}},contours:{value:O}}}})}function R$(e){return/^density$/i.test(e)}var Hct={ariaLabel:"geo",fill:"none",stroke:"currentColor",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1},Wb=class extends bt{constructor(t,r={}){let[n,i]=Se(r.r,3);super(t,{geometry:{value:r.geometry,scale:"projection"},r:{value:n,scale:"r",filter:Zn,optional:!0}},Lb(r),Hct),this.r=i}render(t,r,n,i,o){let{geometry:s,r:a}=n,c=mn(o.projection??Zct(r)),{r:l}=this;return uu(l)?t=[]:l!==void 0&&c.pointRadius(l),ct("svg:g",o).call(Pt,this,i,o).call(vt,this,r).call(u=>{u.selectAll().data(t).enter().append("path").call(Dt,this).attr("d",a?f=>c.pointRadius(a[f])(s[f]):f=>c(s[f])).call(he,this,n)}).node()}};function Zct({x:e,y:t}){if(e||t)return e??=r=>r,t??=r=>r,Rf({point(r,n){this.stream.point(e(r),t(n))}})}function bT(e,{geometry:t=K,...r}={}){switch(e?.type){case"FeatureCollection":e=e.features;break;case"GeometryCollection":e=e.geometries;break;case"Feature":case"LineString":case"MultiLineString":case"MultiPoint":case"MultiPolygon":case"Point":case"Polygon":case"Sphere":e=[e];break}return new Wb(e,{geometry:t,...r})}function C$({strokeWidth:e=1.5,...t}={}){return bT({type:"Sphere"},{strokeWidth:e,...t})}function U$({strokeOpacity:e=.1,...t}={}){return bT(jB(),{strokeOpacity:e,...t})}var Kp=.5,Qp=0;function P$(e={fill:"count"},{binWidth:t,...r}={}){let{z:n}=r;return t=t===void 0?20:Nt(t),e=ub(e,r),Ta(e,"fill")&&(r.channels={...r.channels,fill:{value:[]}}),r.symbol===void 0&&(r.symbol="hexagon"),r.r===void 0&&!Ta(e,"r")&&(r.r=t/2),Qe(r,(i,o,s,a,c,l)=>{let{x:u,y:f,z:d,fill:h,stroke:p,symbol:m}=s;if(u===void 0)throw new Error("missing channel: x");if(f===void 0)throw new Error("missing channel: y");({x:u,y:f}=bu(s,a,l)),d=d?d.value:gt(i,n),h=h?.value,p=p?.value,m=m?.value;let g=fb(e,{z:d,fill:h,stroke:p,symbol:m}),y=d&&[],b=h&&[],x=p&&[],_=m&&[],w=[],v=[],A=[],B=-1;for(let O of e)O.initialize(i);for(let O of o){let L=[];for(let S of e)S.scope("facet",O);for(let[S,E]of pu(O,g))for(let I of Kct(E,u,f,t)){L.push(++B),v.push(I.x),A.push(I.y),d&&y.push(g===d?S:d[I[0]]),h&&b.push(g===h?S:h[I[0]]),p&&x.push(g===p?S:p[I[0]]),m&&_.push(g===m?S:m[I[0]]);for(let F of e)F.reduce(I)}w.push(L)}let D=s.x.scale,T=s.y.scale,M={x:{value:v,source:a[D]?{value:fe(v,a[D].invert),scale:D}:null},y:{value:A,source:a[T]?{value:fe(A,a[T].invert),scale:T}:null},...d&&{z:{value:y}},...h&&{fill:{value:b,scale:"auto"}},...p&&{stroke:{value:x,scale:"auto"}},...m&&{symbol:{value:_,scale:"auto"}},...Object.fromEntries(e.map(({name:O,output:L})=>[O,{scale:"auto",label:L.label,radius:O==="r"?t/2:void 0,value:L.transform()}]))};return{data:i,facets:w,channels:M}})}function Kct(e,t,r,n){let i=n*(1.5/VO),o=new Map;for(let s of e){let a=t[s],c=r[s];if(isNaN(a)||isNaN(c))continue;let l=Math.round(c=(c-Qp)/i),u=Math.round(a=(a-Kp)/n-(l&1)/2),f=c-l;if(Math.abs(f)*3>1){let p=a-u,m=u+(a<u?-1:1)/2,g=l+(c<l?-1:1),y=a-m,b=c-g;p*p+f*f>y*y+b*b&&(u=m+(l&1?1:-1)/2,l=g)}let d=`${u},${l}`,h=o.get(d);h===void 0&&(o.set(d,h=[]),h.x=(u+(l&1)/2)*n+Kp,h.y=l*i+Qp),h.push(s)}return o.values()}var Qct={ariaLabel:"hexgrid",fill:"none",stroke:"currentColor",strokeOpacity:.1};function $$(e){return new Gb(e)}var Gb=class extends bt{constructor({binWidth:t=20,clip:r=!0,...n}={}){super(fu,void 0,{clip:r,...n},Qct),this.binWidth=Nt(t)}render(t,r,n,i,o){let{binWidth:s}=this,{marginTop:a,marginRight:c,marginBottom:l,marginLeft:u,width:f,height:d}=i,h=u-Kp,p=f-c-Kp,m=a-Qp,g=d-l-Qp,y=s/2,b=y*jO,x=b/2,_=y*2,w=b*1.5,v=Math.floor(h/_),A=Math.ceil(p/_),B=Math.floor((m+x)/w),D=Math.ceil((g-x)/w)+1,T=`m0,${Su(-b)}l${Su(y)},${Su(x)}v${Su(b)}l${Su(-y)},${Su(x)}`,M=T;for(let O=B;O<D;++O)for(let L=v;L<A;++L)M+=`M${Su(L*_+(O&1)*y)},${Su(O*w)}${T}`;return ct("svg:g",o).datum(0).call(Pt,this,i,o).call(vt,this,{},ir+Kp,ir+Qp).call(O=>O.append("path").call(Dt,this).call(he,this,n).attr("d",M)).node()}};function Su(e){return Math.round(e*1e3)/1e3}var Jct={ariaLabel:"image",fill:null,stroke:null};function tlt(e){return/^\.*\//.test(e)}function elt(e){return/^(blob|data|file|http|https):/i.test(e)}function rlt(e){return typeof e=="string"&&(tlt(e)||elt(e))?[void 0,e]:[e,void 0]}var Xb=class extends bt{constructor(t,r={}){let{x:n,y:i,r:o,width:s,height:a,rotate:c,src:l,preserveAspectRatio:u,crossOrigin:f,frameAnchor:d,imageRendering:h}=r;o==null&&(o=void 0),o===void 0&&s===void 0&&a===void 0?s=a=16:s===void 0&&a!==void 0?s=a:a===void 0&&s!==void 0&&(a=s);let[p,m]=rlt(l),[g,y]=Se(o),[b,x]=Se(s,y!==void 0?y*2:void 0),[_,w]=Se(a,y!==void 0?y*2:void 0),[v,A]=Se(c,0);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},r:{value:g,scale:"r",filter:Zn,optional:!0},width:{value:b,filter:Zn,optional:!0},height:{value:_,filter:Zn,optional:!0},rotate:{value:v,optional:!0},src:{value:p,optional:!0}},Lb(r),Jct),this.src=m,this.width=x,this.rotate=A,this.height=w,this.r=y,this.preserveAspectRatio=Ae(u,"xMidYMid"),this.crossOrigin=nr(f),this.frameAnchor=Ia(d),this.imageRendering=Ae(h,"auto")}render(t,r,n,i,o){let{x:s,y:a}=r,{x:c,y:l,width:u,height:f,r:d,rotate:h,src:p}=n,{r:m,width:g,height:y,rotate:b}=this,[x,_]=Zr(this,i);return ct("svg:g",o).call(Pt,this,i,o).call(vt,this,{x:c&&s,y:l&&a}).call(w=>w.selectAll().data(t).enter().append("image").call(Dt,this).attr("x",z$(c,u,d,x,g,m)).attr("y",z$(l,f,d,_,y,m)).attr("width",u?v=>u[v]:g!==void 0?g:d?v=>d[v]*2:m*2).attr("height",f?v=>f[v]:y!==void 0?y:d?v=>d[v]*2:m*2).attr("transform",h?v=>`rotate(${h[v]})`:b?`rotate(${b})`:null).attr("transform-origin",h||b?_u`${c?v=>c[v]:x}px ${l?v=>l[v]:_}px`:null).call(lt,"href",p?v=>p[v]:this.src).call(lt,"preserveAspectRatio",this.preserveAspectRatio).call(lt,"crossorigin",this.crossOrigin).call(lt,"image-rendering",this.imageRendering).call(lt,"clip-path",d?v=>`circle(${d[v]}px)`:m!==void 0?`circle(${m}px)`:null).call(he,this,n)).node()}};function z$(e,t,r,n,i,o){return t&&e?s=>e[s]-t[s]/2:t?s=>n-t[s]/2:e&&i!==void 0?s=>e[s]-i/2:i!==void 0?n-i/2:r&&e?s=>e[s]-r[s]:r?s=>n-r[s]:e?s=>e[s]-o:n-o}function V$(e,{x:t,y:r,...n}={}){return n.frameAnchor===void 0&&([t,r]=hr(t,r)),new Xb(e,{...n,x:t,y:r})}function nlt(e,t,r){var n=1e-8,i=t-1,o=r-1,s=0,a,c,l,u,f,d,h,p,m,g,y;if(e<=0)return 0;if(e>=1)return 1;for(t>=1&&r>=1?(l=e<.5?e:1-e,u=Math.sqrt(-2*Math.log(l)),h=(2.30753+u*.27061)/(1+u*(.99229+u*.04481))-u,e<.5&&(h=-h),p=(h*h-3)/6,m=2/(1/(2*t-1)+1/(2*r-1)),g=h*Math.sqrt(p+m)/m-(1/(2*r-1)-1/(2*t-1))*(p+5/6-2/(3*m)),h=t/(t+r*Math.exp(2*g))):(a=Math.log(t/(t+r)),c=Math.log(r/(t+r)),u=Math.exp(t*a)/t,f=Math.exp(r*c)/r,g=u+f,e<u/g?h=Math.pow(t*g*e,1/t):h=1-Math.pow(r*g*(1-e),1/r)),y=-Jp(t)-Jp(r)+Jp(t+r);s<10;s++){if(h===0||h===1)return h;if(d=ilt(h,t,r)-e,u=Math.exp(i*Math.log(h)+o*Math.log(1-h)+y),f=d/u,h-=u=f/(1-.5*Math.min(1,f*(i/h-o/(1-h)))),h<=0&&(h=.5*(h+u)),h>=1&&(h=.5*(h+u+1)),Math.abs(u)<n*h&&s>0)break}return h}function ilt(e,t,r){var n=e===0||e===1?0:Math.exp(Jp(t+r)-Jp(t)-Jp(r)+t*Math.log(e)+r*Math.log(1-e));return e<0||e>1?!1:e<(t+1)/(t+r+2)?n*j$(e,t,r)/t:1-n*j$(1-e,r,t)/r}function j$(e,t,r){var n=1e-30,i=1,o=t+r,s=t+1,a=t-1,c=1,l=1-o*e/s,u,f,d,h;for(Math.abs(l)<n&&(l=n),l=1/l,h=l;i<=100&&(u=2*i,f=i*(r-i)*e/((a+u)*(t+u)),l=1+f*l,Math.abs(l)<n&&(l=n),c=1+f/c,Math.abs(c)<n&&(c=n),l=1/l,h*=l*c,f=-(t+i)*(o+i)*e/((t+u)*(s+u)),l=1+f*l,Math.abs(l)<n&&(l=n),c=1+f/c,Math.abs(c)<n&&(c=n),l=1/l,d=l*c,h*=d,!(Math.abs(d-1)<3e-7));i++);return h}function Jp(e){var t=0,r=[76.18009172947146,-86.5053203294167,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],n=1.000000000190015,i,o,s;for(s=(o=i=e)+5.5,s-=(i+.5)*Math.log(s);t<6;t++)n+=r[t]/++o;return Math.log(2.506628274631*n/i)-s}function q$(e,t){var r=nlt(2*Math.min(e,1-e),.5*t,.5);return r=Math.sqrt(t*(1-r)/r),e>.5?r:-r}var olt={ariaLabel:"linear-regression",fill:"currentColor",fillOpacity:.1,stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1},xT=class extends bt{constructor(t,r={}){let{x:n,y:i,z:o,ci:s=.95,precision:a=4}=r;if(super(t,{x:{value:n,scale:"x"},y:{value:i,scale:"y"},z:{value:Nn(r),optional:!0}},r,olt),this.z=o,this.ci=+s,this.precision=+a,!(0<=this.ci&&this.ci<1))throw new Error(`invalid ci; not in [0, 1): ${s}`);if(!(this.precision>0))throw new Error(`invalid precision: ${a}`)}render(t,r,n,i,o){let{x:s,y:a,z:c}=n,{ci:l}=this;return ct("svg:g",o).call(Pt,this,i,o).call(vt,this,r).call(u=>u.selectAll().data(c?gb(t,c,this.z):[t]).enter().call(f=>f.append("path").attr("fill","none").call(Dt,this).call(Zf,this,{...n,fill:null,fillOpacity:null}).attr("d",d=>this._renderLine(d,s,a)).call(l&&!zc(this.fill)?d=>d.select(slt).attr("stroke","none").call(Dt,this).call(Zf,this,{...n,stroke:null,strokeOpacity:null,strokeWidth:null}).attr("d",h=>this._renderBand(h,s,a)):()=>{}))).node()}};function slt(){return this.parentNode.insertBefore(this.ownerDocument.createElementNS(Ao.svg,"path"),this)}var oN=class extends xT{constructor(t,r){super(t,r)}_renderBand(t,r,n){let{ci:i,precision:o}=this,[s,a]=ze(t,u=>n[u]),c=_T(t,n,r),l=G$(t,n,r,(1-i)/2,c);return ep().y(u=>u).x0(u=>l(u,-1)).x1(u=>l(u,1))(xr(s,a-o/2,o).concat(a))}_renderLine(t,r,n){let[i,o]=ze(t,a=>n[a]),s=_T(t,n,r);return`M${s(i)},${i}L${s(o)},${o}`}},sN=class extends xT{constructor(t,r){super(t,r)}_renderBand(t,r,n){let{ci:i,precision:o}=this,[s,a]=ze(t,u=>r[u]),c=_T(t,r,n),l=G$(t,r,n,(1-i)/2,c);return ep().x(u=>u).y0(u=>l(u,-1)).y1(u=>l(u,1))(xr(s,a-o/2,o).concat(a))}_renderLine(t,r,n){let[i,o]=ze(t,a=>r[a]),s=_T(t,r,n);return`M${i},${s(i)}L${o},${s(o)}`}};function Y$(e,{y:t=dr,x:r=K,stroke:n,fill:i=Ke(n)?"currentColor":n,...o}={}){return new oN(e,Rp({...o,x:r,y:t,fill:i,stroke:n}))}function W$(e,{x:t=dr,y:r=K,stroke:n,fill:i=Ke(n)?"currentColor":n,...o}={}){return new sN(e,Lp({...o,x:t,y:r,fill:i,stroke:n}))}function _T(e,t,r){let n=0,i=0,o=0,s=0;for(let u of e){let f=t[u],d=r[u];n+=f,i+=d,o+=f*d,s+=f*f}let a=e.length,c=(a*o-n*i)/(a*s-n*n),l=(i-c*n)/a;return u=>c*u+l}function G$(e,t,r,n,i){let o=hn(e,u=>t[u])/e.length,s=0,a=0;for(let u of e)s+=(t[u]-o)**2,a+=(r[u]-i(t[u]))**2;let c=Math.sqrt(a/(e.length-2)),l=q$(n,e.length-2);return(u,f)=>{let d=i(u),h=c*Math.sqrt(1/e.length+(u-o)**2/s);return d+f*l*h}}function Hb({path:e=K,delimiter:t,frameAnchor:r,treeLayout:n=I2,treeSort:i,treeSeparation:o,treeAnchor:s,...a}={}){s=IT(s),i=H$(i),r===void 0&&(r=s.frameAnchor);let c=Z$(t),l=r9(a,Q$),[u,f]=Gr(),[d,h]=Gr();return{x:u,y:d,frameAnchor:r,...Xr(a,(p,m)=>{let g=c(gt(p,e)),y=f([]),b=h([]),x=-1,_=[],w=[],v=v2().path(B=>g[B]),A=n();A.nodeSize&&A.nodeSize([1,1]),A.separation&&o!==void 0&&A.separation(o??ib);for(let B of l)B[vT]=B[t9]([]);for(let B of m){let D=[],T=v(B.filter(M=>g[M]!=null)).each(M=>M.data=p[M.data]);i!=null&&T.sort(i),A(T);for(let M of T.descendants()){D.push(++x),_[x]=M.data,s.position(M,x,y,b);for(let O of l)O[vT][x]=O[e9](M)}w.push(D)}return{data:_,facets:w}}),...Object.fromEntries(l)}}function ST({path:e=K,delimiter:t,curve:r="bump-x",stroke:n="#555",strokeWidth:i=1.5,strokeOpacity:o=.5,treeLayout:s=I2,treeSort:a,treeSeparation:c,treeAnchor:l,...u}={}){l=IT(l),a=H$(a),u={curve:r,stroke:n,strokeWidth:i,strokeOpacity:o,...u};let f=Z$(t),d=r9(u,hlt),[h,p]=Gr(),[m,g]=Gr(),[y,b]=Gr(),[x,_]=Gr();return{x1:h,x2:m,y1:y,y2:x,...Xr(u,(w,v)=>{let A=f(gt(w,e)),B=p([]),D=g([]),T=b([]),M=_([]),O=-1,L=[],S=[],E=v2().path(F=>A[F]),I=s();I.nodeSize&&I.nodeSize([1,1]),I.separation&&c!==void 0&&I.separation(c??ib);for(let F of d)F[vT]=F[t9]([]);for(let F of v){let C=[],U=E(F.filter($=>A[$]!=null)).each($=>$.data=w[$.data]);a!=null&&U.sort(a),I(U);for(let{source:$,target:q}of U.links()){C.push(++O),L[O]=q.data,l.position($,O,B,T),l.position(q,O,D,M);for(let j of d)j[vT][O]=j[e9](q,$)}S.push(C)}return{data:L,facets:S}}),...Object.fromEntries(d)}}function IT(e="left"){switch(`${e}`.trim().toLowerCase()){case"left":return alt;case"right":return clt}throw new Error(`invalid tree anchor: ${e}`)}var alt={frameAnchor:"left",dx:6,position({x:e,y:t},r,n,i){n[r]=t,i[r]=-e}},clt={frameAnchor:"right",dx:-6,position({x:e,y:t},r,n,i){n[r]=-t,i[r]=-e}};function H$(e){return e==null||typeof e=="function"?e:`${e}`.trim().toLowerCase().startsWith("node:")?X$(Q$(e)):X$(llt(e))}function X$(e){return(t,r)=>Wr(e(t),e(r))}function llt(e){return t=>t.data?.[e]}function Z$(e="/"){return`${e}`=="/"?t=>t:t=>t.map(ult(e,"/"))}function ult(e,t){return e=new RegExp(flt(e),"g"),r=>r==null?null:`${r}`.replace(e,t)}function flt(e){return`${e}`.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}function K$(e){return Fn(e)&&typeof e.node=="function"}function dlt(e){return Fn(e)&&typeof e.link=="function"}function Q$(e){if(K$(e))return e.node;if(e=`${e}`.trim().toLowerCase(),!!e.startsWith("node:")){switch(e){case"node:name":return cN;case"node:path":return aN;case"node:internal":return J$;case"node:depth":return lN;case"node:height":return uN}throw new Error(`invalid node value: ${e}`)}}function hlt(e){if(K$(e))return e.node;if(dlt(e))return e.link;if(e=`${e}`.trim().toLowerCase(),!(!e.startsWith("node:")&&!e.startsWith("parent:"))){switch(e){case"parent:name":return wT(cN);case"parent:path":return wT(aN);case"parent:depth":return wT(lN);case"parent:height":return wT(uN);case"node:name":return cN;case"node:path":return aN;case"node:internal":return J$;case"node:depth":return lN;case"node:height":return uN}throw new Error(`invalid link value: ${e}`)}}function aN(e){return e.id}function cN(e){return plt(e.id)}function lN(e){return e.depth}function uN(e){return e.height}function J$(e){return!!e.children}function wT(e){return(t,r)=>r==null?void 0:e(r)}function plt(e){let t=e.length;for(;--t>0&&!mlt(e,t););return e.slice(t+1)}function mlt(e,t){if(e[t]==="/"){let r=0;for(;t>0&&e[--t]==="\\";)++r;if(!(r&1))return!0}return!1}var t9=2,e9=3,vT=4;function r9(e,t){let r=[];for(let n in e){let i=e[n],o=t(i);o!==void 0&&r.push([n,...Gr(i),o])}return r}function fN(e,{fill:t,stroke:r,strokeWidth:n,strokeOpacity:i,strokeLinejoin:o,strokeLinecap:s,strokeMiterlimit:a,strokeDasharray:c,strokeDashoffset:l,marker:u,markerStart:f=u,markerEnd:d=u,dot:h=Ke(f)&&Ke(d),text:p="node:name",textStroke:m="white",title:g="node:path",dx:y,dy:b,...x}={}){return y===void 0&&(y=IT(x.treeAnchor).dx),ti(uT(e,ST({markerStart:f,markerEnd:d,stroke:r!==void 0?r:t===void 0?"node:internal":t,strokeWidth:n,strokeOpacity:i,strokeLinejoin:o,strokeLinecap:s,strokeMiterlimit:a,strokeDasharray:c,strokeDashoffset:l,...x})),h?Lo(e,Hb({fill:t===void 0?"node:internal":t,title:g,...x})):null,p!=null?Ea(e,Hb({text:p,fill:t===void 0?"currentColor":t,stroke:m,dx:y,dy:b,title:g,...x})):null)}function n9(e,t){return fN(e,{...t,treeLayout:M3})}function i9({geometry:e=K,...t}={}){return Qe({...t,x:null,y:null},(r,n,i,o,s,{projection:a})=>{let c=gt(r,e),l=c.length,u=new Float64Array(l),f=new Float64Array(l),d=mn(a);for(let h=0;h<l;++h)[u[h],f[h]]=d.centroid(c[h]);return{data:r,facets:n,channels:{x:{value:u,source:null},y:{value:f,source:null}}}})}function o9({geometry:e=K,...t}={}){let r;return{...t,x:{transform:n=>Float64Array.from(r=gt(gt(n,e),CB),([i])=>i)},y:{transform:()=>Float64Array.from(r,([,n])=>n)}}}var y9=EW(m9(),1);var Slt=({marginLeft:e})=>[1,e],Ilt=({width:e,marginRight:t})=>[-1,e-t],Tlt=({width:e,marginLeft:t,marginRight:r})=>[0,(t+e-r)/2],Alt=({marginTop:e})=>[1,e],Mlt=({height:e,marginBottom:t})=>[-1,e-t],Elt=({height:e,marginTop:t,marginBottom:r})=>[0,(t+e-r)/2];function g9(e){return typeof e=="string"?{anchor:e}:e}function b9(e={},t={}){arguments.length===1&&([e,t]=_9(e));let{anchor:r="left",padding:n=1,r:i=t.r}=g9(e);switch(`${r}`.toLowerCase()){case"left":r=Slt;break;case"right":r=Ilt;break;case"middle":r=Tlt;break;default:throw new Error(`unknown dodge anchor: ${r}`)}return w9("x","y",r,Nt(n),i,t)}function x9(e={},t={}){arguments.length===1&&([e,t]=_9(e));let{anchor:r="bottom",padding:n=1,r:i=t.r}=g9(e);switch(`${r}`.toLowerCase()){case"top":r=Alt;break;case"bottom":r=Mlt;break;case"middle":r=Elt;break;default:throw new Error(`unknown dodge anchor: ${r}`)}return w9("y","x",r,Nt(n),i,t)}function _9(e){let{anchor:t,padding:r,...n}=e,{r:i}=n;return[{anchor:t,padding:r,r:i},n]}function w9(e,t,r,n,i,o){if(i!=null&&typeof i!="number"){let{channels:s,sort:a,reverse:c}=o;s=sb(s),s?.r===void 0&&(o={...o,channels:{...s,r:{value:i,scale:"r"}}}),a===void 0&&c===void 0&&(o.sort={channel:"-r"})}return Qe(o,function(s,a,c,l,u,f){let{[t]:d,r:h}=c;if(!c[t])throw new Error(`missing channel: ${t}`);({[t]:d}=bu(c,l,f));let p=h?void 0:i!==void 0?Nt(i):this.r!==void 0?this.r:3;h&&(h=gt(h.value,l[h.scale]||K,Float64Array));let[m,g]=r(u),y=m?Olt:Blt,b=new Float64Array(d.length),x=h?_=>h[_]:()=>p;for(let _ of a){let w=(0,y9.default)();_=_.filter(h?A=>sp(d[A])&&Zn(h[A]):A=>sp(d[A]));let v=new Float64Array(2*_.length+2);for(let A of _){let B=x(A),D=m?B+n:0,T=d[A]-B,M=d[A]+B,O=2;w.queryInterval(T-n,M+n,([,,S])=>{let E=b[S]-D,I=d[A]-d[S],F=n+(h?h[A]+h[S]:2*p),C=Math.sqrt(F*F-I*I);v[O++]=E-C,v[O++]=E+C});let L=v.slice(0,O);m&&(L=L.filter(S=>S>=0));t:for(let S of L.sort(y)){for(let E=0;E<O;E+=2)if(v[E]+1e-6<S&&S<v[E+1]-1e-6)continue t;b[A]=S+D;break}w.insert([T,M,A])}}m||(m=1);for(let _ of a)for(let w of _)b[w]=b[w]*m+g;return{data:s,facets:a,channels:{[e]:{value:b,source:null},[t]:{value:d,source:c[t]},...h&&{r:{value:h,source:c.r}}}}})}function Blt(e,t){return Math.abs(e)-Math.abs(t)}function Olt(e,t){return e-t}function S9(e,t){return arguments.length===1&&({basis:e,...t}=e),Xp(MT(e),t)}function I9(e,t){return arguments.length===1&&({basis:e,...t}=e),Hp(MT(e),t)}function MT(e){if(e===void 0)return v9;if(typeof e=="function")return ET(up(e));if(/^p\d{2}$/i.test(e))return nm(ap(e));switch(`${e}`.toLowerCase()){case"deviation":return Dlt;case"first":return v9;case"last":return Nlt;case"max":return Llt;case"mean":return Rlt;case"median":return klt;case"min":return Clt;case"sum":return Ult;case"extent":return Flt}throw new Error(`invalid basis: ${e}`)}function ET(e){return{mapIndex(t,r,n){let i=+e(t,r);for(let o of t)n[o]=r[o]===null?NaN:r[o]/i}}}function nm(e){return ET((t,r)=>e(t,n=>r[n]))}var Flt={mapIndex(e,t,r){let[n,i]=ze(e,s=>t[s]),o=i-n;for(let s of e)r[s]=t[s]===null?NaN:(t[s]-n)/o}},v9=ET((e,t)=>{for(let r=0;r<e.length;++r){let n=t[e[r]];if(_r(n))return n}}),Nlt=ET((e,t)=>{for(let r=e.length-1;r>=0;--r){let n=t[e[r]];if(_r(n))return n}}),Dlt={mapIndex(e,t,r){let n=xf(e,o=>t[o]),i=na(e,o=>t[o]);for(let o of e)r[o]=t[o]===null?NaN:i?(t[o]-n)/i:0}},Llt=nm(ue),Rlt=nm(xf),klt=nm(ws),Clt=nm(Te),Ult=nm(hn);function T9(e={},t){return arguments.length===1&&(t=e),Xp(FT(e),t)}function A9(e={},t){return arguments.length===1&&(t=e),Hp(FT(e),t)}function FT(e={}){typeof e=="number"&&(e={k:e});let{k:t,reduce:r,shift:n,anchor:i,strict:o}=e;if(i===void 0&&n!==void 0&&(i=$lt(n),xn(`Warning: the shift option is deprecated; please use anchor "${i}" instead.`)),!((t=Math.floor(t))>0))throw new Error(`invalid k: ${t}`);return zlt(r)(t,Plt(i,t),o)}function Plt(e="middle",t){switch(`${e}`.toLowerCase()){case"middle":return t-1>>1;case"start":return 0;case"end":return t-1}throw new Error(`invalid anchor: ${e}`)}function $lt(e){switch(`${e}`.toLowerCase()){case"centered":return"middle";case"leading":return"start";case"trailing":return"end"}throw new Error(`invalid shift: ${e}`)}function zlt(e="mean"){if(typeof e=="string"){if(/^p\d{2}$/i.test(e))return BT(ap(e));switch(e.toLowerCase()){case"deviation":return BT(na);case"max":return OT((t,r)=>ue(t,n=>r[n]));case"mean":return Vlt;case"median":return BT(ws);case"min":return OT((t,r)=>Te(t,n=>r[n]));case"mode":return OT((t,r)=>xh(t,n=>r[n]));case"sum":return M9;case"variance":return BT(zl);case"difference":return Ylt;case"ratio":return Wlt;case"first":return Glt;case"last":return Xlt}}if(typeof e!="function")throw new Error(`invalid reduce: ${e}`);return OT(up(e))}function im(e,t,r){return e.subarray?e.subarray(t,r):e.slice(t,r)}function BT(e){return(t,r,n)=>n?{mapIndex(i,o,s){let a=l=>o[l]==null?NaN:+o[l],c=0;for(let l=0;l<t-1;++l)isNaN(a(l))&&++c;for(let l=0,u=i.length-t+1;l<u;++l)isNaN(a(l+t-1))&&++c,s[i[l+a]]=c===0?e(im(i,l,l+t),a):NaN,isNaN(a(l))&&--c}}:{mapIndex(i,o,s){let a=c=>o[c]==null?NaN:+o[c];for(let c=-a;c<0;++c)s[i[c+a]]=e(im(i,0,c+t),a);for(let c=0,l=i.length-a;c<l;++c)s[i[c+a]]=e(im(i,c,c+t),a)}}}function OT(e){return(t,r,n)=>n?{mapIndex(i,o,s){let a=0;for(let c=0;c<t-1;++c)a+=_r(o[i[c]]);for(let c=0,l=i.length-t+1;c<l;++c)a+=_r(o[i[c+t-1]]),a===t&&(s[i[c+r]]=e(im(i,c,c+t),o)),a-=_r(o[i[c]])}}:{mapIndex(i,o,s){for(let a=-r;a<0;++a)s[i[a+r]]=e(im(i,0,a+t),o);for(let a=0,c=i.length-r;a<c;++a)s[i[a+r]]=e(im(i,a,a+t),o)}}}function M9(e,t,r){return r?{mapIndex(n,i,o){let s=0,a=0;for(let c=0;c<e-1;++c){let l=i[n[c]];l===null||isNaN(l)?++s:a+=+l}for(let c=0,l=n.length-e+1;c<l;++c){let u=i[n[c]],f=i[n[c+e-1]];f===null||isNaN(f)?++s:a+=+f,o[n[c+t]]=s===0?a:NaN,u===null||isNaN(u)?--s:a-=+u}}}:{mapIndex(n,i,o){let s=0,a=n.length;for(let c=0,l=Math.min(a,e-t-1);c<l;++c)s+=+i[n[c]]||0;for(let c=-t,l=a-t;c<l;++c)s+=+i[n[c+e-1]]||0,o[n[c+t]]=s,s-=+i[n[c]]||0}}}function Vlt(e,t,r){if(r){let n=M9(e,t,r);return{mapIndex(i,o,s){n.mapIndex(i,o,s);for(let a=0,c=i.length-e+1;a<c;++a)s[i[a+t]]/=e}}}else return{mapIndex(n,i,o){let s=0,a=0,c=n.length;for(let l=0,u=Math.min(c,e-t-1);l<u;++l){let f=i[n[l]];f!==null&&!isNaN(f=+f)&&(s+=f,++a)}for(let l=-t,u=c-t;l<u;++l){let f=i[n[l+e-1]],d=i[n[l]];f!==null&&!isNaN(f=+f)&&(s+=f,++a),o[n[l+t]]=s/a,d!==null&&!isNaN(d=+d)&&(s-=d,--a)}}}}function jlt(e,t,r,n){for(let i=r+n;r<i;++r){let o=e[t[r]];if(_r(o))return o}}function qlt(e,t,r,n){for(let i=r+n-1;i>=r;--i){let o=e[t[i]];if(_r(o))return o}}function E9(e,t,r,n){for(let i=r+n;r<i;++r){let o=e[t[r]];if(o!==null&&!isNaN(o=+o))return o}}function B9(e,t,r,n){for(let i=r+n-1;i>=r;--i){let o=e[t[i]];if(o!==null&&!isNaN(o=+o))return o}}function Ylt(e,t,r){return r?{mapIndex(n,i,o){for(let s=0,a=n.length-e;s<a;++s){let c=i[n[s]],l=i[n[s+e-1]];o[n[s+t]]=c===null||l===null?NaN:l-c}}}:{mapIndex(n,i,o){for(let s=-t,a=n.length-e+t+1;s<a;++s)o[n[s+t]]=B9(i,n,s,e)-E9(i,n,s,e)}}}function Wlt(e,t,r){return r?{mapIndex(n,i,o){for(let s=0,a=n.length-e;s<a;++s){let c=i[n[s]],l=i[n[s+e-1]];o[n[s+t]]=c===null||l===null?NaN:l/c}}}:{mapIndex(n,i,o){for(let s=-t,a=n.length-e+t+1;s<a;++s)o[n[s+t]]=B9(i,n,s,e)/E9(i,n,s,e)}}}function Glt(e,t,r){return r?{mapIndex(n,i,o){for(let s=0,a=n.length-e;s<a;++s)o[n[s+t]]=i[n[s]]}}:{mapIndex(n,i,o){for(let s=-t,a=n.length-e+t+1;s<a;++s)o[n[s+t]]=jlt(i,n,s,e)}}}function Xlt(e,t,r){return r?{mapIndex(n,i,o){for(let s=0,a=n.length-e;s<a;++s)o[n[s+t]]=i[n[s+e-1]]}}:{mapIndex(n,i,o){for(let s=-t,a=n.length-e+t+1;s<a;++s)o[n[s+t]]=qlt(i,n,s,e)}}}function O9(e,t={}){if(typeof e=="string")switch(e.toLowerCase()){case"first":return gN(t);case"last":return bN(t)}if(typeof e=="function")return Iu(null,e,t);let r,n;for(r in e){if(n!==void 0)throw new Error("ambiguous selector; multiple inputs");n=Hlt(e[r])}if(n===void 0)throw new Error(`invalid selector: ${e}`);return Iu(r,n,t)}function Hlt(e){if(typeof e=="function")return e;switch(`${e}`.toLowerCase()){case"min":return xN;case"max":return _N}throw new Error(`unknown selector: ${e}`)}function gN(e){return Iu(null,Zlt,e)}function bN(e){return Iu(null,Klt,e)}function F9(e){return Iu("x",xN,e)}function N9(e){return Iu("y",xN,e)}function D9(e){return Iu("x",_N,e)}function L9(e){return Iu("y",_N,e)}function*Zlt(e){yield e[0]}function*Klt(e){yield e[e.length-1]}function*xN(e,t){yield ov(e,r=>t[r])}function*_N(e,t){yield bf(e,r=>t[r])}function Iu(e,t,r){if(e!=null){if(r[e]==null)throw new Error(`missing channel: ${e}`);e=r[e]}let n=Nn(r);return Xr(r,(i,o)=>{let s=gt(i,n),a=gt(i,e),c=[];for(let l of o){let u=[];for(let f of s?Vr(l,d=>s[d]).values():[l])for(let d of t(f,a))u.push(d);c.push(u)}return{data:i,facets:c}})}var R9=new Map([["style","style"],["width","width"],["height","height"],["margin","margin"],["marginLeft","marginLeft"],["marginRight","marginRight"],["marginTop","marginTop"],["marginBottom","marginBottom"],["align","align"],["aspectRatio","aspectRatio"],["axis","axis"],["inset","inset"],["grid","grid"],["label","label"],["padding","padding"],["round","round"],["xScale","x.type"],["xDomain","x.domain"],["xRange","x.range"],["xNice","x.nice"],["xInset","x.inset"],["xInsetLeft","x.insetLeft"],["xInsetRight","x.insetRight"],["xClamp","x.clamp"],["xRound","x.round"],["xAlign","x.align"],["xPadding","x.padding"],["xPaddingInner","x.paddingInner"],["xPaddingOuter","x.paddingOuter"],["xAxis","x.axis"],["xTicks","x.ticks"],["xTickSize","x.tickSize"],["xTickSpacing","x.tickSpacing"],["xTickPadding","x.tickPadding"],["xTickFormat","x.tickFormat"],["xTickRotate","x.tickRotate"],["xGrid","x.grid"],["xLine","x.line"],["xLabel","x.label"],["xLabelAnchor","x.labelAnchor"],["xLabelOffset","x.labelOffset"],["xFontVariant","x.fontVariant"],["xAriaLabel","x.ariaLabel"],["xAriaDescription","x.ariaDescription"],["xReverse","x.reverse"],["xZero","x.zero"],["yScale","y.type"],["yDomain","y.domain"],["yRange","y.range"],["yNice","y.nice"],["yInset","y.inset"],["yInsetTop","y.insetTop"],["yInsetBottom","y.insetBottom"],["yClamp","y.clamp"],["yRound","y.round"],["yAlign","y.align"],["yPadding","y.padding"],["yPaddingInner","y.paddingInner"],["yPaddingOuter","y.paddingOuter"],["yAxis","y.axis"],["yTicks","y.ticks"],["yTickSize","y.tickSize"],["yTickSpacing","y.tickSpacing"],["yTickPadding","y.tickPadding"],["yTickFormat","y.tickFormat"],["yTickRotate","y.tickRotate"],["yGrid","y.grid"],["yLine","y.line"],["yLabel","y.label"],["yLabelAnchor","y.labelAnchor"],["yLabelOffset","y.labelOffset"],["yFontVariant","y.fontVariant"],["yAriaLabel","y.ariaLabel"],["yAriaDescription","y.ariaDescription"],["yReverse","y.reverse"],["yZero","y.zero"],["facetMargin","facet.margin"],["facetMarginTop","facet.marginTop"],["facetMarginBottom","facet.marginBottom"],["facetMarginLeft","facet.marginLeft"],["facetMarginRight","facet.marginRight"],["facetGrid","facet.grid"],["facetLabel","facet.label"],["fxDomain","fx.domain"],["fxRange","fx.range"],["fxNice","fx.nice"],["fxInset","fx.inset"],["fxInsetLeft","fx.insetLeft"],["fxInsetRight","fx.insetRight"],["fxRound","fx.round"],["fxAlign","fx.align"],["fxPadding","fx.padding"],["fxPaddingInner","fx.paddingInner"],["fxPaddingOuter","fx.paddingOuter"],["fxAxis","fx.axis"],["fxTicks","fx.ticks"],["fxTickSize","fx.tickSize"],["fxTickSpacing","fx.tickSpacing"],["fxTickPadding","fx.tickPadding"],["fxTickFormat","fx.tickFormat"],["fxTickRotate","fx.tickRotate"],["fxGrid","fx.grid"],["fxLine","fx.line"],["fxLabel","fx.label"],["fxLabelAnchor","fx.labelAnchor"],["fxLabelOffset","fx.labelOffset"],["fxFontVariant","fx.fontVariant"],["fxAriaLabel","fx.ariaLabel"],["fxAriaDescription","fx.ariaDescription"],["fxReverse","fx.reverse"],["fyDomain","fy.domain"],["fyRange","fy.range"],["fyNice","fy.mice"],["fyInset","fy,inset"],["fyInsetTop","fy.insetTop"],["fyInsetBottom","fy.insetBottom"],["fyRound","fy.round"],["fyAlign","fy.align"],["fyPadding","fy.padding"],["fyPaddingInner","fy.paddingInner"],["fyPaddingOuter","fy.paddingOuter"],["fyAxis","fy.axis"],["fyTicks","fy.ticks"],["fyTickSize","fy.tickSize"],["fyTickSpacing","fy.tickSpacing"],["fyTickPadding","fy.tickPadding"],["fyTickFormat","fy.tickFormat"],["fyTickRotate","fy.tickRotate"],["fyGrid","fy.grid"],["fyLine","fy.line"],["fyLabel","fy.label"],["fyLabelAnchor","fy.labelAnchor"],["fyLabelOffset","fy.labelOffset"],["fyFontVariant","fy.fontVariant"],["fyAriaLabel","fy.ariaLabel"],["fyAriaDescription","fy.ariaDescription"],["fyReverse","fy.reverse"],["colorScale","color.type"],["colorDomain","color.domain"],["colorRange","color.range"],["colorClamp","color.clamp"],["colorNice","color.nice"],["colorScheme","color.scheme"],["colorInterpolate","color.interpolate"],["colorPivot","color.pivot"],["colorSymmetric","color.symmetric"],["colorLabel","color.label"],["colorReverse","color.reverse"],["colorZero","color.zero"],["colorTickFormat","color.tickFormat"],["opacityScale","opacity.type"],["opacityDomain","opacity.domain"],["opacityRange","opacity.range"],["opacityClamp","opacity.clamp"],["opacityNice","opacity.nice"],["opacityLabel","opacity.label"],["opacityReverse","opacity.reverse"],["opacityZero","opacity.zero"],["opacityTickFormat","opacity.tickFormat"],["rScale","r.type"],["rDomain","r.domain"],["rRange","r.range"],["rClamp","r.clamp"],["rNice","r.nice"],["rZero","r.zero"],["lengthScale","length.type"],["lengthDomain","length.domain"],["lengthRange","length.range"],["lengthClamp","length.clamp"],["lengthNice","length.nice"],["lengthZero","length.zero"],["projectionType","projection.type"],["projectionParallels","projection.parallels"],["projectionPrecision","projection.precision"],["projectionRotate","projection.rotate"],["projectionDomain","projection.domain"],["projectionInset","projection.inset"],["projectionInsetLeft","projection.insetLeft"],["projectionInsetRight","projection.insetRight"],["projectionInsetTop","projection.insetTop"],["projectionInsetBottom","projection.insetBottom"],["projectionClip","projection.clip"]]);var Qlt=new Set(["frame","hexgrid","sphere","graticule"]);function Jlt(e,t,r){for(let n=0;n<t.length;++n){let i=t[n];n===t.length-1?e[i]=r:e=e[i]||(e[i]={})}}async function C9(e){let t={marks:[]},r=[],{attributes:n,marks:i}=e;for(let a in n){let c=R9.get(a);if(c==null)throw new Error(`Unrecognized plot attribute: ${a}`);let l=n[a];typeof l=="symbol"?r.push(a):l!==void 0&&Jlt(t,c.split("."),l)}let o=[];for(let a of i)for(let{type:c,data:l,options:u}of a.plotSpecs())Qlt.has(c)?t.marks.push(NT[c](u)):t.marks.push(NT[c](l,u)),o.push(a.index);eut(t,e);let s=Tb(t);rut(s,o),tut(e,s,n,r);for(let a of e.interactors)await a.init(s);return s}function tut(e,t,r,n){n.forEach(i=>{let o=r[i];if(o===mf){if(!i.endsWith("Domain"))throw new Error(`Unsupported fixed attribute: ${i}`);let s=i.slice(0,-6),a=t.scale(s);a?.domain&&e.setAttribute(i,r[`${s}Reverse`]?a.domain.slice().reverse():a.domain)}else throw new Error(`Unrecognized symbol: ${o}`)})}function eut(e,t){let{marks:r}=t;DT("x",e,r,["x","x1","x2"]),DT("y",e,r,["y","y1","y2"]),DT("fx",e,r),DT("fy",e,r)}function DT(e,t,r,n=[e]){let i=t[e]||{};if(i.axis===null||i.label!==void 0)return;let o=r.map(u=>u.channelField(n)?.field);if(o.every(u=>u==null))return;let s,a,c;for(let u=0;u<o.length;++u){let{column:f,label:d}=o[u]||{};f===void 0&&d===void 0||(s===void 0&&a===void 0?(s=f,a=d,c=nut(r[u].data,n)||"number"):a!==d?a=void 0:s!==f&&(s=void 0))}let l=a||s;if(l!==void 0){if((c==="number"||c==="date")&&(e==="x"||e==="y")){i.percent&&(l=`${l} (%)`);let u=(e==="x"?1:-1)*(i.reverse?-1:1);e==="x"||i.labelAnchor==="center"?l=e==="x"==u<0?`\u2190 ${l}`:`${l} \u2192`:l=`${u<0?"\u2191 ":"\u2193 "}${l}`}t[e]={...i,label:l}}}function rut(e,t){let r=e.querySelectorAll('g[aria-label="facet"]');if(r.length)for(let n of r)k9(n,t);else k9(e,t)}function k9(e,t){let r=-1;for(let n of e.children){let i=n.getAttribute("aria-label")||"";n.nodeName==="style"||i.includes("-axis")||i.includes("-grid")||n.setAttribute("data-index",t[++r])}}function nut(e,t){for(let r of e)for(let n=0;n<t.length;++n){let i=r[t[n]];if(i!=null)return i instanceof Date?"date":typeof i}}var iut={width:640,marginLeft:40,marginRight:20,marginTop:20,marginBottom:30},Qb=class{constructor(t){this.attributes={...iut},this.listeners=null,this.interactors=[],this.legends=[],this.marks=[],this.markset=null,this.element=t||document.createElement("div"),this.element.setAttribute("class","plot"),this.element.style.display="flex",this.element.value=this,this.params=new Map,this.synch=EE()}margins(){return{left:this.getAttribute("marginLeft"),top:this.getAttribute("marginTop"),bottom:this.getAttribute("marginBottom"),right:this.getAttribute("marginRight")}}innerWidth(){let{left:t,right:r}=this.margins();return this.getAttribute("width")-t-r}innerHeight(){let{top:t,bottom:r}=this.margins();return this.getAttribute("height")-t-r}pending(t){this.synch.pending(t)}update(t){return this.synch.ready(t)&&!this.pendingRender&&(this.pendingRender=!0,requestAnimationFrame(()=>this.render())),this.synch.promise}async render(){this.pendingRender=!1;let t=await C9(this),r=this.legends.flatMap(({legend:n,include:i})=>{let o=n.init(t);return i?o:[]});this.element.replaceChildren(t,...r),this.synch.resolve()}getAttribute(t){return this.attributes[t]}setAttribute(t,r,n){return Iy(this.attributes[t],r)?(r===void 0?delete this.attributes[t]:this.attributes[t]=r,n?.silent||this.listeners?.get(t)?.forEach(i=>i(t,r)),!0):!1}addAttributeListener(t,r){let n=this.listeners||(this.listeners=new Map);return n.has(t)||n.set(t,new Set),n.get(t).add(r),this}removeAttributeListener(t,r){return this.listeners?.get(t)?.delete(r)}addParams(t,r){let{params:n}=this;for(let i of r)n.has(i)?n.get(i).push(t):(n.set(i,[t]),i.addEventListener("value",()=>Promise.allSettled(n.get(i).map(o=>o.requestQuery()))))}addMark(t){return t.setPlot(this,this.marks.length),this.marks.push(t),this.markset=null,this}get markSet(){return this.markset||(this.markset=new Set(this.marks))}addInteractor(t){return this.interactors.push(t),this}addLegend(t,r=!0){t.setPlot(this),this.legends.push({legend:t,include:r})}};function vN(...e){let t=new Qb;return e.flat().forEach(r=>r(t)),t.marks.forEach(r=>nn().connect(r)),t.element}var wN=class extends Map{request(t,r){if(this.has(t))r(this.get(t));else{let n=this.waiting||(this.waiting=new Map),i=n.get(t)||[];n.set(t,i.concat(r))}}set(t,r){this.has(t)&&console.warn(`Overwriting named plot "${t}".`);let{waiting:n}=this;return n?.has(t)&&(n.get(t).forEach(i=>i(r)),n.delete(t)),super.set(t,r)}},om=new wN;function out(){om.clear(),nn().clear()}function U9(e){return t=>om.set(e,t)}function P9(e,t,r){yi(r)?(r.addEventListener("value",n=>{e.setAttribute(t,n),e.update()}),r.value!==void 0&&e.setAttribute(t,r.value)):e.setAttribute(t,r)}function SN(e,t){return r=>{P9(r,e,t)}}function LT(e){return t=>{for(let[r,n]of Object.entries(e))P9(t,r,n)}}function $9(e){let{top:t,bottom:r,left:n,right:i}=e,o={};return t!==void 0&&(o.marginTop=t),r!==void 0&&(o.marginBottom=r),n!==void 0&&(o.marginLeft=n),i!==void 0&&(o.marginRight=i),LT(o)}function z9(e){return LT({xDomain:e,yDomain:e})}var R=e=>t=>SN(e,t),V9=R("style"),j9=R("width"),q9=R("height"),Y9=R("margin"),W9=R("marginLeft"),G9=R("marginRight"),X9=R("marginTop"),H9=R("marginBottom"),Z9=R("align"),K9=R("aspectRatio"),Q9=R("axis"),J9=R("inset"),tz=R("grid"),ez=R("label"),rz=R("padding"),nz=R("round"),iz=R("xScale"),oz=R("xDomain"),sz=R("xRange"),az=R("xNice"),cz=R("xInset"),lz=R("xInsetLeft"),uz=R("xInsetRight"),fz=R("xClamp"),dz=R("xRound"),hz=R("xAlign"),pz=R("xPadding"),mz=R("xPaddingInner"),yz=R("xPaddingOuter"),gz=R("xAxis"),bz=R("xTicks"),xz=R("xTickSize"),_z=R("xTickSpacing"),wz=R("xTickPadding"),vz=R("xTickFormat"),Sz=R("xTickRotate"),Iz=R("xGrid"),Tz=R("xLine"),Az=R("xLabel"),Mz=R("xLabelAnchor"),Ez=R("xLabelOffset"),Bz=R("xFontVariant"),Oz=R("xAriaLabel"),Fz=R("xAriaDescription"),Nz=R("xReverse"),Dz=R("xZero"),Lz=R("yScale"),Rz=R("yDomain"),kz=R("yRange"),Cz=R("yNice"),Uz=R("yInset"),Pz=R("yInsetTop"),$z=R("yInsetBottom"),zz=R("yClamp"),Vz=R("yRound"),jz=R("yAlign"),qz=R("yPadding"),Yz=R("yPaddingInner"),Wz=R("yPaddingOuter"),Gz=R("yAxis"),Xz=R("yTicks"),Hz=R("yTickSize"),Zz=R("yTickSpacing"),Kz=R("yTickPadding"),Qz=R("yTickFormat"),Jz=R("yTickRotate"),tV=R("yGrid"),eV=R("yLine"),rV=R("yLabel"),nV=R("yLabelAnchor"),iV=R("yLabelOffset"),oV=R("yFontVariant"),sV=R("yAriaLabel"),aV=R("yAriaDescription"),cV=R("yReverse"),lV=R("yZero"),uV=R("facetMargin"),fV=R("facetMarginTop"),dV=R("facetMarginBottom"),hV=R("facetMarginLeft"),pV=R("facetMarginRight"),mV=R("facetGrid"),yV=R("facetLabel"),gV=R("fxDomain"),bV=R("fxRange"),xV=R("fxNice"),_V=R("fxInset"),wV=R("fxInsetLeft"),vV=R("fxInsetRight"),SV=R("fxRound"),IV=R("fxAlign"),TV=R("fxPadding"),AV=R("fxPaddingInner"),MV=R("fxPaddingOuter"),EV=R("fxAxis"),BV=R("fxTicks"),OV=R("fxTickSize"),FV=R("fxTickSpacing"),NV=R("fxTickPadding"),DV=R("fxTickFormat"),LV=R("fxTickRotate"),RV=R("fxGrid"),kV=R("fxLine"),CV=R("fxLabel"),UV=R("fxLabelAnchor"),PV=R("fxLabelOffset"),$V=R("fxFontVariant"),zV=R("fxAriaLabel"),VV=R("fxAriaDescription"),jV=R("fxReverse"),qV=R("fyDomain"),YV=R("fyRange"),WV=R("fyNice"),GV=R("fyInset"),XV=R("fyInsetTop"),HV=R("fyInsetBottom"),ZV=R("fyRound"),KV=R("fyAlign"),QV=R("fyPadding"),JV=R("fyPaddingInner"),tj=R("fyPaddingOuter"),ej=R("fyAxis"),rj=R("fyTicks"),nj=R("fyTickSize"),ij=R("fyTickSpacing"),oj=R("fyTickPadding"),sj=R("fyTickFormat"),aj=R("fyTickRotate"),cj=R("fyGrid"),lj=R("fyLine"),uj=R("fyLabel"),fj=R("fyLabelAnchor"),dj=R("fyLabelOffset"),hj=R("fyFontVariant"),pj=R("fyAriaLabel"),mj=R("fyAriaDescription"),yj=R("fyReverse"),gj=R("colorScale"),bj=R("colorDomain"),xj=R("colorRange"),_j=R("colorClamp"),wj=R("colorNice"),vj=R("colorScheme"),Sj=R("colorInterpolate"),Ij=R("colorPivot"),Tj=R("colorSymmetric"),Aj=R("colorLabel"),Mj=R("colorReverse"),Ej=R("colorZero"),Bj=R("colorTickFormat"),Oj=R("opacityScale"),Fj=R("opacityDomain"),Nj=R("opacityRange"),Dj=R("opacityClamp"),Lj=R("opacityNice"),Rj=R("opacityLabel"),kj=R("opacityReverse"),Cj=R("opacityZero"),Uj=R("opacityTickFormat"),Pj=R("rScale"),$j=R("rDomain"),zj=R("rRange"),Vj=R("rClamp"),jj=R("rNice"),qj=R("rZero"),Yj=R("lengthScale"),Wj=R("lengthDomain"),Gj=R("lengthRange"),Xj=R("lengthClamp"),Hj=R("lengthNice"),Zj=R("lengthZero"),Kj=R("projectionType"),Qj=R("projectionParallels"),Jj=R("projectionPrecision"),tq=R("projectionRotate"),eq=R("projectionDomain"),rq=R("projectionInset"),nq=R("projectionInsetLeft"),iq=R("projectionInsetRight"),oq=R("projectionInsetTop"),sq=R("projectionInsetBottom"),aq=R("projectionClip");function TN(e,t){return{table:e,options:t}}var DN={};Qr(DN,{area:()=>vq,areaX:()=>Sq,areaY:()=>Iq,arrow:()=>pY,axisFx:()=>xY,axisFy:()=>_Y,axisX:()=>gY,axisY:()=>bY,barX:()=>Eq,barY:()=>Bq,cell:()=>Oq,cellX:()=>Fq,cellY:()=>Nq,circle:()=>Pq,contour:()=>nY,delaunayLink:()=>fY,delaunayMesh:()=>dY,denseLine:()=>rY,density:()=>eY,densityX:()=>Jq,densityY:()=>tY,dot:()=>kq,dotX:()=>Cq,dotY:()=>Uq,frame:()=>yY,geo:()=>TY,graticule:()=>MY,gridFx:()=>SY,gridFy:()=>IY,gridX:()=>wY,gridY:()=>vY,hexagon:()=>$q,hexbin:()=>sY,hexgrid:()=>aY,hull:()=>hY,image:()=>Qq,line:()=>Tq,lineX:()=>Aq,lineY:()=>Mq,link:()=>mY,raster:()=>iY,rasterTile:()=>oY,rect:()=>Dq,rectX:()=>Lq,rectY:()=>Rq,regressionY:()=>cY,ruleX:()=>qq,ruleY:()=>Yq,sphere:()=>AY,spike:()=>Kq,text:()=>zq,textX:()=>Vq,textY:()=>jq,tickX:()=>Wq,tickY:()=>Gq,vector:()=>Xq,vectorX:()=>Hq,vectorY:()=>Zq,voronoi:()=>lY,voronoiMesh:()=>uY});function sm(e){return typeof e!="string"?!1:(e=e.toLowerCase().trim(),e==="none"||e==="currentcolor"||e.startsWith("url(")&&e.endsWith(")")||e.startsWith("var(")&&e.endsWith(")")||Vn(e)!==null)}var sut=new Set(["order","label","anchor","curve","tension","marker","markerStart","markerMid","markerEnd","textAnchor","lineAnchor","lineHeight","textOverflow","monospace","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","frameAnchor","strokeLinejoin","strokeLinecap","strokeMiterlimit","strokeDasharray","strokeDashoffset","mixBlendMode","shapeRendering","imageRendering","preserveAspectRatio","interpolate","crossOrigin","paintOrder","pointerEvents"]);function cq(e){return sut.has(e)}var aut=new Set(["asterisk","circle","cross","diamond","diamond2","hexagon","plus","square","square2","star","times","triangle","triangle2","wye"]);function lq(e){return aut.has(`${e}`.toLowerCase())}var uq=e=>e==="stroke"||e==="fill",cut=e=>e==="symbol",AN=(e,t)=>({channel:e,field:t,as:t instanceof fi?t.column:e}),MN=(e,t)=>({channel:e,value:t}),ei=class extends mi{constructor(t,r,n,i={}){super(r?.options?.filterBy),this.type=t,this.reqs=i,this.source=r,Array.isArray(this.source)&&(this.data=this.source);let o=this.channels=[],s=this.params=new Set,a=(c,l)=>{let u=typeof l;if(u==="function"&&l[Kw]){let f=l(this,c);for(let d in f)a(d,f[d])}else if(u==="string")cq(c)||uq(c)&&sm(l)||cut(c)&&lq(l)?o.push(MN(c,l)):o.push(AN(c,Wu(l)));else if(rc(l))if(Array.isArray(l.columns))o.push(AN(c,l)),s.add(l);else{let f=MN(c,l.value);o.push(f),l.addEventListener("value",d=>(f.value=d,this.update()))}else u==="object"&&!Array.isArray(l)&&l!=null?o.push(AN(c,l)):l!==void 0&&o.push(MN(c,l))};for(let c in n)a(c,n[c])}setPlot(t,r){this.plot=t,this.index=r,t.addParams(this,this.params),this.source?.table&&this.queryPending()}hasOwnData(){return this.source==null||Array.isArray(this.source)}channel(t){return this.channels.find(r=>r.channel===t)}channelField(...t){let r=t.flat();for(let n of r){let i=this.channel(n);if(i?.field)return i}return null}fields(){if(this.hasOwnData())return null;let{source:{table:t},channels:r,reqs:n}=this,i=new Map;for(let{channel:o,field:s}of r){let a=s?.column;if(a){if(s.stats?.length||n[o]){i.has(a)||i.set(a,new Set);let c=i.get(a);n[o]?.forEach(l=>c.add(l)),s.stats?.forEach(l=>c.add(l))}}else continue}return Array.from(i,([o,s])=>({table:t,column:o,stats:Array.from(s)}))}fieldInfo(t){return this.stats=t.reduce((r,n)=>(r[n.column]=n,r),Object.create(null)),this}query(t=[]){if(this.hasOwnData())return null;let{channels:r,source:{table:n}}=this;return EN(r,n).where(t)}queryPending(){return this.plot.pending(this),this}queryResult(t){return this.data=Array.from(t),this}update(){return this.plot.update(this)}plotSpecs(){let{type:t,data:r,channels:n}=this,i={};for(let o of n)i[o.channel]=Ro(o);return[{type:t,data:r,options:i}]}};function Ro(e){return Object.hasOwn(e,"value")?e.value:uq(e.channel)?{value:e.as,scale:"color"}:e.as}function EN(e,t,r=[]){let n=yt.from({source:t}),i=new Set,o=!1;for(let s of e){let{channel:a,field:c,as:l}=s;if(!r.includes(a)){if(a==="order")n.orderby(s.value);else if(c){if(c.aggregate)o=!0;else{if(i.has(l))continue;i.add(l)}n.select({[l]:c})}}}return o&&n.groupby(Array.from(i)),n}function no(e,t,r){if(!e.stats)return n;let{field:n}=e.channelField(t),{type:i}=e.stats[n.column];return r=r??n,i==="date"?wy(r):r}function Jb(e,t,r,n,i=!1,o=1){let s=(n-o)/(r-t),a=s!==1?` * ${s}::DOUBLE`:"";return i?Y`(${+r} - ${e}::DOUBLE)${a}`:Y`(${e}::DOUBLE - ${+t})${a}`}var BN={x:["min","max"]},ON={y:["min","max"]},RT={...BN,...ON};function fq(e,t,r,n,i){let{plot:o,stats:s}=e,a=o.getAttribute(n),c=o.getAttribute(i);if(Array.isArray(a)&&!a[bs])return a;{let{field:l}=e.channelField(r),{column:u}=l,{min:f,max:d}=s[u],h=FN(t,u)||(c?Rc().domain([f,d]).nice().domain():[f,d]);return a!==mf&&(h[bs]=!0),o.setAttribute(n,h,{silent:!0}),h}}function Fa(e,t){return fq(e,t,"x","xDomain","xNice")}function Na(e,t){return fq(e,t,"y","yDomain","yNice")}function FN(e,t){if(!e)return;let r,n,i=(o,s)=>{if(o==="BETWEEN"&&s.field.column===t){let{range:a}=s;a&&(r==null||a[0]<r)&&(r=a[0]),a&&(n==null||a[1]>n)&&(n=a[1])}};return Array.isArray(e)?e.forEach(o=>o.visit?.(i)):e.visit&&e.visit(i),r!=null&&n!=null&&r!==n?[r,n]:void 0}var kT=class extends ei{constructor(t,r,n){let i=t.endsWith("X")?"y":"x",o={[i]:["count","min","max"]};super(t,r,n,o),this.dim=i}query(t=[]){let{plot:r,dim:n,source:i,stats:o}=this,{optimize:s=!0}=i.options||{},{field:a,as:c}=this.channelField(n),l=super.query(t);if(s){let{column:u}=a,{count:f,max:d,min:h}=o[u],p=n==="x"?r.innerWidth():r.innerHeight(),[m,g]=FN(t,u)||[h,d],y=(g-m)/(d-h);if(f*y>p*4){let b=no(this,n,c),x=this.channelField(n==="x"?"y":"x").as,_=l.select().map(w=>w.as).filter(w=>w!==c&&w!==x);return lut(l,b,c,x,m,g,p,_)}}return l.orderby(c)}};function lut(e,t,r,n,i,o,s,a=[]){let c=Y`FLOOR(${s/(o-i)}::DOUBLE * (${t} - ${+i}::DOUBLE))::INTEGER`,l=u=>yt.from(e).select(u).groupby(c,a);return yt.union(l([{[r]:ki(r),[n]:by(n,r)},...a]),l([{[r]:Ri(r),[n]:xy(n,r)},...a]),l([{[r]:by(r,n),[n]:ki(n)},...a]),l([{[r]:xy(r,n),[n]:Ri(n)},...a])).orderby(a,r)}function tx(e,t=!1){let r=new Float64Array(5),n=new Float64Array(4);uut(r,n,e);let i=Float64Array.of(0,n[1]-r[1]*n[0],n[2]-r[2]*n[0],n[3]-r[3]*n[0],-r[4]*n[0]),o=1+r[1]+r[2]+r[3]+r[4],s=(n[0]+n[1]+n[2]+n[3])/o,a=(i[1]+i[2]+i[3]+i[4])/o;return{sigma:e,negative:t,a:r,b_causal:n,b_anticausal:i,sum_causal:s,sum_anticausal:a}}function uut(e,t,r){let i=Float64Array.of(.84,1.8675,.84,-1.8675,-.34015,-.1299,-.34015,.1299),o=Math.exp(-1.783/r),s=Math.exp(-1.723/r),a=.6318/r,c=1.997/r,l=Float64Array.of(-o*Math.cos(a),o*Math.sin(a),-o*Math.cos(-a),o*Math.sin(-a),-s*Math.cos(c),s*Math.sin(c),-s*Math.cos(-c),s*Math.sin(-c)),u=r*2.5066282746310007,f=Float64Array.of(i[0],i[1],0,0,0,0,0,0),d=Float64Array.of(1,0,l[0],l[1],0,0,0,0,0,0),h,p;for(p=2;p<8;p+=2){for(f[p]=l[p]*f[p-2]-l[p+1]*f[p-1],f[p+1]=l[p]*f[p-1]+l[p+1]*f[p-2],h=p-2;h>0;h-=2)f[h]+=l[p]*f[h-2]-l[p+1]*f[h-1],f[h+1]+=l[p]*f[h-1]+l[p+1]*f[h-2];for(h=0;h<=p;h+=2)f[h]+=i[p]*d[h]-i[p+1]*d[h+1],f[h+1]+=i[p]*d[h+1]+i[p+1]*d[h];for(d[p+2]=l[p]*d[p]-l[p+1]*d[p+1],d[p+3]=l[p]*d[p+1]+l[p+1]*d[p],h=p;h>0;h-=2)d[h]+=l[p]*d[h-2]-l[p+1]*d[h-1],d[h+1]+=l[p]*d[h-1]+l[p+1]*d[h-2]}for(p=0;p<4;++p)h=p<<1,t[p]=f[h]/u,e[p+1]=d[h+2]}function dq(e,t,r,[n,i]){let o=new Float64Array(Math.max(n,i)),s=new Float64Array(Math.max(n,i)),a=new Float64Array(5),c=new Float64Array(r.length);for(let l=0,u=0;l<i;++l,u+=n){let f=c.subarray(u);CT(e,r.subarray(u),n,1,o,s,a,f)}for(let l=0;l<n;++l){let u=c.subarray(l);CT(t,u,i,n,o,s,a,u)}return c}function CT(e,t,r,n=1,i=new Float64Array(r),o=new Float64Array(r),s=new Float64Array(5),a=i,c=fut){let l=n*2,u=n*3,f=n*4,d=n*r,h,p;for(c(i,t,r,n,e.b_causal,3,e.a,4,e.sum_causal,s,e.sigma),p=4,h=f;p<r;++p,h+=n)i[p]=e.b_causal[0]*t[h]+e.b_causal[1]*t[h-n]+e.b_causal[2]*t[h-l]+e.b_causal[3]*t[h-u]-e.a[1]*i[p-1]-e.a[2]*i[p-2]-e.a[3]*i[p-3]-e.a[4]*i[p-4];for(c(o,t,r,-n,e.b_anticausal,4,e.a,4,e.sum_anticausal,s,e.sigma),p=4,h=d-n*5;p<r;++p,h-=n)o[p]=e.b_anticausal[1]*t[h+n]+e.b_anticausal[2]*t[h+l]+e.b_anticausal[3]*t[h+u]+e.b_anticausal[4]*t[h+f]-e.a[1]*o[p-1]-e.a[2]*o[p-2]-e.a[3]*o[p-3]-e.a[4]*o[p-4];if(e.negative)for(p=0,h=0;p<r;++p,h+=n)a[h]=i[p]+o[r-p-1];else for(p=0,h=0;p<r;++p,h+=n)a[h]=Math.max(0,i[p]+o[r-p-1]);return a}function fut(e,t,r,n,i,o,s,a,c,l){let u=Math.abs(n)*r,f=n<0?u+n:0,d,h,p;for(h=0;h<a;++h)for(l[h]=h<=o?i[h]:0,p=1;p<=a&&p<=h;++p)l[h]-=s[p]*l[h-p];for(p=0;p<a;++p)for(e[p]=0,h=1;h<=p;++h)d=f+n*h,d>=0&&d<u&&(e[p]+=l[p-h]*t[d]);let m=t[f];if(m>0)for(p=0;p<a;++p)e[p]+=l[p]*m}function hq(e,t){return yq(new Float64Array(e),t)}function pq(e,t,r,n=[]){return n.length?Object.values(dut(e*t,r,n)):[{grid:yq(new Float64Array(e*t),r)}]}function mq(e){return typeof e.getChild=="function"}function yq(e,t){if(mq(t)){let r=t.numRows;if(r===0)return e;let n=t.getChild("index").toArray(),i=t.getChild("value").toArray();for(let o=0;o<r;++o)e[n[o]]=i[o]}else for(let r of t)e[r.index]=r.value;return e}function dut(e,t,r){let n={},i=o=>(n[o]||(n[o]={key:o,grid:new Float64Array(e)})).grid;if(mq(t)){let o=t.numRows;if(o===0)return n;let s=t.getChild("index").toArray(),a=t.getChild("value").toArray(),c=r.map(l=>t.getChild(l));for(let l=0;l<o;++l){let u=c.map(f=>f.get(l));i(u)[s[l]]=a[l]}}else for(let o of t){let s=r.map(a=>o[a]);i(s)[o.index]=o.value}return n}function Kr(e,t,r,n){yi(r)?(n=n||(()=>e.requestUpdate()),r.addEventListener("value",i=>(e[t]=i,n())),e[t]=r.value):e[t]=r}var ex=class extends ei{constructor(t,r,n){let{bins:i=1024,bandwidth:o=20,...s}=n,a=t.endsWith("X")?"y":"x";super(t,r,s,a==="x"?BN:ON),this.dim=a,Kr(this,"bins",i),Kr(this,"bandwidth",o,()=>this.grid?this.convolve().update():null)}get filterIndexable(){let t=this.dim==="x"?"xDomain":"yDomain",r=this.plot.getAttribute(t);return r&&!r[bs]}query(t=[]){if(this.hasOwnData())throw new Error("Density1DMark requires a data source");let{bins:r,channels:n,dim:i,source:{table:o}}=this,[s,a]=this.extent=(i==="x"?Fa:Na)(this,t),c=no(this,i);return hut(EN(n,o,[i]).where(t.concat(tr(c,[s,a]))),Jb(c,s,a,r),this.channelField("weight")?"weight":null)}queryResult(t){return this.grid=hq(this.bins,t),this.convolve()}convolve(){let{bins:t,bandwidth:r,dim:n,grid:i,plot:o,extent:[s,a]}=this,c=i.some(b=>b<0),l=n==="x"?o.innerWidth():o.innerHeight(),u=tx(r*(t-1)/l,c),f=CT(u,i,t),d=this.data=[],h=n==="x"?"y":"x",p=this.channelField(n).as,m=+s,g=(a-m)/(t-1),y=1/g;for(let b=0;b<t;++b)d.push({[p]:m+b*g,[h]:f[b]*y});return this}plotSpecs(){let{type:t,data:r,channels:n,dim:i}=this,o=i==="x"?{y:"y"}:{x:"x"};for(let s of n)o[s.channel]=Ro(s);return[{type:t,data:r,options:o}]}};function hut(e,t,r){let n=r?`* ${r}`:"",i=e.clone().select({p:t,i:Y`FLOOR(p)::INTEGER`,w:Y`(FLOOR(p) + 1 - p)${n}`}),o=e.clone().select({p:t,i:Y`FLOOR(p)::INTEGER + 1`,w:Y`(p - FLOOR(p))${n}`});return yt.from(yt.unionAll(i,o)).select({index:"i",value:pi("w")}).groupby("index").having(zd("value",0))}var Da=class extends ei{constructor(t,r,n){let{bandwidth:i=20,binType:o="linear",binWidth:s=2,binPad:a=1,...c}=n,l=put(c);super(t,r,c,RT),this.densityMap=l,Kr(this,"bandwidth",i,()=>this.grids?this.convolve().update():null),Kr(this,"binWidth",s),Kr(this,"binType",o),Kr(this,"binPad",a)}setPlot(t,r){let n=()=>{this.stats&&this.requestUpdate()};return t.addAttributeListener("domainX",n),t.addAttributeListener("domainY",n),super.setPlot(t,r)}get filterIndexable(){let t=this.plot.getAttribute("xDomain"),r=this.plot.getAttribute("yDomain");return t&&r&&!t[bs]&&!r[bs]}query(t=[]){let{plot:r,binType:n,binPad:i,channels:o,densityMap:s,source:a}=this,[c,l]=this.extentX=Fa(this,t),[u,f]=this.extentY=Na(this,t),[d,h]=this.bins=this.binDimensions(this),p=no(this,"x"),m=no(this,"y"),g=!!r.getAttribute("xReverse"),y=!!r.getAttribute("yReverse"),b=gq(p,c,l,d,g,this.binPad),x=gq(m,u,f,h,y,this.binPad),_=i?[tr(p,[c,l]),tr(m,[u,f])]:[bl(c,p),gl(p,l),bl(u,m),gl(m,f)],w=yt.from(a.table).where(t.concat(_)),v=this.groupby=[],A=hi();for(let B of o)if(Object.hasOwn(B,"field")){let{as:D,channel:T,field:M}=B;M.aggregate?(A=M,s[T]=!0):T==="weight"?A=pi(M):T!=="x"&&T!=="y"&&(w.select({[D]:M}),v.push(D))}return n==="linear"?yut(w,b,x,A,d,v):mut(w,b,x,A,d,v)}binDimensions(){let{plot:t,binWidth:r}=this;return[Math.round(t.innerWidth()/r),Math.round(t.innerHeight()/r)]}queryResult(t){let[r,n]=this.bins;return this.grids=pq(r,n,t,this.groupby),this.convolve()}convolve(){let{bandwidth:t,bins:r,grids:n,plot:i}=this;if(t<=0)this.kde=this.grids.map(({key:o,grid:s})=>(s.key=o,s));else{let o=i.innerWidth(),s=i.innerHeight(),[a,c]=r,l=n.some(({grid:d})=>d.some(h=>h<0)),u=tx(t*(a-1)/o,l),f=tx(t*(c-1)/s,l);this.kde=this.grids.map(({key:d,grid:h})=>{let p=dq(u,f,h,r);return p.key=d,p})}return this}plotSpecs(){throw new Error("Unimplemented. Use a Grid2D mark subclass.")}};function put(e){let t={};for(let r in e)e[r]==="density"&&(delete e[r],t[r]=!0);return t}function gq(e,t,r,n,i,o){let s=(n-o)/(r-t),a=s!==1?` * ${s}::DOUBLE`:"";return i?Y`(${r} - ${e}::DOUBLE)${a}`:Y`(${e}::DOUBLE - ${t})${a}`}function mut(e,t,r,n,i,o){return e.select({index:Y`FLOOR(${t})::INTEGER + FLOOR(${r})::INTEGER * ${i}`,value:n}).groupby("index",o)}function yut(e,t,r,n,i,o){let s=n.column?`* ${n.column}`:"",a=(d,h)=>e.clone().select({xp:t,yp:r,i:d,w:h}),c=a(Y`FLOOR(xp)::INTEGER + FLOOR(yp)::INTEGER * ${i}`,Y`(FLOOR(xp)::INTEGER + 1 - xp) * (FLOOR(yp)::INTEGER + 1 - yp)${s}`),l=a(Y`FLOOR(xp)::INTEGER + (FLOOR(yp)::INTEGER + 1) * ${i}`,Y`(FLOOR(xp)::INTEGER + 1 - xp) * (yp - FLOOR(yp)::INTEGER)${s}`),u=a(Y`FLOOR(xp)::INTEGER + 1 + FLOOR(yp)::INTEGER * ${i}`,Y`(xp - FLOOR(xp)::INTEGER) * (FLOOR(yp)::INTEGER + 1 - yp)${s}`),f=a(Y`FLOOR(xp)::INTEGER + 1 + (FLOOR(yp)::INTEGER + 1) * ${i}`,Y`(xp - FLOOR(xp)::INTEGER) * (yp - FLOOR(yp)::INTEGER)${s}`);return yt.from(yt.unionAll(c,l,u,f)).select({index:"i",value:pi("w")},o).groupby("index",o).having(zd("value",0))}var UT=class extends Da{constructor(t,r){let{type:n="dot",binsX:i,binsY:o,...s}=r;s.binPad=s.binPad??0,super(n,t,s),Kr(this,"binsX",i),Kr(this,"binsY",o)}convolve(){super.convolve();let{bins:t,binPad:r,extentX:n,extentY:i}=this,[o,s]=t,[a,c]=n,[l,u]=i,f=(c-a)/(o-r),d=(u-l)/(s-r),h=r?0:.5;return this.data=gut(this.kde,t,a,l,f,d,h),this}binDimensions(){let{plot:t,binWidth:r,binsX:n,binsY:i}=this;return[n??Math.round(t.innerWidth()/r),i??Math.round(t.innerHeight()/r)]}plotSpecs(){let{type:t,channels:r,densityMap:n,data:i}=this,o={};for(let s of r){let{channel:a}=s;o[a]=a==="x"||a==="y"?a:Ro(s)}for(let s in n)n[s]&&(o[s]="density");return[{type:t,data:i,options:o}]}};function gut(e,t,r,n,i,o,s){let a=1/(i*o),[c,l]=t,u=[];for(let f of e)for(let d=0,h=0;h<l;++h)for(let p=0;p<c;++p,++d)u.push({x:r+(p+s)*i,y:n+(h+s)*o,density:f[d]*a});return u}function PT(e,t,r,n,i,o){let s=(o.length>>2)-1;for(let a=0,c=0;a<n;++a)for(let l=0,u=(n-a-1)*r;l<r;++l,c+=4){let f=s*i(e[l+u])<<2;t[c+0]=o[f+0],t[c+1]=o[f+1],t[c+2]=o[f+2],t[c+3]=o[f+3]}}function am(e,t){let r=new Uint8ClampedArray(4*e),n=e-1;for(let i=0;i<=n;++i){let o=t(i/n),{r:s,g:a,b:c,opacity:l=1}=typeof o=="string"?jr(o):o,u=i<<2;r[u+0]=s,r[u+1]=a,r[u+2]=c,r[u+3]=255*l|0}return r}function $T(e,t){if(typeof document<"u"){let r=document.createElement("canvas");return r.setAttribute("width",e),r.setAttribute("height",t),r}throw new Error("Can not create a canvas instance.")}function zT(e="black"){let{r:t,g:r,b:n}=jr(e);return i=>({r:t,g:r,b:n,opacity:i})}var cm=class extends Da{constructor(t,r){super("image",t,r)}setPlot(t,r){let n=()=>{this.stats&&this.rasterize()};t.addAttributeListener("schemeColor",n),super.setPlot(t,r)}convolve(){return super.convolve().rasterize()}rasterize(){let{bins:t,kde:r,groupby:n}=this,[i,o]=t,{canvas:s,ctx:a,img:c}=but(this,i,o),l=xut(this),u=n.indexOf(this.channelField("fill")?.as),f=u<0?[]:r.map(({key:d})=>d[u]);return this.data=r.map(d=>{let h=_ut(this,f,d.key?.[u]);return PT(d,c.data,i,o,l,h),a.putImageData(c,0,0),{src:s.toDataURL()}}),this}plotSpecs(){let{type:t,plot:r,data:n}=this,i={src:"src",width:r.innerWidth(),height:r.innerHeight(),preserveAspectRatio:"none",imageRendering:this.channel("imageRendering")?.value,frameAnchor:"middle"};return[{type:t,data:n,options:i}]}};function but(e,t,r){if(!e.image||e.image.w!==t||e.image.h!==r){let n=$T(t,r),i=n.getContext("2d",{willReadFrequently:!0}),o=i.getImageData(0,0,t,r);e.image={canvas:n,ctx:i,img:o,w:t,h:r}}return e.image}function xut(e){let{densityMap:t,kde:r,plot:n}=e,i=t.fill&&n.getAttribute("colorDomain");if(!i){let s=0,a=0;r.forEach(c=>{for(let l of c)l<s&&(s=l),l>a&&(a=l)}),i=s===0&&a===0?[0,1]:[s,a]}let o=n.getAttribute("colorScale");return Ma({x:{type:o,domain:i,range:[0,1]}}).apply}function _ut(e,t,r,n=1024){let{densityMap:i,plot:o}=e,s=o.getAttribute("colorScheme"),a;if(i.fill){if(s)try{return am(n,Ma({color:{scheme:s,domain:[0,1]}}).interpolate)}catch(c){console.warn(c)}}else if(t.length){let c=o.getAttribute("colorRange");a=Ma({color:{domain:t,range:c,scheme:s||(c?void 0:"tableau10")}}).apply(r)}else{let c=e.channelField("fill");a=sm(c?.value)?c.value:void 0}return am(n,zT(a))}var VT=class extends cm{constructor(t,r){let{normalize:n=!0,...i}=r;super(t,{bandwidth:0,...i}),Kr(this,"normalize",n)}query(t=[]){let{plot:r,channels:n,normalize:i,source:o}=this,[s,a]=Fa(this,t),[c,l]=Na(this,t),[u,f]=this.bins=this.binDimensions(this),d=no(this,"x"),h=no(this,"y"),p=!!r.getAttribute("xReverse"),m=!!r.getAttribute("yReverse"),g=Jb(d,s,a,u,p,this.binPad),y=Jb(h,c,l,f,m,this.binPad),b=yt.from(o.table).where(wut(this,t)),x=this.groupby=[],_=[];for(let w of n)if(Object.hasOwn(w,"field")){let{channel:v,field:A}=w;v==="z"?(b.select({[v]:A}),_.push("z")):v!=="x"&&v!=="y"&&(b.select({[v]:A}),x.push(v))}return vut(b,g,y,_,u,f,x,i)}};function wut(e,t){if(Array.isArray(t)&&!t.length)return t;let r=e.channelField("x").field.column,n=e.channelField("y").field.column,i=s=>s.op!=="BETWEEN"||s.field.column!==r&&s.field.column!==n,o=s=>s.op==="AND"?di(s.children.filter(a=>i(a))):s;return Array.isArray(t)?t.filter(s=>i(s)).map(s=>o(s)):o(t)}function vut(e,t,r,n,i,o,s=[],a=!0){e.select({x:Y`FLOOR(${t})::INTEGER`,y:Y`FLOOR(${r})::INTEGER`});let c=s.concat(n),l=c.length?`PARTITION BY ${c.join(", ")} `:"",u=yt.from(e).select(c,{x0:"x",y0:"y",dx:Y`(lead(x) OVER sw - x)`,dy:Y`(lead(y) OVER sw - y)`}).window({sw:Y`${l}ORDER BY x ASC`}).qualify(di(Y`(x0 < ${i} OR x0 + dx < ${i})`,Y`(y0 < ${o} OR y0 + dy < ${o})`,Y`(x0 > 0 OR x0 + dx > 0)`,Y`(y0 > 0 OR y0 + dy > 0)`)),f=yt.select({x:Y`GREATEST(MAX(ABS(dx)), MAX(ABS(dy)))`}).from("pairs"),d=yt.select({i:Y`UNNEST(range((${f})))::INTEGER`}),h=yt.unionAll(yt.select(c,{x:Y`x0 + i`,y:Y`y0 + ROUND(i * dy / dx::FLOAT)::INTEGER`}).from("pairs","indices").where(Y`ABS(dy) <= ABS(dx) AND i < ABS(dx)`),yt.select(c,{x:Y`x0 + ROUND(SIGN(dy) * i * dx / dy::FLOAT)::INTEGER`,y:Y`y0 + SIGN(dy) * i`}).from("pairs","indices").where(Y`ABS(dy) > ABS(dx) AND i < ABS(dy)`),yt.select(c,{x:"x0",y:"y0"}).from("pairs").where($d("dx"))),p=["x"].concat(c).join(", "),m=yt.from("raster").select(c,"x","y",a?{w:Y`1.0 / COUNT(*) OVER (PARTITION BY ${p})`}:null).where(di(tr("x",[0,i]),tr("y",[0,o])));return yt.with({pairs:u,indices:d,raster:h,points:m}).from("points").select(s,{index:Y`x + y * ${i}::INTEGER`,value:a?pi("w"):hi()}).groupby("index",s)}var jT=class extends Da{constructor(t,r){let{thresholds:n=10,...i}=r;super("geo",t,i),Kr(this,"thresholds",n,()=>this.grids?this.contours().update():null)}convolve(){return super.convolve().contours()}contours(){let{bins:t,densityMap:r,kde:n,thresholds:i,groupby:o,plot:s}=this,a=i;if(!Array.isArray(a)){let w=ue(n.map(v=>ue(v)));a=Array.from({length:a-1},(v,A)=>w*(A+1)/a)}(r.fill||r.stroke)&&this.plot.getAttribute("colorScale")!=="log"&&this.plot.setAttribute("colorZero",!0);let[c,l]=t,[u,f]=s.getAttribute("xDomain"),[d,h]=s.getAttribute("yDomain"),p=(f-u)/c,m=(h-d)/l,g=+u,y=+d,b=w=>g+w*p,x=w=>y+w*m,_=Zl().size(t);return this.data=n.flatMap(w=>a.map(v=>{let A=Sut(_.contour(w,v),b,x);return o.forEach((B,D)=>A[B]=w.key[D]),A.density=v,A})),this}plotSpecs(){let{type:t,channels:r,densityMap:n,data:i}=this,o={};for(let s of r){let{channel:a}=s;a!=="x"&&a!=="y"&&(o[a]=Ro(s))}return n.fill&&(o.fill="density"),n.stroke&&(o.stroke="density"),[{type:t,data:i,options:o}]}};function Sut(e,t,r){function n(s){s.forEach(i)}function i(s){s.forEach(o)}function o(s){s[0]=t(s[0]),s[1]=r(s[1])}return e.coordinates.forEach(n),e}var qT=class extends ei{constructor(t,r){let{type:n="hexagon",binWidth:i=20,...o}=r;super(n,t,{r:i/2,clip:!0,...o},RT),this.binWidth=i}get filterIndexable(){let t=this.plot.getAttribute("xDomain"),r=this.plot.getAttribute("yDomain");return t&&r&&!t[bs]&&!r[bs]}query(t=[]){if(this.hasOwnData())return null;let{plot:r,binWidth:n,channels:i,source:o}=this,[s,a]=Fa(this,t),[c,l]=Na(this,t),u=.5-r.getAttribute("marginLeft"),f=0-r.getAttribute("marginTop"),d=`${n}::DOUBLE`,h=`${n*(1.5/Math.sqrt(3))}::DOUBLE`,p=`${r.innerWidth()/(a-s)}::DOUBLE`,m=`${r.innerHeight()/(l-c)}::DOUBLE`,g,y,b=new Set,x={};for(let B of i)B.channel==="order"?_.orderby(B.value):B.channel==="x"?g=B:B.channel==="y"?y=B:Object.hasOwn(B,"field")&&(x[B.as]=B.field,B.field.aggregate&&B.field.columns.forEach(D=>b.add(D)));let _=yt.select({[g.as]:Y`${s}::DOUBLE + ((x + 0.5 * (y & 1)) * ${d} + ${u})::DOUBLE / ${p}`,[y.as]:Y`${l}::DOUBLE - (y * ${h} + ${f})::DOUBLE / ${m}`,...x}).groupby("x","y"),w=`${p} * (${g.field} - ${s}::DOUBLE)`,v=`${m} * (${l}::DOUBLE - ${y.field})`,A=yt.select({py:Y`(${v} - ${f}) / ${h}`,pj:Y`ROUND(py)::INTEGER`,px:Y`(${w} - ${u}) / ${d} - 0.5 * (pj & 1)`,pi:Y`ROUND(px)::INTEGER`,tt:Y`ABS(py-pj) * 3 > 1 AND (px-pi)**2 + (py-pj)**2 > (px - pi - 0.5 * CASE WHEN px < pi THEN -1 ELSE 1 END)**2 + (py - pj - CASE WHEN py < pj THEN -1 ELSE 1 END)**2`,x:Y`CASE WHEN tt THEN (pi + (CASE WHEN px < pi THEN -0.5 ELSE 0.5 END) + (CASE WHEN pj & 1 <> 0 THEN 0.5 ELSE -0.5 END))::INTEGER ELSE pi END`,y:Y`CASE WHEN tt THEN (pj + CASE WHEN py < pj THEN -1 ELSE 1 END)::INTEGER ELSE pj END`}).select(Array.from(b)).from(o.table).where(ml(g.field),ml(y.field),t);return _.from(A)}};var YT=class extends Da{constructor(t,r){let{origin:n=[0,0],dim:i="xy",...o}=r;super("image",t,o),this.origin=n,this.tileX=i.toLowerCase().includes("x"),this.tileY=i.toLowerCase().includes("y")}setPlot(t,r){let n=()=>{this.stats&&this.rasterize()};t.addAttributeListener("schemeColor",n),super.setPlot(t,r)}requestQuery(){return this.requestTiles()}query(t=[]){return this._filter=t,null}tileQuery(t){let{plot:r,binType:n,binPad:i,channels:o,densityMap:s,source:a}=this,[[c,l],[u,f]]=t,[d,h]=this.bins,p=no(this,"x"),m=no(this,"y"),g=!!r.getAttribute("xReverse"),y=!!r.getAttribute("yReverse"),b=bq(p,c,l,d,g,i),x=bq(m,u,f,h,y,i),_=i?[tr(p,[c,l]),tr(m,[u,f])]:[bl(c,p),gl(p,l),bl(u,m),gl(m,f)],w=yt.from(a.table).where(_),v=this.groupby=[],A=hi();for(let B of o)if(Object.hasOwn(B,"field")){let{channel:D,field:T}=B;T.aggregate?(A=T,s[D]=!0):D==="weight"?A=pi(T):D!=="x"&&D!=="y"&&(w.select({[D]:T}),v.push(D))}return n==="linear"?Out(w,b,x,A,d,v):But(w,b,x,A,d,v)}async requestTiles(){let t=nn();this.prefetch&&t.cancel(this.prefetch);let{binPad:r,tileX:n,tileY:i,origin:[o,s]}=this,[a,c]=this.bins=this.binDimensions(this),[l,u]=Fa(this,this._filter),[f,d]=Na(this,this._filter),h=u-l,p=d-f,m=Math.floor((l-o)*(a-r)/h),g=Math.floor((f-s)*(c-r)/p),y=(T,M)=>[[o+T*h,o+(T+1)*h],[s+M*p,s+(M+1)*p]],b=Math.floor((l-o)/h),x=n?xq((u-o)/h):b,_=Math.floor((f-s)/p),w=i?xq((d-s)/p):_,v=[];for(let T=b;T<=x;++T)for(let M=_;M<=w;++M)v.push([T,M]);let A=v.map(([T,M])=>t.query(this.tileQuery(y(T,M)))),B=[];if(n)for(let T=_;T<=w;++T)B.push([x+1,T]),B.push([b-1,T]);if(i){let T=n?b-1:b,M=n?x+1:x;for(let O=T;O<=M;++O)B.push([O,w+1]),B.push([O,_-1])}this.prefetch=B.map(([T,M])=>t.prefetch(this.tileQuery(y(T,M))));let D=await Promise.all(A);this.grids=[{grid:Iut(a,c,m,g,v,D)}],this.convolve().update()}convolve(){return super.convolve().rasterize()}rasterize(){let{bins:t,kde:r,groupby:n}=this,[i,o]=t,{canvas:s,ctx:a,img:c}=Aut(this,i,o),l=Mut(this),u=n.indexOf(this.channelField("fill")?.as),f=u<0?[]:r.map(({key:d})=>d[u]);return this.data=r.map(d=>{let h=Eut(this,f,d.key?.[u]);return PT(d,c.data,i,o,l,h),a.putImageData(c,0,0),{src:s.toDataURL()}}),this}plotSpecs(){let{type:t,data:r,plot:n}=this,i={src:"src",width:n.innerWidth(),height:n.innerHeight(),preserveAspectRatio:"none",imageRendering:this.channel("imageRendering")?.value,frameAnchor:"middle"};return[{type:t,data:r,options:i}]}};function Iut(e,t,r,n,i,o){let s=new Float64Array(e*t);return o.forEach((a,c)=>{let[l,u]=i[c],f=l*e-r,d=u*t-n;Tut(e,t,s,a,f,d)}),s}function Tut(e,t,r,n,i,o){let s=n.numRows;if(s===0)return;let a=n.getChild("index").toArray(),c=n.getChild("value").toArray();for(let l=0;l<s;++l){let u=a[l],f=i+u%e,d=o+Math.floor(u/e);0<=f&&f<e&&0<=d&&d<t&&(r[f+d*e]=c[l])}}function Aut(e,t,r){if(!e.image||e.image.w!==t||e.image.h!==r){let n=$T(t,r),i=n.getContext("2d",{willReadFrequently:!0}),o=i.getImageData(0,0,t,r);e.image={canvas:n,ctx:i,img:o,w:t,h:r}}return e.image}function Mut(e){let{densityMap:t,kde:r,plot:n}=e,i=t.fill&&n.getAttribute("colorDomain");if(!i){let s=0,a=0;r.forEach(c=>{for(let l of c)l<s&&(s=l),l>a&&(a=l)}),i=s===0&&a===0?[0,1]:[s,a]}let o=n.getAttribute("colorScale");return Ma({x:{type:o,domain:i,range:[0,1]}}).apply}function Eut(e,t,r,n=1024){let{densityMap:i,plot:o}=e,s=o.getAttribute("colorScheme"),a;if(i.fill){if(s)try{return am(n,Ma({color:{scheme:s,domain:[0,1]}}).interpolate)}catch(c){console.warn(c)}}else if(t.length){let c=o.getAttribute("colorRange");a=Ma({color:{domain:t,range:c,scheme:s||(c?void 0:"tableau10")}}).apply(r)}else{let c=e.channelField("fill");a=sm(c?.value)?c.value:void 0}return am(n,zT(a))}function bq(e,t,r,n,i,o){let s=(n-o)/(r-t),a=s!==1?` * ${s}::DOUBLE`:"";return i?Y`(${r} - ${e}::DOUBLE)${a}`:Y`(${e}::DOUBLE - ${t})${a}`}function But(e,t,r,n,i,o){return e.select({index:Y`FLOOR(${t})::INTEGER + FLOOR(${r})::INTEGER * ${i}`,value:n}).groupby("index",o)}function Out(e,t,r,n,i,o){let s=n.column?`* ${n.column}`:"",a=(d,h)=>e.clone().select({xp:t,yp:r,i:d,w:h}),c=a(Y`FLOOR(xp)::INTEGER + FLOOR(yp)::INTEGER * ${i}`,Y`(FLOOR(xp)::INTEGER + 1 - xp) * (FLOOR(yp)::INTEGER + 1 - yp)${s}`),l=a(Y`FLOOR(xp)::INTEGER + (FLOOR(yp)::INTEGER + 1) * ${i}`,Y`(FLOOR(xp)::INTEGER + 1 - xp) * (yp - FLOOR(yp)::INTEGER)${s}`),u=a(Y`FLOOR(xp)::INTEGER + 1 + FLOOR(yp)::INTEGER * ${i}`,Y`(xp - FLOOR(xp)::INTEGER) * (FLOOR(yp)::INTEGER + 1 - yp)${s}`),f=a(Y`FLOOR(xp)::INTEGER + 1 + (FLOOR(yp)::INTEGER + 1) * ${i}`,Y`(xp - FLOOR(xp)::INTEGER) * (yp - FLOOR(yp)::INTEGER)${s}`);return yt.from(yt.unionAll(c,l,u,f)).select({index:"i",value:pi("w")},o).groupby("index",o).having(C_("value",0))}function xq(e){let t=Math.floor(e);return t===e?t-1:t}function Fut(e,t,r){var n=1e-8,i=t-1,o=r-1,s=0,a,c,l,u,f,d,h,p,m,g,y;if(e<=0)return 0;if(e>=1)return 1;for(t>=1&&r>=1?(l=e<.5?e:1-e,u=Math.sqrt(-2*Math.log(l)),h=(2.30753+u*.27061)/(1+u*(.99229+u*.04481))-u,e<.5&&(h=-h),p=(h*h-3)/6,m=2/(1/(2*t-1)+1/(2*r-1)),g=h*Math.sqrt(p+m)/m-(1/(2*r-1)-1/(2*t-1))*(p+5/6-2/(3*m)),h=t/(t+r*Math.exp(2*g))):(a=Math.log(t/(t+r)),c=Math.log(r/(t+r)),u=Math.exp(t*a)/t,f=Math.exp(r*c)/r,g=u+f,e<u/g?h=Math.pow(t*g*e,1/t):h=1-Math.pow(r*g*(1-e),1/r)),y=-lm(t)-lm(r)+lm(t+r);s<10;s++){if(h===0||h===1)return h;if(d=Nut(h,t,r)-e,u=Math.exp(i*Math.log(h)+o*Math.log(1-h)+y),f=d/u,h-=u=f/(1-.5*Math.min(1,f*(i/h-o/(1-h)))),h<=0&&(h=.5*(h+u)),h>=1&&(h=.5*(h+u+1)),Math.abs(u)<n*h&&s>0)break}return h}function Nut(e,t,r){var n=e===0||e===1?0:Math.exp(lm(t+r)-lm(t)-lm(r)+t*Math.log(e)+r*Math.log(1-e));return e<0||e>1?!1:e<(t+1)/(t+r+2)?n*_q(e,t,r)/t:1-n*_q(1-e,r,t)/r}function _q(e,t,r){var n=1e-30,i=1,o=t+r,s=t+1,a=t-1,c=1,l=1-o*e/s,u,f,d,h;for(Math.abs(l)<n&&(l=n),l=1/l,h=l;i<=100&&(u=2*i,f=i*(r-i)*e/((a+u)*(t+u)),l=1+f*l,Math.abs(l)<n&&(l=n),c=1+f/c,Math.abs(c)<n&&(c=n),l=1/l,h*=l*c,f=-(t+i)*(o+i)*e/((t+u)*(s+u)),l=1+f*l,Math.abs(l)<n&&(l=n),c=1+f/c,Math.abs(c)<n&&(c=n),l=1/l,d=l*c,h*=d,!(Math.abs(d-1)<3e-7));i++);return h}function lm(e){var t=0,r=[76.18009172947146,-86.5053203294167,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],n=1.000000000190015,i,o,s;for(s=(o=i=e)+5.5,s-=(i+.5)*Math.log(s);t<6;t++)n+=r[t]/++o;return Math.log(2.506628274631*n/i)-s}function wq(e,t){var r=Fut(2*Math.min(e,1-e),.5*t,.5);return r=Math.sqrt(t*(1-r)/r),e>.5?r:-r}var WT=class extends ei{constructor(t,r){let{ci:n=.95,precision:i=4,...o}=r;super("line",t,o);let s=()=>this.modelFit?this.confidenceBand().update():null;Kr(this,"ci",n,s),Kr(this,"precision",i,s)}query(t=[]){let r=this.channelField("x").as,n=this.channelField("y").as,i=Array.from(new Set(["stroke","z","fx","fy"].flatMap(o=>this.channelField(o)?.as||[])));return yt.from(super.query(t)).select({intercept:hM(n,r),slope:pM(n,r),n:mM(n,r),ssy:yM(n,r),ssx:gM(n,r),xm:bM(n,r),x0:_y(ki(r).where(ml(n))),x1:_y(Ri(r).where(ml(n)))}).select(i).groupby(i)}queryResult(t){return this.modelFit=Array.from(t),this.lineData=this.modelFit.flatMap(r=>Dut(r)),this.confidenceBand()}confidenceBand(){let{ci:t,modelFit:r,precision:n,plot:i}=this,o=i.innerWidth();return this.areaData=t?r.flatMap(s=>Lut(t,n,s,o)):null,this}plotSpecs(){let{lineData:t,areaData:r,channels:n,ci:i}=this,o={x:"x",y:"y"},s={x:"x",y1:"y1",y2:"y2",fillOpacity:.1};for(let a of n)switch(a.channel){case"x":case"y":case"fill":break;case"stroke":o.stroke=s.fill=Ro(a);break;case"strokeOpacity":o.strokeOpacity=Ro(a);break;case"fillOpacity":s.fillOpacity=Ro(a);break;default:o[a.channel]=s[a.channel]=Ro(a);break}return[...i?[{type:"areaY",data:r,options:s}]:[],{type:"line",data:t,options:o}]}};function Dut(e){let{x0:t,x1:r,xm:n,intercept:i,slope:o,n:s,ssx:a,ssy:c,...l}=e;return[{x:t,y:i+t*o,...l},{x:r,y:i+r*o,...l}]}function Lut(e,t,r,n){let{x0:i,x1:o,xm:s,intercept:a,slope:c,n:l,ssx:u,ssy:f,...d}=r,h=t*(o-i)/n,p=wq((1-e)/2,l-2)*Math.sqrt(f/(l-2));return xr(i,o-h/2,h).concat(o).map(m=>{let g=a+m*c,y=p*Math.sqrt(1/l+(m-s)**2/u);return{x:m,y1:g-y,y2:g+y,...d}})}var Rut=new Set(["frame","axisX","axisY","axisFx","axisFy","gridX","gridY","gridFx","gridFy","hexgrid","graticule","sphere"]);function xt(e,t,r){arguments.length===2&&(r=t,t=Rut.has(e)?null:[{}]);let n=e.startsWith("area")||e.startsWith("line")?kT:ei;return NN(n,e,t,r)}function NN(e,t,r,n){return i=>{i.addMark(new e(t,r,n))}}function hd(e,t,r){return n=>{n.addMark(new e(t,r))}}var vq=(...e)=>xt("area",...e),Sq=(...e)=>xt("areaX",...e),Iq=(...e)=>xt("areaY",...e),Tq=(...e)=>xt("line",...e),Aq=(...e)=>xt("lineX",...e),Mq=(...e)=>xt("lineY",...e),Eq=(...e)=>xt("barX",...e),Bq=(...e)=>xt("barY",...e),Oq=(...e)=>xt("cell",...e),Fq=(...e)=>xt("cellX",...e),Nq=(...e)=>xt("cellY",...e),Dq=(...e)=>xt("rect",...e),Lq=(...e)=>xt("rectX",...e),Rq=(...e)=>xt("rectY",...e),kq=(...e)=>xt("dot",...e),Cq=(...e)=>xt("dotX",...e),Uq=(...e)=>xt("dotY",...e),Pq=(...e)=>xt("circle",...e),$q=(...e)=>xt("hexagon",...e),zq=(...e)=>xt("text",...e),Vq=(...e)=>xt("textX",...e),jq=(...e)=>xt("textY",...e),qq=(...e)=>xt("ruleX",...e),Yq=(...e)=>xt("ruleY",...e),Wq=(...e)=>xt("tickX",...e),Gq=(...e)=>xt("tickY",...e),Xq=(...e)=>xt("vector",...e),Hq=(...e)=>xt("vectoX",...e),Zq=(...e)=>xt("vectorY",...e),Kq=(...e)=>xt("spike",...e),Qq=(...e)=>xt("image",...e),Jq=(...e)=>NN(ex,"areaX",...e),tY=(...e)=>NN(ex,"areaY",...e),eY=(...e)=>hd(UT,...e),rY=(...e)=>hd(VT,...e),nY=(...e)=>hd(jT,...e),iY=(...e)=>hd(cm,...e),oY=(...e)=>hd(YT,...e),sY=(...e)=>hd(qT,...e),aY=(...e)=>xt("hexgrid",...e),cY=(...e)=>hd(WT,...e),lY=(...e)=>xt("voronoi",...e),uY=(...e)=>xt("voronoiMesh",...e),fY=(...e)=>xt("delaunayLink",...e),dY=(...e)=>xt("delaunayMesh",...e),hY=(...e)=>xt("hull",...e),pY=(...e)=>xt("arrow",...e),mY=(...e)=>xt("link",...e),yY=(...e)=>xt("frame",...e),gY=(...e)=>xt("axisX",...e),bY=(...e)=>xt("axisY",...e),xY=(...e)=>xt("axisFx",...e),_Y=(...e)=>xt("axisFy",...e),wY=(...e)=>xt("gridX",...e),vY=(...e)=>xt("gridY",...e),SY=(...e)=>xt("gridFx",...e),IY=(...e)=>xt("gridFy",...e),TY=(...e)=>xt("geo",...e),AY=(...e)=>xt("sphere",...e),MY=(...e)=>xt("graticule",...e);var CN={};Qr(CN,{highlight:()=>DY,intervalX:()=>PY,intervalXY:()=>zY,intervalY:()=>$Y,nearestX:()=>CY,nearestY:()=>UY,pan:()=>VY,panX:()=>jY,panY:()=>qY,panZoom:()=>YY,panZoomX:()=>WY,panZoomY:()=>GY,toggle:()=>sx,toggleColor:()=>kY,toggleX:()=>LY,toggleY:()=>RY});function EY(e){let t=e.toLowerCase(),r=e.length,n="";for(let i=0;i<r;++i)n+=(e[i]!==t[i]?"-":"")+t[i];return n}function um(e){let t={};for(let r in e)t[EY(r)]=e[r];return t}var GT=class{constructor(t,{selection:r,channels:n={}}){this.mark=t,this.selection=r;let i=Object.entries(um(n));this.channels=i.length?i:[["opacity",.2]],this.selection.addEventListener("value",Sy(()=>this.update()))}init(t){this.svg=t;let r=this.values=[],n=this.mark.index,i=this.nodes=t.querySelectorAll(`[data-index="${n}"] > *`),{channels:o}=this;for(let s=0;s<i.length;++s){let a=i[s];r.push(o.map(c=>a.getAttribute(c[0])))}return this.update()}async update(){let{svg:t,nodes:r,channels:n,values:i,mark:o,selection:s}=this;if(!t)return;let a=await kut(o,s);for(let c=0;c<r.length;++c){let l=r[c],u=i[c],f=a(l.__data__);for(let d=0;d<n.length;++d){let[h,p]=n[d];l.setAttribute(h,f?u[d]:p)}}}};async function kut(e,t){let r=t?.predicate(e);if(!r||r.length===0)return()=>!0;let n={__:di(r)},i=e.query(e.filterBy?.predicate(e)),o=i.groupby().length?i.select(n):i.$select(n),s=await nn().query(o),a=s.getChild?.("__");return a?c=>a.get(c):c=>s[c].__}var fm=class{constructor(t,{selection:r,channels:n}){this.value=null,this.mark=t,this.selection=r,this.clients=new Set().add(t),this.channels=n.map(i=>{let o=i==="color"?["fill","stroke"]:i==="x"?["x","x1","x2"]:i==="y"?["y","y1","y2"]:[i];for(let s=0;s<o.length;++s){let a=t.channelField(o[s]);if(a)return{field:a.field?.basis||a.field,as:a.as}}throw new Error(`Missing channel: ${i}`)})}clause(t){let{channels:r,clients:n}=this,i=null;if(t){let o=t.map(s=>{let a=s.map((c,l)=>Vs(r[l].field,po(c)));return a.length>1?di(a):a[0]});i=o.length>1?Pd(o):o[0]}return{source:this,schema:{type:"point"},clients:n,value:t,predicate:i}}init(t,r,n){let{mark:i,channels:o,selection:s}=this,{data:a}=i;n=n||(l=>{let u=a[l.__data__];return o.map(f=>u[f.as])}),r=r||`[data-index="${i.index}"]`;let c=new Set(t.querySelectorAll(r));t.addEventListener("pointerdown",l=>{let u=s.single?s.value:this.value,f=l.target,d=null;if(Cut(c,f)){let h=n(f);l.shiftKey&&u?.length?(d=u.filter(p=>LN(p,h)),d.length===u.length&&d.push(h)):u?.length===1&&!LN(u[0],h)?d=null:d=[h]}this.value=d,Uut(u,d)&&s.update(this.clause(d))}),t.addEventListener("pointerenter",()=>{this.selection.activate(this.clause([this.channels.map(()=>0)]))})}};function Cut(e,t){return e.has(t)||e.has(t.parentNode)||e.has(t.parentNode?.parentNode)}function Uut(e,t){return e==null||t==null?e!=null||t!=null:e.length!==t.length||e.some((r,n)=>LN(r,t[n]))}function LN(e,t){let r=e.length;if(t.length!==r)return!0;for(let n=0;n<r;++n)if(e[n]!==t[n])return!0;return!1}function RN(e){let t=e.on,r=!0;function n(i){r=!1,i(),r=!0}return e.reset=(...i)=>{n(()=>e.clear(...i))},e.moveSilent=(...i)=>{n(()=>e.move(...i))},e.on=(...i)=>{if(i.length>1&&i[1]){let o=i[1];i[1]=(...s)=>r&&o(...s)}return t(...i)},e}function BY(){return RN(yB())}function OY(){return RN(pB())}function FY(){return RN(mB())}function rx(e,t){return e===t||e&&t&&Math.abs(e[0]-t[0])<1e-12&&Math.abs(e[1]-t[1])<1e-12||!1}function La(e,t){let r=e.channelField(t)?.field;return r?.basis||r}function nx(e,t,r=1){return t.invert(r*Math.floor(e/r))}function XT(){let e=this,t=e.getScreenCTM,r;e.getScreenCTM=()=>e.isConnected?r=t.call(e):r}var ix=class{constructor(t,{channel:r,selection:n,field:i,pixelSize:o=1,peers:s=!0,brush:a}){this.mark=t,this.channel=r,this.pixelSize=o||1,this.selection=n,this.peers=s,this.field=i||La(t,[r,r+"1",r+"2"]),this.style=a&&um(a),this.brush=r==="y"?FY():OY(),this.brush.on("brush end",({selection:c})=>this.publish(c))}reset(){this.value=void 0,this.g&&this.brush.reset(this.g)}activate(){this.selection.activate(this.clause(this.value||[0,1]))}publish(t){let r;t&&(r=t.map(n=>nx(n,this.scale,this.pixelSize)).sort((n,i)=>n-i)),rx(r,this.value)||(this.value=r,this.g.call(this.brush.moveSilent,t),this.selection.update(this.clause(r)))}clause(t){let{mark:r,pixelSize:n,field:i,scale:o}=this;return{source:this,schema:{type:"interval",pixelSize:n,scales:[o]},clients:this.peers?r.plot.markSet:new Set().add(r),value:t,predicate:t?tr(i,t):null}}init(t){let{brush:r,channel:n,style:i}=this;this.scale=t.scale(n);let o=t.scale("x").range,s=t.scale("y").range;r.extent([[Te(o),Te(s)],[ue(o),ue(s)]]);let a=ne(t).selectAll('g[aria-label="facet"]'),c=a.size()?a:ne(t);if(this.g=c.append("g").attr("class",`interval-${n}`).each(XT).call(r).call(r.moveSilent,this.value?.map(this.scale.apply)),i){let l=this.g.selectAll("rect.selection");for(let u in i)l.attr(u,i[u])}t.addEventListener("pointerenter",()=>this.activate())}};var HT=(e,t)=>e-t,ZT=class{constructor(t,{selection:r,xfield:n,yfield:i,pixelSize:o=1,peers:s=!0,brush:a}){this.mark=t,this.pixelSize=o||1,this.selection=r,this.peers=s,this.xfield=n||La(t,["x","x1","x2"]),this.yfield=i||La(t,["y","y1","y2"]),this.style=a&&um(a),this.brush=BY(),this.brush.on("brush end",({selection:c})=>this.publish(c))}reset(){this.value=void 0,this.g&&this.brush.reset(this.g)}activate(){this.selection.activate(this.clause(this.value||[[0,1],[0,1]]))}publish(t){let{value:r,pixelSize:n,xscale:i,yscale:o}=this,s,a;if(t){let[c,l]=t;s=[c[0],l[0]].map(u=>nx(u,i,n)).sort(HT),a=[c[1],l[1]].map(u=>nx(u,o,n)).sort(HT)}(!rx(s,r?.[0])||!rx(a,r?.[1]))&&(this.value=t?[s,a]:void 0,this.g.call(this.brush.moveSilent,t),this.selection.update(this.clause(this.value)))}clause(t){let{mark:r,pixelSize:n,xfield:i,yfield:o,xscale:s,yscale:a}=this;return{source:this,schema:{type:"interval",pixelSize:n,scales:[s,a]},clients:this.peers?r.plot.markSet:new Set().add(r),value:t,predicate:t?di(tr(i,t[0]),tr(o,t[1])):null}}init(t){let{brush:r,style:n}=this,i=this.xscale=t.scale("x"),o=this.yscale=t.scale("y"),s=i.range,a=o.range;r.extent([[Te(s),Te(a)],[ue(s),ue(a)]]);let c=ne(t).selectAll('g[aria-label="facet"]'),l=c.size()?c:ne(t);if(this.g=l.append("g").attr("class","interval-xy").each(XT).call(r),n){let u=this.g.selectAll("rect.selection");for(let f in n)u.attr(f,n[f])}if(this.value){let[u,f]=this.value[0].map(i.apply).sort(HT),[d,h]=this.value[1].map(o.apply).sort(HT);this.g.call(r.moveSilent,[[u,d],[f,h]])}t.addEventListener("pointerenter",()=>this.activate())}};var NY=(e,t)=>e-t,KT=class{constructor(t,{x:r=new gi,y:n=new gi,xfield:i,yfield:o,zoom:s=!0,panx:a=!0,pany:c=!0}){this.mark=t,this.xsel=r,this.ysel=n,this.xfield=i||La(t,["x","x1","x2"]),this.yfield=o||La(t,["y","y1","y2"]),this.zoom=kN(s,[0,1/0],[1,1]),this.panx=this.xsel&&a,this.pany=this.ysel&&c;let{plot:l}=t;a&&this.xsel.addEventListener("value",u=>{l.setAttribute("xDomain",u)&&l.update()}),c&&this.ysel.addEventListener("value",u=>{l.setAttribute("yDomain",u)&&l.update()})}publish(t){if(this.panx){let r=Put(t,this.xscale);this.xsel.update(this.clause(r,this.xfield,this.xscale))}if(this.pany){let r=$ut(t,this.yscale);this.ysel.update(this.clause(r,this.yfield,this.yscale))}}clause(t,r,n){return{source:this,schema:{type:"interval",scales:[n]},clients:this.mark.plot.markSet,value:t,predicate:t?tr(r,t):null}}init(t){if(this.svg=t,this.initialized)return;this.initialized=!0;let{panx:r,pany:n,mark:{plot:{element:i}},xsel:o,ysel:s}=this;this.xscale=t.scale("x"),this.yscale=t.scale("y");let a=this.xscale.range.slice().sort(NY),c=this.yscale.range.slice().sort(NY),l=kN(r,[-1/0,1/0],a),u=kN(n,[-1/0,1/0],c),f=DO().extent([[a[0],c[0]],[a[1],c[1]]]).scaleExtent(this.zoom).translateExtent([[l[0],u[0]],[l[1],u[1]]]).on("start",()=>{this.xscale=this.svg.scale("x"),this.yscale=this.svg.scale("y")}).on("end",()=>i.__zoom=new Hi(1,0,0)).on("zoom",({transform:d})=>this.publish(d));if(ne(i).call(f),r||n){let d=!1;i.addEventListener("mouseenter",()=>{if(!d){if(d=!0,r){let{xscale:h,xfield:p}=this;o.activate(this.clause(h.domain,p,h))}if(n){let{yscale:h,yfield:p}=this;s.activate(this.clause(h.domain,p,h))}}}),i.addEventListener("mouseleave",()=>d=!1)}}};function kN(e,t,r){return e?Array.isArray(e)?e:t:r}function Put(e,t){return t.range.map(e.invertX,e).map(t.invert,t)}function $ut(e,t){return t.range.map(e.invertY,e).map(t.invert,t)}var ox=class{constructor(t,{selection:r,channel:n,field:i}){this.mark=t,this.selection=r,this.clients=new Set().add(t),this.channel=n,this.field=i||La(t,[n])}clause(t){let{clients:r,field:n}=this,i=t?Vs(n,po(t)):null;return{source:this,schema:{type:"point"},clients:r,value:t,predicate:i}}init(t){let r=this,{mark:n,channel:i,selection:o}=this,{data:s}=n,a=n.channelField(i).as,c=ne(t).selectAll('g[aria-label="facet"]'),l=c.size()?c:ne(t),u=t.scale(i),f=!yo(o);l.on("pointerdown pointermove",function(d){let[h,p]=Sn(d,this),m=zut(s,a,u.invert(i==="x"?h:p));o.update(f?m:r.clause(m))}),!f&&t.addEventListener("pointerenter",()=>{this.selection.activate(this.clause(0))})}};function zut(e,t,r){let n=1/0,i;return e.forEach(o=>{let s=Math.abs(o[t]-r);s<n&&(n=s,i=o[t])}),i}function Tu(e,t){return r=>{let n=r.marks[r.marks.length-1];r.addInteractor(new e(n,t))}}function DY({by:e,...t}){return Tu(GT,{selection:e,channels:t})}function sx({as:e,...t}){return Tu(fm,{...t,selection:e})}function LY({as:e}){return sx({as:e,channels:["x"]})}function RY({as:e}){return sx({as:e,channels:["y"]})}function kY({as:e}){return sx({as:e,channels:["color"]})}function CY({as:e,...t}){return Tu(ox,{...t,selection:e,channel:"x"})}function UY({as:e,...t}){return Tu(ox,{...t,selection:e,channel:"y"})}function PY({as:e,...t}){return Tu(ix,{...t,selection:e,channel:"x"})}function $Y({as:e,...t}){return Tu(ix,{...t,selection:e,channel:"y"})}function zY({as:e,...t}){return Tu(ZT,{...t,selection:e})}function dm(e){return Tu(KT,e)}function VY(e={}){return dm({...e,zoom:!1})}function jY(e={}){return dm({...e,zoom:!1,pany:!1})}function qY(e={}){return dm({...e,zoom:!1,panx:!1})}function YY(e={}){return dm(e)}function WY(e={}){return dm({...e,pany:!1})}function GY(e={}){return dm({...e,panx:!1})}var PN={};Qr(PN,{colorLegend:()=>XY,opacityLegend:()=>HY,symbolLegend:()=>ZY});var ax=class{constructor(t,r){let{as:n,...i}=r;this.channel=t,this.options={label:null,...i},this.selection=n,this.element=document.createElement("div"),this.element.setAttribute("class","legend"),this.element.value=this}setPlot(t){let{channel:r,selection:n}=this,i=Vut(t,r);this.selection&&i&&(this.handler=new fm(i,{selection:n,channels:[r]}),this.selection.addEventListener("value",()=>this.update()))}init(t){let{channel:r,options:n,handler:i}=this,s=t.scale(r).type==="ordinal"?n:{marginTop:1,tickSize:2,height:28,...n};return this.legend=t.legend(r,s),i&&(i.init(this.legend,":scope > div",a=>[a.__data__]),this.update()),this.element.replaceChildren(this.legend),this.element}update(){if(!this.legend)return;let{value:t}=this.selection,r=t&&t.length?new Set(t.map(i=>i[0])):null,n=this.legend.querySelectorAll(":scope > div");for(let i of n){let o=r?r.has(i.__data__):!0;i.style.opacity=o?1:.2}}};function Vut({marks:e},t){let r=t==="color"?["fill","stroke"]:t==="opacity"?["opacity","fillOpacity","strokeOpacity"]:null;if(r==null)return null;for(let n=e.length-1;n>-1;--n)if(e[n].channelField(r))return e[n];return null}function UN(e,t={}){if(t.for){let{for:r,...n}=t,i=new ax(e,n),o=typeof r,s=a=>a.addLegend(i,!1);return o==="string"?om.request(r,s):r.value&&s(r.value),i.element}else return r=>r.addLegend(new ax(e,t))}var XY=e=>UN("color",e),HY=e=>UN("opacity",e),ZY=e=>UN("symbol",e);function KY({direction:e="vertical",wrap:t=!1},r){let n=document.createElement("div");return n.style.display="flex",n.style.flexDirection=e==="vertical"?"column":"row",n.style.flexWrap=t?t===!0?"wrap":t:"nowrap",n.style.justifyContent="flex-start",n.style.alignItems="flex-start",r.forEach(i=>n.appendChild(i)),n.value={element:n},n}function QT(...e){return KY({direction:"vertical"},e.flat())}function JT(...e){return KY({direction:"horizontal"},e.flat())}function QY({dim:e="width",size:t=10}){let r=document.createElement("span");r.style.display="inline-block",r.style[e]=Number.isNaN(+t)?t:`${t}px`;let n={element:r};return r.value=n,r}function tA(e){return QY({dim:"height",size:e})}function eA(e){return QY({dim:"width",size:e})}function $N(e){return e}function rA(e){if(e==null)return $N;var t,r,n=e.scale[0],i=e.scale[1],o=e.translate[0],s=e.translate[1];return function(a,c){c||(t=r=0);var l=2,u=a.length,f=new Array(u);for(f[0]=(t+=a[0])*n+o,f[1]=(r+=a[1])*i+s;l<u;)f[l]=a[l],++l;return f}}function JY(e,t){for(var r,n=e.length,i=n-t;i<--n;)r=e[i],e[i++]=e[n],e[n]=r}function zN(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(r){return tW(e,r)})}:tW(e,t)}function tW(e,t){var r=t.id,n=t.bbox,i=t.properties==null?{}:t.properties,o=nA(e,t);return r==null&&n==null?{type:"Feature",properties:i,geometry:o}:n==null?{type:"Feature",id:r,properties:i,geometry:o}:{type:"Feature",id:r,bbox:n,properties:i,geometry:o}}function nA(e,t){var r=rA(e.transform),n=e.arcs;function i(u,f){f.length&&f.pop();for(var d=n[u<0?~u:u],h=0,p=d.length;h<p;++h)f.push(r(d[h],h));u<0&&JY(f,p)}function o(u){return r(u)}function s(u){for(var f=[],d=0,h=u.length;d<h;++d)i(u[d],f);return f.length<2&&f.push(f[0]),f}function a(u){for(var f=s(u);f.length<4;)f.push(f[0]);return f}function c(u){return u.map(a)}function l(u){var f=u.type,d;switch(f){case"GeometryCollection":return{type:f,geometries:u.geometries.map(l)};case"Point":d=o(u.coordinates);break;case"MultiPoint":d=u.coordinates.map(o);break;case"LineString":d=s(u.arcs);break;case"MultiLineString":d=u.arcs.map(s);break;case"Polygon":d=c(u.arcs);break;case"MultiPolygon":d=u.arcs.map(c);break;default:return null}return{type:f,coordinates:d}}return l(t)}function VN(e,t){var r={},n={},i={},o=[],s=-1;t.forEach(function(l,u){var f=e.arcs[l<0?~l:l],d;f.length<3&&!f[1][0]&&!f[1][1]&&(d=t[++s],t[s]=l,t[u]=d)}),t.forEach(function(l){var u=a(l),f=u[0],d=u[1],h,p;if(h=i[f])if(delete i[h.end],h.push(l),h.end=d,p=n[d]){delete n[p.start];var m=p===h?h:h.concat(p);n[m.start=h.start]=i[m.end=p.end]=m}else n[h.start]=i[h.end]=h;else if(h=n[d])if(delete n[h.start],h.unshift(l),h.start=f,p=i[f]){delete i[p.end];var g=p===h?h:p.concat(h);n[g.start=p.start]=i[g.end=h.end]=g}else n[h.start]=i[h.end]=h;else h=[l],n[h.start=f]=i[h.end=d]=h});function a(l){var u=e.arcs[l<0?~l:l],f=u[0],d;return e.transform?(d=[0,0],u.forEach(function(h){d[0]+=h[0],d[1]+=h[1]})):d=u[u.length-1],l<0?[d,f]:[f,d]}function c(l,u){for(var f in l){var d=l[f];delete u[d.start],delete d.start,delete d.end,d.forEach(function(h){r[h<0?~h:h]=1}),o.push(d)}}return c(i,n),c(n,i),t.forEach(function(l){r[l<0?~l:l]||o.push([l])}),o}function jN(e){return nA(e,eW.apply(this,arguments))}function eW(e,t,r){var n,i,o;if(arguments.length>1)n=jut(e,t,r);else for(i=0,n=new Array(o=e.arcs.length);i<o;++i)n[i]=i;return{type:"MultiLineString",arcs:VN(e,n)}}function jut(e,t,r){var n=[],i=[],o;function s(f){var d=f<0?~f:f;(i[d]||(i[d]=[])).push({i:f,g:o})}function a(f){f.forEach(s)}function c(f){f.forEach(a)}function l(f){f.forEach(c)}function u(f){switch(o=f,f.type){case"GeometryCollection":f.geometries.forEach(u);break;case"LineString":a(f.arcs);break;case"MultiLineString":case"Polygon":c(f.arcs);break;case"MultiPolygon":l(f.arcs);break}}return u(t),i.forEach(r==null?function(f){n.push(f[0].i)}:function(f){r(f[0].g,f[f.length-1].g)&&n.push(f[0].i)}),n}function iA(e){let t=typeof e;return t==="object"?e?.param:t==="string"?Wut(e):null}function Wut(e){return e?.[0]==="$"?e.slice(1):null}function Au(e){return[e].flat()}function io(e){return Array.isArray(e)}function hm(e){return e!==null&&typeof e=="object"&&!io(e)}function pm(e){let t=typeof e;return t==="number"||t==="string"}function Ur(e){return typeof e=="string"}function ko(e){return typeof e=="function"}function pr(e,t){throw Object.assign(Error(e),{data:t})}function oA(e,t,r){t=Gut(t,r);let n=r.dataFormats.get(t.type);if(n)return n(e,t,r);pr("Unrecognized data format type.",t)}function Gut(e,t){return io(e)&&(e={type:"json",data:e}),Ur(e)&&(e={type:"table",query:e}),{...e,type:Xut(e),file:Zut(e,t)}}function Xut(e){return e.type||Hut(e.file)||"table"}function Hut(e){let t=e?.lastIndexOf(".");return t>0?e.slice(t+1):null}function Zut({file:e},t){return e&&t.baseURL?new URL(e,t.baseURL).toString():e}function rW(e,t){let{query:r,type:n,...i}=t;if(r)return xl(e,r,i)}function nW(e,t){let{file:r,type:n,...i}=t;return a1(e,r,i)}function iW(e,t){let{file:r,type:n,...i}=t;return o1(e,r,i)}function oW(e,t){let{data:r,file:n,type:i,...o}=t;return r?c1(e,r,o):s1(e,n,o)}var Kut={menu:jw,search:Yw,slider:Gw,table:Zw},Qut=new Map([["intersect",()=>gi.intersect()],["crossfilter",()=>gi.crossfilter()],["union",()=>gi.union()],["single",()=>gi.single()],["value",({date:e,value:t},r)=>Array.isArray(t)?ts.array(t.map(n=>r.maybeParam(n))):ts.value(pf(e,t))]]),Jut=new Map([["plot",{type:io,parse:aW}],["mark",{type:Ur,parse:yft}],["legend",{type:Ur,parse:cW}],["hconcat",{type:io,parse:mft}],["vconcat",{type:io,parse:pft}],["hspace",{type:pm,parse:fft}],["vspace",{type:pm,parse:dft}],["input",{type:Ur,parse:hft}]]),tft=new Map([["csv",iW],["json",oW],["geojson",cft],["topojson",lft],["parquet",nW],["table",rW]]),eft=new Map([["avg",H_],["bin",wg],["count",hi],["dateMonth",t1],["dateMonthDay",e1],["dateDay",r1],["bin",wg],["max",Ri],["median",Z_],["min",ki],["mode",Q_],["quantile",K_],["sum",pi],["row_number",U_],["rank",P_],["dense_rank",$_],["percent_rank",z_],["cume_dist",V_],["ntile",j_],["lag",q_],["lead",Y_],["first_value",W_],["last_value",G_],["nth_value",X_]]),rft=new Map(Object.entries(DN)),nft=new Map(Object.entries(Kut)),ift=new Map(Object.entries(PN)),oft=new Map(Object.entries(IN)),sft=new Map(Object.entries(CN));function aft(e,t){return e=Ur(e)?JSON.parse(e):e,new mm(t).parse(e)}var mm=class{constructor({specParsers:t=Jut,paramParsers:r=Qut,dataFormats:n=tft,transforms:i=eft,attributes:o=oft,interactors:s=sft,legends:a=ift,inputs:c=nft,marks:l=rft,params:u=[],datasets:f=[],baseURL:d=null}={}){this.specParsers=t,this.paramParsers=r,this.dataFormats=n,this.transforms=i,this.attributes=o,this.interactors=s,this.legends=a,this.inputs=c,this.marks=l,this.params=new Map(u),this.datasets=new Map(f),this.baseURL=d,this.postQueue=[]}after(t){this.postQueue.push(t)}maybeParam(t,r=()=>ts.value()){let{params:n}=this,i=iA(t);if(i){if(n.has(i))return n.get(i);{let o=r();return n.set(i,o),o}}return t}maybeSelection(t){return this.maybeParam(t,()=>gi.intersect())}maybeTransform(t){if(hm(t))return t.expr?vft(t,this):Sft(t,this)}async parse(t){let{meta:r,data:n={},plotDefaults:i={},params:o,...s}=t;for(let c in n){let l=await oA(c,n[c],this);l?.data?this.datasets.set(c,l.data):l&&await nn().exec(l)}this.plotDefaults=Object.keys(i).map(c=>lW(i,c,this));for(let c in o)this.params.set(c,uft(o[c],this));let a=qN(s,this);return this.postQueue.forEach(c=>c()),this.postQueue=[],this.plotDefaults={},a}};async function sW(e){let{data:t,file:r}=e;return t||await fetch(r).then(n=>n.json())}async function cft(e,t){return{data:await sW(t)}}async function lft(e,t){let r=await sW(t),n;if(t.feature)n=zN(r,r.objects[t.feature]);else{let i=t.mesh?r.objects[t.mesh]:void 0,o={interior:(s,a)=>s!==a,exterior:(s,a)=>s===a}[t.filter];n=jN(r,i,o)}return{data:n&&n.features||[n]}}function uft(e,t){e=hm(e)?e:{value:e};let{select:r="value"}=e,n=t.paramParsers.get(r);return n||pr(`Unrecognized param type: ${r}`,e),n(e,t)}function qN(e,t){for(let[r,{type:n,parse:i}]of t.specParsers){let o=e[r];if(o!=null){if(n(o))return i(e,t);pr(`Invalid property type: ${r}`,e)}}pr("Invalid specification.",e)}function fft(e){return eA(e.hspace)}function dft(e){return tA(e.vspace)}function hft(e,t){let{input:r,...n}=e,i=t.inputs.get(r);ko(i)||pr(`Unrecognized input: ${r}`,e);for(let o in n)n[o]=t.maybeSelection(n[o]);return i(n)}function pft(e,t){return QT(e.vconcat.map(r=>qN(r,t)))}function mft(e,t){return JT(e.hconcat.map(r=>qN(r,t)))}function aW(e,t){let{plot:r,...n}=e,i=t.plotDefaults.concat(Object.keys(n).map(s=>lW(e,s,t))),o=r.map(s=>gft(s,t));return vN(i,o)}function yft(e,t){return aW({plot:[e]},t)}function cW(e,t){let{legend:r,...n}=e,i=`${r}Legend`,o=t.legends.get(i);ko(o)||pr(`Unrecognized legend type: ${r}`,e);for(let s in n)n[s]=t.maybeSelection(n[s]);return o(n)}function lW(e,t,r){let n=r.attributes.get(t);ko(n)||pr(`Unrecognized attribute: ${t}`,e);let i=e[t],o=i==="Fixed"?mf:r.maybeParam(i);return n(o)}function gft(e,t){return Ur(e.mark)?bft(e,t):Ur(e.legend)?cW(e,t):Ur(e.select)?wft(e,t):pr("Invalid plot entry.",e)}function bft(e,t){let{mark:r,data:n,...i}=e,o=t.marks.get(r);ko(o)||pr(`Unrecognized mark type: ${r}`,e);let s=xft(n,t);for(let a in i)i[a]=_ft(i[a],t);return s?o(s,i):o(i)}function xft(e,t){if(!e)return null;if(io(e))return e;let{from:r,...n}=e;if(t.datasets.has(r))return t.datasets.get(r);for(let i in n)n[i]=t.maybeSelection(n[i]);return TN(r,n)}function _ft(e,t){return t.maybeTransform(e)||t.maybeParam(e)}function wft(e,t){let{select:r,...n}=e,i=t.interactors.get(r);ko(i)||pr(`Unrecognized interactor type: ${r}`,e);for(let o in n)n[o]=t.maybeSelection(n[o]);return i(n)}function vft(e,t){let{expr:r,label:n}=e,i=r.split(/(\\'|\\"|"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|\$\w+)/g),o=[""],s=[];for(let a=0,c=0;a<i.length;++a){let l=i[a];l.startsWith("$")?(s[c]=t.maybeParam(l),o[++c]=""):o[c]+=l}return Y(o,...s).annotate({label:n})}function Sft(e,t){let{transforms:r}=t,n;for(let a in e)r.has(a)&&(n=a);if(!n)return;let i=r.get(n),o=n==="count"||n==null?[]:Au(e[n]),s=i(...o);if(e.distinct&&(s=s.distinct()),e.order){let a=Au(e.order).map(c=>t.maybeParam(c));s=s.orderby(a)}if(e.partition){let a=Au(e.partition).map(c=>t.maybeParam(c));s=s.partitionby(a)}return e.rows?s=s.rows(t.maybeParam(e.rows)):e.range&&(s=s.range(t.maybeParam(e.range))),s}var uW="https://cdn.jsdelivr.net/npm/topojson@3.0.2/+esm",Ift=new Map([["plot",{type:io,parse:dW}],["mark",{type:Ur,parse:zft}],["legend",{type:Ur,parse:hW}],["hconcat",{type:io,parse:$ft}],["vconcat",{type:io,parse:Pft}],["hspace",{type:pm,parse:kft}],["vspace",{type:pm,parse:Cft}],["input",{type:Ur,parse:Uft}]]),Tft=new Map([["csv",Nft],["json",Dft],["geojson",Lft],["topojson",Rft],["parquet",Fft],["table",Oft]]);function Aft(e,t){return e=Ur(e)?JSON.parse(e):e,new YN(t).generate(e)}function sA(e){return e?.length?[""]:[]}var YN=class extends mm{constructor(t){super({specParsers:Ift,dataFormats:Tft,...t}),this.imports=t?.imports||new Map([["@uwdata/vgplot","* as vg"]]),this.depth=0}async generate(t){let{meta:r,data:n={},plotDefaults:i={},params:o,...s}=t,a=await Promise.all(Object.keys(n).flatMap(h=>{let p=oA(h,n[h],this);return p?p.data?`const ${h} = ${p.data};`:`await vg.coordinator().exec(
  ${p}
);`:[]})),c=Object.keys(i).map(h=>pW(i,h,this)),l=[];c.length&&(this.plotDefaults="defaultAttributes",l=["const defaultAttributes = [",c.map(h=>"  "+h).join(`,
`),"];"]);for(let h in o)this.params.set(`$${h}`,Bft(o[h],this));let u=[`export default ${GN(s,this)};`],f=[];for(let[h,p]of this.params)f.push(`const ${h} = ${p};`);let d=[];for(let[h,p]of this.imports)d.push(Ur(p)?`import ${p} from "${h}";`:`import { ${p.join(", ")} } from "${h}";`);return[...d,...sA(d),...a,...sA(a),...f,...sA(f),...l,...sA(l),...u].join(`
`)}addImport(t,r){this.imports.has(t)||this.imports.set(t,[]),this.imports.get(t).push(r)}setImports(t,r){this.imports.set(t,r)}maybeParam(t,r="vg.Param.value()"){let{params:n}=this,i=iA(t);if(i){let o=`$${i}`;return n.has(o)||n.set(o,r),o}return JSON.stringify(t)}maybeSelection(t){return this.maybeParam(t,"vg.Selection.intersect()")}maybeTransform(t){if(hm(t))return t.expr?Mft(t,this):Eft(t,this)}indent(){this.depth+=1}undent(){this.depth-=1}tab(){return Array.from({length:this.depth},()=>"  ").join("")}};function Mft(e,t){let{expr:r,label:n}=e,i=r.split(/(\\'|\\"|"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|\$\w+)/g),o="";for(let s=0;s<i.length;++s){let a=i[s];a.startsWith("$")?o+=`\${${t.maybeParam(a)}}`:o+=a}return`vg.sql\`${o}\``+(n?`.annotate({ label: ${JSON.stringify(n)} })`:"")}function Eft(e,t){let{transforms:r}=t,n;for(let s in e)r.has(s)&&(n=s);if(!n)return;let i=n==="count"||n==null?[]:Au(e[n]),o=`vg.${n}(`+i.map(s=>t.maybeParam(s)).join(", ")+")";if(e.distinct&&(o+=".distinct()"),e.order){let s=Au(e.order).map(a=>t.maybeParam(a));o+=`.orderby(${s.join(", ")})`}if(e.partition){let s=Au(e.partition).map(a=>t.maybeParam(a));o+=`.partitionby(${s.join(", ")})`}return e.rows?o+=`.rows(${t.maybeParam(e.rows)})`:e.range&&(o+=`.range(${t.maybeParam(e.rows)})`),o}function Bft(e,t){e=hm(e)?e:{value:e};let{select:r="value"}=e;if(t.paramParsers.get(r)||pr(`Unrecognized param type: ${r}`,e),r==="value"){let{value:i,date:o}=e;return Array.isArray(i)?`vg.Param.array([${i.map(s=>t.maybeParam(s)).join(", ")}])`:o?`vg.Param.value(new Date(${JSON.stringify(o)}))`:`vg.Param.value(${JSON.stringify(i)})`}else return`vg.Selection.${r}()`}function WN(e){let t=[];for(let r in e)t.push(`${r}: ${JSON.stringify(e[r])}`);return t.length?`, { ${t.join(", ")} }`:""}function Oft(e,t){let{query:r,type:n,...i}=t;if(r)return`\`${xl(e,r,i)}\``}function Fft(e,t){let{file:r,type:n,...i}=t;return`vg.loadParquet("${e}", "${r}"${WN(i)})`}function Nft(e,t){let{file:r,type:n,...i}=t;return`vg.loadCSV("${e}", "${r}"${WN(i)})`}function Dft(e,t){let{data:r,file:n,type:i,...o}=t,s=WN(o);if(r){let a=`[
    `+r.map(c=>JSON.stringify(c)).join(`,
    `)+`
  ]`;return`vg.loadObjects("${e}", ${a}${s})`}else return`vg.loadCSV("${e}", "${n}"${s})`}function fW(e){let{data:t,file:r}=e;return t?JSON.stringify(t):`await fetch("${r}")
  .then(r => r.json())`}function Lft(e,t,r){return r.datasets.set(e,e),{data:fW(t)}}function Rft(e,t,r){r.datasets.set(e,e);let n=fW(t),i;if(t.feature){r.addImport(uW,"feature");let o=`json.objects['${t.feature}']`;i=n+`
  .then(json => feature(json, ${o}).features)`}else{r.addImport(uW,"mesh");let o=t.mesh?`json.objects['${t.mesh}']`:"undefined",s=t.filter==="interior"?", (a, b) => a !== b":t.filter==="exterior"?", (a, b) => a === b":"";i=n+`
  .then(json => [mesh(json, ${o}${s})])`}return{data:i}}function GN(e,t){for(let[r,{type:n,parse:i}]of t.specParsers){let o=e[r];if(o!=null){if(n(o))return i(e,t);pr(`Invalid property type: ${r}`,e)}}pr("Invalid specification.",e)}function kft(e,t){return`${t.tab()}vg.hspace(${e.hspace})`}function Cft(e,t){return`${t.tab()}vg.vspace(${e.vspace})`}function Uft(e,t){let{input:r,...n}=e,i=t.inputs.get(r);ko(i)||pr(`Unrecognized input: ${r}`,e);let o=[];for(let s in n)o.push(`${s}: ${t.maybeSelection(n[s])}`);return`${t.tab()}vg.${r}({ ${o.join(", ")} })`}function Pft(e,t){t.indent();let r=e.vconcat.map(n=>GN(n,t));return t.undent(),`${t.tab()}vg.vconcat(
${r.join(`,
`)}
${t.tab()})`}function $ft(e,t){t.indent();let r=e.hconcat.map(n=>GN(n,t));return t.undent(),`${t.tab()}vg.hconcat(
${r.join(`,
`)}
${t.tab()})`}function dW(e,t){let{plot:r,...n}=e;t.indent();let i=[...t.plotDefaults?[`${t.tab()}...defaultAttributes`]:[],...Object.keys(n).map(a=>pW(e,a,t))],s=r.map(a=>Vft(a,t)).concat(i);return t.undent(),`${t.tab()}vg.plot(
${s.join(`,
`)}
${t.tab()})`}function zft(e,t){return dW({plot:[e]},t)}function hW(e,t){let{legend:r,...n}=e,i=`${r}Legend`;ko(t.legends.get(i))||pr(`Unrecognized legend type: ${r}`,e);let o=[];for(let s in n)o.push(`${s}: ${t.maybeSelection(n[s])}`);return`${t.tab()}vg.${i}({ ${o.join(", ")} })`}function pW(e,t,r){let n=r.attributes.get(t);ko(n)||pr(`Unrecognized attribute: ${t}`,e);let i=e[t],o=i==="Fixed"?"vg.Fixed":r.maybeParam(i);return`${r.tab()}vg.${t}(${o})`}function Vft(e,t){return Ur(e.mark)?jft(e,t):Ur(e.legend)?hW(e,t):Ur(e.select)?Wft(e,t):pr("Invalid plot entry.",e)}function jft(e,t){let{mark:r,data:n,...i}=e;ko(t.marks.get(r))||pr(`Unrecognized mark type: ${r}`,e);let o=qft(n,t),s=[];for(let u in i)s.push(`${u}: ${Yft(i[u],t)}`);let a=o||"",c=s.length?`{ ${s.join(", ")} }`:"",l=`${a}${c}`;return a&&c&&(t.indent(),l=`
${t.tab()}${a},
${t.tab()}${c}
`,t.undent(),l+=t.tab()),`${t.tab()}vg.${r}(${l})`}function qft(e,t){if(!e)return null;if(io(e))return JSON.stringify(e);let{from:r,...n}=e;if(t.datasets.has(r))return t.datasets.get(r);{let i=[];for(let s in n)i.push(`${s}: ${t.maybeSelection(n[s])}`);let o=i.length?`, { ${i.join(", ")} }`:"";return`vg.from("${r}"${o})`}}function Yft(e,t){return t.maybeTransform(e)||t.maybeParam(e)}function Wft(e,t){let{select:r,...n}=e;ko(t.interactors.get(r))||pr(`Unrecognized interactor type: ${r}`,e);let i=[];for(let o in n)i.push(`${o}: ${t.maybeSelection(n[o])}`);return`${t.tab()}vg.${r}({ ${i.join(", ")} })`}export{vy as Coordinator,mf as Fixed,ei as Mark,mi as MosaicClient,ts as Param,mm as ParseContext,Qb as Plot,yt as Query,gi as Selection,X6 as agg,Z9 as align,di as and,vq as area,Sq as areaX,Iq as areaY,xy as argmax,by as argmin,cL as arrayAgg,pY as arrow,K9 as aspectRatio,SN as attribute,LT as attributes,H_ as avg,Q9 as axis,xY as axisFx,_Y as axisFy,gY as axisX,bY as axisY,Eq as barX,Bq as barY,wg as bin,J_ as cast,_y as castDouble,lL as castInteger,Oq as cell,Fq as cellX,Nq as cellY,Pq as circle,_j as colorClamp,bj as colorDomain,Sj as colorInterpolate,Aj as colorLabel,XY as colorLegend,wj as colorNice,Ij as colorPivot,xj as colorRange,Mj as colorReverse,gj as colorScale,vj as colorScheme,Tj as colorSymmetric,Bj as colorTickFormat,Ej as colorZero,Wu as column,nY as contour,nn as coordinator,iL as corr,hi as count,oL as covarPop,V_ as cume_dist,r1 as dateDay,t1 as dateMonth,e1 as dateMonthDay,fY as delaunayLink,dY as delaunayMesh,rY as denseLine,$_ as dense_rank,eY as density,Jq as densityX,tY as densityY,kq as dot,Cq as dotX,Uq as dotY,eL as entropy,Vs as eq,mV as facetGrid,yV as facetLabel,uV as facetMargin,dV as facetMarginBottom,hV as facetMarginLeft,pV as facetMarginRight,fV as facetMarginTop,W_ as first_value,yY as frame,TN as from,IV as fxAlign,VV as fxAriaDescription,zV as fxAriaLabel,EV as fxAxis,gV as fxDomain,$V as fxFontVariant,RV as fxGrid,_V as fxInset,wV as fxInsetLeft,vV as fxInsetRight,CV as fxLabel,UV as fxLabelAnchor,PV as fxLabelOffset,kV as fxLine,xV as fxNice,TV as fxPadding,AV as fxPaddingInner,MV as fxPaddingOuter,bV as fxRange,jV as fxReverse,SV as fxRound,DV as fxTickFormat,NV as fxTickPadding,LV as fxTickRotate,OV as fxTickSize,FV as fxTickSpacing,BV as fxTicks,KV as fyAlign,mj as fyAriaDescription,pj as fyAriaLabel,ej as fyAxis,qV as fyDomain,hj as fyFontVariant,cj as fyGrid,GV as fyInset,HV as fyInsetBottom,XV as fyInsetTop,uj as fyLabel,fj as fyLabelAnchor,dj as fyLabelOffset,lj as fyLine,WV as fyNice,QV as fyPadding,JV as fyPaddingInner,tj as fyPaddingOuter,YV as fyRange,yj as fyReverse,ZV as fyRound,sj as fyTickFormat,oj as fyTickPadding,aj as fyTickRotate,nj as fyTickSize,ij as fyTickSpacing,rj as fyTicks,TY as geo,MY as graticule,tz as grid,SY as gridFx,IY as gridFy,wY as gridX,vY as gridY,zd as gt,z6 as gte,JT as hconcat,q9 as height,$q as hexagon,sY as hexbin,aY as hexgrid,DY as highlight,eA as hspace,hY as hull,Qq as image,J9 as inset,PY as intervalX,zY as intervalXY,$Y as intervalY,tr as isBetween,V6 as isDistinct,Y6 as isNotBetween,j6 as isNotDistinct,ml as isNotNull,$d as isNull,tL as kurtosis,ez as label,q_ as lag,sL as last,G_ as last_value,Y_ as lead,Xj as lengthClamp,Wj as lengthDomain,Hj as lengthNice,Gj as lengthRange,Yj as lengthScale,Zj as lengthZero,Tq as line,Aq as lineX,Mq as lineY,mY as link,po as literal,o1 as loadCSV,s1 as loadJSON,c1 as loadObjects,a1 as loadParquet,gl as lt,bl as lte,H6 as mad,Y9 as margin,H9 as marginBottom,W9 as marginLeft,G9 as marginRight,X9 as marginTop,$9 as margins,Ri as max,Z_ as median,jw as menu,ki as min,Q_ as mode,U9 as name,om as namedPlots,CY as nearestX,UY as nearestY,C_ as neq,P6 as not,X_ as nth_value,j_ as ntile,Dj as opacityClamp,Fj as opacityDomain,Rj as opacityLabel,HY as opacityLegend,Lj as opacityNice,Nj as opacityRange,kj as opacityReverse,Oj as opacityScale,Uj as opacityTickFormat,Cj as opacityZero,Pd as or,rz as padding,VY as pan,jY as panX,qY as panY,YY as panZoom,WY as panZoomX,GY as panZoomY,aft as parseSpec,z_ as percent_rank,vN as plot,Z6 as product,aq as projectionClip,eq as projectionDomain,rq as projectionInset,sq as projectionInsetBottom,nq as projectionInsetLeft,iq as projectionInsetRight,oq as projectionInsetTop,Qj as projectionParallels,Jj as projectionPrecision,tq as projectionRotate,Kj as projectionType,K_ as quantile,Vj as rClamp,$j as rDomain,jj as rNice,zj as rRange,Pj as rScale,qj as rZero,P_ as rank,iY as raster,oY as rasterTile,Dq as rect,Lq as rectX,Rq as rectY,cY as regressionY,out as reset,TL as restConnector,nz as round,U_ as row_number,qq as ruleX,Yq as ruleY,Yw as search,J6 as skewness,Gw as slider,R_ as socketConnector,Aft as specToModule,AY as sphere,Kq as spike,Y as sql,Q6 as stddev,nL as stddevPop,aL as stringAgg,V9 as style,pi as sum,ZY as symbolLegend,Zw as table,zq as text,Vq as textX,jq as textY,Wq as tickX,Gq as tickY,sx as toggle,kY as toggleColor,LY as toggleX,RY as toggleY,rL as varPop,K6 as variance,QT as vconcat,Xq as vector,Hq as vectorX,Zq as vectorY,lY as voronoi,uY as voronoiMesh,tA as vspace,yR as wasmConnector,j9 as width,hz as xAlign,Fz as xAriaDescription,Oz as xAriaLabel,gz as xAxis,fz as xClamp,oz as xDomain,Bz as xFontVariant,Iz as xGrid,cz as xInset,lz as xInsetLeft,uz as xInsetRight,Az as xLabel,Mz as xLabelAnchor,Ez as xLabelOffset,Tz as xLine,az as xNice,pz as xPadding,mz as xPaddingInner,yz as xPaddingOuter,sz as xRange,Nz as xReverse,dz as xRound,iz as xScale,vz as xTickFormat,wz as xTickPadding,Sz as xTickRotate,xz as xTickSize,_z as xTickSpacing,bz as xTicks,Dz as xZero,z9 as xyDomain,jz as yAlign,aV as yAriaDescription,sV as yAriaLabel,Gz as yAxis,zz as yClamp,Rz as yDomain,oV as yFontVariant,tV as yGrid,Uz as yInset,$z as yInsetBottom,Pz as yInsetTop,rV as yLabel,nV as yLabelAnchor,iV as yLabelOffset,eV as yLine,Cz as yNice,qz as yPadding,Yz as yPaddingInner,Wz as yPaddingOuter,kz as yRange,cV as yReverse,Vz as yRound,Lz as yScale,Qz as yTickFormat,Kz as yTickPadding,Jz as yTickRotate,Hz as yTickSize,Zz as yTickSpacing,Xz as yTicks,lV as yZero};
